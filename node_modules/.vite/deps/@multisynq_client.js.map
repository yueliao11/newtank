{
  "version": 3,
  "sources": ["../../toastify-js/src/toastify.js", "../../fast-json-stable-stringify/index.js", "../../fastpriorityqueue/FastPriorityQueue.js", "../../@croquet/croquet/node_modules/regenerator-runtime/runtime.js", "../../@croquet/croquet/teatime/src/urlOptions.js", "../../@croquet/croquet/teatime/thirdparty-patched/seedrandom/seedrandom.js", "../../@croquet/croquet/teatime/thirdparty-patched/qrcodejs/qrcode.js", "../../@croquet/croquet/teatime/node_modules/crypto-js/core.js", "../../@croquet/croquet/teatime/node_modules/crypto-js/lib-typedarrays.js", "../../@croquet/croquet/teatime/node_modules/crypto-js/sha256.js", "../../@croquet/croquet/teatime/src/hashing.js", "../../@croquet/croquet/teatime/src/stats.js", "../../@croquet/croquet/teatime/src/html.js", "../../@croquet/croquet/teatime/src/domain.js", "../../@croquet/croquet/teatime/src/realms.js", "../../@croquet/croquet/math/math-dist.js", "../../@croquet/croquet/teatime/src/priorityQueue.js", "../../@croquet/croquet/teatime/node_modules/crypto-js/enc-base64.js", "../../@croquet/croquet/teatime/node_modules/crypto-js/enc-utf8.js", "../../@croquet/croquet/teatime/node_modules/crypto-js/hmac.js", "../../@croquet/croquet/teatime/node_modules/crypto-js/pbkdf2.js", "../../@croquet/croquet/teatime/node_modules/crypto-js/md5.js", "../../@croquet/croquet/teatime/node_modules/crypto-js/sha1.js", "../../@croquet/croquet/teatime/node_modules/crypto-js/evpkdf.js", "../../@croquet/croquet/teatime/node_modules/crypto-js/aes.js", "../../@croquet/croquet/teatime/node_modules/crypto-js/cipher-core.js", "../../@croquet/croquet/teatime/node_modules/crypto-js/hmac-sha256.js", "../../@croquet/croquet/teatime/node_modules/pako/dist/pako.esm.mjs", "../../@croquet/croquet/teatime/src/offline.js", "../../@croquet/croquet/teatime/src/webrtc.js", "../../@croquet/croquet/teatime/src/controller.js", "../../@croquet/croquet/teatime/src/data.js", "../../@croquet/croquet/teatime/src/vm.js", "../../@croquet/croquet/teatime/src/model.js", "../../@croquet/croquet/teatime/src/view.js", "../../@croquet/croquet/teatime/src/messenger.js", "../../@croquet/croquet/teatime/src/session.js", "../../@croquet/croquet/croquet.js", "../../@multisynq/client/multisynq-client.ts"],
  "sourcesContent": ["/*!\n * Toastify js 1.12.0\n * https://github.com/apvarun/toastify-js\n * @license MIT licensed\n *\n * Copyright (C) 2018 Varun A P\n */\n(function(root, factory) {\n  if (typeof module === \"object\" && module.exports) {\n    module.exports = factory();\n  } else {\n    root.Toastify = factory();\n  }\n})(this, function(global) {\n  // Object initialization\n  var Toastify = function(options) {\n      // Returning a new init object\n      return new Toastify.lib.init(options);\n    },\n    // Library version\n    version = \"1.12.0\";\n\n  // Set the default global options\n  Toastify.defaults = {\n    oldestFirst: true,\n    text: \"Toastify is awesome!\",\n    node: undefined,\n    duration: 3000,\n    selector: undefined,\n    callback: function () {\n    },\n    destination: undefined,\n    newWindow: false,\n    close: false,\n    gravity: \"toastify-top\",\n    positionLeft: false,\n    position: '',\n    backgroundColor: '',\n    avatar: \"\",\n    className: \"\",\n    stopOnFocus: true,\n    onClick: function () {\n    },\n    offset: {x: 0, y: 0},\n    escapeMarkup: true,\n    ariaLive: 'polite',\n    style: {background: ''}\n  };\n\n  // Defining the prototype of the object\n  Toastify.lib = Toastify.prototype = {\n    toastify: version,\n\n    constructor: Toastify,\n\n    // Initializing the object with required parameters\n    init: function(options) {\n      // Verifying and validating the input object\n      if (!options) {\n        options = {};\n      }\n\n      // Creating the options object\n      this.options = {};\n\n      this.toastElement = null;\n\n      // Validating the options\n      this.options.text = options.text || Toastify.defaults.text; // Display message\n      this.options.node = options.node || Toastify.defaults.node;  // Display content as node\n      this.options.duration = options.duration === 0 ? 0 : options.duration || Toastify.defaults.duration; // Display duration\n      this.options.selector = options.selector || Toastify.defaults.selector; // Parent selector\n      this.options.callback = options.callback || Toastify.defaults.callback; // Callback after display\n      this.options.destination = options.destination || Toastify.defaults.destination; // On-click destination\n      this.options.newWindow = options.newWindow || Toastify.defaults.newWindow; // Open destination in new window\n      this.options.close = options.close || Toastify.defaults.close; // Show toast close icon\n      this.options.gravity = options.gravity === \"bottom\" ? \"toastify-bottom\" : Toastify.defaults.gravity; // toast position - top or bottom\n      this.options.positionLeft = options.positionLeft || Toastify.defaults.positionLeft; // toast position - left or right\n      this.options.position = options.position || Toastify.defaults.position; // toast position - left or right\n      this.options.backgroundColor = options.backgroundColor || Toastify.defaults.backgroundColor; // toast background color\n      this.options.avatar = options.avatar || Toastify.defaults.avatar; // img element src - url or a path\n      this.options.className = options.className || Toastify.defaults.className; // additional class names for the toast\n      this.options.stopOnFocus = options.stopOnFocus === undefined ? Toastify.defaults.stopOnFocus : options.stopOnFocus; // stop timeout on focus\n      this.options.onClick = options.onClick || Toastify.defaults.onClick; // Callback after click\n      this.options.offset = options.offset || Toastify.defaults.offset; // toast offset\n      this.options.escapeMarkup = options.escapeMarkup !== undefined ? options.escapeMarkup : Toastify.defaults.escapeMarkup;\n      this.options.ariaLive = options.ariaLive || Toastify.defaults.ariaLive;\n      this.options.style = options.style || Toastify.defaults.style;\n      if(options.backgroundColor) {\n        this.options.style.background = options.backgroundColor;\n      }\n\n      // Returning the current object for chaining functions\n      return this;\n    },\n\n    // Building the DOM element\n    buildToast: function() {\n      // Validating if the options are defined\n      if (!this.options) {\n        throw \"Toastify is not initialized\";\n      }\n\n      // Creating the DOM object\n      var divElement = document.createElement(\"div\");\n      divElement.className = \"toastify on \" + this.options.className;\n\n      // Positioning toast to left or right or center\n      if (!!this.options.position) {\n        divElement.className += \" toastify-\" + this.options.position;\n      } else {\n        // To be depreciated in further versions\n        if (this.options.positionLeft === true) {\n          divElement.className += \" toastify-left\";\n          console.warn('Property `positionLeft` will be depreciated in further versions. Please use `position` instead.')\n        } else {\n          // Default position\n          divElement.className += \" toastify-right\";\n        }\n      }\n\n      // Assigning gravity of element\n      divElement.className += \" \" + this.options.gravity;\n\n      if (this.options.backgroundColor) {\n        // This is being deprecated in favor of using the style HTML DOM property\n        console.warn('DEPRECATION NOTICE: \"backgroundColor\" is being deprecated. Please use the \"style.background\" property.');\n      }\n\n      // Loop through our style object and apply styles to divElement\n      for (var property in this.options.style) {\n        divElement.style[property] = this.options.style[property];\n      }\n\n      // Announce the toast to screen readers\n      if (this.options.ariaLive) {\n        divElement.setAttribute('aria-live', this.options.ariaLive)\n      }\n\n      // Adding the toast message/node\n      if (this.options.node && this.options.node.nodeType === Node.ELEMENT_NODE) {\n        // If we have a valid node, we insert it\n        divElement.appendChild(this.options.node)\n      } else {\n        if (this.options.escapeMarkup) {\n          divElement.innerText = this.options.text;\n        } else {\n          divElement.innerHTML = this.options.text;\n        }\n\n        if (this.options.avatar !== \"\") {\n          var avatarElement = document.createElement(\"img\");\n          avatarElement.src = this.options.avatar;\n\n          avatarElement.className = \"toastify-avatar\";\n\n          if (this.options.position == \"left\" || this.options.positionLeft === true) {\n            // Adding close icon on the left of content\n            divElement.appendChild(avatarElement);\n          } else {\n            // Adding close icon on the right of content\n            divElement.insertAdjacentElement(\"afterbegin\", avatarElement);\n          }\n        }\n      }\n\n      // Adding a close icon to the toast\n      if (this.options.close === true) {\n        // Create a span for close element\n        var closeElement = document.createElement(\"button\");\n        closeElement.type = \"button\";\n        closeElement.setAttribute(\"aria-label\", \"Close\");\n        closeElement.className = \"toast-close\";\n        closeElement.innerHTML = \"&#10006;\";\n\n        // Triggering the removal of toast from DOM on close click\n        closeElement.addEventListener(\n          \"click\",\n          function(event) {\n            event.stopPropagation();\n            this.removeElement(this.toastElement);\n            window.clearTimeout(this.toastElement.timeOutValue);\n          }.bind(this)\n        );\n\n        //Calculating screen width\n        var width = window.innerWidth > 0 ? window.innerWidth : screen.width;\n\n        // Adding the close icon to the toast element\n        // Display on the right if screen width is less than or equal to 360px\n        if ((this.options.position == \"left\" || this.options.positionLeft === true) && width > 360) {\n          // Adding close icon on the left of content\n          divElement.insertAdjacentElement(\"afterbegin\", closeElement);\n        } else {\n          // Adding close icon on the right of content\n          divElement.appendChild(closeElement);\n        }\n      }\n\n      // Clear timeout while toast is focused\n      if (this.options.stopOnFocus && this.options.duration > 0) {\n        var self = this;\n        // stop countdown\n        divElement.addEventListener(\n          \"mouseover\",\n          function(event) {\n            window.clearTimeout(divElement.timeOutValue);\n          }\n        )\n        // add back the timeout\n        divElement.addEventListener(\n          \"mouseleave\",\n          function() {\n            divElement.timeOutValue = window.setTimeout(\n              function() {\n                // Remove the toast from DOM\n                self.removeElement(divElement);\n              },\n              self.options.duration\n            )\n          }\n        )\n      }\n\n      // Adding an on-click destination path\n      if (typeof this.options.destination !== \"undefined\") {\n        divElement.addEventListener(\n          \"click\",\n          function(event) {\n            event.stopPropagation();\n            if (this.options.newWindow === true) {\n              window.open(this.options.destination, \"_blank\");\n            } else {\n              window.location = this.options.destination;\n            }\n          }.bind(this)\n        );\n      }\n\n      if (typeof this.options.onClick === \"function\" && typeof this.options.destination === \"undefined\") {\n        divElement.addEventListener(\n          \"click\",\n          function(event) {\n            event.stopPropagation();\n            this.options.onClick();\n          }.bind(this)\n        );\n      }\n\n      // Adding offset\n      if(typeof this.options.offset === \"object\") {\n\n        var x = getAxisOffsetAValue(\"x\", this.options);\n        var y = getAxisOffsetAValue(\"y\", this.options);\n\n        var xOffset = this.options.position == \"left\" ? x : \"-\" + x;\n        var yOffset = this.options.gravity == \"toastify-top\" ? y : \"-\" + y;\n\n        divElement.style.transform = \"translate(\" + xOffset + \",\" + yOffset + \")\";\n\n      }\n\n      // Returning the generated element\n      return divElement;\n    },\n\n    // Displaying the toast\n    showToast: function() {\n      // Creating the DOM object for the toast\n      this.toastElement = this.buildToast();\n\n      // Getting the root element to with the toast needs to be added\n      var rootElement;\n      if (typeof this.options.selector === \"string\") {\n        rootElement = document.getElementById(this.options.selector);\n      } else if (this.options.selector instanceof HTMLElement || (typeof ShadowRoot !== 'undefined' && this.options.selector instanceof ShadowRoot)) {\n        rootElement = this.options.selector;\n      } else {\n        rootElement = document.body;\n      }\n\n      // Validating if root element is present in DOM\n      if (!rootElement) {\n        throw \"Root element is not defined\";\n      }\n\n      // Adding the DOM element\n      var elementToInsert = Toastify.defaults.oldestFirst ? rootElement.firstChild : rootElement.lastChild;\n      rootElement.insertBefore(this.toastElement, elementToInsert);\n\n      // Repositioning the toasts in case multiple toasts are present\n      Toastify.reposition();\n\n      if (this.options.duration > 0) {\n        this.toastElement.timeOutValue = window.setTimeout(\n          function() {\n            // Remove the toast from DOM\n            this.removeElement(this.toastElement);\n          }.bind(this),\n          this.options.duration\n        ); // Binding `this` for function invocation\n      }\n\n      // Supporting function chaining\n      return this;\n    },\n\n    hideToast: function() {\n      if (this.toastElement.timeOutValue) {\n        clearTimeout(this.toastElement.timeOutValue);\n      }\n      this.removeElement(this.toastElement);\n    },\n\n    // Removing the element from the DOM\n    removeElement: function(toastElement) {\n      // Hiding the element\n      // toastElement.classList.remove(\"on\");\n      toastElement.className = toastElement.className.replace(\" on\", \"\");\n\n      // Removing the element from DOM after transition end\n      window.setTimeout(\n        function() {\n          // remove options node if any\n          if (this.options.node && this.options.node.parentNode) {\n            this.options.node.parentNode.removeChild(this.options.node);\n          }\n\n          // Remove the element from the DOM, only when the parent node was not removed before.\n          if (toastElement.parentNode) {\n            toastElement.parentNode.removeChild(toastElement);\n          }\n\n          // Calling the callback function\n          this.options.callback.call(toastElement);\n\n          // Repositioning the toasts again\n          Toastify.reposition();\n        }.bind(this),\n        400\n      ); // Binding `this` for function invocation\n    },\n  };\n\n  // Positioning the toasts on the DOM\n  Toastify.reposition = function() {\n\n    // Top margins with gravity\n    var topLeftOffsetSize = {\n      top: 15,\n      bottom: 15,\n    };\n    var topRightOffsetSize = {\n      top: 15,\n      bottom: 15,\n    };\n    var offsetSize = {\n      top: 15,\n      bottom: 15,\n    };\n\n    // Get all toast messages on the DOM\n    var allToasts = document.getElementsByClassName(\"toastify\");\n\n    var classUsed;\n\n    // Modifying the position of each toast element\n    for (var i = 0; i < allToasts.length; i++) {\n      // Getting the applied gravity\n      if (containsClass(allToasts[i], \"toastify-top\") === true) {\n        classUsed = \"toastify-top\";\n      } else {\n        classUsed = \"toastify-bottom\";\n      }\n\n      var height = allToasts[i].offsetHeight;\n      classUsed = classUsed.substr(9, classUsed.length-1)\n      // Spacing between toasts\n      var offset = 15;\n\n      var width = window.innerWidth > 0 ? window.innerWidth : screen.width;\n\n      // Show toast in center if screen with less than or equal to 360px\n      if (width <= 360) {\n        // Setting the position\n        allToasts[i].style[classUsed] = offsetSize[classUsed] + \"px\";\n\n        offsetSize[classUsed] += height + offset;\n      } else {\n        if (containsClass(allToasts[i], \"toastify-left\") === true) {\n          // Setting the position\n          allToasts[i].style[classUsed] = topLeftOffsetSize[classUsed] + \"px\";\n\n          topLeftOffsetSize[classUsed] += height + offset;\n        } else {\n          // Setting the position\n          allToasts[i].style[classUsed] = topRightOffsetSize[classUsed] + \"px\";\n\n          topRightOffsetSize[classUsed] += height + offset;\n        }\n      }\n    }\n\n    // Supporting function chaining\n    return this;\n  };\n\n  // Helper function to get offset.\n  function getAxisOffsetAValue(axis, options) {\n\n    if(options.offset[axis]) {\n      if(isNaN(options.offset[axis])) {\n        return options.offset[axis];\n      }\n      else {\n        return options.offset[axis] + 'px';\n      }\n    }\n\n    return '0px';\n\n  }\n\n  function containsClass(elem, yourClass) {\n    if (!elem || typeof yourClass !== \"string\") {\n      return false;\n    } else if (\n      elem.className &&\n      elem.className\n        .trim()\n        .split(/\\s+/gi)\n        .indexOf(yourClass) > -1\n    ) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  // Setting up the prototype for the init object\n  Toastify.lib.init.prototype = Toastify.lib;\n\n  // Returning the Toastify function to be assigned to the window object/module\n  return Toastify;\n});\n", "'use strict';\n\nmodule.exports = function (data, opts) {\n    if (!opts) opts = {};\n    if (typeof opts === 'function') opts = { cmp: opts };\n    var cycles = (typeof opts.cycles === 'boolean') ? opts.cycles : false;\n\n    var cmp = opts.cmp && (function (f) {\n        return function (node) {\n            return function (a, b) {\n                var aobj = { key: a, value: node[a] };\n                var bobj = { key: b, value: node[b] };\n                return f(aobj, bobj);\n            };\n        };\n    })(opts.cmp);\n\n    var seen = [];\n    return (function stringify (node) {\n        if (node && node.toJSON && typeof node.toJSON === 'function') {\n            node = node.toJSON();\n        }\n\n        if (node === undefined) return;\n        if (typeof node == 'number') return isFinite(node) ? '' + node : 'null';\n        if (typeof node !== 'object') return JSON.stringify(node);\n\n        var i, out;\n        if (Array.isArray(node)) {\n            out = '[';\n            for (i = 0; i < node.length; i++) {\n                if (i) out += ',';\n                out += stringify(node[i]) || 'null';\n            }\n            return out + ']';\n        }\n\n        if (node === null) return 'null';\n\n        if (seen.indexOf(node) !== -1) {\n            if (cycles) return JSON.stringify('__cycle__');\n            throw new TypeError('Converting circular structure to JSON');\n        }\n\n        var seenIndex = seen.push(node) - 1;\n        var keys = Object.keys(node).sort(cmp && cmp(node));\n        out = '';\n        for (i = 0; i < keys.length; i++) {\n            var key = keys[i];\n            var value = stringify(node[key]);\n\n            if (!value) continue;\n            if (out) out += ',';\n            out += JSON.stringify(key) + ':' + value;\n        }\n        seen.splice(seenIndex, 1);\n        return '{' + out + '}';\n    })(data);\n};\n", "/**\n * FastPriorityQueue.js : a fast heap-based priority queue  in JavaScript.\n * (c) the authors\n * Licensed under the Apache License, Version 2.0.\n *\n * Speed-optimized heap-based priority queue for modern browsers and JavaScript engines.\n *\n * Usage :\n         Installation (in shell, if you use node):\n         $ npm install fastpriorityqueue\n\n         Running test program (in JavaScript):\n\n         // var FastPriorityQueue = require(\"fastpriorityqueue\");// in node\n         var x = new FastPriorityQueue();\n         x.add(1);\n         x.add(0);\n         x.add(5);\n         x.add(4);\n         x.add(3);\n         x.peek(); // should return 0, leaves x unchanged\n         x.size; // should return 5, leaves x unchanged\n         while(!x.isEmpty()) {\n           console.log(x.poll());\n         } // will print 0 1 3 4 5\n         x.trim(); // (optional) optimizes memory usage\n */\n'use strict';\n\nvar defaultcomparator = function(a, b) {\n  return a < b;\n};\n\n\n// construct a new priority queue\n// the provided comparator function should take a, b and return *true* when a < b\nfunction FastPriorityQueue(comparator) {\n  if (!(this instanceof FastPriorityQueue)) return new FastPriorityQueue(comparator);\n  this.array = [];\n  this.size = 0;\n  this.compare = comparator || defaultcomparator;\n}\n\n// copy the priority queue into another, and return it. Queue items are shallow-copied.\n// Runs in `O(n)` time.\nFastPriorityQueue.prototype.clone = function() {\n  var fpq = new FastPriorityQueue(this.compare);\n  fpq.size = this.size;\n  fpq.array = this.array.slice(0, this.size);\n  return fpq;\n};\n\n// add an element into the queue\n// runs in `O(log n)` time\nFastPriorityQueue.prototype.add = function(myval) {\n  var i = this.size;\n  this.array[this.size] = myval;\n  this.size += 1;\n  var p;\n  var ap;\n  while (i > 0) {\n    p = (i - 1) >> 1;\n    ap = this.array[p];\n    if (!this.compare(myval, ap)) {\n      break;\n    }\n    this.array[i] = ap;\n    i = p;\n  }\n  this.array[i] = myval;\n};\n\n// replace the content of the heap by provided array and \"heapify it\"\nFastPriorityQueue.prototype.heapify = function(arr) {\n  this.array = arr;\n  this.size = arr.length;\n  var i;\n  for (i = this.size >> 1; i >= 0; i--) {\n    this._percolateDown(i);\n  }\n};\n\n// for internal use\nFastPriorityQueue.prototype._percolateUp = function(i, force) {\n  var myval = this.array[i];\n  var p;\n  var ap;\n  while (i > 0) {\n    p = (i - 1) >> 1;\n    ap = this.array[p];\n    // force will skip the compare\n    if (!force && !this.compare(myval, ap)) {\n      break;\n    }\n    this.array[i] = ap;\n    i = p;\n  }\n  this.array[i] = myval;\n};\n\n// for internal use\nFastPriorityQueue.prototype._percolateDown = function(i) {\n  var size = this.size;\n  var hsize = this.size >>> 1;\n  var ai = this.array[i];\n  var l;\n  var r;\n  var bestc;\n  while (i < hsize) {\n    l = (i << 1) + 1;\n    r = l + 1;\n    bestc = this.array[l];\n    if (r < size) {\n      if (this.compare(this.array[r], bestc)) {\n        l = r;\n        bestc = this.array[r];\n      }\n    }\n    if (!this.compare(bestc, ai)) {\n      break;\n    }\n    this.array[i] = bestc;\n    i = l;\n  }\n  this.array[i] = ai;\n};\n\n// internal\n// _removeAt(index) will remove the item at the given index from the queue,\n// retaining balance. returns the removed item, or undefined if nothing is removed.\nFastPriorityQueue.prototype._removeAt = function(index) {\n  if (index > this.size - 1 || index < 0) return undefined;\n\n  // impl1:\n  //this.array.splice(index, 1);\n  //this.heapify(this.array);\n  // impl2:\n  this._percolateUp(index, true);\n  return this.poll();\n};\n\n// remove(myval) will remove an item matching the provided value from the\n// queue, checked for equality by using the queue's comparator.\n// return true if removed, false otherwise.\nFastPriorityQueue.prototype.remove = function(myval) {\n  for (var i = 0; i < this.size; i++) {\n    if (!this.compare(this.array[i], myval) && !this.compare(myval, this.array[i])) {\n      // items match, comparator returns false both ways, remove item\n      this._removeAt(i);\n      return true;\n    }\n  }\n  return false;\n};\n\n// removeOne(callback) will execute the callback function for each item of the queue\n// and will remove the first item for which the callback will return true.\n// return the removed item, or undefined if nothing is removed.\nFastPriorityQueue.prototype.removeOne = function(callback) {\n  if (typeof callback !== \"function\") {\n    return undefined;\n  }\n  for (var i = 0; i < this.size; i++) {\n    if (callback(this.array[i])) {\n      return this._removeAt(i);\n    }\n  }\n};\n\n// remove(callback[, limit]) will execute the callback function for each item of\n// the queue and will remove each item for which the callback returns true, up to\n// a max limit of removed items if specified or no limit if unspecified.\n// return an array containing the removed items.\n// The callback function should be a pure function.\nFastPriorityQueue.prototype.removeMany = function(callback, limit) {\n  // Skip unnecessary processing for edge cases\n  if (typeof callback !== \"function\" || this.size < 1) {\n    return [];\n  }\n  limit = limit ? Math.min(limit, this.size) : this.size;\n\n  // Prepare the results container to hold up to the results limit\n  var resultSize = 0;\n  var result = new Array(limit);\n\n  // Prepare a temporary array to hold items we'll traverse through and need to keep\n  var tmpSize = 0;\n  var tmp = new Array(this.size);\n\n  while (resultSize < limit && !this.isEmpty()) {\n    // Dequeue items into either the results or our temporary array\n    var item = this.poll();\n    if (callback(item)) {\n      result[resultSize++] = item;\n    } else {\n      tmp[tmpSize++] = item;\n    }\n  }\n  // Update the result array with the exact number of results\n  result.length = resultSize;\n\n  // Re-add all the items we can keep\n  var i = 0;\n  while (i < tmpSize) {\n    this.add(tmp[i++]);\n  }\n\n  return result;\n};\n\n// Look at the top of the queue (one of the smallest elements) without removing it\n// executes in constant time\n//\n// Calling peek on an empty priority queue returns\n// the \"undefined\" value.\n// https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/undefined\n//\nFastPriorityQueue.prototype.peek = function() {\n  if (this.size == 0) return undefined;\n  return this.array[0];\n};\n\n// remove the element on top of the heap (one of the smallest elements)\n// runs in logarithmic time\n//\n// If the priority queue is empty, the function returns the\n// \"undefined\" value.\n// https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/undefined\n//\n// For long-running and large priority queues, or priority queues\n// storing large objects, you may  want to call the trim function\n// at strategic times to recover allocated memory.\nFastPriorityQueue.prototype.poll = function() {\n  if (this.size == 0) return undefined;\n  var ans = this.array[0];\n  if (this.size > 1) {\n    this.array[0] = this.array[--this.size];\n    this._percolateDown(0);\n  } else {\n    this.size -= 1;\n  }\n  return ans;\n};\n\n// This function adds the provided value to the heap, while removing\n// and returning one of the smallest elements (like poll). The size of the queue\n// thus remains unchanged.\nFastPriorityQueue.prototype.replaceTop = function(myval) {\n  if (this.size == 0) return undefined;\n  var ans = this.array[0];\n  this.array[0] = myval;\n  this._percolateDown(0);\n  return ans;\n};\n\n// recover unused memory (for long-running priority queues)\nFastPriorityQueue.prototype.trim = function() {\n  this.array = this.array.slice(0, this.size);\n};\n\n// Check whether the heap is empty\nFastPriorityQueue.prototype.isEmpty = function() {\n  return this.size === 0;\n};\n\n// iterate over the items in order, pass a callback that receives (item, index) as args.\n// TODO once we transpile, uncomment\n// if (Symbol && Symbol.iterator) {\n//   FastPriorityQueue.prototype[Symbol.iterator] = function*() {\n//     if (this.isEmpty()) return;\n//     var fpq = this.clone();\n//     while (!fpq.isEmpty()) {\n//       yield fpq.poll();\n//     }\n//   };\n// }\nFastPriorityQueue.prototype.forEach = function(callback) {\n  if (this.isEmpty() || typeof callback != 'function') return;\n  var i = 0;\n  var fpq = this.clone();\n  while (!fpq.isEmpty()) {\n    callback(fpq.poll(), i++);\n  }\n};\n\n// return the k 'smallest' elements of the queue as an array,\n// runs in O(k log k) time, the elements are not removed\n// from the priority queue.\nFastPriorityQueue.prototype.kSmallest = function(k) {\n  if ((this.size == 0) || (k<=0)) return [];\n  k = Math.min(this.size, k);\n  const newSize = Math.min(this.size, (2 ** (k - 1)) + 1);\n  if (newSize < 2) { return [this.peek()] }\n\n  const fpq = new FastPriorityQueue(this.compare);\n  fpq.size = newSize;\n  fpq.array = this.array.slice(0, newSize);\n\n  const smallest = new Array(k);\n  for (let i = 0; i < k; i++) {\n    smallest[i] = fpq.poll();\n  }\n  return smallest;\n}\n\nmodule.exports = FastPriorityQueue;\n", "/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var defineProperty = Object.defineProperty || function (obj, key, desc) { obj[key] = desc.value; };\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    defineProperty(generator, \"_invoke\", { value: makeInvokeMethod(innerFn, self, context) });\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = GeneratorFunctionPrototype;\n  defineProperty(Gp, \"constructor\", { value: GeneratorFunctionPrototype, configurable: true });\n  defineProperty(\n    GeneratorFunctionPrototype,\n    \"constructor\",\n    { value: GeneratorFunction, configurable: true }\n  );\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    defineProperty(this, \"_invoke\", { value: enqueue });\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  });\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per GeneratorResume behavior specified since ES2015:\n        // ES2015 spec, step 3: https://262.ecma-international.org/6.0/#sec-generatorresume\n        // Latest spec, step 2: https://tc39.es/ecma262/#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var methodName = context.method;\n    var method = delegate.iterator[methodName];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method, or a missing .next method, always terminate the\n      // yield* loop.\n      context.delegate = null;\n\n      // Note: [\"return\"] must be used for ES3 parsing compatibility.\n      if (methodName === \"throw\" && delegate.iterator[\"return\"]) {\n        // If the delegate iterator has a return method, give it a\n        // chance to clean up.\n        context.method = \"return\";\n        context.arg = undefined;\n        maybeInvokeDelegate(delegate, context);\n\n        if (context.method === \"throw\") {\n          // If maybeInvokeDelegate(context) changed context.method from\n          // \"return\" to \"throw\", let that override the TypeError below.\n          return ContinueSentinel;\n        }\n      }\n      if (methodName !== \"return\") {\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a '\" + methodName + \"' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  define(Gp, iteratorSymbol, function() {\n    return this;\n  });\n\n  define(Gp, \"toString\", function() {\n    return \"[object Generator]\";\n  });\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(val) {\n    var object = Object(val);\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable != null) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    throw new TypeError(typeof iterable + \" is not iterable\");\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, in modern engines\n  // we can explicitly access globalThis. In older engines we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n", "const sessionFromPath = window && window.location.hostname.endsWith(\"croquet.studio\");\nlet sessionApp = \"\";\nlet sessionArgs = \"\";\n\nclass UrlOptions {\n    constructor() {\n        this.getSession();\n        parseUrlOptionString(this, window.location.search.slice(1));\n        parseUrlOptionString(this, sessionFromPath ? window.location.hash.slice(1) : sessionArgs);\n        if (window.location.pathname.indexOf('/ar.html') >= 0) this.ar = true;\n    }\n\n    /**\n     * - has(\"debug\", \"recv\", false) matches debug=recv and debug=send,recv\n     * - has(\"debug\", \"recv\", true) matches debug=norecv and debug=send,norecv\n     * - has(\"debug\", \"recv\", \"localhost\") defaults to true on localhost, false otherwise\n     *\n     * @param {String} key - key for list of items\n     * @param {String} item - value to look for in list of items\n     * @param {Boolean|String} defaultValue - if string, true on that hostname, false otherwise\n     */\n    has(key, item, defaultValue = false) {\n        if (typeof defaultValue === \"string\") defaultValue = this.isHost(defaultValue);\n        const urlString = this[key];\n        if (typeof urlString !== \"string\") return defaultValue;\n        const urlItems = urlString.split(',');\n        if (defaultValue === true) item =`no${item}`;\n        if (item.endsWith(\"s\")) item = item.slice(0, -1);\n        if (urlItems.includes(item) || urlItems.includes(`${item}s`)) return !defaultValue;\n        return defaultValue;\n    }\n\n    /** Extract session from either path or hash or option\n     * - on croquet.studio, it is \"/app/session/with/slashes\"\n     * - elsewhere, it is \"...#session/with/slashes&...\"\n     * - or optionally, passed as \"session=session/with/slashes\"\n     * @return {String} \"\" or \"session/with/slashes\"\n     */\n    getSession() {\n        // extract app and session from /(app)/(session)\n        if (sessionFromPath) {\n            const PATH_REGEX = /^\\/([^/]+)\\/(.*)$/;\n            const pathMatch = window.location.pathname.match(PATH_REGEX);\n            if (pathMatch) {\n                sessionApp = pathMatch[1];     // used in setSession()\n                return pathMatch[2];\n            }\n        } else {\n            // extract session and args from #(session)&(arg=val&arg)\n            const HASH_REGEX = /^#([^&]+)&?(.*)$/;\n            const hashMatch = window.location.hash.match(HASH_REGEX);\n            if (hashMatch) {\n                // if first match includes \"=\" it's not a session\n                if (hashMatch[1].includes(\"=\")) {\n                    sessionArgs = `${hashMatch[1]}&${hashMatch[2]}`;\n                    return \"\";\n                }\n                sessionArgs = hashMatch[2];    // used in setSession()\n                return hashMatch[1];\n            }\n        }\n        // check session arg\n        if (typeof this.session === \"string\") {\n            sessionArgs = window.location.hash.slice(1);\n            return this.session;\n        }\n        // no session\n        return \"\";\n    }\n\n    setSession(session, replace=false) {\n        // make sure sessionFromPath, sessionApp and sessionArgs\n        // are initialized\n        if (sessionFromPath == null) this.getSession();\n        const {search, hash} = window.location;\n        const url = sessionFromPath\n            ? `/${sessionApp}/${session}${search}${hash}`\n            : `#${session}${sessionArgs ? \"&\" + sessionArgs: \"\"}`;\n        if (replace) window.history.replaceState({}, \"\", url);\n        else window.history.pushState({}, \"\", url);\n    }\n\n    isHost(hostname) {\n        const actualHostname = window.location.hostname;\n        if (actualHostname === hostname) return true;\n        if (hostname !== \"localhost\") return false;\n        // answer true for a variety of localhost equivalents\n        if (actualHostname.endsWith(\".ngrok.io\")) return true;\n        if (actualHostname === \"croquet.io\") {\n            const path = window.location.pathname;\n            if (path.match(/^\\/(dev|files)\\//)) return true;\n        }\n        if (window.location.protocol === \"file:\") return true;\n        return [\"127.0.0.1\", \"[::1]\"].includes(actualHostname);\n    }\n\n    isLocalhost() {\n        return this.isHost(\"localhost\");\n    }\n}\n\nfunction parseUrlOptionString(target, optionString) {\n    if (!optionString) return;\n    for (const arg of optionString.split(\"&\")) {\n        const keyAndVal = arg.split(\"=\");\n        const key = keyAndVal[0];\n        let val = true;\n        if (keyAndVal.length > 1) {\n            val = decodeURIComponent(keyAndVal.slice(1).join(\"=\"));\n            if (val.match(/^(true|false|null|[0-9.]*|[\"[{].*)$/)) {\n                try { val = JSON.parse(val); } catch (e) {\n                    if (val[0] === \"[\") val = val.slice(1, -1).split(\",\"); // handle string arrays\n                    // if not JSON use string itself\n                }\n            }\n        }\n        target[key] = val;\n    }\n}\n\nconst urlOptions = new UrlOptions();\nexport default urlOptions;\n", "/*\nCopyright 2019 David Bau.\n\nPermission is hereby granted, free of charge, to any person obtaining\na copy of this software and associated documentation files (the\n\"Software\"), to deal in the Software without restriction, including\nwithout limitation the rights to use, copy, modify, merge, publish,\ndistribute, sublicense, and/or sell copies of the Software, and to\npermit persons to whom the Software is furnished to do so, subject to\nthe following conditions:\n\nThe above copyright notice and this permission notice shall be\nincluded in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\nIN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\nCLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\nTORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\nSOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nPatched 2025 by Croquet Labs to:\n- remove import of `crypto` module\n- use ES6 module syntax.\n- remove Math patching\n- remove global entropy pool and autoseeding\n- remove unused code\n\n*/\n\n//\n// The following constants are related to IEEE 754 limits.\n//\n\nvar width = 256,        // each RC4 output is 0 <= x < 256\n    chunks = 6,         // at least six RC4 outputs for each double\n    digits = 52,        // there are 52 significant digits in a double\n    startdenom = Math.pow(width, chunks),\n    significance = Math.pow(2, digits),\n    overflow = significance * 2,\n    mask = width - 1;\n\n//\n// seedrandom()\n//\nfunction seedrandom(seed, options) {\n  var key = [];\n  options = options || {};\n\n  if (options.entropy) throw new Error('this version of seedrandom does not support entropy');\n  if (seed == null && !options.state) throw new Error('this version of seedrandom requires a seed');\n\n  // Flatten the seed string\n  mixkey(flatten(seed, 3), key);\n\n  // Use the seed to initialize an ARC4 generator.\n  var arc4 = new ARC4(key);\n\n  // This function returns a random double in [0, 1) that contains\n  // randomness in every bit of the mantissa of the IEEE 754 value.\n  var prng = function() {\n    var n = arc4.g(chunks),             // Start with a numerator n < 2 ^ 48\n        d = startdenom,                 //   and denominator d = 2 ^ 48.\n        x = 0;                          //   and no 'extra last byte'.\n    while (n < significance) {          // Fill up all significant digits by\n      n = (n + x) * width;              //   shifting numerator and\n      d *= width;                       //   denominator and generating a\n      x = arc4.g(1);                    //   new least-significant-byte.\n    }\n    while (n >= overflow) {             // To avoid rounding up, before adding\n      n /= 2;                           //   last byte, shift everything\n      d /= 2;                           //   right using integer math until\n      x >>>= 1;                         //   we have exactly the desired bits.\n    }\n    return (n + x) / d;                 // Form the number within [0, 1).\n  };\n\n  prng.int32 = function() { return arc4.g(4) | 0; }\n  prng.quick = function() { return arc4.g(4) / 0x100000000; }\n  prng.double = prng;\n\n  return (options.pass ||\n      function(prng, state) {\n        if (state) {\n          // Load the arc4 state from the given state if it has an S array.\n          if (state.S) { copy(state, arc4); }\n          // Only provide the .state method if requested via options.state.\n          prng.state = function() { return copy(arc4, {}); }\n        }\n        return prng;\n      })(\n  prng,\n  options.state);\n}\n\n//\n// ARC4\n//\n// An ARC4 implementation.  The constructor takes a key in the form of\n// an array of at most (width) integers that should be 0 <= x < (width).\n//\n// The g(count) method returns a pseudorandom integer that concatenates\n// the next (count) outputs from ARC4.  Its return value is a number x\n// that is in the range 0 <= x < (width ^ count).\n//\nfunction ARC4(key) {\n  var t, keylen = key.length,\n      me = this, i = 0, j = me.i = me.j = 0, s = me.S = [];\n\n  // The empty key [] is treated as [0].\n  if (!keylen) { key = [keylen++]; }\n\n  // Set up S using the standard key scheduling algorithm.\n  while (i < width) {\n    s[i] = i++;\n  }\n  for (i = 0; i < width; i++) {\n    s[i] = s[j = mask & (j + key[i % keylen] + (t = s[i]))];\n    s[j] = t;\n  }\n\n  // The \"g\" method returns the next (count) outputs as one number.\n  (me.g = function(count) {\n    // Using instance members instead of closure state nearly doubles speed.\n    var t, r = 0,\n        i = me.i, j = me.j, s = me.S;\n    while (count--) {\n      t = s[i = mask & (i + 1)];\n      r = r * width + s[mask & ((s[i] = s[j = mask & (j + t)]) + (s[j] = t))];\n    }\n    me.i = i; me.j = j;\n    return r;\n    // For robust unpredictability, the function call below automatically\n    // discards an initial batch of values.  This is called RC4-drop[256].\n    // See http://google.com/search?q=rsa+fluhrer+response&btnI\n  })(width);\n}\n\n//\n// copy()\n// Copies internal state of ARC4 to or from a plain object.\n//\nfunction copy(f, t) {\n  t.i = f.i;\n  t.j = f.j;\n  t.S = f.S.slice();\n  return t;\n};\n\n//\n// flatten()\n// Converts an object tree to nested arrays of strings.\n//\nfunction flatten(obj, depth) {\n  var result = [], typ = (typeof obj), prop;\n  if (depth && typ == 'object') {\n    for (prop in obj) {\n      try { result.push(flatten(obj[prop], depth - 1)); } catch (e) {}\n    }\n  }\n  return (result.length ? result : typ == 'string' ? obj : obj + '\\0');\n}\n\n//\n// mixkey()\n// Mixes a string seed into a key that is an array of integers, and\n// returns a shortened string seed that is equivalent to the result key.\n//\nfunction mixkey(seed, key) {\n  var stringseed = seed + '', smear, j = 0;\n  while (j < stringseed.length) {\n    key[mask & j] =\n      mask & ((smear ^= key[mask & j] * 19) + stringseed.charCodeAt(j++));\n  }\n  return tostring(key);\n}\n\n//\n// tostring()\n// Converts an array of charcodes to a string\n//\nfunction tostring(a) {\n  return String.fromCharCode.apply(0, a);\n}\n\nexport default seedrandom;\n", "/**\n * @fileoverview\n * - Using the 'QRCode for Javascript library'\n * - Fixed dataset of 'QRCode for Javascript library' for support full-spec.\n * - this library has no dependencies.\n *\n * @author davidshimjs\n * @see <a href=\"http://www.d-project.com/\" target=\"_blank\">http://www.d-project.com/</a>\n * @see <a href=\"http://jeromeetienne.github.com/jquery-qrcode/\" target=\"_blank\">http://jeromeetienne.github.com/jquery-qrcode/</a>\n */\nvar QRCode;\n\n(function () {\n\t//---------------------------------------------------------------------\n\t// QRCode for JavaScript\n\t//\n\t// Copyright (c) 2009 Kazuhiko Arase\n\t//\n\t// URL: http://www.d-project.com/\n\t//\n\t// Licensed under the MIT license:\n\t//   http://www.opensource.org/licenses/mit-license.php\n\t//\n\t// The word \"QR Code\" is registered trademark of\n\t// DENSO WAVE INCORPORATED\n\t//   http://www.denso-wave.com/qrcode/faqpatent-e.html\n\t//\n\t//---------------------------------------------------------------------\n\tfunction QR8bitByte(data) {\n\t\tthis.mode = QRMode.MODE_8BIT_BYTE;\n\t\tthis.data = data;\n\t\tthis.parsedData = [];\n\n\t\t// Added to support UTF-8 Characters\n\t\tfor (var i = 0, l = this.data.length; i < l; i++) {\n\t\t\tvar byteArray = [];\n\t\t\tvar code = this.data.charCodeAt(i);\n\n\t\t\tif (code > 0x10000) {\n\t\t\t\tbyteArray[0] = 0xF0 | ((code & 0x1C0000) >>> 18);\n\t\t\t\tbyteArray[1] = 0x80 | ((code & 0x3F000) >>> 12);\n\t\t\t\tbyteArray[2] = 0x80 | ((code & 0xFC0) >>> 6);\n\t\t\t\tbyteArray[3] = 0x80 | (code & 0x3F);\n\t\t\t} else if (code > 0x800) {\n\t\t\t\tbyteArray[0] = 0xE0 | ((code & 0xF000) >>> 12);\n\t\t\t\tbyteArray[1] = 0x80 | ((code & 0xFC0) >>> 6);\n\t\t\t\tbyteArray[2] = 0x80 | (code & 0x3F);\n\t\t\t} else if (code > 0x80) {\n\t\t\t\tbyteArray[0] = 0xC0 | ((code & 0x7C0) >>> 6);\n\t\t\t\tbyteArray[1] = 0x80 | (code & 0x3F);\n\t\t\t} else {\n\t\t\t\tbyteArray[0] = code;\n\t\t\t}\n\n\t\t\tthis.parsedData.push(byteArray);\n\t\t}\n\n\t\tthis.parsedData = Array.prototype.concat.apply([], this.parsedData);\n\n\t\tif (this.parsedData.length != this.data.length) {\n\t\t\tthis.parsedData.unshift(191);\n\t\t\tthis.parsedData.unshift(187);\n\t\t\tthis.parsedData.unshift(239);\n\t\t}\n\t}\n\n\tQR8bitByte.prototype = {\n\t\tgetLength: function (buffer) {\n\t\t\treturn this.parsedData.length;\n\t\t},\n\t\twrite: function (buffer) {\n\t\t\tfor (var i = 0, l = this.parsedData.length; i < l; i++) {\n\t\t\t\tbuffer.put(this.parsedData[i], 8);\n\t\t\t}\n\t\t}\n\t};\n\n\tfunction QRCodeModel(typeNumber, errorCorrectLevel) {\n\t\tthis.typeNumber = typeNumber;\n\t\tthis.errorCorrectLevel = errorCorrectLevel;\n\t\tthis.modules = null;\n\t\tthis.moduleCount = 0;\n\t\tthis.dataCache = null;\n\t\tthis.dataList = [];\n\t}\n\n\tQRCodeModel.prototype={addData:function(data){var newData=new QR8bitByte(data);this.dataList.push(newData);this.dataCache=null;},isDark:function(row,col){if(row<0||this.moduleCount<=row||col<0||this.moduleCount<=col){throw new Error(row+\",\"+col);}\n\treturn this.modules[row][col];},getModuleCount:function(){return this.moduleCount;},make:function(){this.makeImpl(false,this.getBestMaskPattern());},makeImpl:function(test,maskPattern){this.moduleCount=this.typeNumber*4+17;this.modules=new Array(this.moduleCount);for(var row=0;row<this.moduleCount;row++){this.modules[row]=new Array(this.moduleCount);for(var col=0;col<this.moduleCount;col++){this.modules[row][col]=null;}}\n\tthis.setupPositionProbePattern(0,0);this.setupPositionProbePattern(this.moduleCount-7,0);this.setupPositionProbePattern(0,this.moduleCount-7);this.setupPositionAdjustPattern();this.setupTimingPattern();this.setupTypeInfo(test,maskPattern);if(this.typeNumber>=7){this.setupTypeNumber(test);}\n\tif(this.dataCache==null){this.dataCache=QRCodeModel.createData(this.typeNumber,this.errorCorrectLevel,this.dataList);}\n\tthis.mapData(this.dataCache,maskPattern);},setupPositionProbePattern:function(row,col){for(var r=-1;r<=7;r++){if(row+r<=-1||this.moduleCount<=row+r)continue;for(var c=-1;c<=7;c++){if(col+c<=-1||this.moduleCount<=col+c)continue;if((0<=r&&r<=6&&(c==0||c==6))||(0<=c&&c<=6&&(r==0||r==6))||(2<=r&&r<=4&&2<=c&&c<=4)){this.modules[row+r][col+c]=true;}else{this.modules[row+r][col+c]=false;}}}},getBestMaskPattern:function(){var minLostPoint=0;var pattern=0;for(var i=0;i<8;i++){this.makeImpl(true,i);var lostPoint=QRUtil.getLostPoint(this);if(i==0||minLostPoint>lostPoint){minLostPoint=lostPoint;pattern=i;}}\n\treturn pattern;},createMovieClip:function(target_mc,instance_name,depth){var qr_mc=target_mc.createEmptyMovieClip(instance_name,depth);var cs=1;this.make();for(var row=0;row<this.modules.length;row++){var y=row*cs;for(var col=0;col<this.modules[row].length;col++){var x=col*cs;var dark=this.modules[row][col];if(dark){qr_mc.beginFill(0,100);qr_mc.moveTo(x,y);qr_mc.lineTo(x+cs,y);qr_mc.lineTo(x+cs,y+cs);qr_mc.lineTo(x,y+cs);qr_mc.endFill();}}}\n\treturn qr_mc;},setupTimingPattern:function(){for(var r=8;r<this.moduleCount-8;r++){if(this.modules[r][6]!=null){continue;}\n\tthis.modules[r][6]=(r%2==0);}\n\tfor(var c=8;c<this.moduleCount-8;c++){if(this.modules[6][c]!=null){continue;}\n\tthis.modules[6][c]=(c%2==0);}},setupPositionAdjustPattern:function(){var pos=QRUtil.getPatternPosition(this.typeNumber);for(var i=0;i<pos.length;i++){for(var j=0;j<pos.length;j++){var row=pos[i];var col=pos[j];if(this.modules[row][col]!=null){continue;}\n\tfor(var r=-2;r<=2;r++){for(var c=-2;c<=2;c++){if(r==-2||r==2||c==-2||c==2||(r==0&&c==0)){this.modules[row+r][col+c]=true;}else{this.modules[row+r][col+c]=false;}}}}}},setupTypeNumber:function(test){var bits=QRUtil.getBCHTypeNumber(this.typeNumber);for(var i=0;i<18;i++){var mod=(!test&&((bits>>i)&1)==1);this.modules[Math.floor(i/3)][i%3+this.moduleCount-8-3]=mod;}\n\tfor(var i=0;i<18;i++){var mod=(!test&&((bits>>i)&1)==1);this.modules[i%3+this.moduleCount-8-3][Math.floor(i/3)]=mod;}},setupTypeInfo:function(test,maskPattern){var data=(this.errorCorrectLevel<<3)|maskPattern;var bits=QRUtil.getBCHTypeInfo(data);for(var i=0;i<15;i++){var mod=(!test&&((bits>>i)&1)==1);if(i<6){this.modules[i][8]=mod;}else if(i<8){this.modules[i+1][8]=mod;}else{this.modules[this.moduleCount-15+i][8]=mod;}}\n\tfor(var i=0;i<15;i++){var mod=(!test&&((bits>>i)&1)==1);if(i<8){this.modules[8][this.moduleCount-i-1]=mod;}else if(i<9){this.modules[8][15-i-1+1]=mod;}else{this.modules[8][15-i-1]=mod;}}\n\tthis.modules[this.moduleCount-8][8]=(!test);},mapData:function(data,maskPattern){var inc=-1;var row=this.moduleCount-1;var bitIndex=7;var byteIndex=0;for(var col=this.moduleCount-1;col>0;col-=2){if(col==6)col--;while(true){for(var c=0;c<2;c++){if(this.modules[row][col-c]==null){var dark=false;if(byteIndex<data.length){dark=(((data[byteIndex]>>>bitIndex)&1)==1);}\n\tvar mask=QRUtil.getMask(maskPattern,row,col-c);if(mask){dark=!dark;}\n\tthis.modules[row][col-c]=dark;bitIndex--;if(bitIndex==-1){byteIndex++;bitIndex=7;}}}\n\trow+=inc;if(row<0||this.moduleCount<=row){row-=inc;inc=-inc;break;}}}}};QRCodeModel.PAD0=0xEC;QRCodeModel.PAD1=0x11;QRCodeModel.createData=function(typeNumber,errorCorrectLevel,dataList){var rsBlocks=QRRSBlock.getRSBlocks(typeNumber,errorCorrectLevel);var buffer=new QRBitBuffer();for(var i=0;i<dataList.length;i++){var data=dataList[i];buffer.put(data.mode,4);buffer.put(data.getLength(),QRUtil.getLengthInBits(data.mode,typeNumber));data.write(buffer);}\n\tvar totalDataCount=0;for(var i=0;i<rsBlocks.length;i++){totalDataCount+=rsBlocks[i].dataCount;}\n\tif(buffer.getLengthInBits()>totalDataCount*8){throw new Error(\"code length overflow. (\"\n\t+buffer.getLengthInBits()\n\t+\">\"\n\t+totalDataCount*8\n\t+\")\");}\n\tif(buffer.getLengthInBits()+4<=totalDataCount*8){buffer.put(0,4);}\n\twhile(buffer.getLengthInBits()%8!=0){buffer.putBit(false);}\n\twhile(true){if(buffer.getLengthInBits()>=totalDataCount*8){break;}\n\tbuffer.put(QRCodeModel.PAD0,8);if(buffer.getLengthInBits()>=totalDataCount*8){break;}\n\tbuffer.put(QRCodeModel.PAD1,8);}\n\treturn QRCodeModel.createBytes(buffer,rsBlocks);};QRCodeModel.createBytes=function(buffer,rsBlocks){var offset=0;var maxDcCount=0;var maxEcCount=0;var dcdata=new Array(rsBlocks.length);var ecdata=new Array(rsBlocks.length);for(var r=0;r<rsBlocks.length;r++){var dcCount=rsBlocks[r].dataCount;var ecCount=rsBlocks[r].totalCount-dcCount;maxDcCount=Math.max(maxDcCount,dcCount);maxEcCount=Math.max(maxEcCount,ecCount);dcdata[r]=new Array(dcCount);for(var i=0;i<dcdata[r].length;i++){dcdata[r][i]=0xff&buffer.buffer[i+offset];}\n\toffset+=dcCount;var rsPoly=QRUtil.getErrorCorrectPolynomial(ecCount);var rawPoly=new QRPolynomial(dcdata[r],rsPoly.getLength()-1);var modPoly=rawPoly.mod(rsPoly);ecdata[r]=new Array(rsPoly.getLength()-1);for(var i=0;i<ecdata[r].length;i++){var modIndex=i+modPoly.getLength()-ecdata[r].length;ecdata[r][i]=(modIndex>=0)?modPoly.get(modIndex):0;}}\n\tvar totalCodeCount=0;for(var i=0;i<rsBlocks.length;i++){totalCodeCount+=rsBlocks[i].totalCount;}\n\tvar data=new Array(totalCodeCount);var index=0;for(var i=0;i<maxDcCount;i++){for(var r=0;r<rsBlocks.length;r++){if(i<dcdata[r].length){data[index++]=dcdata[r][i];}}}\n\tfor(var i=0;i<maxEcCount;i++){for(var r=0;r<rsBlocks.length;r++){if(i<ecdata[r].length){data[index++]=ecdata[r][i];}}}\n\treturn data;};var QRMode={MODE_NUMBER:1<<0,MODE_ALPHA_NUM:1<<1,MODE_8BIT_BYTE:1<<2,MODE_KANJI:1<<3};var QRErrorCorrectLevel={L:1,M:0,Q:3,H:2};var QRMaskPattern={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var QRUtil={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:(1<<10)|(1<<8)|(1<<5)|(1<<4)|(1<<2)|(1<<1)|(1<<0),G18:(1<<12)|(1<<11)|(1<<10)|(1<<9)|(1<<8)|(1<<5)|(1<<2)|(1<<0),G15_MASK:(1<<14)|(1<<12)|(1<<10)|(1<<4)|(1<<1),getBCHTypeInfo:function(data){var d=data<<10;while(QRUtil.getBCHDigit(d)-QRUtil.getBCHDigit(QRUtil.G15)>=0){d^=(QRUtil.G15<<(QRUtil.getBCHDigit(d)-QRUtil.getBCHDigit(QRUtil.G15)));}\n\treturn((data<<10)|d)^QRUtil.G15_MASK;},getBCHTypeNumber:function(data){var d=data<<12;while(QRUtil.getBCHDigit(d)-QRUtil.getBCHDigit(QRUtil.G18)>=0){d^=(QRUtil.G18<<(QRUtil.getBCHDigit(d)-QRUtil.getBCHDigit(QRUtil.G18)));}\n\treturn(data<<12)|d;},getBCHDigit:function(data){var digit=0;while(data!=0){digit++;data>>>=1;}\n\treturn digit;},getPatternPosition:function(typeNumber){return QRUtil.PATTERN_POSITION_TABLE[typeNumber-1];},getMask:function(maskPattern,i,j){switch(maskPattern){case QRMaskPattern.PATTERN000:return(i+j)%2==0;case QRMaskPattern.PATTERN001:return i%2==0;case QRMaskPattern.PATTERN010:return j%3==0;case QRMaskPattern.PATTERN011:return(i+j)%3==0;case QRMaskPattern.PATTERN100:return(Math.floor(i/2)+Math.floor(j/3))%2==0;case QRMaskPattern.PATTERN101:return(i*j)%2+(i*j)%3==0;case QRMaskPattern.PATTERN110:return((i*j)%2+(i*j)%3)%2==0;case QRMaskPattern.PATTERN111:return((i*j)%3+(i+j)%2)%2==0;default:throw new Error(\"bad maskPattern:\"+maskPattern);}},getErrorCorrectPolynomial:function(errorCorrectLength){var a=new QRPolynomial([1],0);for(var i=0;i<errorCorrectLength;i++){a=a.multiply(new QRPolynomial([1,QRMath.gexp(i)],0));}\n\treturn a;},getLengthInBits:function(mode,type){if(1<=type&&type<10){switch(mode){case QRMode.MODE_NUMBER:return 10;case QRMode.MODE_ALPHA_NUM:return 9;case QRMode.MODE_8BIT_BYTE:return 8;case QRMode.MODE_KANJI:return 8;default:throw new Error(\"mode:\"+mode);}}else if(type<27){switch(mode){case QRMode.MODE_NUMBER:return 12;case QRMode.MODE_ALPHA_NUM:return 11;case QRMode.MODE_8BIT_BYTE:return 16;case QRMode.MODE_KANJI:return 10;default:throw new Error(\"mode:\"+mode);}}else if(type<41){switch(mode){case QRMode.MODE_NUMBER:return 14;case QRMode.MODE_ALPHA_NUM:return 13;case QRMode.MODE_8BIT_BYTE:return 16;case QRMode.MODE_KANJI:return 12;default:throw new Error(\"mode:\"+mode);}}else{throw new Error(\"type:\"+type);}},getLostPoint:function(qrCode){var moduleCount=qrCode.getModuleCount();var lostPoint=0;for(var row=0;row<moduleCount;row++){for(var col=0;col<moduleCount;col++){var sameCount=0;var dark=qrCode.isDark(row,col);for(var r=-1;r<=1;r++){if(row+r<0||moduleCount<=row+r){continue;}\n\tfor(var c=-1;c<=1;c++){if(col+c<0||moduleCount<=col+c){continue;}\n\tif(r==0&&c==0){continue;}\n\tif(dark==qrCode.isDark(row+r,col+c)){sameCount++;}}}\n\tif(sameCount>5){lostPoint+=(3+sameCount-5);}}}\n\tfor(var row=0;row<moduleCount-1;row++){for(var col=0;col<moduleCount-1;col++){var count=0;if(qrCode.isDark(row,col))count++;if(qrCode.isDark(row+1,col))count++;if(qrCode.isDark(row,col+1))count++;if(qrCode.isDark(row+1,col+1))count++;if(count==0||count==4){lostPoint+=3;}}}\n\tfor(var row=0;row<moduleCount;row++){for(var col=0;col<moduleCount-6;col++){if(qrCode.isDark(row,col)&&!qrCode.isDark(row,col+1)&&qrCode.isDark(row,col+2)&&qrCode.isDark(row,col+3)&&qrCode.isDark(row,col+4)&&!qrCode.isDark(row,col+5)&&qrCode.isDark(row,col+6)){lostPoint+=40;}}}\n\tfor(var col=0;col<moduleCount;col++){for(var row=0;row<moduleCount-6;row++){if(qrCode.isDark(row,col)&&!qrCode.isDark(row+1,col)&&qrCode.isDark(row+2,col)&&qrCode.isDark(row+3,col)&&qrCode.isDark(row+4,col)&&!qrCode.isDark(row+5,col)&&qrCode.isDark(row+6,col)){lostPoint+=40;}}}\n\tvar darkCount=0;for(var col=0;col<moduleCount;col++){for(var row=0;row<moduleCount;row++){if(qrCode.isDark(row,col)){darkCount++;}}}\n\tvar ratio=Math.abs(100*darkCount/moduleCount/moduleCount-50)/5;lostPoint+=ratio*10;return lostPoint;}};var QRMath={glog:function(n){if(n<1){throw new Error(\"glog(\"+n+\")\");}\n\treturn QRMath.LOG_TABLE[n];},gexp:function(n){while(n<0){n+=255;}\n\twhile(n>=256){n-=255;}\n\treturn QRMath.EXP_TABLE[n];},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)};for(var i=0;i<8;i++){QRMath.EXP_TABLE[i]=1<<i;}\n\tfor(var i=8;i<256;i++){QRMath.EXP_TABLE[i]=QRMath.EXP_TABLE[i-4]^QRMath.EXP_TABLE[i-5]^QRMath.EXP_TABLE[i-6]^QRMath.EXP_TABLE[i-8];}\n\tfor(var i=0;i<255;i++){QRMath.LOG_TABLE[QRMath.EXP_TABLE[i]]=i;}\n\tfunction QRPolynomial(num,shift){if(num.length==undefined){throw new Error(num.length+\"/\"+shift);}\n\tvar offset=0;while(offset<num.length&&num[offset]==0){offset++;}\n\tthis.num=new Array(num.length-offset+shift);for(var i=0;i<num.length-offset;i++){this.num[i]=num[i+offset];}}\n\tQRPolynomial.prototype={get:function(index){return this.num[index];},getLength:function(){return this.num.length;},multiply:function(e){var num=new Array(this.getLength()+e.getLength()-1);for(var i=0;i<this.getLength();i++){for(var j=0;j<e.getLength();j++){num[i+j]^=QRMath.gexp(QRMath.glog(this.get(i))+QRMath.glog(e.get(j)));}}\n\treturn new QRPolynomial(num,0);},mod:function(e){if(this.getLength()-e.getLength()<0){return this;}\n\tvar ratio=QRMath.glog(this.get(0))-QRMath.glog(e.get(0));var num=new Array(this.getLength());for(var i=0;i<this.getLength();i++){num[i]=this.get(i);}\n\tfor(var i=0;i<e.getLength();i++){num[i]^=QRMath.gexp(QRMath.glog(e.get(i))+ratio);}\n\treturn new QRPolynomial(num,0).mod(e);}};function QRRSBlock(totalCount,dataCount){this.totalCount=totalCount;this.dataCount=dataCount;}\n\tQRRSBlock.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];QRRSBlock.getRSBlocks=function(typeNumber,errorCorrectLevel){var rsBlock=QRRSBlock.getRsBlockTable(typeNumber,errorCorrectLevel);if(rsBlock==undefined){throw new Error(\"bad rs block @ typeNumber:\"+typeNumber+\"/errorCorrectLevel:\"+errorCorrectLevel);}\n\tvar length=rsBlock.length/3;var list=[];for(var i=0;i<length;i++){var count=rsBlock[i*3+0];var totalCount=rsBlock[i*3+1];var dataCount=rsBlock[i*3+2];for(var j=0;j<count;j++){list.push(new QRRSBlock(totalCount,dataCount));}}\n\treturn list;};QRRSBlock.getRsBlockTable=function(typeNumber,errorCorrectLevel){switch(errorCorrectLevel){case QRErrorCorrectLevel.L:return QRRSBlock.RS_BLOCK_TABLE[(typeNumber-1)*4+0];case QRErrorCorrectLevel.M:return QRRSBlock.RS_BLOCK_TABLE[(typeNumber-1)*4+1];case QRErrorCorrectLevel.Q:return QRRSBlock.RS_BLOCK_TABLE[(typeNumber-1)*4+2];case QRErrorCorrectLevel.H:return QRRSBlock.RS_BLOCK_TABLE[(typeNumber-1)*4+3];default:return undefined;}};function QRBitBuffer(){this.buffer=[];this.length=0;}\n\tQRBitBuffer.prototype={get:function(index){var bufIndex=Math.floor(index/8);return((this.buffer[bufIndex]>>>(7-index%8))&1)==1;},put:function(num,length){for(var i=0;i<length;i++){this.putBit(((num>>>(length-i-1))&1)==1);}},getLengthInBits:function(){return this.length;},putBit:function(bit){var bufIndex=Math.floor(this.length/8);if(this.buffer.length<=bufIndex){this.buffer.push(0);}\n\tif(bit){this.buffer[bufIndex]|=(0x80>>>(this.length%8));}\n\tthis.length++;}};var QRCodeLimitLength=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]];\n\n\t// Drawing in DOM by using Table tag\n\tvar Drawing = (function () { // Drawing in Canvas\n\t\t/**\n\t\t * Drawing QRCode by using canvas\n\t\t *\n\t\t * @constructor\n\t\t * @param {HTMLElement} el\n\t\t * @param {Object} htOption QRCode Options\n\t\t */\n\t\tvar Drawing = function (el, htOption) {\n\t\t\tthis._bIsPainted = false;\n\n\t\t\tthis._htOption = htOption;\n\t\t\tthis._elCanvas = document.createElement(\"canvas\");\n\t\t\tthis._elCanvas.width = htOption.width;\n\t\t\tthis._elCanvas.height = htOption.height;\n\t\t\tel.appendChild(this._elCanvas);\n\t\t\tthis._el = el;\n\t\t\tthis._oContext = this._elCanvas.getContext(\"2d\");\n\t\t\tthis._bIsPainted = false;\n\t\t\tthis._bSupportDataURI = null;\n\t\t};\n\n\t\t/**\n\t\t * Draw the QRCode\n\t\t *\n\t\t * @param {QRCode} oQRCode\n\t\t */\n\t\tDrawing.prototype.draw = function (oQRCode) {\n            var _oContext = this._oContext;\n            var _htOption = this._htOption;\n\n\t\t\tvar nCount = oQRCode.getModuleCount();\n\t\t\tvar nWidth = _htOption.width / nCount;\n\t\t\tvar nHeight = _htOption.height / nCount;\n\t\t\tvar nRoundedWidth = Math.round(nWidth);\n\t\t\tvar nRoundedHeight = Math.round(nHeight);\n\n\t\t\tthis.clear();\n\n\t\t\tfor (var row = 0; row < nCount; row++) {\n\t\t\t\tfor (var col = 0; col < nCount; col++) {\n\t\t\t\t\tvar bIsDark = oQRCode.isDark(row, col);\n\t\t\t\t\tvar nLeft = col * nWidth;\n\t\t\t\t\tvar nTop = row * nHeight;\n\t\t\t\t\t_oContext.strokeStyle = bIsDark ? _htOption.colorDark : _htOption.colorLight;\n\t\t\t\t\t_oContext.lineWidth = 1;\n\t\t\t\t\t_oContext.fillStyle = bIsDark ? _htOption.colorDark : _htOption.colorLight;\n\t\t\t\t\t_oContext.fillRect(nLeft, nTop, nWidth, nHeight);\n\n\t\t\t\t\t//    \n\t\t\t\t\t_oContext.strokeRect(\n\t\t\t\t\t\tMath.floor(nLeft) + 0.5,\n\t\t\t\t\t\tMath.floor(nTop) + 0.5,\n\t\t\t\t\t\tnRoundedWidth,\n\t\t\t\t\t\tnRoundedHeight\n\t\t\t\t\t);\n\n\t\t\t\t\t_oContext.strokeRect(\n\t\t\t\t\t\tMath.ceil(nLeft) - 0.5,\n\t\t\t\t\t\tMath.ceil(nTop) - 0.5,\n\t\t\t\t\t\tnRoundedWidth,\n\t\t\t\t\t\tnRoundedHeight\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._bIsPainted = true;\n\t\t};\n\n\t\t/**\n\t\t * Return whether the QRCode is painted or not\n\t\t *\n\t\t * @return {Boolean}\n\t\t */\n\t\tDrawing.prototype.isPainted = function () {\n\t\t\treturn this._bIsPainted;\n\t\t};\n\n\t\t/**\n\t\t * Clear the QRCode\n\t\t */\n\t\tDrawing.prototype.clear = function () {\n\t\t\tthis._oContext.clearRect(0, 0, this._elCanvas.width, this._elCanvas.height);\n\t\t\tthis._bIsPainted = false;\n\t\t};\n\n\t\t/**\n\t\t * @private\n\t\t * @param {Number} nNumber\n\t\t */\n\t\tDrawing.prototype.round = function (nNumber) {\n\t\t\tif (!nNumber) {\n\t\t\t\treturn nNumber;\n\t\t\t}\n\n\t\t\treturn Math.floor(nNumber * 1000) / 1000;\n\t\t};\n\n\t\treturn Drawing;\n\t})();\n\n\t/**\n\t * Get the type by string length\n\t *\n\t * @private\n\t * @param {String} sText\n\t * @param {Number} nCorrectLevel\n\t * @return {Number} type\n\t */\n\tfunction _getTypeNumber(sText, nCorrectLevel) {\n\t\tvar nType = 1;\n\t\tvar length = _getUTF8Length(sText);\n\n\t\tfor (var i = 0, len = QRCodeLimitLength.length; i <= len; i++) {\n\t\t\tvar nLimit = 0;\n\n\t\t\tswitch (nCorrectLevel) {\n\t\t\t\tcase QRErrorCorrectLevel.L :\n\t\t\t\t\tnLimit = QRCodeLimitLength[i][0];\n\t\t\t\t\tbreak;\n\t\t\t\tcase QRErrorCorrectLevel.M :\n\t\t\t\t\tnLimit = QRCodeLimitLength[i][1];\n\t\t\t\t\tbreak;\n\t\t\t\tcase QRErrorCorrectLevel.Q :\n\t\t\t\t\tnLimit = QRCodeLimitLength[i][2];\n\t\t\t\t\tbreak;\n\t\t\t\tcase QRErrorCorrectLevel.H :\n\t\t\t\t\tnLimit = QRCodeLimitLength[i][3];\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (length <= nLimit) {\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\tnType++;\n\t\t\t}\n\t\t}\n\n\t\tif (nType > QRCodeLimitLength.length) {\n\t\t\tthrow new Error(\"Too long data\");\n\t\t}\n\n\t\treturn nType;\n\t}\n\n\tfunction _getUTF8Length(sText) {\n\t\tvar replacedText = encodeURI(sText).toString().replace(/\\%[0-9a-fA-F]{2}/g, 'a');\n\t\treturn replacedText.length + (replacedText.length != sText ? 3 : 0);\n\t}\n\n\t/**\n\t * @class QRCode\n\t * @constructor\n\t * @example\n\t * new QRCode(document.getElementById(\"test\"), \"http://jindo.dev.naver.com/collie\");\n\t *\n\t * @example\n\t * var oQRCode = new QRCode(\"test\", {\n\t *    text : \"http://naver.com\",\n\t *    width : 128,\n\t *    height : 128\n\t * });\n\t *\n\t * oQRCode.clear(); // Clear the QRCode.\n\t * oQRCode.makeCode(\"http://map.naver.com\"); // Re-create the QRCode.\n\t *\n\t * @param {HTMLElement|String} el target element or 'id' attribute of element.\n\t * @param {Object|String} vOption\n\t * @param {String} vOption.text QRCode link data\n\t * @param {Number} [vOption.width=256]\n\t * @param {Number} [vOption.height=256]\n\t * @param {String} [vOption.colorDark=\"#000000\"]\n\t * @param {String} [vOption.colorLight=\"#ffffff\"]\n\t * @param {QRCode.CorrectLevel} [vOption.correctLevel=QRCode.CorrectLevel.H] [L|M|Q|H]\n\t */\n\tQRCode = function (el, vOption) {\n\t\tthis._htOption = {\n\t\t\twidth : 256,\n\t\t\theight : 256,\n\t\t\ttypeNumber : 4,\n\t\t\tcolorDark : \"#000000\",\n\t\t\tcolorLight : \"#ffffff\",\n\t\t\tcorrectLevel : QRErrorCorrectLevel.H\n\t\t};\n\n\t\tif (typeof vOption === 'string') {\n\t\t\tvOption\t= {\n\t\t\t\ttext : vOption\n\t\t\t};\n\t\t}\n\n\t\t// Overwrites options\n\t\tif (vOption) {\n\t\t\tfor (var i in vOption) {\n\t\t\t\tthis._htOption[i] = vOption[i];\n\t\t\t}\n\t\t}\n\n\t\tif (typeof el == \"string\") {\n\t\t\tel = document.getElementById(el);\n\t\t}\n\n\t\tif (this._htOption.useSVG) {\n\t\t\tDrawing = svgDrawer;\n\t\t}\n\n\t\tthis._el = el;\n\t\tthis._oQRCode = null;\n\t\tthis._oDrawing = new Drawing(this._el, this._htOption);\n\n\t\tif (this._htOption.text) {\n\t\t\tthis.makeCode(this._htOption.text);\n\t\t}\n\t};\n\n\t/**\n\t * Make the QRCode\n\t *\n\t * @param {String} sText link data\n\t */\n\tQRCode.prototype.makeCode = function (sText) {\n\t\tthis._oQRCode = new QRCodeModel(_getTypeNumber(sText, this._htOption.correctLevel), this._htOption.correctLevel);\n\t\tthis._oQRCode.addData(sText);\n\t\tthis._oQRCode.make();\n\t\tthis._oDrawing.draw(this._oQRCode);\n\t};\n\n\t/**\n\t * Clear the QRCode\n\t */\n\tQRCode.prototype.clear = function () {\n\t\tthis._oDrawing.clear();\n\t};\n\n\t/**\n\t * (added for Croquet) return the internal canvas holding the QRCode\n\t */\n\tQRCode.prototype.getCanvas = function () {\n\t\tfor (let i = 0; i < this._el.children.length; i++) {\n\t\t\tconst child = this._el.children[i];\n\t\t\tif (child.tagName === 'CANVAS') return child;\n\t\t}\n\t\treturn null;\n\t};\n\n\t/**\n\t * @name QRCode.CorrectLevel\n\t */\n\tQRCode.CorrectLevel = QRErrorCorrectLevel;\n})();\n\nexport default QRCode;\n", ";(function (root, factory) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory();\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\troot.CryptoJS = factory();\n\t}\n}(this, function () {\n\n\t/*globals window, global, require*/\n\n\t/**\n\t * CryptoJS core components.\n\t */\n\tvar CryptoJS = CryptoJS || (function (Math, undefined) {\n\n\t    var crypto;\n\n\t    // Native crypto from window (Browser)\n\t    if (typeof window !== 'undefined' && window.crypto) {\n\t        crypto = window.crypto;\n\t    }\n\n\t    // Native crypto in web worker (Browser)\n\t    if (typeof self !== 'undefined' && self.crypto) {\n\t        crypto = self.crypto;\n\t    }\n\n\t    // Native crypto from worker\n\t    if (typeof globalThis !== 'undefined' && globalThis.crypto) {\n\t        crypto = globalThis.crypto;\n\t    }\n\n\t    // Native (experimental IE 11) crypto from window (Browser)\n\t    if (!crypto && typeof window !== 'undefined' && window.msCrypto) {\n\t        crypto = window.msCrypto;\n\t    }\n\n\t    // Native crypto from global (NodeJS)\n\t    if (!crypto && typeof global !== 'undefined' && global.crypto) {\n\t        crypto = global.crypto;\n\t    }\n\n\t    // Native crypto import via require (NodeJS)\n\t    if (!crypto && typeof require === 'function') {\n\t        try {\n\t            crypto = require('crypto');\n\t        } catch (err) {}\n\t    }\n\n\t    /*\n\t     * Cryptographically secure pseudorandom number generator\n\t     *\n\t     * As Math.random() is cryptographically not safe to use\n\t     */\n\t    var cryptoSecureRandomInt = function () {\n\t        if (crypto) {\n\t            // Use getRandomValues method (Browser)\n\t            if (typeof crypto.getRandomValues === 'function') {\n\t                try {\n\t                    return crypto.getRandomValues(new Uint32Array(1))[0];\n\t                } catch (err) {}\n\t            }\n\n\t            // Use randomBytes method (NodeJS)\n\t            if (typeof crypto.randomBytes === 'function') {\n\t                try {\n\t                    return crypto.randomBytes(4).readInt32LE();\n\t                } catch (err) {}\n\t            }\n\t        }\n\n\t        throw new Error('Native crypto module could not be used to get secure random number.');\n\t    };\n\n\t    /*\n\t     * Local polyfill of Object.create\n\n\t     */\n\t    var create = Object.create || (function () {\n\t        function F() {}\n\n\t        return function (obj) {\n\t            var subtype;\n\n\t            F.prototype = obj;\n\n\t            subtype = new F();\n\n\t            F.prototype = null;\n\n\t            return subtype;\n\t        };\n\t    }());\n\n\t    /**\n\t     * CryptoJS namespace.\n\t     */\n\t    var C = {};\n\n\t    /**\n\t     * Library namespace.\n\t     */\n\t    var C_lib = C.lib = {};\n\n\t    /**\n\t     * Base object for prototypal inheritance.\n\t     */\n\t    var Base = C_lib.Base = (function () {\n\n\n\t        return {\n\t            /**\n\t             * Creates a new object that inherits from this object.\n\t             *\n\t             * @param {Object} overrides Properties to copy into the new object.\n\t             *\n\t             * @return {Object} The new object.\n\t             *\n\t             * @static\n\t             *\n\t             * @example\n\t             *\n\t             *     var MyType = CryptoJS.lib.Base.extend({\n\t             *         field: 'value',\n\t             *\n\t             *         method: function () {\n\t             *         }\n\t             *     });\n\t             */\n\t            extend: function (overrides) {\n\t                // Spawn\n\t                var subtype = create(this);\n\n\t                // Augment\n\t                if (overrides) {\n\t                    subtype.mixIn(overrides);\n\t                }\n\n\t                // Create default initializer\n\t                if (!subtype.hasOwnProperty('init') || this.init === subtype.init) {\n\t                    subtype.init = function () {\n\t                        subtype.$super.init.apply(this, arguments);\n\t                    };\n\t                }\n\n\t                // Initializer's prototype is the subtype object\n\t                subtype.init.prototype = subtype;\n\n\t                // Reference supertype\n\t                subtype.$super = this;\n\n\t                return subtype;\n\t            },\n\n\t            /**\n\t             * Extends this object and runs the init method.\n\t             * Arguments to create() will be passed to init().\n\t             *\n\t             * @return {Object} The new object.\n\t             *\n\t             * @static\n\t             *\n\t             * @example\n\t             *\n\t             *     var instance = MyType.create();\n\t             */\n\t            create: function () {\n\t                var instance = this.extend();\n\t                instance.init.apply(instance, arguments);\n\n\t                return instance;\n\t            },\n\n\t            /**\n\t             * Initializes a newly created object.\n\t             * Override this method to add some logic when your objects are created.\n\t             *\n\t             * @example\n\t             *\n\t             *     var MyType = CryptoJS.lib.Base.extend({\n\t             *         init: function () {\n\t             *             // ...\n\t             *         }\n\t             *     });\n\t             */\n\t            init: function () {\n\t            },\n\n\t            /**\n\t             * Copies properties into this object.\n\t             *\n\t             * @param {Object} properties The properties to mix in.\n\t             *\n\t             * @example\n\t             *\n\t             *     MyType.mixIn({\n\t             *         field: 'value'\n\t             *     });\n\t             */\n\t            mixIn: function (properties) {\n\t                for (var propertyName in properties) {\n\t                    if (properties.hasOwnProperty(propertyName)) {\n\t                        this[propertyName] = properties[propertyName];\n\t                    }\n\t                }\n\n\t                // IE won't copy toString using the loop above\n\t                if (properties.hasOwnProperty('toString')) {\n\t                    this.toString = properties.toString;\n\t                }\n\t            },\n\n\t            /**\n\t             * Creates a copy of this object.\n\t             *\n\t             * @return {Object} The clone.\n\t             *\n\t             * @example\n\t             *\n\t             *     var clone = instance.clone();\n\t             */\n\t            clone: function () {\n\t                return this.init.prototype.extend(this);\n\t            }\n\t        };\n\t    }());\n\n\t    /**\n\t     * An array of 32-bit words.\n\t     *\n\t     * @property {Array} words The array of 32-bit words.\n\t     * @property {number} sigBytes The number of significant bytes in this word array.\n\t     */\n\t    var WordArray = C_lib.WordArray = Base.extend({\n\t        /**\n\t         * Initializes a newly created word array.\n\t         *\n\t         * @param {Array} words (Optional) An array of 32-bit words.\n\t         * @param {number} sigBytes (Optional) The number of significant bytes in the words.\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.lib.WordArray.create();\n\t         *     var wordArray = CryptoJS.lib.WordArray.create([0x00010203, 0x04050607]);\n\t         *     var wordArray = CryptoJS.lib.WordArray.create([0x00010203, 0x04050607], 6);\n\t         */\n\t        init: function (words, sigBytes) {\n\t            words = this.words = words || [];\n\n\t            if (sigBytes != undefined) {\n\t                this.sigBytes = sigBytes;\n\t            } else {\n\t                this.sigBytes = words.length * 4;\n\t            }\n\t        },\n\n\t        /**\n\t         * Converts this word array to a string.\n\t         *\n\t         * @param {Encoder} encoder (Optional) The encoding strategy to use. Default: CryptoJS.enc.Hex\n\t         *\n\t         * @return {string} The stringified word array.\n\t         *\n\t         * @example\n\t         *\n\t         *     var string = wordArray + '';\n\t         *     var string = wordArray.toString();\n\t         *     var string = wordArray.toString(CryptoJS.enc.Utf8);\n\t         */\n\t        toString: function (encoder) {\n\t            return (encoder || Hex).stringify(this);\n\t        },\n\n\t        /**\n\t         * Concatenates a word array to this word array.\n\t         *\n\t         * @param {WordArray} wordArray The word array to append.\n\t         *\n\t         * @return {WordArray} This word array.\n\t         *\n\t         * @example\n\t         *\n\t         *     wordArray1.concat(wordArray2);\n\t         */\n\t        concat: function (wordArray) {\n\t            // Shortcuts\n\t            var thisWords = this.words;\n\t            var thatWords = wordArray.words;\n\t            var thisSigBytes = this.sigBytes;\n\t            var thatSigBytes = wordArray.sigBytes;\n\n\t            // Clamp excess bits\n\t            this.clamp();\n\n\t            // Concat\n\t            if (thisSigBytes % 4) {\n\t                // Copy one byte at a time\n\t                for (var i = 0; i < thatSigBytes; i++) {\n\t                    var thatByte = (thatWords[i >>> 2] >>> (24 - (i % 4) * 8)) & 0xff;\n\t                    thisWords[(thisSigBytes + i) >>> 2] |= thatByte << (24 - ((thisSigBytes + i) % 4) * 8);\n\t                }\n\t            } else {\n\t                // Copy one word at a time\n\t                for (var j = 0; j < thatSigBytes; j += 4) {\n\t                    thisWords[(thisSigBytes + j) >>> 2] = thatWords[j >>> 2];\n\t                }\n\t            }\n\t            this.sigBytes += thatSigBytes;\n\n\t            // Chainable\n\t            return this;\n\t        },\n\n\t        /**\n\t         * Removes insignificant bits.\n\t         *\n\t         * @example\n\t         *\n\t         *     wordArray.clamp();\n\t         */\n\t        clamp: function () {\n\t            // Shortcuts\n\t            var words = this.words;\n\t            var sigBytes = this.sigBytes;\n\n\t            // Clamp\n\t            words[sigBytes >>> 2] &= 0xffffffff << (32 - (sigBytes % 4) * 8);\n\t            words.length = Math.ceil(sigBytes / 4);\n\t        },\n\n\t        /**\n\t         * Creates a copy of this word array.\n\t         *\n\t         * @return {WordArray} The clone.\n\t         *\n\t         * @example\n\t         *\n\t         *     var clone = wordArray.clone();\n\t         */\n\t        clone: function () {\n\t            var clone = Base.clone.call(this);\n\t            clone.words = this.words.slice(0);\n\n\t            return clone;\n\t        },\n\n\t        /**\n\t         * Creates a word array filled with random bytes.\n\t         *\n\t         * @param {number} nBytes The number of random bytes to generate.\n\t         *\n\t         * @return {WordArray} The random word array.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.lib.WordArray.random(16);\n\t         */\n\t        random: function (nBytes) {\n\t            var words = [];\n\n\t            for (var i = 0; i < nBytes; i += 4) {\n\t                words.push(cryptoSecureRandomInt());\n\t            }\n\n\t            return new WordArray.init(words, nBytes);\n\t        }\n\t    });\n\n\t    /**\n\t     * Encoder namespace.\n\t     */\n\t    var C_enc = C.enc = {};\n\n\t    /**\n\t     * Hex encoding strategy.\n\t     */\n\t    var Hex = C_enc.Hex = {\n\t        /**\n\t         * Converts a word array to a hex string.\n\t         *\n\t         * @param {WordArray} wordArray The word array.\n\t         *\n\t         * @return {string} The hex string.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var hexString = CryptoJS.enc.Hex.stringify(wordArray);\n\t         */\n\t        stringify: function (wordArray) {\n\t            // Shortcuts\n\t            var words = wordArray.words;\n\t            var sigBytes = wordArray.sigBytes;\n\n\t            // Convert\n\t            var hexChars = [];\n\t            for (var i = 0; i < sigBytes; i++) {\n\t                var bite = (words[i >>> 2] >>> (24 - (i % 4) * 8)) & 0xff;\n\t                hexChars.push((bite >>> 4).toString(16));\n\t                hexChars.push((bite & 0x0f).toString(16));\n\t            }\n\n\t            return hexChars.join('');\n\t        },\n\n\t        /**\n\t         * Converts a hex string to a word array.\n\t         *\n\t         * @param {string} hexStr The hex string.\n\t         *\n\t         * @return {WordArray} The word array.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.enc.Hex.parse(hexString);\n\t         */\n\t        parse: function (hexStr) {\n\t            // Shortcut\n\t            var hexStrLength = hexStr.length;\n\n\t            // Convert\n\t            var words = [];\n\t            for (var i = 0; i < hexStrLength; i += 2) {\n\t                words[i >>> 3] |= parseInt(hexStr.substr(i, 2), 16) << (24 - (i % 8) * 4);\n\t            }\n\n\t            return new WordArray.init(words, hexStrLength / 2);\n\t        }\n\t    };\n\n\t    /**\n\t     * Latin1 encoding strategy.\n\t     */\n\t    var Latin1 = C_enc.Latin1 = {\n\t        /**\n\t         * Converts a word array to a Latin1 string.\n\t         *\n\t         * @param {WordArray} wordArray The word array.\n\t         *\n\t         * @return {string} The Latin1 string.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var latin1String = CryptoJS.enc.Latin1.stringify(wordArray);\n\t         */\n\t        stringify: function (wordArray) {\n\t            // Shortcuts\n\t            var words = wordArray.words;\n\t            var sigBytes = wordArray.sigBytes;\n\n\t            // Convert\n\t            var latin1Chars = [];\n\t            for (var i = 0; i < sigBytes; i++) {\n\t                var bite = (words[i >>> 2] >>> (24 - (i % 4) * 8)) & 0xff;\n\t                latin1Chars.push(String.fromCharCode(bite));\n\t            }\n\n\t            return latin1Chars.join('');\n\t        },\n\n\t        /**\n\t         * Converts a Latin1 string to a word array.\n\t         *\n\t         * @param {string} latin1Str The Latin1 string.\n\t         *\n\t         * @return {WordArray} The word array.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.enc.Latin1.parse(latin1String);\n\t         */\n\t        parse: function (latin1Str) {\n\t            // Shortcut\n\t            var latin1StrLength = latin1Str.length;\n\n\t            // Convert\n\t            var words = [];\n\t            for (var i = 0; i < latin1StrLength; i++) {\n\t                words[i >>> 2] |= (latin1Str.charCodeAt(i) & 0xff) << (24 - (i % 4) * 8);\n\t            }\n\n\t            return new WordArray.init(words, latin1StrLength);\n\t        }\n\t    };\n\n\t    /**\n\t     * UTF-8 encoding strategy.\n\t     */\n\t    var Utf8 = C_enc.Utf8 = {\n\t        /**\n\t         * Converts a word array to a UTF-8 string.\n\t         *\n\t         * @param {WordArray} wordArray The word array.\n\t         *\n\t         * @return {string} The UTF-8 string.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var utf8String = CryptoJS.enc.Utf8.stringify(wordArray);\n\t         */\n\t        stringify: function (wordArray) {\n\t            try {\n\t                return decodeURIComponent(escape(Latin1.stringify(wordArray)));\n\t            } catch (e) {\n\t                throw new Error('Malformed UTF-8 data');\n\t            }\n\t        },\n\n\t        /**\n\t         * Converts a UTF-8 string to a word array.\n\t         *\n\t         * @param {string} utf8Str The UTF-8 string.\n\t         *\n\t         * @return {WordArray} The word array.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.enc.Utf8.parse(utf8String);\n\t         */\n\t        parse: function (utf8Str) {\n\t            return Latin1.parse(unescape(encodeURIComponent(utf8Str)));\n\t        }\n\t    };\n\n\t    /**\n\t     * Abstract buffered block algorithm template.\n\t     *\n\t     * The property blockSize must be implemented in a concrete subtype.\n\t     *\n\t     * @property {number} _minBufferSize The number of blocks that should be kept unprocessed in the buffer. Default: 0\n\t     */\n\t    var BufferedBlockAlgorithm = C_lib.BufferedBlockAlgorithm = Base.extend({\n\t        /**\n\t         * Resets this block algorithm's data buffer to its initial state.\n\t         *\n\t         * @example\n\t         *\n\t         *     bufferedBlockAlgorithm.reset();\n\t         */\n\t        reset: function () {\n\t            // Initial values\n\t            this._data = new WordArray.init();\n\t            this._nDataBytes = 0;\n\t        },\n\n\t        /**\n\t         * Adds new data to this block algorithm's buffer.\n\t         *\n\t         * @param {WordArray|string} data The data to append. Strings are converted to a WordArray using UTF-8.\n\t         *\n\t         * @example\n\t         *\n\t         *     bufferedBlockAlgorithm._append('data');\n\t         *     bufferedBlockAlgorithm._append(wordArray);\n\t         */\n\t        _append: function (data) {\n\t            // Convert string to WordArray, else assume WordArray already\n\t            if (typeof data == 'string') {\n\t                data = Utf8.parse(data);\n\t            }\n\n\t            // Append\n\t            this._data.concat(data);\n\t            this._nDataBytes += data.sigBytes;\n\t        },\n\n\t        /**\n\t         * Processes available data blocks.\n\t         *\n\t         * This method invokes _doProcessBlock(offset), which must be implemented by a concrete subtype.\n\t         *\n\t         * @param {boolean} doFlush Whether all blocks and partial blocks should be processed.\n\t         *\n\t         * @return {WordArray} The processed data.\n\t         *\n\t         * @example\n\t         *\n\t         *     var processedData = bufferedBlockAlgorithm._process();\n\t         *     var processedData = bufferedBlockAlgorithm._process(!!'flush');\n\t         */\n\t        _process: function (doFlush) {\n\t            var processedWords;\n\n\t            // Shortcuts\n\t            var data = this._data;\n\t            var dataWords = data.words;\n\t            var dataSigBytes = data.sigBytes;\n\t            var blockSize = this.blockSize;\n\t            var blockSizeBytes = blockSize * 4;\n\n\t            // Count blocks ready\n\t            var nBlocksReady = dataSigBytes / blockSizeBytes;\n\t            if (doFlush) {\n\t                // Round up to include partial blocks\n\t                nBlocksReady = Math.ceil(nBlocksReady);\n\t            } else {\n\t                // Round down to include only full blocks,\n\t                // less the number of blocks that must remain in the buffer\n\t                nBlocksReady = Math.max((nBlocksReady | 0) - this._minBufferSize, 0);\n\t            }\n\n\t            // Count words ready\n\t            var nWordsReady = nBlocksReady * blockSize;\n\n\t            // Count bytes ready\n\t            var nBytesReady = Math.min(nWordsReady * 4, dataSigBytes);\n\n\t            // Process blocks\n\t            if (nWordsReady) {\n\t                for (var offset = 0; offset < nWordsReady; offset += blockSize) {\n\t                    // Perform concrete-algorithm logic\n\t                    this._doProcessBlock(dataWords, offset);\n\t                }\n\n\t                // Remove processed words\n\t                processedWords = dataWords.splice(0, nWordsReady);\n\t                data.sigBytes -= nBytesReady;\n\t            }\n\n\t            // Return processed words\n\t            return new WordArray.init(processedWords, nBytesReady);\n\t        },\n\n\t        /**\n\t         * Creates a copy of this object.\n\t         *\n\t         * @return {Object} The clone.\n\t         *\n\t         * @example\n\t         *\n\t         *     var clone = bufferedBlockAlgorithm.clone();\n\t         */\n\t        clone: function () {\n\t            var clone = Base.clone.call(this);\n\t            clone._data = this._data.clone();\n\n\t            return clone;\n\t        },\n\n\t        _minBufferSize: 0\n\t    });\n\n\t    /**\n\t     * Abstract hasher template.\n\t     *\n\t     * @property {number} blockSize The number of 32-bit words this hasher operates on. Default: 16 (512 bits)\n\t     */\n\t    var Hasher = C_lib.Hasher = BufferedBlockAlgorithm.extend({\n\t        /**\n\t         * Configuration options.\n\t         */\n\t        cfg: Base.extend(),\n\n\t        /**\n\t         * Initializes a newly created hasher.\n\t         *\n\t         * @param {Object} cfg (Optional) The configuration options to use for this hash computation.\n\t         *\n\t         * @example\n\t         *\n\t         *     var hasher = CryptoJS.algo.SHA256.create();\n\t         */\n\t        init: function (cfg) {\n\t            // Apply config defaults\n\t            this.cfg = this.cfg.extend(cfg);\n\n\t            // Set initial values\n\t            this.reset();\n\t        },\n\n\t        /**\n\t         * Resets this hasher to its initial state.\n\t         *\n\t         * @example\n\t         *\n\t         *     hasher.reset();\n\t         */\n\t        reset: function () {\n\t            // Reset data buffer\n\t            BufferedBlockAlgorithm.reset.call(this);\n\n\t            // Perform concrete-hasher logic\n\t            this._doReset();\n\t        },\n\n\t        /**\n\t         * Updates this hasher with a message.\n\t         *\n\t         * @param {WordArray|string} messageUpdate The message to append.\n\t         *\n\t         * @return {Hasher} This hasher.\n\t         *\n\t         * @example\n\t         *\n\t         *     hasher.update('message');\n\t         *     hasher.update(wordArray);\n\t         */\n\t        update: function (messageUpdate) {\n\t            // Append\n\t            this._append(messageUpdate);\n\n\t            // Update the hash\n\t            this._process();\n\n\t            // Chainable\n\t            return this;\n\t        },\n\n\t        /**\n\t         * Finalizes the hash computation.\n\t         * Note that the finalize operation is effectively a destructive, read-once operation.\n\t         *\n\t         * @param {WordArray|string} messageUpdate (Optional) A final message update.\n\t         *\n\t         * @return {WordArray} The hash.\n\t         *\n\t         * @example\n\t         *\n\t         *     var hash = hasher.finalize();\n\t         *     var hash = hasher.finalize('message');\n\t         *     var hash = hasher.finalize(wordArray);\n\t         */\n\t        finalize: function (messageUpdate) {\n\t            // Final message update\n\t            if (messageUpdate) {\n\t                this._append(messageUpdate);\n\t            }\n\n\t            // Perform concrete-hasher logic\n\t            var hash = this._doFinalize();\n\n\t            return hash;\n\t        },\n\n\t        blockSize: 512/32,\n\n\t        /**\n\t         * Creates a shortcut function to a hasher's object interface.\n\t         *\n\t         * @param {Hasher} hasher The hasher to create a helper for.\n\t         *\n\t         * @return {Function} The shortcut function.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var SHA256 = CryptoJS.lib.Hasher._createHelper(CryptoJS.algo.SHA256);\n\t         */\n\t        _createHelper: function (hasher) {\n\t            return function (message, cfg) {\n\t                return new hasher.init(cfg).finalize(message);\n\t            };\n\t        },\n\n\t        /**\n\t         * Creates a shortcut function to the HMAC's object interface.\n\t         *\n\t         * @param {Hasher} hasher The hasher to use in this HMAC helper.\n\t         *\n\t         * @return {Function} The shortcut function.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var HmacSHA256 = CryptoJS.lib.Hasher._createHmacHelper(CryptoJS.algo.SHA256);\n\t         */\n\t        _createHmacHelper: function (hasher) {\n\t            return function (message, key) {\n\t                return new C_algo.HMAC.init(hasher, key).finalize(message);\n\t            };\n\t        }\n\t    });\n\n\t    /**\n\t     * Algorithm namespace.\n\t     */\n\t    var C_algo = C.algo = {};\n\n\t    return C;\n\t}(Math));\n\n\n\treturn CryptoJS;\n\n}));", ";(function (root, factory) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory(require(\"./core\"));\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([\"./core\"], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\tfactory(root.CryptoJS);\n\t}\n}(this, function (CryptoJS) {\n\n\t(function () {\n\t    // Check if typed arrays are supported\n\t    if (typeof ArrayBuffer != 'function') {\n\t        return;\n\t    }\n\n\t    // Shortcuts\n\t    var C = CryptoJS;\n\t    var C_lib = C.lib;\n\t    var WordArray = C_lib.WordArray;\n\n\t    // Reference original init\n\t    var superInit = WordArray.init;\n\n\t    // Augment WordArray.init to handle typed arrays\n\t    var subInit = WordArray.init = function (typedArray) {\n\t        // Convert buffers to uint8\n\t        if (typedArray instanceof ArrayBuffer) {\n\t            typedArray = new Uint8Array(typedArray);\n\t        }\n\n\t        // Convert other array views to uint8\n\t        if (\n\t            typedArray instanceof Int8Array ||\n\t            (typeof Uint8ClampedArray !== \"undefined\" && typedArray instanceof Uint8ClampedArray) ||\n\t            typedArray instanceof Int16Array ||\n\t            typedArray instanceof Uint16Array ||\n\t            typedArray instanceof Int32Array ||\n\t            typedArray instanceof Uint32Array ||\n\t            typedArray instanceof Float32Array ||\n\t            typedArray instanceof Float64Array\n\t        ) {\n\t            typedArray = new Uint8Array(typedArray.buffer, typedArray.byteOffset, typedArray.byteLength);\n\t        }\n\n\t        // Handle Uint8Array\n\t        if (typedArray instanceof Uint8Array) {\n\t            // Shortcut\n\t            var typedArrayByteLength = typedArray.byteLength;\n\n\t            // Extract bytes\n\t            var words = [];\n\t            for (var i = 0; i < typedArrayByteLength; i++) {\n\t                words[i >>> 2] |= typedArray[i] << (24 - (i % 4) * 8);\n\t            }\n\n\t            // Initialize this word array\n\t            superInit.call(this, words, typedArrayByteLength);\n\t        } else {\n\t            // Else call normal init\n\t            superInit.apply(this, arguments);\n\t        }\n\t    };\n\n\t    subInit.prototype = WordArray;\n\t}());\n\n\n\treturn CryptoJS.lib.WordArray;\n\n}));", ";(function (root, factory) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory(require(\"./core\"));\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([\"./core\"], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\tfactory(root.CryptoJS);\n\t}\n}(this, function (CryptoJS) {\n\n\t(function (Math) {\n\t    // Shortcuts\n\t    var C = CryptoJS;\n\t    var C_lib = C.lib;\n\t    var WordArray = C_lib.WordArray;\n\t    var Hasher = C_lib.Hasher;\n\t    var C_algo = C.algo;\n\n\t    // Initialization and round constants tables\n\t    var H = [];\n\t    var K = [];\n\n\t    // Compute constants\n\t    (function () {\n\t        function isPrime(n) {\n\t            var sqrtN = Math.sqrt(n);\n\t            for (var factor = 2; factor <= sqrtN; factor++) {\n\t                if (!(n % factor)) {\n\t                    return false;\n\t                }\n\t            }\n\n\t            return true;\n\t        }\n\n\t        function getFractionalBits(n) {\n\t            return ((n - (n | 0)) * 0x100000000) | 0;\n\t        }\n\n\t        var n = 2;\n\t        var nPrime = 0;\n\t        while (nPrime < 64) {\n\t            if (isPrime(n)) {\n\t                if (nPrime < 8) {\n\t                    H[nPrime] = getFractionalBits(Math.pow(n, 1 / 2));\n\t                }\n\t                K[nPrime] = getFractionalBits(Math.pow(n, 1 / 3));\n\n\t                nPrime++;\n\t            }\n\n\t            n++;\n\t        }\n\t    }());\n\n\t    // Reusable object\n\t    var W = [];\n\n\t    /**\n\t     * SHA-256 hash algorithm.\n\t     */\n\t    var SHA256 = C_algo.SHA256 = Hasher.extend({\n\t        _doReset: function () {\n\t            this._hash = new WordArray.init(H.slice(0));\n\t        },\n\n\t        _doProcessBlock: function (M, offset) {\n\t            // Shortcut\n\t            var H = this._hash.words;\n\n\t            // Working variables\n\t            var a = H[0];\n\t            var b = H[1];\n\t            var c = H[2];\n\t            var d = H[3];\n\t            var e = H[4];\n\t            var f = H[5];\n\t            var g = H[6];\n\t            var h = H[7];\n\n\t            // Computation\n\t            for (var i = 0; i < 64; i++) {\n\t                if (i < 16) {\n\t                    W[i] = M[offset + i] | 0;\n\t                } else {\n\t                    var gamma0x = W[i - 15];\n\t                    var gamma0  = ((gamma0x << 25) | (gamma0x >>> 7))  ^\n\t                                  ((gamma0x << 14) | (gamma0x >>> 18)) ^\n\t                                   (gamma0x >>> 3);\n\n\t                    var gamma1x = W[i - 2];\n\t                    var gamma1  = ((gamma1x << 15) | (gamma1x >>> 17)) ^\n\t                                  ((gamma1x << 13) | (gamma1x >>> 19)) ^\n\t                                   (gamma1x >>> 10);\n\n\t                    W[i] = gamma0 + W[i - 7] + gamma1 + W[i - 16];\n\t                }\n\n\t                var ch  = (e & f) ^ (~e & g);\n\t                var maj = (a & b) ^ (a & c) ^ (b & c);\n\n\t                var sigma0 = ((a << 30) | (a >>> 2)) ^ ((a << 19) | (a >>> 13)) ^ ((a << 10) | (a >>> 22));\n\t                var sigma1 = ((e << 26) | (e >>> 6)) ^ ((e << 21) | (e >>> 11)) ^ ((e << 7)  | (e >>> 25));\n\n\t                var t1 = h + sigma1 + ch + K[i] + W[i];\n\t                var t2 = sigma0 + maj;\n\n\t                h = g;\n\t                g = f;\n\t                f = e;\n\t                e = (d + t1) | 0;\n\t                d = c;\n\t                c = b;\n\t                b = a;\n\t                a = (t1 + t2) | 0;\n\t            }\n\n\t            // Intermediate hash value\n\t            H[0] = (H[0] + a) | 0;\n\t            H[1] = (H[1] + b) | 0;\n\t            H[2] = (H[2] + c) | 0;\n\t            H[3] = (H[3] + d) | 0;\n\t            H[4] = (H[4] + e) | 0;\n\t            H[5] = (H[5] + f) | 0;\n\t            H[6] = (H[6] + g) | 0;\n\t            H[7] = (H[7] + h) | 0;\n\t        },\n\n\t        _doFinalize: function () {\n\t            // Shortcuts\n\t            var data = this._data;\n\t            var dataWords = data.words;\n\n\t            var nBitsTotal = this._nDataBytes * 8;\n\t            var nBitsLeft = data.sigBytes * 8;\n\n\t            // Add padding\n\t            dataWords[nBitsLeft >>> 5] |= 0x80 << (24 - nBitsLeft % 32);\n\t            dataWords[(((nBitsLeft + 64) >>> 9) << 4) + 14] = Math.floor(nBitsTotal / 0x100000000);\n\t            dataWords[(((nBitsLeft + 64) >>> 9) << 4) + 15] = nBitsTotal;\n\t            data.sigBytes = dataWords.length * 4;\n\n\t            // Hash final blocks\n\t            this._process();\n\n\t            // Return final computed hash\n\t            return this._hash;\n\t        },\n\n\t        clone: function () {\n\t            var clone = Hasher.clone.call(this);\n\t            clone._hash = this._hash.clone();\n\n\t            return clone;\n\t        }\n\t    });\n\n\t    /**\n\t     * Shortcut function to the hasher's object interface.\n\t     *\n\t     * @param {WordArray|string} message The message to hash.\n\t     *\n\t     * @return {WordArray} The hash.\n\t     *\n\t     * @static\n\t     *\n\t     * @example\n\t     *\n\t     *     var hash = CryptoJS.SHA256('message');\n\t     *     var hash = CryptoJS.SHA256(wordArray);\n\t     */\n\t    C.SHA256 = Hasher._createHelper(SHA256);\n\n\t    /**\n\t     * Shortcut function to the HMAC's object interface.\n\t     *\n\t     * @param {WordArray|string} message The message to hash.\n\t     * @param {WordArray|string} key The secret key.\n\t     *\n\t     * @return {WordArray} The HMAC.\n\t     *\n\t     * @static\n\t     *\n\t     * @example\n\t     *\n\t     *     var hmac = CryptoJS.HmacSHA256(message, key);\n\t     */\n\t    C.HmacSHA256 = Hasher._createHmacHelper(SHA256);\n\t}(Math));\n\n\n\treturn CryptoJS.SHA256;\n\n}));", "/* global croquet_build_process */\nimport stableStringify from \"fast-json-stable-stringify\";\nimport WordArray from \"crypto-js/lib-typedarrays\";\nimport sha256 from \"crypto-js/sha256\";\nimport urlOptions from \"./_URLOPTIONS_MODULE_\"; // eslint-disable-line import/no-unresolved\nimport { App } from \"./_HTML_MODULE_\"; // eslint-disable-line import/no-unresolved\n\nconst NODE = croquet_build_process.env.CROQUET_PLATFORM === 'node';\n\nlet digest;\nif (globalThis.crypto && globalThis.crypto.subtle && typeof globalThis.crypto.subtle.digest === \"function\") {\n    digest = globalThis.crypto.subtle.digest.bind(globalThis.crypto.subtle);\n} else {\n    digest = (algorithm, arrayBuffer) => {\n        if (algorithm !== \"SHA-256\") throw Error(`${App.libName}: only SHA-256 available`);\n        const inputWordArray = WordArray.create(arrayBuffer);\n        const outputWordArray = sha256(inputWordArray);\n        const bytes = cryptoJsWordArrayToUint8Array(outputWordArray);\n        return bytes.buffer;\n    };\n}\n\nexport function cryptoJsWordArrayToUint8Array(wordArray) {\n    const l = wordArray.sigBytes;\n    const words = wordArray.words;\n    const result = new Uint8Array(l);\n    let i = 0, j = 0;\n    while (i < l) {\n        const w = words[j++];\n        result[i++] = (w & 0xff000000) >>> 24; if (i === l) break;\n        result[i++] = (w & 0x00ff0000) >>> 16; if (i === l) break;\n        result[i++] = (w & 0x0000ff00) >>> 8;  if (i === l) break;\n        result[i++] = (w & 0x000000ff);\n    }\n    return result;\n}\n\nfunction funcSrc(func) {\n    // this is used to provide the source code for hashing, and hence for generating\n    // a session ID.  we do some minimal cleanup to unify the class / function strings\n    // as provided by different browsers.\n    function cleanup(str) {\n        const openingBrace = str.indexOf('{');\n        const closingBrace = str.lastIndexOf('}');\n        if (openingBrace === -1 || closingBrace === -1 || closingBrace < openingBrace) return str;\n        const head = str.slice(0, openingBrace).replace(/\\s+/g, ' ').replace(/\\s\\(/, '(');\n        const body = str.slice(openingBrace + 1, closingBrace);\n        return `${head.trim()}{${body.trim()}}`;\n    }\n    let src = cleanup(\"\" + func);\n    if (!src.startsWith(\"class\")) {\n        // possibly class has been minified and replaced with function definition\n        // add source of prototype methods\n        const p = func.prototype;\n        if (p) src += Object.getOwnPropertyNames(p).map(n => `${n}:${cleanup(\"\" + p[n])}`).join('');\n    }\n    return src;\n    // remnants of an experiment (june 2019) in deriving the same hash for code\n    // that is semantically equivalent, even if formatted differently - so that\n    // tools such as Codepen, which mess with white space depending on the\n    // requested view type (e.g., debug or not), would nonetheless generate\n    // the same session ID for all views.\n    // our white-space standardisation involved stripping space immediately\n    // inside a brace, and at the start of each line:\n\n    // .replace(/\\{\\s+/g, '{').replace(/\\s+\\}/g, '}').replace(/^\\s+/gm, '')}}`;\n\n    // upon realising that Codepen also reserves the right to inject code, such\n    // as into \"for\" loops to allow interruption, we decided to abandon this\n    // approach.  users should just get used to different views having different\n    // session IDs.\n}\n\nexport function fromBase64url(base64) {\n    return new Uint8Array(atob(base64.padEnd((base64.length + 3) & ~3, \"=\")\n        .replace(/-/g, \"+\")\n        .replace(/_/g, \"/\")).split('').map(c => c.charCodeAt(0)));\n}\n\nexport function toBase64url(bits) {\n    return btoa(String.fromCharCode(...new Uint8Array(bits)))\n        .replace(/=/g, \"\")\n        .replace(/\\+/g, \"-\")\n        .replace(/\\//g, \"_\");\n}\n\n/** return buffer hashed into 256 bits encoded using base64 (suitable in URL) */\nexport async function hashBuffer(buffer) {\n    // MS Edge does not like empty buffer\n    if (buffer.length === 0) return \"47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU\";\n    const bits = await digest(\"SHA-256\", buffer);\n    return toBase64url(bits);\n}\n\nfunction debugHashing() { return urlOptions.has(\"debug\", \"hashing\", false); }\n\nlet debugHashes = {};\n\nconst encoder = new TextEncoder();\n\n/** return string hashed into 256 bits encoded using base64 (suitable in URL)  */\nexport async function hashString(string) {\n    const buffer = encoder.encode(string);\n    const hash = await hashBuffer(buffer);\n    debugHashes[hash] = {string, buffer};\n    return hash;\n}\n\nconst hashPromises = [];\nconst codeHashCache = {}; // persistentID to { codeHashes, computedCodeHash }, cached on first JOIN in case additional code or constants (presumably for a different session) get registered later, and the user explicitly leaves and re-joins\n\nexport function addClassHash(cls, classId) {\n    const source = funcSrc(cls);\n    const hashPromise = hashString(`${classId}:${source}`);\n    hashPromises.push(hashPromise);\n    hashPromise.then(hash => debugHashes[hash].what = `Class ${classId}`);\n}\n\nexport function addConstantsHash(constants) {\n    // replace functions with their source\n    const json = JSON.stringify(constants, (_, val) => typeof val === \"function\" ? funcSrc(val) : val);\n    if (json === \"{}\") return;\n    // use a stable stringification\n    const obj = JSON.parse(json);\n    const string = stableStringify(obj);\n    const hashPromise = hashString(string);\n    hashPromises.push(hashPromise);\n    hashPromise.then(hash => debugHashes[hash].what = `${App.libName} Constants`);\n}\n\n/** generate persistentId for the vm */\nexport async function hashNameAndOptions(appIdAndName, options) {\n    return hashString(appIdAndName + stableStringify(options));\n}\n\nconst logged = new Set();\n\nexport async function hashSessionAndCode(persistentId, developerId, params, hashOverride, sdk_version) {\n    // codeHashes are from registered user models and constants (in hashPromises).\n    // jul 2021: note that if multiple sessions are loaded in the same tab, *all*\n    // sessions' models and constants registered up to this point will be taken into\n    // account.  later we'd like to provide an interface (perhaps through App) for\n    // registering each session's resources separately.\n    let codeHashes;\n    /** identifies the code being executed - user code, constants, croquet */\n    let computedCodeHash;\n    const cached = codeHashCache[persistentId];\n    let cacheAnnotation = \"\";\n    if (cached) {\n        // the cached codeHashes list is only used in logging, and logging will\n        // only happen if the final derived session ID has changed.\n        codeHashes = cached.codeHashes;\n        computedCodeHash = cached.computedCodeHash;\n        cacheAnnotation = \" (code hashing from cache)\";\n    } else {\n        codeHashes = await Promise.all(hashPromises);\n        computedCodeHash = await hashString([sdk_version, ...codeHashes].join('|'));\n        codeHashCache[persistentId] = { codeHashes, computedCodeHash };\n    }\n    // let developer override hashing (at their own peril)\n    const effectiveCodeHash = hashOverride || computedCodeHash;\n    /** identifies the session */\n    const id = await hashString(persistentId + '|' + developerId + stableStringify(params) + effectiveCodeHash);\n    // log all hashes if debug=hashing\n    if (debugHashing() && !logged.has(id)) {\n        const charset = NODE ? 'utf-8' : [...document.getElementsByTagName('meta')].find(el => el.getAttribute('charset'));\n        if (!charset) console.warn(`${App.libName}: Missing <meta charset=\"...\"> declaration. ${App.libName} model code hashing might differ between browsers.`);\n        debugHashes[computedCodeHash].what = \"Version ID\";\n        debugHashes[persistentId].what = \"Persistent ID\";\n        debugHashes[id].what = \"Session ID\";\n        if (effectiveCodeHash !== computedCodeHash) {\n            codeHashes.push(computedCodeHash); // for allHashes\n            debugHashes[computedCodeHash].what = \"Computed Version ID (replaced by overrideHash)\";\n            debugHashes[effectiveCodeHash] = { what: \"Version ID (as specified by overrideHash)\"};\n        }\n        const allHashes = [...codeHashes, effectiveCodeHash, persistentId, id].map(each => ({ hash: each, ...debugHashes[each]}));\n        console.log(`${App.libName}: Debug Hashing for session ${id}${cacheAnnotation}`, allHashes);\n        logged.add(id);\n    }\n    if (!debugHashing()) debugHashes = {}; // clear debugHashes to save memory\n    return { id, persistentId, codeHash: effectiveCodeHash, computedCodeHash };\n}\n", "const StartDate = Date.now();\nif (typeof performance === \"undefined\") window.performance = { now: () => Date.now() - StartDate };\n\nconst order = [\n    \"simulate\",\n    \"update\",\n    \"render\",\n    \"snapshot\",\n];\n\nconst colors = {\n    total: \"black\",\n    update: \"blue\",\n    render: \"magenta\",\n    simulate: \"yellow\",\n    snapshot: \"green\",\n    backlog: \"red\",\n    network: \"lightgray\",\n};\n\nlet statsDiv = null;\nlet canvas = null;\nlet ctx = null;\nlet drawX = 0;\nexport const PLOT_BACKLOG = false; // currently the true case is not well supported\n\nlet fps = null;\nlet fCtx = null;\n\nlet horizCanvas;\nlet hCtx;\n\nlet backlogCanvas;\nlet bCtx;\n\nexport function makeStats(div) {\n    statsDiv = div;\n\n    while (div.firstChild) div.removeChild(div.firstChild);\n\n    div.style.background = '#faf0dc';\n\n    fps = document.createElement('canvas');\n    fCtx = fps.getContext(\"2d\");\n\n    fps.id = 'text_stats';\n    fps.width = Math.min(140, window.innerWidth);\n    fps.height = 36;\n    fps.style.width = fps.width;\n    fps.style.height = fps.height;\n    fCtx.font = '9.5pt sans-serif';\n    div.appendChild(fps);\n\n    // ael: used to be on canvas - but that now has \"pointer-events: none\"\n    div.title = Object.entries(colors).map(([k, c]) => `${c}: ${k}`).join('\\n');\n\n    canvas = document.createElement('canvas');\n    canvas.width = Math.min(125, window.innerWidth);\n    canvas.height = (PLOT_BACKLOG ? 360 : 125);\n    canvas.style.width = \"100%\";\n\n    const innerDiv = document.createElement(\"div\");\n    innerDiv.id = \"innerDiv\";\n\n    div.appendChild(innerDiv);\n    innerDiv.appendChild(canvas);\n    ctx = canvas.getContext(\"2d\");\n}\n\nconst frames = [];\nlet maxBacklog = 0;\nlet connected = false;\nlet currentFrame = newFrame(0);\n\nconst oneFrame = 1000 / 60;\nfunction map(v) {\n    return (1 - v / oneFrame) * 20 + 60;\n    // zero is at y=80; a full frame's time (at 60Hz) subtracts 20\n}\n\nfunction makeOverlayCanvas(baseCanvas) {\n    const c = document.createElement('canvas');\n    c.width = baseCanvas.width;\n    c.height = baseCanvas.height;\n    c.style.width = \"100%\";\n    c.style.position = \"absolute\";\n    c.style.left = \"0px\";\n\n    const innerDiv = statsDiv.querySelector(\"#innerDiv\");\n    innerDiv.appendChild(c);\n    return c;\n}\n\nfunction makeHorizCanvas(baseCanvas) {\n    horizCanvas = makeOverlayCanvas(baseCanvas);\n    hCtx = horizCanvas.getContext(\"2d\");\n\n    hCtx.strokeStyle = 'rgba(255, 255, 255, 0.5)';\n    for (let y = 0; y < 60; y += oneFrame) {\n        const m = map(y);\n        hCtx.moveTo(0, m);\n        hCtx.lineTo(horizCanvas.width, m);\n        hCtx.stroke();\n    }\n}\n\nfunction makeBacklogCanvas(baseCanvas) {\n    backlogCanvas = makeOverlayCanvas(baseCanvas);\n    bCtx = backlogCanvas.getContext(\"2d\");\n}\n\nfunction cleanupOverlayCanvases() {\n    if (horizCanvas) {\n        horizCanvas.remove();\n        hCtx = null;\n    }\n    if (backlogCanvas) {\n        backlogCanvas.remove();\n        bCtx = null;\n    }\n}\n\nfunction drawTextStats(avgMS, maxMS) {\n    fCtx.globalCompositeOperation = \"copy\";\n    fCtx.fillStyle = \"rgb(255, 255, 255, 0)\";\n    fCtx.fillRect(0, 0, fps.width, fps.height);\n\n    fCtx.fillStyle = \"rgb(0, 0, 0, 1)\";\n    fCtx.globalCompositeOperation = \"source-over\";\n    let line = `${currentFrame.users} users, ${Math.round(1000/avgMS)} fps`;\n    if (maxMS > 70) line += ` ${Math.ceil(maxMS).toLocaleString()}ms`;\n    fCtx.fillText(line, 2, 15);\n\n    line = (currentFrame.backlog < 100 && currentFrame.activity < 1000\n            ? `latency: ${currentFrame.latency} ms`\n            : `backlog: ${currentFrame.backlog < 100 ? '0.0' : (currentFrame.backlog/1000).toFixed(1)} s`);\n    fCtx.fillText(line, 2, 33);\n}\n\nfunction newFrame(now) {\n    return {\n        start: now,\n        total: 0,\n        items: {},\n        users: 0,\n        backlog: 0,\n        network: 0,\n        latency: 0,\n        activity: 1000,\n        connected\n    };\n}\n\nfunction endCurrentFrame(timestamp) {\n    // add current frame to end\n    currentFrame.total = timestamp - currentFrame.start;\n    const limit = Math.min(120, window.innerWidth);\n    // drop at least one to make room\n    if (frames.length >= limit) {frames.splice(0, frames.length - limit + 1);}\n    frames.push(currentFrame);\n\n    if  (frames.length <= 1) return;\n\n    if (!statsDiv) return;\n    if (statsDiv.offsetHeight === 0) return;\n\n    // get base framerate as minimum of all frames\n    const realFrames = frames.slice(1).filter(f => f.total);\n    const avgMS = realFrames.map(f => f.total).reduce((a, b) => a + b, 0) / realFrames.length;\n    const maxMS = Math.max(...realFrames.map(f => f.total));\n    const newMax = Math.max(...realFrames.map(f => Math.max(f.backlog, f.network)));\n    maxBacklog = PLOT_BACKLOG ? Math.max(newMax, maxBacklog * 0.98) : 1000; // reduce scale slowly\n\n    drawTextStats(avgMS, maxMS);\n\n    if (!horizCanvas) {makeHorizCanvas(canvas);}\n    if (PLOT_BACKLOG && !backlogCanvas) {makeBacklogCanvas(canvas);}\n\n    if (drawX === canvas.width) {\n        ctx.globalCompositeOperation = \"copy\";\n        ctx.drawImage(canvas, 1, 0, canvas.width - 1, canvas.height, 0, 0, canvas.width - 1, canvas.height);\n        ctx.globalCompositeOperation = \"source-over\";\n        ctx.fillStyle = \"transparent\";\n        ctx.fillRect(canvas.width - 1, 0, 1, canvas.height);\n    } else {\n        drawX++;\n    }\n    // for backlog, zero maps to y=85\n    // max with flexible backlog is what -200ms would look like at frame scale (80 + 12frames * 20 + 5) => 325\n    // max with fixed backlog (so we're only plotting network delay) makes 1s of delay plot as 2 frames' height.\n    const mapBacklog = v => map(PLOT_BACKLOG ? (v / Math.max(3000, maxBacklog) * -200) : (v / maxBacklog * -2 * oneFrame)) + 5;\n\n    {\n        const frame = frames[frames.length - 1];\n        const x = drawX - 0.5; // it is already incremented so go half pixel left to draw\n        let y = map(0);\n\n        ctx.beginPath();\n        ctx.moveTo(x, y);\n        ctx.lineTo(x, map(frame.total));\n        ctx.strokeStyle = colors[frame.connected ? \"total\" : \"network\"];\n        ctx.stroke();\n\n        ctx.beginPath();\n        ctx.moveTo(x, y);\n        y = map(frame.total);\n        let ms = 0;\n        for (const item of order) {\n            if (!frame.items[item]) continue;\n            ms += frame.items[item];\n            y = map(ms);\n            ctx.lineTo(x, y);\n            ctx.strokeStyle = colors[item];\n            ctx.stroke();\n            ctx.beginPath();\n            ctx.moveTo(x, y);\n        }\n\n        if (frame.network) {\n            ctx.beginPath();\n            ctx.moveTo(x, mapBacklog(0));\n            ctx.lineTo(x, mapBacklog(frame.network));\n            ctx.strokeStyle = colors[\"network\"];\n            ctx.stroke();\n        }\n        if (PLOT_BACKLOG && frame.backlog) {\n            ctx.beginPath();\n            ctx.moveTo(x, mapBacklog(0));\n            ctx.lineTo(x, mapBacklog(frame.backlog));\n            ctx.strokeStyle = colors[\"backlog\"];\n            ctx.stroke();\n        }\n    }\n\n    if (PLOT_BACKLOG && maxBacklog > 500) {\n        // draw lines with labels for backlog\n        // use log10 to draw lines every 1s, or 10s, or 100s etc.\n        const unit = 10 ** Math.floor(Math.log10(Math.max(3000, maxBacklog)));\n        bCtx.clearRect(0, 0, backlogCanvas.width, backlogCanvas.height);\n        bCtx.font = '10pt sans-serif';\n        bCtx.fillStyle = 'rgba(255, 255, 0, 1)';\n        for (let i = 1; i < 11; i++) {\n            const value = i * unit;\n            const y = mapBacklog(value);\n            bCtx.moveTo(0, y);\n            bCtx.lineTo(120, y);\n            bCtx.stroke();\n            bCtx.fillText(`${value / 1000}s`, 0, y - 5);\n            if (value > maxBacklog) break;\n        }\n    }\n\n    if (PLOT_BACKLOG) statsDiv.style.bottom = mapBacklog(Math.max(1000, maxBacklog)) - 350;\n}\n\nconst stack = []; // stack of current timing items (begin/end pairs)\n\nconst networkTraffic = {}; // network stats accumulators\nlet currentSecond = {}; // message bundling stats logged per second\n\nexport const Stats = {\n    frames, // only to expose it for testing\n\n    animationFrame(timestamp, stats={}) {\n        endCurrentFrame(timestamp);\n        currentFrame = newFrame(timestamp);\n        // controller.stepSession invokes this with a stats object with entries\n        // { backlog, starvation, latency, activity, users }.  below are methods\n        // for each key, recording the supplied values in currentFrame.\n        for (const [key, value] of Object.entries(stats)) this[key](value);\n    },\n    begin(item) {\n        // start inner measurement\n        const now = performance.now();\n        currentFrame.items[item] = (currentFrame.items[item] || 0) - now;\n        // stop outer measurement\n        const outer = stack[stack.length - 1];\n        if (outer) currentFrame.items[outer] += now;\n        stack.push(item);\n        return now;\n    },\n    end(item) {\n        // stop inner measurement\n        const now = performance.now();\n        currentFrame.items[item] += now;\n        // start outer measurement\n        const expected = stack.pop();\n        if (expected !== item) throw Error(`Unmatched stats calls: expected end(\"${expected}\"), got end(\"${item}\")`);\n        const outer = stack[stack.length - 1];\n        if (outer) currentFrame.items[outer] -= now;\n        return now;\n    },\n    backlog(ms) {\n        currentFrame.backlog = Math.max(ms, currentFrame.backlog);\n    },\n    starvation(ms) {\n        currentFrame.network = ms;\n    },\n    latency(ms) {\n        currentFrame.latency = ms;\n    },\n    activity(ms) {\n        currentFrame.activity = ms;\n    },\n    users(users) {\n        currentFrame.users = users;\n    },\n    connected(bool) {\n        const wasConnected = connected;\n        currentFrame.connected = connected = bool;\n        if (wasConnected && !connected) {\n            cleanupOverlayCanvases();\n        }\n    },\n\n    // accumulate network traffic\n    networkTraffic,\n    addNetworkTraffic(key, bytes, storeForAudit=false) {\n        networkTraffic[key] = (networkTraffic[key] || 0) + bytes;\n        if (storeForAudit) networkTraffic[`audit_${key}`] = (networkTraffic[`audit_${key}`] || 0) + bytes;\n    },\n    resetAuditStats() {\n        for (const key in networkTraffic) {\n            if (key.startsWith('audit_')) networkTraffic[key] = 0;\n        }\n    },\n\n    // the stats gathered here (iff window.logMessageStats is truthy) are reported by\n    // Stats.stepSession (below), which is invoked by controller.stepSession on every step.\n    perSecondTally(stats = {}) {\n        if (!window.logMessageStats) return;\n\n        for (const [key, value] of Object.entries(stats)) currentSecond[key] = (currentSecond[key] || 0) + value;\n    },\n    stepSession(_timestamp, report=false) {\n        const second = Math.floor(Date.now() / 1000);\n\n        if (!window.logMessageStats) {\n            // no reporting needed.  keep updating the per-second record, ready for logging\n            // to start.\n            currentSecond = { second };\n            return null;\n        }\n\n        let result = null;\n        if (second !== currentSecond.second) {\n            // don't report if no messages have been requested or sent\n            if (currentSecond.second && report && (currentSecond.requestedMessages || currentSecond.sentMessagesTotal)) {\n                result = { ...currentSecond };\n                // if multiple seconds have passed, add a sampleSeconds property\n                const sampleSeconds = second - currentSecond.second;\n                if (sampleSeconds !== 1) result.sampleSeconds = sampleSeconds;\n                // average the size of bundles, and the delays in sending messages via a bundle\n                if (result.sentBundles) {\n                    result.averageDelay = Math.round(10 * result.sendDelay / result.sentMessagesTotal) / 10;\n                    result.averageBundlePayload = Math.round(result.sentBundlePayload / result.sentBundles);\n                }\n                // clean up\n                delete result.second;\n                delete result.sendDelay;\n                delete result.sentBundlePayload;\n            }\n            currentSecond = { second };\n        }\n        return result;\n    }\n};\n\nglobalThis.CROQUETSTATS = Stats;\n", "import Toastify from 'toastify-js';\nimport SeedRandom from \"../thirdparty-patched/seedrandom/seedrandom\";\nimport QRCode from \"../thirdparty-patched/qrcodejs/qrcode\";\nimport urlOptions from \"./urlOptions\";\nimport { toBase64url } from \"./hashing\";\nimport { makeStats } from \"./stats\";\n\n\nconst TOUCH = 'ontouchstart' in document.documentElement;\nconst IFRAMED = window && window.parent !== window;\nconst BAR_PROPORTION = 18; // height of dock, in % of content size\nconst BUTTON_RIGHT = 2; // %\nconst BUTTON_WIDTH = TOUCH ? 20 : 12; // %\nconst BUTTON_SEPARATION = 2; // %\nconst BUTTON_OFFSET = TOUCH ? 0 : 15; // extra % from the right\nconst CONTENT_MARGIN = 2; // px\nconst TRANSITION_TIME = 0.3; // seconds\n\n// add style for the standard widgets that can appear on a Croquet page\nlet addedWidgetStyle = false;\nfunction addWidgetStyle() {\n    if (addedWidgetStyle) return;\n    addedWidgetStyle = true;\n    const widgetCSS = `\n        #croquet_dock { position: fixed; z-index: 2; border: 3px solid white; bottom: 6px; left: 6px; width: 36px; height: 36px; box-sizing: border-box; background: white; opacity: 0.4; transition: all ${TRANSITION_TIME}s ease; }\n        #croquet_dock.active { opacity: 0.95; border-radius: 12px; }\n        #croquet_dock.debug { width: 84px; }\n        #croquet_dock_bar { position: absolute; border: 3px solid white; width: 100%; height: 30px; box-sizing: border-box; background: white; }\n\n        #croquet_badge { position: absolute; width: 72px; height: 24px; top: 50%; transform: translate(0px, -50%); cursor: none; }\n        #croquet_dock.active #croquet_badge { left: 2%; }\n        #croquet_dock:not(.debug) #croquet_badge { display: none; }\n\n        .croquet_dock_button { position: absolute; width: ${BUTTON_WIDTH}%; height: 90%; top: 50%; transform: translate(0px, -50%); border-radius: 20%; }\n        .croquet_dock_button:focus { outline: 0; }\n        .croquet_dock_button canvas { position: absolute; width: 100%; height: 100%; top: 0px; left: 0px; }\n        #croquet_dock:not(.active) .croquet_dock_button { display: none; }\n        #croquet_dock_left { right: ${BUTTON_RIGHT + BUTTON_OFFSET + BUTTON_WIDTH + BUTTON_SEPARATION}% }\n        #croquet_dock:not(.debug) #croquet_dock_left { display: none; }\n        #croquet_dock_right { right: ${BUTTON_RIGHT + BUTTON_OFFSET}%; }\n        #croquet_dock:not(.debug) #croquet_dock_right { display: none; }\n        #croquet_dock_pin { right: ${BUTTON_RIGHT}%; }\n        #croquet_dock_pin.pinned { background: #cce6ff; }\n\n        #croquet_dock_content { position: absolute; left: ${CONTENT_MARGIN}px; top: ${CONTENT_MARGIN}px; right: ${CONTENT_MARGIN}px; bottom: ${CONTENT_MARGIN}px; background: white; overflow: hidden; }\n        #croquet_dock.debug:not(.active) #croquet_dock_content { display: none; }\n        #croquet_dock.debug:not(.active) #croquet_dock_content div { display: none; }\n\n        #croquet_qrcode { position: absolute; width: 100%; height: 100%;box-sizing: border-box; cursor: crosshair; }\n        #croquet_dock.active #croquet_qrcode { border: 6px solid white; }\n        #croquet_dock.debug #croquet_qrcode:not(.active) { display: none; }\n        #croquet_qrcode canvas { image-rendering: pixelated; }\n\n        #croquet_stats { position: absolute; width: 70%; height: 90%; left: 15%; top: 5%; opacity: 0.8; font-family: sans-serif; }\n        #croquet_stats:not(.active) { display: none; }\n`;\n    const widgetStyle = document.createElement(\"style\");\n    widgetStyle.innerHTML = widgetCSS;\n    document.head.insertBefore(widgetStyle, document.head.querySelector(\"style,link[rel=stylesheet]\"));\n}\n\n// add style for the spinner\nlet addedSpinnerStyle = false;\nfunction addSpinnerStyle() {\n    if (addedSpinnerStyle) return;\n    addedSpinnerStyle = true;\n    // unless this app is explicitly rejecting our default html additions by setting\n    // App.root to false (in which case the spinner won't be made), we add a default\n    // minimum height for document.body to help our IntersectionObserver (controller.js)\n    // make accurate judgements about whether an iframed app is in or out of view.\n    const spinnerCSS = `\n        ${IFRAMED ? \"body { min-height: 100vh }\" : \"\"}\n        #croquet_spinnerOverlay {\n            z-index: 1000;\n            position: fixed;\n            left: 0;\n            top: 0;\n            width: 100%;\n            height: 100%;\n            background-color:#333;\n            opacity:0.9;\n            display:flex;\n            align-items:center;\n            justify-content:center;\n            transition: opacity 1.0s ease-out;\n        }\n        /* https://github.com/lukehaas/css-loaders */\n        @keyframes croquet_dots {\n            0%, 80%, 100% { box-shadow: 0 2.5em 0 -1.3em; }\n            40% { box-shadow: 0 2.5em 0 0; }\n        }\n        #croquet_loader,\n        #croquet_loader::before,\n        #croquet_loader::after {\n          border-radius: 50%;\n          width: 2.5em;\n          height: 2.5em;\n          animation: croquet_dots 1.8s infinite ease-in-out;\n        }\n        #croquet_loader {\n          color: #fff;\n          font-size: 10px;\n          margin: 80px auto;\n          position: relative;\n          text-indent: -9999em;\n          animation-delay: -0.16s;\n        }\n        #croquet_loader::before,\n        #croquet_loader::after {\n          content: '';\n          position: absolute;\n          top: 0;\n        }\n        #croquet_loader::before { left: -3.5em; animation-delay: -0.32s; }\n        #croquet_loader::after { left: 3.5em; }\n        #croquet_spinnerOverlay.croquet_error>*,\n        #croquet_spinnerOverlay.croquet_error>*::before,\n        #croquet_spinnerOverlay.croquet_error>*::after {\n            color: #f00;\n        }\n        #croquet_spinnerOverlay.croquet_fatal>*,\n        #croquet_spinnerOverlay.croquet_fatal>*::before,\n        #croquet_spinnerOverlay.croquet_fatal>*::after {\n            color: #f00;\n            box-shadow: 0 2.5em 0 0 !important;\n            animation: none !important;\n        }\n`;\n    const spinnerStyle = document.createElement(\"style\");\n    spinnerStyle.innerHTML = spinnerCSS;\n    document.head.insertBefore(spinnerStyle, document.head.querySelector(\"style,link[rel=stylesheet]\"));\n}\n\nlet addedToastifyStyle = false;\nfunction addToastifyStyle() {\n    if (addedToastifyStyle) return;\n    addedToastifyStyle = true;\n    // inject toastify's standard css\n    let toastifyCSS = `/*!\n        * Toastify js 1.5.0\n        * https://github.com/apvarun/toastify-js\n        * @license MIT licensed\n        *\n        * Copyright (C) 2018 Varun A P\n        */\n        .toastify {\n            padding: 12px 20px;\n            color: #ffffff;\n            display: inline-block;\n            box-shadow: 0 3px 6px -1px rgba(0, 0, 0, 0.12), 0 10px 36px -4px rgba(77, 96, 232, 0.3);\n            background: -webkit-linear-gradient(315deg, #73a5ff, #5477f5);\n            background: linear-gradient(135deg, #73a5ff, #5477f5);\n            position: fixed;\n            opacity: 0;\n            transition: all 0.4s cubic-bezier(0.215, 0.61, 0.355, 1);\n            border-radius: 2px;\n            cursor: pointer;\n            text-decoration: none;\n            max-width: calc(50% - 20px);\n            z-index: 2147483647;\n        }\n        .toastify.on {\n            opacity: 1;\n        }\n        .toast-close {\n            opacity: 0.4;\n            padding: 0 5px;\n        }\n        .toastify-right {\n            right: 15px;\n        }\n        .toastify-left {\n            left: 15px;\n        }\n        .toastify-top {\n            top: -150px;\n        }\n        .toastify-bottom {\n            bottom: -150px;\n        }\n        .toastify-rounded {\n            border-radius: 25px;\n        }\n        .toastify-avatar {\n            width: 1.5em;\n            height: 1.5em;\n            margin: 0 5px;\n            border-radius: 2px;\n        }\n        @media only screen and (max-width: 360px) {\n            .toastify-right, .toastify-left {\n                margin-left: auto;\n                margin-right: auto;\n                left: 0;\n                right: 0;\n                max-width: fit-content;\n            }\n        }\n`;\n    // add our own (post-v1.5.0) preferences\n    toastifyCSS += `\n        .toastify {\n            font-family: sans-serif;\n            border-radius: 8px;\n        }\n\n        .toastify-center {\n            margin-left: auto;\n            margin-right: auto;\n            left: 0;\n            right: 0;\n            max-width: fit-content;\n            max-width: -moz-fit-content;\n        }\n`;\n    const toastifyStyle = document.createElement(\"style\");\n    toastifyStyle.innerHTML = toastifyCSS;\n    document.head.insertBefore(toastifyStyle, document.head.querySelector(\"style,link[rel=stylesheet]\"));\n}\n\n// this is the default App.messageFunction\nexport function showMessageAsToast(msg, options = {}) {\n    const level = options.level;\n    let gradient;\n    if (level === 'error') { gradient = 'orangered,red'; console.error(msg); }\n    else if (level === 'warning') { gradient = 'gold,orange'; console.warn(msg); }\n    else gradient = 'silver,gray';\n\n    return displayToast(msg, { style: { background: `linear-gradient(90deg,${gradient})`}, ...options });\n}\n\nexport function displayError(msg, options={}) {\n    return msg && App.showMessage(msg, { ...options, level: 'error' });\n}\n\nexport function displayWarning(msg, options={}) {\n    return msg && App.showMessage(msg, { ...options, level: 'warning' });\n}\n\nexport function displayStatus(msg, options={}) {\n    return msg && App.showMessage(msg, { ...options, level: 'status' });\n}\n\nexport function displayAppError(where, error, level = \"error\") {\n    console.error(`Error during ${where}`, error);\n    const userStack = (error.stack || '').split(\"\\n\").filter(l => !l.match(/croquet-.*\\.min.js/)).join('\\n');\n    App.showMessage(`Error during ${where}: ${error.message}\\n\\n${userStack}`,  {\n        level,\n        duration: level === \"error\" ? 10000 : undefined,\n        stopOnFocus: true,\n    });\n}\n\nfunction displayToast(msg, options) {\n    const parentDef = findElement(App.root, () => document.body);\n    if (parentDef === false) return null;\n\n    addToastifyStyle();\n\n    const toastOpts = {\n        text: msg,\n        duration: 3000,\n        //close: true,\n        gravity: 'bottom', // `top` or `bottom`\n        position: 'right', // `left`, `center` or `right`\n        stopOnFocus: true, // Prevents dismissing of toast on hover\n        ...options };\n\n    let selector;\n    if (parentDef instanceof Element && parentDef !== document.body) {\n        // toastify needs an id, not an element.  if the element has no id, give it one.\n        selector = parentDef.id;\n        if (!selector) parentDef.id = selector = '_croquetToastParent';\n    } else if (typeof parentDef === 'string') selector = parentDef;\n    // else fall through with no selector (so body will be used as parent)\n\n    if (selector) toastOpts.selector = selector;\n\n    return Toastify(toastOpts).showToast();\n}\n\nfunction monikerForId(id) {\n    // random page title suffix\n    const random = new SeedRandom(id);\n    const letters = ['bcdfghjklmnpqrstvwxyz', 'aeiou'];\n    let moniker = '';\n    for (let i = 0; i < 5; i++) moniker += letters[i % 2][random.quick() * letters[i % 2].length | 0];\n    return moniker;\n}\n\nfunction colorsForId(id, n=1) {\n    const random = new SeedRandom(id);\n    const colors = [];\n    for (let i=0; i<n; i++) colors.push(`hsl(${random.quick() * 360}, 50%, 70%)`);\n    return colors;\n}\n\nfunction clearSessionMoniker() {\n    if (App.badge === false) return; // we have reason to believe the moniker was never set (so don't mess with a title that might be being used to show something else)\n\n    document.title = document.title.replace(/:.*/, '');\n}\n\nlet localStorage;\ntry {\n    // check if we're allowed to use localStorage\n    localStorage = window.localStorage;\n    localStorage['croquet-debug-persist-allowed'] = \"true\";\n    if (localStorage['croquet-debug-persist-allowed'] !== \"true\") throw Error(\"localStorage not persisted\");\n    delete localStorage['croquet-debug-persist-allowed'];\n} catch (err) {\n    // if not, fake it\n    console.warn('localStorage not allowed');\n    localStorage = {};\n}\n\nconst dockState = {\n    // localStorage is per-host, but we also want per-app\n    get pinned() { return localStorage[window.location.pathname + '/croquet-debug-ui-pinned'] === \"true\"; },\n    set pinned(bool) { localStorage[window.location.pathname + '/croquet-debug-ui-pinned'] = !!bool; },\n    get activePage() { return localStorage[window.location.pathname + '/croquet-debug-ui-activePage']; },\n    set activePage(id) { localStorage[window.location.pathname + '/croquet-debug-ui-activePage'] = id; },\n};\n\nconst smotherEvent = evt => {\n    // console.log(\"smothering event\", evt);\n    evt.preventDefault();\n    evt.stopPropagation();\n};\n\n// an app can call App.makeWidgetDock with options specifying which of the widgets to include\n// in the dock.  by default, widgets badge, qrcode, stats are shown; turn off by setting\n// corresponding options property to false.\nfunction makeWidgetDock(options = {}) {\n    if (urlOptions.nodock) return;\n\n    const debug = options.debug || urlOptions.debug;\n\n    const oldDockDiv = document.getElementById('croquet_dock');\n    if (oldDockDiv) oldDockDiv.parentElement.removeChild(oldDockDiv);\n\n    const dockParent = findElement(App.root, () => document.body);\n    if (!dockParent) return;\n\n    addWidgetStyle();\n\n    const dockDiv = document.createElement('div');\n    dockDiv.id = 'croquet_dock';\n    if (debug) dockDiv.classList.add(\"debug\");\n    if (IFRAMED && options.iframe === false) dockDiv.style.display = \"none\";\n    dockParent.appendChild(dockDiv);\n\n    const barDiv = document.createElement('div');\n    barDiv.id = 'croquet_dock_bar';\n    dockDiv.appendChild(barDiv);\n\n    let badgeDiv;\n    if (options.badge !== false) {\n        badgeDiv = document.createElement('div');\n        badgeDiv.id = 'croquet_badge';\n        barDiv.appendChild(badgeDiv);\n        App.badge = badgeDiv;\n    }\n\n    const contentDiv = document.createElement('div');\n    contentDiv.id = 'croquet_dock_content';\n    dockDiv.appendChild(contentDiv);\n\n    const dockPageIds = []; // an ordered collection of available page (i.e., element) ids\n\n    let qrDiv;\n    if (options.qrcode !== false) {\n        const url = App.sessionURL;\n        if (url) {\n            qrDiv = document.createElement('div');\n            qrDiv.id = 'croquet_qrcode';\n            contentDiv.appendChild(qrDiv);\n            dockPageIds.push(qrDiv.id);\n            App.qrcode = qrDiv;\n            if (!debug) dockState.activePage = qrDiv.id;\n        }\n    }\n\n    let statsDiv;\n    if (options.stats !== false) {\n        statsDiv = document.createElement('div');\n        statsDiv.id = 'croquet_stats';\n        contentDiv.appendChild(statsDiv);\n        dockPageIds.push(statsDiv.id);\n        App.stats = statsDiv;\n    }\n\n    if (dockPageIds.length) {\n        function shiftPage(dir) {\n            const numPages = dockPageIds.length;\n            // on reconnect it's possible that a previously selected page is no longer available.\n            // if so, or if no page has been selected yet, act as if the first was.\n            let oldIndex = 0, oldElem;\n            if (dockState.activePage) {\n                const index = dockPageIds.indexOf(dockState.activePage);\n                if (index >= 0) {\n                    oldIndex = index;\n                    oldElem = document.getElementById(dockState.activePage);\n                } else dockState.activePage = null;\n            }\n            const newIndex = (oldIndex + numPages + dir) % numPages, newPage = dockPageIds[newIndex];\n            let newElem;\n            if (newPage === dockState.activePage) newElem = oldElem;\n            else {\n                if (oldElem) oldElem.classList.remove('active');\n                newElem = document.getElementById(newPage);\n            }\n            if (newElem) newElem.classList.add('active');\n\n            dockState.activePage = newPage;\n        }\n\n        if (dockPageIds.length > 1) {\n            barDiv.appendChild(makeButton('<', 'croquet_dock_left', () => shiftPage(-1)));\n            barDiv.appendChild(makeButton('>', 'croquet_dock_right', () => shiftPage(1)));\n        }\n\n        shiftPage(0); // set up a starting page (or re-select, if already set)\n    }\n\n    if (!TOUCH && !options.alwaysPinned) {\n        const pinButton = makeButton('', 'croquet_dock_pin', () => {\n            dockState.pinned = !dockState.pinned;\n            setPinState();\n            });\n        const setPinState = () => { if (dockState.pinned) pinButton.classList.add('pinned'); else pinButton.classList.remove('pinned'); };\n        setPinState();\n        barDiv.appendChild(pinButton);\n    }\n\n    const expandedSize = 200;\n    const minExpandedSize = 166;\n    const expandedBorder = 8;\n    const setCustomSize = sz => {\n        dockDiv.style.width = `${sz}px`;\n        const docHeight = sz * (1 + BAR_PROPORTION/100);\n        dockDiv.style.height = `${docHeight}px`;\n\n        const barHeight = sz * BAR_PROPORTION/100;\n        barDiv.style.height = `${barHeight}px`;\n        contentDiv.style.top = `${barHeight + CONTENT_MARGIN}px`;\n\n        if (badgeDiv) {\n            badgeDiv.style.height = `${barHeight * 0.9}px`;\n            badgeDiv.style.width = `${barHeight * 0.9 * 3}px`;\n        }\n\n        if (qrDiv) qrDiv.style.border = `${expandedBorder * sz / expandedSize}px solid white`;\n    };\n    const removeCustomSize = () => {\n        dockDiv.style.width = dockDiv.style.height = \"\";\n\n        barDiv.style.height = \"\";\n        contentDiv.style.top = \"\";\n\n        if (badgeDiv) badgeDiv.style.height = badgeDiv.style.width = \"\";\n        if (qrDiv) qrDiv.style.border = \"\";\n    };\n    let size = options.fixedSize || expandedSize; // start with default size for \"active\" state\n    const active = () => dockDiv.classList.contains('active');\n    const activate = () => {\n        dockDiv.classList.add('active');\n        setCustomSize(size);\n        // remove timed transition, to allow instant response during mouse-wheel resizing\n        setTimeout(() => dockDiv.style.transition = \"none\", TRANSITION_TIME * 1000);\n        };\n    const deactivate = () => {\n        dockDiv.style.transition = \"\"; // remove override - i.e., revert to timed transition\n        dockDiv.classList.remove('active');\n        removeCustomSize();\n        };\n    if (TOUCH) {\n        deactivate();\n        dockDiv.ontouchstart = evt => {\n            evt.preventDefault();\n            evt.stopPropagation();\n            if (active()) deactivate(); else activate();\n            };\n        dockDiv.ontouchend = smotherEvent;\n        dockDiv.onpointerdown = smotherEvent;\n        dockDiv.onpointerup = smotherEvent;\n    } else {\n        if (options.alwaysPinned) activate();\n        else {\n            if (dockState.pinned) activate(); else deactivate();\n            dockDiv.onmouseenter = activate;\n            dockDiv.onmouseleave = () => { if (!dockState.pinned) deactivate(); };\n        }\n        if (!options.fixedSize) {\n            let lastWheelTime = 0;\n            dockDiv.addEventListener(\"wheel\", evt => {\n                evt.stopPropagation();\n\n                const now = Date.now();\n                if (now - lastWheelTime < 100) return;\n                lastWheelTime = now;\n\n                let { deltaY } = evt;\n                deltaY = Math.sign(deltaY) * Math.min(5, Math.abs(deltaY)); // real mouse wheels generate huge deltas\n                const max = Math.min(window.innerWidth, window.innerHeight) * 0.8;\n                size = Math.max(minExpandedSize, Math.min(max, dockDiv.offsetWidth / (1.05 ** deltaY)));\n                setCustomSize(size);\n            }, { passive: true });\n        }\n    }\n}\n\nfunction makeButton(text, id, fn) {\n    const canvas = document.createElement('canvas');\n    const w = canvas.width = 40 * BUTTON_WIDTH/12; // @@ fudge to allow diff button width on touch\n    const h = canvas.height = 60;\n    const ctx = canvas.getContext('2d');\n    ctx.font = \"36px Arial\";\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n    ctx.fillStyle = 'black';\n    ctx.fillText(text, w / 2, h * 0.55);\n\n    const button = document.createElement('button');\n    button.id = id;\n    button.className = 'croquet_dock_button';\n    const trigger = evt => {\n        evt.preventDefault();\n        evt.stopPropagation();\n        fn();\n        };\n    if (TOUCH) {\n        button.ontouchstart = trigger;\n        button.ontouchend = smotherEvent;\n        button.onpointerdown = smotherEvent;\n        button.onpointerup = smotherEvent;\n    } else {\n        button.onclick = trigger;\n        button.onpointerdown = smotherEvent;\n        button.onpointerup = smotherEvent;\n    }\n    button.appendChild(canvas);\n    return button;\n}\n\nfunction makeBadge(div, sessionId) {\n    if (App.badge === false) return;\n\n    const moniker = monikerForId(sessionId);\n    document.title = document.title.replace(/:.*/, '');\n    document.title += ':' + moniker;\n\n    while (div.firstChild) div.removeChild(div.firstChild);\n    const canvas = document.createElement('canvas');\n    const w = canvas.width = 120;\n    const h = canvas.height = 40;\n    canvas.style.width = \"100%\";\n    div.appendChild(canvas);\n    const ctx = canvas.getContext('2d');\n    const colors = colorsForId(sessionId, 2);\n    ctx.fillStyle = colors[0];\n    ctx.beginPath();\n    ctx.moveTo(0, 0);\n    ctx.lineTo(0, h);\n    ctx.lineTo(w, 0);\n    ctx.closePath();\n    ctx.fill();\n\n    ctx.fillStyle = colors[1];\n    ctx.beginPath();\n    ctx.moveTo(w, h);\n    ctx.lineTo(w, 0);\n    ctx.lineTo(0, h);\n    ctx.closePath();\n    ctx.fill();\n\n    ctx.font = \"30px Arial\";\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n    ctx.fillStyle = 'black';\n    ctx.fillText(moniker, w/2, h/2);\n}\n\n// the QRCode maker takes an element and options (including the text for the code).\n// it adds a canvas to the element, draws the code into the canvas, and returns an\n// object that allows the code to be cleared and replaced.\nfunction makeQRCode(div, url, options={}) {\n    while (div.firstChild) div.removeChild(div.firstChild);\n    return new QRCode(div, {\n        text: url,\n        width: 128,\n        height: 128,\n        colorDark: \"#000000\",\n        colorLight: \"#ffffff\",\n        correctLevel: QRCode.CorrectLevel.L,   // L, M, Q, H\n        ...options\n        });\n}\n\nfunction displayBadgeIfNeeded(sessionId) {\n    if (!sessionId || App.root === false) return;\n\n    const badgeDiv = findElement(App.badge);\n    if (!badgeDiv) return;\n\n    makeBadge(badgeDiv, sessionId);\n}\n\nfunction toggleDebug() {\n    const dockDiv = document.getElementById('croquet_dock');\n    if (dockDiv) dockDiv.classList.toggle(\"debug\");\n}\n\nfunction displayQRCodeIfNeeded() {\n    if (App.root === false || App.qrcode === false) return;\n    if (urlOptions.noqr) return;\n\n    const url = App.sessionURL;\n    if (!url) { console.warn(\"App.sessionURL is not set\"); return; }\n\n    const qrDiv = findElement(App.qrcode);\n    if (!qrDiv) return;\n\n    if (!TOUCH) qrDiv.onclick = evt => {\n        evt.preventDefault();\n        evt.stopPropagation();\n        if (evt.shiftKey) toggleDebug();\n        else window.open(url);\n        };\n    const qrcode = makeQRCode(qrDiv, url); // default options\n    qrcode.getCanvas().style.width = \"100%\";\n}\n\nfunction displayStatsIfNeeded() {\n    if (App.root === false) return;\n    if (urlOptions.nostats) return;\n\n    const statsDiv = findElement(App.stats);\n    if (!statsDiv) return;\n\n    makeStats(statsDiv);\n}\n\nfunction makeSessionWidgets(sessionId) {\n    // sessionId can be undefined (in which case you won't get a badge)\n    displayBadgeIfNeeded(sessionId);\n    displayQRCodeIfNeeded();\n    displayStatsIfNeeded();\n}\n\n\nlet spinnerOverlay;\nlet spinnerEnabled; // set true when spinner is shown, or about to be shown\nlet spinnerTimeout = 0; // used to debounce.  only act on enabled true/false if steady for 500ms.\n\nfunction displaySpinner(enabled) {\n    if (spinnerEnabled === enabled) return;\n\n    // don't overwrite \"error\" or \"fatal\" status\n    if (typeof spinnerEnabled === \"string\" && enabled === true) return;\n\n    if (App.sync === false) enabled = false;\n\n    spinnerEnabled = enabled;\n    if (enabled) {\n        clearTimeout(spinnerTimeout);\n\n        // set timer to add the overlay after 500ms iff still enabled\n        spinnerTimeout = setTimeout(() => {\n            if (!spinnerEnabled) return; // not enabled any more.  don't show.\n\n            const parent = findElement(App.root, () => document.body);\n            parent.appendChild(spinnerOverlay);\n\n            spinnerOverlay.style.opacity = 0.9; // animate into view\n            if (spinnerEnabled === \"error\") spinnerOverlay.className = \"croquet_error\";\n            else if (spinnerEnabled === \"fatal\") spinnerOverlay.className = \"croquet_fatal\";\n            else spinnerOverlay.className = \"\";\n        }, 500);\n    } else {\n        if (!spinnerOverlay) return;\n\n        clearTimeout(spinnerTimeout);\n\n        spinnerOverlay.style.opacity = 0.0; // start the animated fade\n        spinnerOverlay.className = \"\";\n\n        // set timer to remove the overlay after 500ms iff still disabled\n        spinnerTimeout = setTimeout(() => {\n            if (spinnerEnabled) return; // now enabled.  don't remove.\n\n            if (spinnerOverlay.parentElement) spinnerOverlay.parentElement.removeChild(spinnerOverlay);\n        }, 500);\n    }\n}\n\nfunction makeSpinner() {\n    addSpinnerStyle();\n\n    const overlay = document.createElement(\"div\");\n    overlay.id = \"croquet_spinnerOverlay\";\n\n    const spinner = document.createElement(\"div\");\n    spinner.id = \"croquet_loader\";\n    spinner.innerText = \"Catching up...\";\n\n    overlay.appendChild(spinner);\n\n    return overlay;\n}\n\nfunction findElement(value, ifNotFoundDo) {\n    if (value === false) return false;\n\n    if (value instanceof Element) return value;\n\n    if (typeof value === \"string\") {\n        const elem = document.getElementById(value);\n        if (elem) return elem;\n    }\n\n    return ifNotFoundDo ? ifNotFoundDo() : null;\n}\n\nfunction defaultSessionURL() {\n    // use window.location.href unless there is a canonical url\n\n    let canonicalUrl = null;\n    const metas = document.getElementsByTagName('link');\n    for (const meta of metas) {\n        if (meta.getAttribute('rel') === 'canonical') {\n            canonicalUrl = meta.getAttribute('href');\n            break;\n        }\n    }\n\n    if (!canonicalUrl) {\n        return window.location.href;\n    }\n\n    return canonicalUrl;\n}\n\nfunction secureRandomString(length=16) {\n    const bytes = new Uint8Array(length);\n    window.crypto.getRandomValues(bytes); // okay to use on insecure origin\n    return toBase64url(bytes.buffer);\n}\n\nconst seenMessages = new Set();\n\nlet _sessionURL = defaultSessionURL();\n\nexport const App = {\n    get libName() { return globalThis.__MULTISYNQ__ ? \"Multisynq\" : \"Croquet\"; },\n\n    get sessionURL() { return _sessionURL; },\n    set sessionURL(url) { _sessionURL = url; displayQRCodeIfNeeded(); },\n    root: null, // root for messages, the sync spinner, and the info dock (defaults to document.body)\n    sync: true, // whether to show the sync spinner while starting a session, or catching up\n    messages: false, // whether to show status messages (e.g., as toasts)\n\n    // the following can take a DOM element, an element ID, or false (to suppress)\n    badge: false, // the two-colour session badge and 5-letter moniker\n    stats: false, // the frame-by-frame stats display\n    qrcode: false,\n\n    // make a fancy collapsible dock of info widgets (currently badge, qrcode, stats).\n    // disable any widget by setting e.g. { stats: false } in the options.\n    makeWidgetDock,\n\n    // build widgets in accordance with latest settings for root, badge, stats, and qrcode.\n    // called internally immediately after a session is established.\n    // can be called by an app at any time, to take account of changes in the settings.\n    makeSessionWidgets,\n\n    // make a canvas painted with the qr code for the currently set sessionURL (if there is one).\n    // options are used as overrides on our default settings, which are:\n    // { width: 128, height: 128, colorDark: \"#000000\", colorLight: \"#ffffff\", correctLevel: QRCode.CorrectLevel.L }\n    // the available CorrectLevel values are L, M, Q, H\n    makeQRCanvas(options = {}) {\n        if (!App.sessionURL) return null;\n\n        const div = document.createElement('div');\n        const qrcode = makeQRCode(div, App.sessionURL, options);\n        return qrcode && qrcode.getCanvas();\n    },\n\n    clearSessionMoniker,\n\n    showSyncWait(bool) {\n        // usually first invoked with bool=true on controller construction in Session.join\n        if (App.root === false) bool = false; // if root (now) false, only allow disabling\n        else if (!spinnerOverlay) spinnerOverlay = makeSpinner(); // includes our default style for document.body\n\n        displaySpinner(bool);\n    },\n\n    // messageFunction(msg, options) - where options from internally generated messages will include { level: 'status' | 'warning' | 'error' }\n    messageFunction: showMessageAsToast,\n\n    showMessage(msg, options={}) {\n        // thin layer on top of messageFunction, to discard messages if there's nowhere\n        // (or no permission) to show them, as well as add non-toastify features like\n        // { only: \"once\" } or { level: \"fatal\" } or { showSyncWait: \"error\" }\n        if (options.only === \"once\") {\n            if (seenMessages.has(msg)) return null;\n            seenMessages.add(msg);\n        }\n        if (options.level === \"fatal\") {\n            options.level = \"error\";\n            options.showSyncWait = \"fatal\";\n        }\n        if (options.showSyncWait) {\n            if (options.showSyncWait === \"fatal\" && !options.duration) options.duration = -1;\n            App.showSyncWait(options.showSyncWait);\n        }\n        if (urlOptions.nomessages || App.root === false || App.messages === false || !App.messageFunction) {\n            if (options.level === \"warning\") console.warn(msg);\n            if (options.level === \"error\") console.error(msg);\n            return null;\n        }\n\n        return App.messageFunction(msg, options);\n    },\n\n    // this is also used in prerelease.js\n    isCroquetHost(hostname) {\n        return hostname.endsWith(\"croquet.io\")\n            || [\"localhost\", \"127.0.0.1\", \"[::1]\"].includes(hostname)\n            || hostname.endsWith(\"ngrok.io\");\n    },\n\n    // sanitized session URL (always without @user:password and #hash, and without query if not same-origin as croquet.io)\n    referrerURL() {\n        const url = new URL(App.sessionURL);\n        const sameOrigin = this.isCroquetHost(url.hostname);\n        // can't use url.origin because Firefox answers \"null\" for file:// URLs\n        return `${url.protocol}//${url.host}${url.pathname}${sameOrigin ? url.search : \"\"}`;\n    },\n\n    // get session name from url search under the key given, or create random name\n    // If force=true, always create a new name (even if one is already there)\n    // If default is given, use that instead of random\n    // If keyless=true, allow ?name and #name without key (backwards compatibility)\n    autoSession(options = { key: 'q', force: false, default: '', keyless: false }) {\n        if (typeof options === \"string\") options = { key: options };\n        if (!options) options = {};\n        const key = options.key || 'q';\n        const url = new URL(App.sessionURL);\n        // fragment comes from ?key=fragment, or ?fragment or #fragment if keyless is enabled\n        let fragment = '';\n        if (!options.force) {\n            // Note: cannot use url.searchParams because browsers differ for malformed % sequences\n            const params = url.search.slice(1).split(\"&\");\n            const keyAndFragment = params.find(param => param.split(\"=\")[0] === key);\n            if (keyAndFragment) {\n                fragment = keyAndFragment.replace(/[^=]*=/, '');\n            } else if (options.keyless) {\n                // allow keyless ?fragment\n                fragment = params.find(param => !param.includes(\"=\"));\n                if (!fragment) { // fall back to #fragment for old URLs\n                    fragment = url.hash.slice(1);\n                    if (fragment) { // ... but redirect to new url\n                        url.hash = '';\n                        if (url.search) url.searchParams.set(key, fragment);\n                        else url.search = fragment;\n                    }\n                }\n            }\n        }\n        // decode % entities if possible\n        if (fragment) try { fragment = decodeURIComponent(fragment); } catch (ex) { /* ignore */ }\n        // if not found, create random fragment\n        else {\n            if (options.default) fragment = options.default;\n            else fragment = this.randomSession();\n            url.searchParams.set(key, fragment);\n        }\n        // change page url if needed\n        App.sessionURL = url.href;\n        if (window.location.href !== url.href) {\n            try {\n                window.history.replaceState({}, \"\", url.href);\n            } catch (ex) {\n                App.showMessage(`Setting address bar to ${url.href}`, { only: \"once\" });\n                App.showMessage(`Failed to change address bar: ${ex.message}`, { level: \"warning\", only: \"once\" });\n            }\n        }\n        if (urlOptions.has(\"debug\", \"session\")) console.log(`${App.libName}.App.autoSession: \"${fragment}\"`);\n        // return Promise for future-proofing\n        const retVal = Promise.resolve(fragment);\n        // warn about using it directly\n        retVal[Symbol.toPrimitive] = () => {\n            console.warn(`Deprecated: ${App.libName}.App.autoSession() return value used directly. It returns a promise now!`);\n            return fragment;\n        };\n        return retVal;\n    },\n\n    // get password from url hash under the key given, or create random password\n    // If scrub=true, remove it but keep in sessionURL for QR code (this makes\n    //    debugging hard, set debug=password to keep anyways)\n    // If keyless=true, allow #password without key (backwards compatibility)\n    // If force=true, always create a new password (even if one is already there)\n    // If default is given, use that instead of random\n    autoPassword(options = { key: 'pw', default: '', force: false, scrub: false, keyless: false}) {\n        if (typeof options === \"string\") options = { key: options };\n        const key = options.key || 'pw';\n        const scrub = options.scrub && !urlOptions.has(\"debug\", \"password\");\n        const keyless = options.keyless;\n        const url = new URL(App.sessionURL);\n        let password = '';\n        const hash = options.force ? '' : url.hash.slice(1);\n        if (hash) {\n            const params = hash.split(\"&\");\n            const keyAndPassword = params.find(param => param.split(\"=\")[0] === key);\n            if (keyAndPassword) {\n                password = keyAndPassword.replace(/[^=]*=/, '');\n                // App.sessionURL has it, but scrub from address bar\n                if (password && scrub) url.hash = params.filter(param => param.split(\"=\")[0] !== key).join('&');\n            } else if (keyless) { // allow keyless #password\n                password = params.find(param => !param.includes(\"=\"));\n                // App.sessionURL has it, but scrub from address bar\n                if (password && scrub) url.hash = params.filter(param => param !== password).join('&');\n            }\n        }\n        // create random password if none provided (or forced)\n        if (!password) {\n            if (options.default) password = options.default;\n            else password = this.randomPassword();\n            // add password to session URL for QR code\n            if (hash) url.hash = `${hash}&${key}=${password}`;\n            else if (keyless) url.hash = password;\n            else url.hash = `${key}=${password}`;\n            App.sessionURL = url.href;\n            // but scrub it from address bar\n            if (scrub) url.hash = keyless ? '' : hash;\n        }\n        if (urlOptions.has(\"debug\", \"session\")) console.log(`${App.libName}.App.sessionUrl: ${App.sessionURL}`);\n        // change url bar if needed\n        if (window.location.href !== url.href) try {\n            window.history.replaceState({}, \"\", url.href);\n        } catch (ex) {\n            App.showMessage(`Setting address bar to ${url.href}`, { only: \"once\" });\n            App.showMessage(`Failed to change address bar: ${ex.message}`, { level: \"warning\", only: \"once\" });\n        }\n        // decode % entities if possible\n        if (password) try { password = decodeURIComponent(password); } catch (ex) { /* ignore */ }\n        if (urlOptions.has(\"debug\", \"session\")) console.log(`${App.libName}.App.autoPassword: \"${password}\"`);\n        // return Promise for future-proofing\n        const retVal = Promise.resolve(password);\n        // warn about using it directly\n        retVal[Symbol.toPrimitive] = () => {\n            console.warn(`Deprecated: ${App.libName}.App.autoPassword() return value used directly. It returns a promise now!`);\n            return password;\n        };\n        return retVal;\n    },\n\n    randomSession(length=10) { return secureRandomString(length); },\n    randomPassword(length=16) { return secureRandomString(length); },\n};\n", "import { App } from \"./_HTML_MODULE_\"; // eslint-disable-line import/no-unresolved\n\nconst VOTE_SUFFIX = '#__vote'; // internal, for 'vote' handling; never seen by user\n\n/** A domain manages subscriptions */\nexport class Domain {\n\n    constructor() {\n        /** maps topic to handlers, handling is either \"immediate\" or \"queued\" or \"oncePerFrame\" or \"oncePerFrameWhileSynced\"\n         * @type {{[topic: String]: {[handling: String]: Set<{fn: Function, for: String}>}}}\n         */\n        this.subscriptions = {};\n        /** maps subscriber to subscribed topics\n         * @type {Map<String, Set<String>>}\n        */\n        this.subscribers = new Map();\n        /** true if we have any generic subscriptions, with \"*\" as scope or event */\n        this.genericSubscriptions = false;\n        /** queue of view events generated by model in this frame */\n        this.queuedEvents = [];\n        /** data of oncePerFrame events generated by model in this frame */\n        this.perFrameEvents = new Map();\n        /** data of oncePerFrameWhileSynced events generated by model in this frame */\n        this.perSyncedFrameEvents = new Map();\n        /** counter for subscriberIds */\n        this.subscriberIds = 0;\n        /** meta data for event currently being handled */\n        this.currentEvent = undefined;\n        /** @type {boolean} true if the currentEvent was published by a model */\n        this.currentEventFromModel = false;\n    }\n\n    register(_subscriber) {\n        return \"V\" + ++this.subscriberIds;\n    }\n\n    deregister(_subscriber) {\n        // assumes subscriptions have been removed before deregistering\n    }\n\n    /** Add a subscription\n     *\n     * @param {String} scope - a string that publishers and subscribers agree on\n     * @param {String} event - a name for the event\n     * @param {String} subscriberId - the owner of this subscription\n     * @param {Function} callback - a function called when event is published in scope\n     * @param {\"immediate\"|\"queued\"|\"oncePerFrame\"|\"oncePerFrameWhileSynced\"|\"vote\"} handling - when to invoke the handler\n     */\n    addSubscription(scope, event, subscriberId, callback, handling) {\n        if (scope.includes(':')) throw Error(`Invalid subscription scope \"${scope}\" (must not contain ':')`);\n\n        if (handling === 'vote') {\n            this.addSubscription(scope, event + VOTE_SUFFIX, subscriberId, callback, 'immediate');\n            return;\n        }\n\n        if (scope === \"*\" || event === \"*\") this.genericSubscriptions = true;\n\n        const topic = scope + \":\" + event;\n        const handler = callback;\n        handler.for = subscriberId;\n        let handlers = this.subscriptions[topic];\n        if (!handlers) handlers = this.subscriptions[topic] = {\n            immediate: new Set(),\n            queued: new Set(),\n            oncePerFrame: new Set(),\n            oncePerFrameWhileSynced: new Set(),\n        };\n        if (!handlers[handling]) throw Error(`Unknown subscribe() option: handling=\"${handling}\"`);\n        handlers[handling].add(handler);\n        let topics = this.subscribers.get(subscriberId);\n        if (!topics) this.subscribers.set(subscriberId, topics = new Set());\n        topics.add(topic);\n    }\n\n    /** Remove a subscription\n     *\n     * @param {String} scope - a string that publishers and subscribers agree on\n     * @param {String} event - a name for the event\n     * @param {String} subscriberId - the owner of this subscription\n     * @param {Function} callback - the callback function to remove, or null to remove all callbacks for this topic\n     */\n    removeSubscription(scope, event, subscriberId, callback=null) {\n        const topic = scope + \":\" + event;\n        const handlers = this.subscriptions[topic];\n        if (handlers) {\n            const remaining = removeHandlers(handlers, subscriberId, callback);\n            if (remaining === \"none\") delete this.subscriptions[topic];\n            if (remaining !== \"subscriber\") {\n                const topics = this.subscribers.get(subscriberId);\n                if (topics) {\n                    topics.delete(topic);\n                    if (topics.size === 0) this.subscribers.delete(subscriberId);\n                }\n            }\n        }\n        if (!event.endsWith(VOTE_SUFFIX)) this.removeSubscription(scope, event + VOTE_SUFFIX, subscriberId);\n    }\n\n    /** Remove all subscriptions\n     *\n     * @param {String} subscriberId\n     */\n    removeAllSubscriptionsFor(subscriberId) {\n        const topics = this.subscribers.get(subscriberId);\n        if (topics) {\n            for (const topic of topics) {\n                const handlers = this.subscriptions[topic];\n                if (handlers) {\n                    const remaining = removeHandlers(handlers, subscriberId);\n                    if (remaining === \"none\") delete this.subscriptions[topic];\n                } else {\n                    console.error(`${App.libName}: topic ${topic} not found in subscriptions table for ${subscriberId} during removeAllSubscriptionsFor()`);\n                }\n            }\n            this.subscribers.delete(subscriberId);\n        }\n    }\n\n    subscriptionsFor(topic) {\n        const subscription = this.subscriptions[topic];\n        if (!subscription && !this.genericSubscriptions) return null; // quick exit if no subscribers\n        const subscriptions = [];\n        let hasUserSubcription = !!subscription;\n        // if we have generic subscriptions, add them before the specific one\n        if (this.genericSubscriptions) {\n            const [ scope, event ] = topic.split(':');\n            if (!((scope.startsWith(\"__\") && scope.endsWith(\"__\"))\n                || (event.startsWith(\"__\") && event.endsWith(\"__\")))) {\n                // order from most generic to most specific\n                for (const generic of [\"*:*\", scope + \":*\", \"*:\" + event]) {\n                    const genericSubscription = this.subscriptions[generic];\n                    if (genericSubscription) {\n                        subscriptions.push([genericSubscription, generic]);\n                        if (!hasUserSubcription && this.hasUserSubcription(genericSubscription)) {\n                            hasUserSubcription = true;\n                        }\n                    }\n                }\n            }\n            const onlyGeneric = !hasUserSubcription;\n            if (onlyGeneric) for (const genericSubscription of subscriptions) {\n                genericSubscription.push(onlyGeneric);\n            }\n        }\n        if (subscription) subscriptions.push([subscription, topic]);\n        if (subscriptions.length === 0) return null;\n        return subscriptions;\n    }\n\n    hasUserSubcription(subscription) {\n        for (const handling of ['immediate', 'queued', 'oncePerFrame', 'oncePerFrameWhileSynced']) {\n            for (const handler of subscription[handling]) {\n                if (!handler.unbound.__CROQUET__) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n\n    /** An event was published. Invoke its immediate handlers now, and/or queue it\n     * for later execution in processFrameEvents()\n     */\n    handleEvent(topic, data, immediateWrapper=null) {\n        // model=>view events are typically queued for later execution from the main loop\n        // The subscriber is encouraged to request batch handling, which only invokes the handler\n        // for the latest event per render frame (e.g. to batch multiple position updates into one)\n        // The subscriber may request immediate handling, but it must not modify model state!\n        const subscriptions = this.subscriptionsFor(topic);\n        if (!subscriptions) return; // quick exit if no subscribers\n        const fromModel = !!immediateWrapper;\n        let queued = 0;\n        let oncePerFrame = 0;\n        let oncePerFrameWhileSynced = 0;\n        for (const [handlers, currentEvent, onlyGeneric] of subscriptions) {\n            queued += handlers.queued.size;\n            oncePerFrame += handlers.oncePerFrame.size;\n            oncePerFrameWhileSynced += handlers.oncePerFrameWhileSynced.size;\n            if (handlers.immediate.size > 0) {\n                if (!immediateWrapper) immediateWrapper = fn => fn();\n                immediateWrapper(() => {\n                    for (const handler of handlers.immediate) {\n                        const prevEvent = this.currentEvent;\n                        const prevEventFromModel = this.currentEventFromModel;\n                        const prevEventOnlyGeneric = this.currentEventOnlyGeneric;\n                        this.currentEvent = topic;\n                        this.currentEventFromModel = fromModel;\n                        this.currentEventOnlyGeneric = onlyGeneric;\n                        try { handler(data); }\n                        catch (err) {\n                            console.error(err);\n                            console.warn(`${App.libName}: error \"${err.message}\" in \"immediate\" subscription ${currentEvent}`);\n                        }\n                        this.currentEvent = prevEvent;\n                        this.currentEventFromModel = prevEventFromModel;\n                        this.currentEventOnlyGeneric = prevEventOnlyGeneric;\n                    }\n               });\n            }\n        }\n        if (queued > 0) this.queuedEvents.push({topic, data, fromModel});\n        if (oncePerFrame > 0) this.perFrameEvents.set(topic, {data, fromModel});\n        if (oncePerFrameWhileSynced > 0) this.perSyncedFrameEvents.set(topic, {data, fromModel});\n    }\n\n    /** Process all queued and oncePerFrame events that were generated since the last invocation\n     * @returns {Number} number of processed events\n     */\n    processFrameEvents(controllerIsInAnimationStep, controllerIsSynced) {\n        let n = 0;\n\n        const invokeHandlers = (handling, topic, data, fromModel) => {\n            const subscriptions = this.subscriptionsFor(topic);\n            if (!subscriptions) return; // quick exit if no subscribers\n            const prevEvent = this.currentEvent;\n            const prevEventFromModel = this.currentEventFromModel;\n            this.currentEvent = topic;\n            this.currentEventFromModel = fromModel;\n            for (const [handlers, _genericTopic, onlyGeneric] of subscriptions) {\n                const prevEventOnlyGeneric = this.currentEventOnlyGeneric;\n                this.currentEventOnlyGeneric = onlyGeneric;\n                for (const handler of handlers[handling]) {\n                    try { handler(data); }\n                    catch (err) {\n                        console.error(err);\n                        console.warn(`${App.libName}: error \"${err.message}\" in \"${handling}\" subscription ${topic}`);\n                    }\n                    n++;\n                }\n                this.currentEventOnlyGeneric = prevEventOnlyGeneric;\n            }\n            this.currentEvent = prevEvent;\n            this.currentEventFromModel = prevEventFromModel;\n    };\n\n        // process queued events in order (for...of will include any added during the iteration)\n        for (const {topic, data, fromModel} of this.queuedEvents) invokeHandlers('queued', topic, data, fromModel);\n        this.queuedEvents.length = 0;\n\n        // only process per-frame events if this has been triggered by an animation step\n        if (controllerIsInAnimationStep) {\n            // process oncePerFrame events in any order\n            for (const [topic, {data, fromModel}] of this.perFrameEvents) invokeHandlers('oncePerFrame', topic, data, fromModel);\n            this.perFrameEvents.clear();\n\n            // process oncePerFrameWhileSynced events in any order\n            if (controllerIsSynced) {\n                for (const [topic, {data, fromModel}] of this.perSyncedFrameEvents) invokeHandlers('oncePerFrameWhileSynced', topic, data, fromModel);\n                this.perSyncedFrameEvents.clear();\n            }\n\n            // finally, process any newly queued events\n            for (const {topic, data, fromModel} of this.queuedEvents) invokeHandlers('queued', topic, data, fromModel);\n            this.queuedEvents.length = 0;\n        }\n\n        return n;\n    }\n\n}\n\n// remove handlers from a topic\nfunction removeHandlers(handlers, subscriberId, callback=null) {\n    let remaining = \"none\";\n    for (const handling of ['immediate', 'queued', 'oncePerFrame', 'oncePerFrameWhileSynced']) {\n        for (const handler of handlers[handling]) {\n            if (handler.for !== subscriberId) {\n                if (remaining === \"none\") remaining = \"others\"; // there are other subscribers for the same topic\n                continue;\n            }\n            if (callback === null || handler.unbound === callback) {\n                handlers[handling].delete(handler);\n            } else {\n                remaining = \"subscriber\"; // even this subscriber has other handlers for the same topic\n            }\n        }\n    }\n    return remaining;\n}\n\nexport const viewDomain = globalThis.CROQUETVD = new Domain();\n", "import urlOptions from \"./_URLOPTIONS_MODULE_\"; // eslint-disable-line import/no-unresolved\nimport { viewDomain } from \"./domain\";\n\n\nlet DEBUG = {\n    get subscribe() {\n        // replace with static value on first call\n        DEBUG = { subscribe: urlOptions.has(\"debug\", \"subscribe\", false) };\n        return DEBUG.subscribe;\n    }\n};\n\n\nclass ModelRealm {\n    constructor(vm) {\n        /** @type import('./vm').default */\n        this.vm = vm;\n    }\n    register(model) {\n        return this.vm.registerModel(model);\n    }\n    deregister(model) {\n        this.vm.deregisterModel(model.id);\n    }\n    publish(event, data, scope) {\n        this.vm.publishFromModel(scope, event, data);\n    }\n    subscribe(model, scope, event, methodName) {\n        if (DEBUG.subscribe) console.log(`Model.subscribe(\"${scope}:${event}\", ${model} ${(\"\"+methodName).replace(/\\([\\s\\S]*/, '')})`);\n        return this.vm.addSubscription(model, scope, event, methodName);\n    }\n    unsubscribe(model, scope, event, methodName='*') {\n        if (DEBUG.subscribe) console.log(`Model.unsubscribe(${scope}:${event}\", ${model} ${(\"\"+methodName).replace(/\\([\\s\\S]*/, '')})`);\n        this.vm.removeSubscription(model, scope, event, methodName);\n    }\n    unsubscribeAll(model) {\n        if (DEBUG.subscribe) console.log(`Model.unsubscribeAll(${model} ${model.id})`);\n        this.vm.removeAllSubscriptionsFor(model);\n    }\n\n    future(model, tOffset, methodName, methodArgs) {\n        if (__currentRealm && __currentRealm.equal(this)) {\n            return this.vm.future(model, tOffset, methodName, methodArgs);\n        }\n        throw Error(`Model.future() called from outside: ${model}`);\n    }\n\n    cancelFuture(model, methodOrMessage) {\n        if (__currentRealm && __currentRealm.equal(this)) {\n            return this.vm.cancelFuture(model, methodOrMessage);\n        }\n        throw Error(`Model.cancelFuture() called from outside: ${model}`);\n    }\n\n    random() {\n        return this.vm.random();\n    }\n\n    now() {\n        return this.vm.time;\n    }\n\n    equal(otherRealm) {\n        return otherRealm instanceof ModelRealm && otherRealm.vm === this.vm;\n    }\n\n    isViewRealm() { return false; }\n}\n\nclass ViewRealm {\n    constructor(vm) {\n        /** @type import('./vm').default */\n        this.vd = viewDomain;\n        this.vm = vm;                    // if vm !== controller.vm, this view is invalid\n        this.controller = vm.controller; // controller stays the same even across reconnects\n    }\n\n    valid() {\n        return this.vm === this.controller.vm;\n    }\n\n    register(view) {\n        return viewDomain.register(view);\n    }\n\n    deregister(view) {\n        viewDomain.deregister(view);\n    }\n\n    publish(event, data, scope) {\n        this.vm.publishFromView(scope, event, data);\n    }\n    subscribe(event, subscriberId, callback, scope, handling=\"queued\") {\n        if (DEBUG.subscribe) console.log(`View[${subscriberId}].subscribe(\"${scope}:${event}\" ${callback ? callback.name || (\"\"+callback).replace(/\\([\\s\\S]*/, '') : \"\"+callback} [${handling}])`);\n        viewDomain.addSubscription(scope, event, subscriberId, callback, handling);\n    }\n    unsubscribe(event, subscriberId, callback=null, scope) {\n        if (DEBUG.subscribe) console.log(`View[${subscriberId}].unsubscribe(\"${scope}:${event}\" ${callback ? callback.name || (\"\"+callback).replace(/\\([\\s\\S]*/, '') : \"*\"})`);\n        viewDomain.removeSubscription(scope, event, subscriberId, callback);\n    }\n    unsubscribeAll(subscriberId) {\n        if (DEBUG.subscribe) console.log(`View[${subscriberId}].unsubscribeAll()`);\n        viewDomain.removeAllSubscriptionsFor(subscriberId);\n    }\n\n    future(view, tOffset) {\n        const vm = this.vm;\n        return new Proxy(view, {\n            get(_target, property) {\n                if (typeof view[property] === \"function\") {\n                    const methodProxy = new Proxy(view[property], {\n                        apply(_method, _this, args) {\n                            setTimeout(() => { if (view.id) inViewRealm(vm, () => view[property](...args), true); }, tOffset);\n                        }\n                    });\n                    return methodProxy;\n                }\n                throw Error(\"Tried to call \" + property + \"() on future of \" + Object.getPrototypeOf(view).constructor.name + \" which is not a function\");\n            }\n        });\n    }\n\n    random() {\n        return Math.random();\n    }\n\n    now() {\n        return this.vm.time;\n    }\n\n    externalNow() {\n        return this.controller.reflectorTime;\n    }\n\n    extrapolatedNow() {\n        return this.controller.extrapolatedTime;\n    }\n\n    isSynced() {\n        return !!this.controller.synced;\n    }\n\n    equal(otherRealm) {\n        return otherRealm instanceof ViewRealm && otherRealm.vm === this.vm;\n    }\n\n    isViewRealm() { return true; }\n}\n\nlet __currentRealm = null;\n\n/** @returns {ModelRealm | ViewRealm} */\nexport function currentRealm(errorIfNoRealm=\"Tried to execute code that requires realm outside of realm.\") {\n    if (!__currentRealm && errorIfNoRealm) {\n        throw Error(errorIfNoRealm);\n    }\n    return __currentRealm;\n}\n\nexport function inModelRealm(vm, callback) {\n    if (__currentRealm !== null) {\n        throw Error(\"Can't switch realms from inside realm\");\n    }\n    try {\n        __currentRealm = new ModelRealm(vm);\n        return callback();\n    } finally {\n        __currentRealm = null;\n    }\n}\n\nexport function inViewRealm(vm, callback, force=false) {\n    if (__currentRealm !== null && !force) {\n        throw Error(\"Can't switch realms from inside realm\");\n    }\n    const prevRealm = __currentRealm;\n    try {\n        __currentRealm = new ViewRealm(vm);\n        return callback();\n    } finally {\n        __currentRealm = prevRealm;\n    }\n}\n", "/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nfunction isnan( x ) {\n\treturn ( x !== x );\n}\nvar main = isnan;\n\nvar lib = main;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar sqrt = Math.sqrt;\nvar main$1 = sqrt;\n\nvar lib$1 = main$1;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar FOURTH_PI = 7.85398163397448309616e-1;\nvar lib$2 = FOURTH_PI;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nfunction evalrational( x ) {\n\tvar ax;\n\tvar s1;\n\tvar s2;\n\tif ( x === 0.0 ) {\n\t\treturn 0.16666666666666713;\n\t}\n\tif ( x < 0.0 ) {\n\t\tax = -x;\n\t} else {\n\t\tax = x;\n\t}\n\tif ( ax <= 1.0 ) {\n\t\ts1 = -8.198089802484825 + (x * (19.562619833175948 + (x * (-16.262479672107002 + (x * (5.444622390564711 + (x * (-0.6019598008014124 + (x * 0.004253011369004428)))))))));\n\t\ts2 = -49.18853881490881 + (x * (139.51056146574857 + (x * (-147.1791292232726 + (x * (70.49610280856842 + (x * (-14.740913729888538 + (x * 1.0)))))))));\n\t} else {\n\t\tx = 1.0 / x;\n\t\ts1 = 0.004253011369004428 + (x * (-0.6019598008014124 + (x * (5.444622390564711 + (x * (-16.262479672107002 + (x * (19.562619833175948 + (x * -8.198089802484825)))))))));\n\t\ts2 = 1.0 + (x * (-14.740913729888538 + (x * (70.49610280856842 + (x * (-147.1791292232726 + (x * (139.51056146574857 + (x * -49.18853881490881)))))))));\n\t}\n\treturn s1 / s2;\n}\nvar rational_pq = evalrational;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nfunction evalrational$1( x ) {\n\tvar ax;\n\tvar s1;\n\tvar s2;\n\tif ( x === 0.0 ) {\n\t\treturn 0.08333333333333809;\n\t}\n\tif ( x < 0.0 ) {\n\t\tax = -x;\n\t} else {\n\t\tax = x;\n\t}\n\tif ( ax <= 1.0 ) {\n\t\ts1 = 28.536655482610616 + (x * (-25.56901049652825 + (x * (6.968710824104713 + (x * (-0.5634242780008963 + (x * 0.002967721961301243)))))));\n\t\ts2 = 342.43986579130785 + (x * (-383.8770957603691 + (x * (147.0656354026815 + (x * (-21.947795316429207 + (x * 1.0)))))));\n\t} else {\n\t\tx = 1.0 / x;\n\t\ts1 = 0.002967721961301243 + (x * (-0.5634242780008963 + (x * (6.968710824104713 + (x * (-25.56901049652825 + (x * 28.536655482610616)))))));\n\t\ts2 = 1.0 + (x * (-21.947795316429207 + (x * (147.0656354026815 + (x * (-383.8770957603691 + (x * 342.43986579130785)))))));\n\t}\n\treturn s1 / s2;\n}\nvar rational_rs = evalrational$1;\n\nvar MOREBITS = 6.123233995736765886130e-17;\nfunction asin( x ) {\n\tvar sgn;\n\tvar zz;\n\tvar a;\n\tvar p;\n\tvar z;\n\tif ( lib( x ) ) {\n\t\treturn NaN;\n\t}\n\tif ( x > 0.0 ) {\n\t\ta = x;\n\t} else {\n\t\tsgn = true;\n\t\ta = -x;\n\t}\n\tif ( a > 1.0 ) {\n\t\treturn NaN;\n\t}\n\tif ( a > 0.625 ) {\n\t\tzz = 1.0 - a;\n\t\tp = zz * rational_rs( zz );\n\t\tzz = lib$1( zz + zz );\n\t\tz = lib$2 - zz;\n\t\tzz = ( zz*p ) - MOREBITS;\n\t\tz -= zz;\n\t\tz += lib$2;\n\t} else {\n\t\tif ( a < 1.0e-8 ) {\n\t\t\treturn x;\n\t\t}\n\t\tzz = a * a;\n\t\tz = zz * rational_pq( zz );\n\t\tz = ( a*z ) + a;\n\t}\n\treturn ( sgn ) ? -z : z;\n}\nvar asin_1 = asin;\n\nvar lib$3 = asin_1;\n\nvar MOREBITS$1 = 6.123233995736765886130e-17;\nfunction acos( x ) {\n\tvar z;\n\tif ( lib( x ) ) {\n\t\treturn NaN;\n\t}\n\tif ( x < -1.0 || x > 1.0 ) {\n\t\treturn NaN;\n\t}\n\tif ( x > 0.5 ) {\n\t\treturn 2.0 * lib$3( lib$1( 0.5 - (0.5*x) ) );\n\t}\n\tz = lib$2 - lib$3( x );\n\tz += MOREBITS$1;\n\tz += lib$2;\n\treturn z;\n}\nvar acos_1 = acos;\n\nvar lib$4 = acos_1;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nfunction hasSymbolSupport() {\n\treturn (\n\t\ttypeof Symbol === 'function' &&\n\t\ttypeof Symbol( 'foo' ) === 'symbol'\n\t);\n}\nvar main$2 = hasSymbolSupport;\n\nvar lib$5 = main$2;\n\nvar FLG = lib$5();\nfunction hasToStringTagSupport() {\n\treturn ( FLG && typeof Symbol.toStringTag === 'symbol' );\n}\nvar main$3 = hasToStringTagSupport;\n\nvar lib$6 = main$3;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar toStr = Object.prototype.toString;\nvar tostring = toStr;\n\nfunction nativeClass( v ) {\n\treturn tostring.call( v );\n}\nvar native_class = nativeClass;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar has = Object.prototype.hasOwnProperty;\nfunction hasOwnProp( value, property ) {\n\tif (\n\t\tvalue === void 0 ||\n\t\tvalue === null\n\t) {\n\t\treturn false;\n\t}\n\treturn has.call( value, property );\n}\nvar main$4 = hasOwnProp;\n\nvar lib$7 = main$4;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar toStrTag = ( typeof Symbol === 'function' ) ? Symbol.toStringTag : '';\nvar tostringtag = toStrTag;\n\nfunction nativeClass$1( v ) {\n\tvar isOwn;\n\tvar tag;\n\tvar out;\n\tif ( v === null || v === void 0 ) {\n\t\treturn tostring.call( v );\n\t}\n\ttag = v[ tostringtag ];\n\tisOwn = lib$7( v, tostringtag );\n\ttry {\n\t\tv[ tostringtag ] = void 0;\n\t} catch ( err ) {\n\t\treturn tostring.call( v );\n\t}\n\tout = tostring.call( v );\n\tif ( isOwn ) {\n\t\tv[ tostringtag ] = tag;\n\t} else {\n\t\tdelete v[ tostringtag ];\n\t}\n\treturn out;\n}\nvar polyfill = nativeClass$1;\n\nvar nativeClass$2;\nif ( lib$6() ) {\n\tnativeClass$2 = polyfill;\n} else {\n\tnativeClass$2 = native_class;\n}\nvar lib$8 = nativeClass$2;\n\nvar hasUint32Array = ( typeof Uint32Array === 'function' );\nfunction isUint32Array( value ) {\n\treturn (\n\t\t( hasUint32Array && value instanceof Uint32Array ) ||\n\t\tlib$8( value ) === '[object Uint32Array]'\n\t);\n}\nvar main$5 = isUint32Array;\n\nvar lib$9 = main$5;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar UINT32_MAX = 4294967295;\nvar lib$a = UINT32_MAX;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar main$6 = ( typeof Uint32Array === 'function' ) ? Uint32Array : null;\nvar uint32array = main$6;\n\nfunction hasUint32ArraySupport() {\n\tvar bool;\n\tvar arr;\n\tif ( typeof uint32array !== 'function' ) {\n\t\treturn false;\n\t}\n\ttry {\n\t\tarr = [ 1, 3.14, -3.14, lib$a+1, lib$a+2 ];\n\t\tarr = new uint32array( arr );\n\t\tbool = (\n\t\t\tlib$9( arr ) &&\n\t\t\tarr[ 0 ] === 1 &&\n\t\t\tarr[ 1 ] === 3 &&\n\t\t\tarr[ 2 ] === lib$a-2 &&\n\t\t\tarr[ 3 ] === 0 &&\n\t\t\tarr[ 4 ] === 1\n\t\t);\n\t} catch ( err ) {\n\t\tbool = false;\n\t}\n\treturn bool;\n}\nvar main$7 = hasUint32ArraySupport;\n\nvar lib$b = main$7;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar ctor = ( typeof Uint32Array === 'function' ) ? Uint32Array : null;\nvar uint32array$1 = ctor;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nfunction polyfill$1() {\n\tthrow new Error( 'not implemented' );\n}\nvar polyfill_1 = polyfill$1;\n\nvar ctor$1;\nif ( lib$b() ) {\n\tctor$1 = uint32array$1;\n} else {\n\tctor$1 = polyfill_1;\n}\nvar lib$c = ctor$1;\n\nvar hasFloat64Array = ( typeof Float64Array === 'function' );\nfunction isFloat64Array( value ) {\n\treturn (\n\t\t( hasFloat64Array && value instanceof Float64Array ) ||\n\t\tlib$8( value ) === '[object Float64Array]'\n\t);\n}\nvar main$8 = isFloat64Array;\n\nvar lib$d = main$8;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar main$9 = ( typeof Float64Array === 'function' ) ? Float64Array : null;\nvar float64array = main$9;\n\nfunction hasFloat64ArraySupport() {\n\tvar bool;\n\tvar arr;\n\tif ( typeof float64array !== 'function' ) {\n\t\treturn false;\n\t}\n\ttry {\n\t\tarr = new float64array( [ 1.0, 3.14, -3.14, NaN ] );\n\t\tbool = (\n\t\t\tlib$d( arr ) &&\n\t\t\tarr[ 0 ] === 1.0 &&\n\t\t\tarr[ 1 ] === 3.14 &&\n\t\t\tarr[ 2 ] === -3.14 &&\n\t\t\tarr[ 3 ] !== arr[ 3 ]\n\t\t);\n\t} catch ( err ) {\n\t\tbool = false;\n\t}\n\treturn bool;\n}\nvar main$a = hasFloat64ArraySupport;\n\nvar lib$e = main$a;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar ctor$2 = ( typeof Float64Array === 'function' ) ? Float64Array : null;\nvar float64array$1 = ctor$2;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nfunction polyfill$2() {\n\tthrow new Error( 'not implemented' );\n}\nvar polyfill_1$1 = polyfill$2;\n\nvar ctor$3;\nif ( lib$e() ) {\n\tctor$3 = float64array$1;\n} else {\n\tctor$3 = polyfill_1$1;\n}\nvar lib$f = ctor$3;\n\nvar hasUint8Array = ( typeof Uint8Array === 'function' );\nfunction isUint8Array( value ) {\n\treturn (\n\t\t( hasUint8Array && value instanceof Uint8Array ) ||\n\t\tlib$8( value ) === '[object Uint8Array]'\n\t);\n}\nvar main$b = isUint8Array;\n\nvar lib$g = main$b;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar UINT8_MAX = 255|0;\nvar lib$h = UINT8_MAX;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar main$c = ( typeof Uint8Array === 'function' ) ? Uint8Array : null;\nvar uint8array = main$c;\n\nfunction hasUint8ArraySupport() {\n\tvar bool;\n\tvar arr;\n\tif ( typeof uint8array !== 'function' ) {\n\t\treturn false;\n\t}\n\ttry {\n\t\tarr = [ 1, 3.14, -3.14, lib$h+1, lib$h+2 ];\n\t\tarr = new uint8array( arr );\n\t\tbool = (\n\t\t\tlib$g( arr ) &&\n\t\t\tarr[ 0 ] === 1 &&\n\t\t\tarr[ 1 ] === 3 &&\n\t\t\tarr[ 2 ] === lib$h-2 &&\n\t\t\tarr[ 3 ] === 0 &&\n\t\t\tarr[ 4 ] === 1\n\t\t);\n\t} catch ( err ) {\n\t\tbool = false;\n\t}\n\treturn bool;\n}\nvar main$d = hasUint8ArraySupport;\n\nvar lib$i = main$d;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar ctor$4 = ( typeof Uint8Array === 'function' ) ? Uint8Array : null;\nvar uint8array$1 = ctor$4;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nfunction polyfill$3() {\n\tthrow new Error( 'not implemented' );\n}\nvar polyfill_1$2 = polyfill$3;\n\nvar ctor$5;\nif ( lib$i() ) {\n\tctor$5 = uint8array$1;\n} else {\n\tctor$5 = polyfill_1$2;\n}\nvar lib$j = ctor$5;\n\nvar hasUint16Array = ( typeof Uint16Array === 'function' );\nfunction isUint16Array( value ) {\n\treturn (\n\t\t( hasUint16Array && value instanceof Uint16Array ) ||\n\t\tlib$8( value ) === '[object Uint16Array]'\n\t);\n}\nvar main$e = isUint16Array;\n\nvar lib$k = main$e;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar UINT16_MAX = 65535|0;\nvar lib$l = UINT16_MAX;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar main$f = ( typeof Uint16Array === 'function' ) ? Uint16Array : null;\nvar uint16array = main$f;\n\nfunction hasUint16ArraySupport() {\n\tvar bool;\n\tvar arr;\n\tif ( typeof uint16array !== 'function' ) {\n\t\treturn false;\n\t}\n\ttry {\n\t\tarr = [ 1, 3.14, -3.14, lib$l+1, lib$l+2 ];\n\t\tarr = new uint16array( arr );\n\t\tbool = (\n\t\t\tlib$k( arr ) &&\n\t\t\tarr[ 0 ] === 1 &&\n\t\t\tarr[ 1 ] === 3 &&\n\t\t\tarr[ 2 ] === lib$l-2 &&\n\t\t\tarr[ 3 ] === 0 &&\n\t\t\tarr[ 4 ] === 1\n\t\t);\n\t} catch ( err ) {\n\t\tbool = false;\n\t}\n\treturn bool;\n}\nvar main$g = hasUint16ArraySupport;\n\nvar lib$m = main$g;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar ctor$6 = ( typeof Uint16Array === 'function' ) ? Uint16Array : null;\nvar uint16array$1 = ctor$6;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nfunction polyfill$4() {\n\tthrow new Error( 'not implemented' );\n}\nvar polyfill_1$3 = polyfill$4;\n\nvar ctor$7;\nif ( lib$m() ) {\n\tctor$7 = uint16array$1;\n} else {\n\tctor$7 = polyfill_1$3;\n}\nvar lib$n = ctor$7;\n\nvar ctors = {\n\t'uint16': lib$n,\n\t'uint8': lib$j\n};\nvar ctors_1 = ctors;\n\nvar bool;\nfunction isLittleEndian() {\n\tvar uint16view;\n\tvar uint8view;\n\tuint16view = new ctors_1[ 'uint16' ]( 1 );\n\tuint16view[ 0 ] = 0x1234;\n\tuint8view = new ctors_1[ 'uint8' ]( uint16view.buffer );\n\treturn ( uint8view[ 0 ] === 0x34 );\n}\nbool = isLittleEndian();\nvar main$h = bool;\n\nvar lib$o = main$h;\n\nvar HIGH;\nif ( lib$o === true ) {\n\tHIGH = 1;\n} else {\n\tHIGH = 0;\n}\nvar high = HIGH;\n\nvar FLOAT64_VIEW = new lib$f( 1 );\nvar UINT32_VIEW = new lib$c( FLOAT64_VIEW.buffer );\nfunction getHighWord( x ) {\n\tFLOAT64_VIEW[ 0 ] = x;\n\treturn UINT32_VIEW[ high ];\n}\nvar main$i = getHighWord;\n\nvar lib$p = main$i;\n\nvar HIGH$1;\nif ( lib$o === true ) {\n\tHIGH$1 = 1;\n} else {\n\tHIGH$1 = 0;\n}\nvar high$1 = HIGH$1;\n\nvar FLOAT64_VIEW$1 = new lib$f( 1 );\nvar UINT32_VIEW$1 = new lib$c( FLOAT64_VIEW$1.buffer );\nfunction setHighWord( x, high ) {\n\tFLOAT64_VIEW$1[ 0 ] = x;\n\tUINT32_VIEW$1[ high$1 ] = ( high >>> 0 );\n\treturn FLOAT64_VIEW$1[ 0 ];\n}\nvar main$j = setHighWord;\n\nvar lib$q = main$j;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar FLOAT64_PINF = Number.POSITIVE_INFINITY;\nvar lib$r = FLOAT64_PINF;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar number = Number;\n\nvar lib$s = number;\n\nvar FLOAT64_NINF = lib$s.NEGATIVE_INFINITY;\nvar lib$t = FLOAT64_NINF;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar FLOAT64_EXPONENT_BIAS = 1023|0;\nvar lib$u = FLOAT64_EXPONENT_BIAS;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nfunction evalpoly( x ) {\n\tif ( x === 0.0 ) {\n\t\treturn 0.6666666666666735;\n\t}\n\treturn 0.6666666666666735 + (x * (0.3999999999940942 + (x * (0.2857142874366239 + (x * (0.22222198432149784 + (x * (0.1818357216161805 + (x * (0.15313837699209373 + (x * 0.14798198605116586)))))))))));\n}\nvar polyval_lp = evalpoly;\n\nvar LN2_HI = 6.93147180369123816490e-01;\nvar LN2_LO = 1.90821492927058770002e-10;\nvar SQRT2M1 = 4.142135623730950488017e-01;\nvar SQRT2HALFM1 = -2.928932188134524755992e-01;\nvar SMALL = 1.862645149230957e-09;\nvar TINY = 5.551115123125783e-17;\nvar TWO53 = 9007199254740992;\nvar TWO_THIRDS = 6.666666666666666666e-01;\nfunction log1p( x ) {\n\tvar hfsq;\n\tvar hu;\n\tvar y;\n\tvar f;\n\tvar c;\n\tvar s;\n\tvar z;\n\tvar R;\n\tvar u;\n\tvar k;\n\tif ( x < -1.0 || lib( x ) ) {\n\t\treturn NaN;\n\t}\n\tif ( x === -1.0 ) {\n\t\treturn lib$t;\n\t}\n\tif ( x === lib$r ) {\n\t\treturn x;\n\t}\n\tif ( x === 0.0 ) {\n\t\treturn x;\n\t}\n\tif ( x < 0.0 ) {\n\t\ty = -x;\n\t} else {\n\t\ty = x;\n\t}\n\tk = 1;\n\tif ( y < SQRT2M1 ) {\n\t\tif ( y < SMALL ) {\n\t\t\tif ( y < TINY ) {\n\t\t\t\treturn x;\n\t\t\t}\n\t\t\treturn x - ( x*x*0.5 );\n\t\t}\n\t\tif ( x > SQRT2HALFM1 ) {\n\t\t\tk = 0;\n\t\t\tf = x;\n\t\t\thu = 1;\n\t\t}\n\t}\n\tif ( k !== 0 ) {\n\t\tif ( y < TWO53 ) {\n\t\t\tu = 1.0 + x;\n\t\t\thu = lib$p( u );\n\t\t\tk = (hu>>20) - lib$u;\n\t\t\tif ( k > 0 ) {\n\t\t\t\tc = 1.0 - (u-x);\n\t\t\t} else {\n\t\t\t\tc = x - (u-1.0);\n\t\t\t}\n\t\t\tc /= u;\n\t\t} else {\n\t\t\tu = x;\n\t\t\thu = lib$p( u );\n\t\t\tk = (hu>>20) - lib$u;\n\t\t\tc = 0;\n\t\t}\n\t\thu &= 0x000fffff;\n\t\tif ( hu < 434334 ) {\n\t\t\tu = lib$q( u, hu|0x3ff00000 );\n\t\t} else {\n\t\t\tk += 1;\n\t\t\tu = lib$q( u, hu|0x3fe00000 );\n\t\t\thu = (1048576-hu)>>2;\n\t\t}\n\t\tf = u - 1.0;\n\t}\n\thfsq = 0.5 * f * f;\n\tif ( hu === 0 ) {\n\t\tif ( f === 0.0 ) {\n\t\t\tc += k * LN2_LO;\n\t\t\treturn ( k * LN2_HI ) + c;\n\t\t}\n\t\tR = hfsq * (1.0 - ( TWO_THIRDS*f ) );\n\t\treturn ( k*LN2_HI ) - ( (R - ( (k*LN2_LO) + c)) - f );\n\t}\n\ts = f / (2.0 + f);\n\tz = s * s;\n\tR = z * polyval_lp( z );\n\tif ( k === 0 ) {\n\t\treturn f - ( hfsq - ( s*(hfsq+R) ) );\n\t}\n\treturn ( k*LN2_HI ) - ( (hfsq - ( (s*(hfsq+R)) + ((k*LN2_LO) + c))) - f );\n}\nvar log1p_1 = log1p;\n\nvar lib$v = log1p_1;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar LN2 = 6.93147180559945309417232121458176568075500134360255254120680009493393621969694715605863326996418687542001481021e-01;\nvar lib$w = LN2;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nfunction evalpoly$1( x ) {\n\tif ( x === 0.0 ) {\n\t\treturn 0.3999999999940942;\n\t}\n\treturn 0.3999999999940942 + (x * (0.22222198432149784 + (x * 0.15313837699209373)));\n}\nvar polyval_p = evalpoly$1;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nfunction evalpoly$2( x ) {\n\tif ( x === 0.0 ) {\n\t\treturn 0.6666666666666735;\n\t}\n\treturn 0.6666666666666735 + (x * (0.2857142874366239 + (x * (0.1818357216161805 + (x * 0.14798198605116586)))));\n}\nvar polyval_q = evalpoly$2;\n\nvar LN2_HI$1 = 6.93147180369123816490e-01;\nvar LN2_LO$1 = 1.90821492927058770002e-10;\nvar TWO54 = 1.80143985094819840000e+16;\nvar ONE_THIRD = 0.33333333333333333;\nvar HIGH_SIGNIFICAND_MASK = 0x000fffff|0;\nvar HIGH_MAX_NORMAL_EXP = 0x7ff00000|0;\nvar HIGH_MIN_NORMAL_EXP = 0x00100000|0;\nvar HIGH_BIASED_EXP_0 = 0x3ff00000|0;\nfunction ln( x ) {\n\tvar hfsq;\n\tvar hx;\n\tvar t2;\n\tvar t1;\n\tvar k;\n\tvar R;\n\tvar f;\n\tvar i;\n\tvar j;\n\tvar s;\n\tvar w;\n\tvar z;\n\tif ( x === 0.0 ) {\n\t\treturn lib$t;\n\t}\n\tif ( lib( x ) || x < 0.0 ) {\n\t\treturn NaN;\n\t}\n\thx = lib$p( x );\n\tk = 0|0;\n\tif ( hx < HIGH_MIN_NORMAL_EXP ) {\n\t\tk -= 54|0;\n\t\tx *= TWO54;\n\t\thx = lib$p( x );\n\t}\n\tif ( hx >= HIGH_MAX_NORMAL_EXP ) {\n\t\treturn x + x;\n\t}\n\tk += ( ( hx>>20 ) - lib$u )|0;\n\thx &= HIGH_SIGNIFICAND_MASK;\n\ti = ( (hx+0x95f64) & 0x100000 )|0;\n\tx = lib$q( x, hx|(i^HIGH_BIASED_EXP_0) );\n\tk += ( i>>20 )|0;\n\tf = x - 1.0;\n\tif ( (HIGH_SIGNIFICAND_MASK&(2+hx)) < 3 ) {\n\t\tif ( f === 0.0 ) {\n\t\t\tif ( k === 0 ) {\n\t\t\t\treturn 0.0;\n\t\t\t}\n\t\t\treturn (k * LN2_HI$1) + (k * LN2_LO$1);\n\t\t}\n\t\tR = f * f * ( 0.5 - (ONE_THIRD*f) );\n\t\tif ( k === 0 ) {\n\t\t\treturn f - R;\n\t\t}\n\t\treturn (k * LN2_HI$1) - ( (R-(k*LN2_LO$1)) - f );\n\t}\n\ts = f / (2.0 + f);\n\tz = s * s;\n\ti = ( hx - 0x6147a )|0;\n\tw = z * z;\n\tj = ( 0x6b851 - hx )|0;\n\tt1 = w * polyval_p( w );\n\tt2 = z * polyval_q( w );\n\ti |= j;\n\tR = t2 + t1;\n\tif ( i > 0 ) {\n\t\thfsq = 0.5 * f * f;\n\t\tif ( k === 0 ) {\n\t\t\treturn f - ( hfsq - (s * (hfsq+R)) );\n\t\t}\n\t\treturn (k * LN2_HI$1) - ( hfsq - ((s*(hfsq+R))+(k*LN2_LO$1)) - f );\n\t}\n\tif ( k === 0 ) {\n\t\treturn f - (s*(f-R));\n\t}\n\treturn (k * LN2_HI$1) - ( ( (s*(f-R)) - (k*LN2_LO$1) ) - f );\n}\nvar ln_1 = ln;\n\nvar lib$x = ln_1;\n\nvar HUGE = 1 << 28;\nfunction acosh( x ) {\n\tvar t;\n\tif ( lib( x ) ) {\n\t\treturn NaN;\n\t}\n\tif ( x < 1.0 ) {\n\t\treturn NaN;\n\t}\n\tif ( x === 1.0 ) {\n\t\treturn 0.0;\n\t}\n\tif ( x >= HUGE ) {\n\t\treturn lib$x( x ) + lib$w;\n\t}\n\tif ( x > 2.0 ) {\n\t\treturn lib$x( (2.0*x) - ( 1.0 / ( x + lib$1( (x*x) - 1.0 ) ) ) );\n\t}\n\tt = x - 1.0;\n\treturn lib$v( t + lib$1( (2.0*t) + (t*t) ) );\n}\nvar acosh_1 = acosh;\n\nvar lib$y = acosh_1;\n\nfunction isInfinite( x ) {\n\treturn (x === lib$r || x === lib$t);\n}\nvar is_infinite = isInfinite;\n\nvar lib$z = is_infinite;\n\nvar NEAR_ZERO = 1.0 / (1 << 28);\nvar HUGE$1 = 1 << 28;\nfunction asinh( x ) {\n\tvar sgn;\n\tvar xx;\n\tvar t;\n\tif ( lib( x ) || lib$z( x ) ) {\n\t\treturn x;\n\t}\n\tif ( x < 0.0 ) {\n\t\tx = -x;\n\t\tsgn = true;\n\t}\n\tif ( x < NEAR_ZERO ) {\n\t\tt = x;\n\t}\n\telse if ( x > HUGE$1 ) {\n\t\tt = lib$x( x ) + lib$w;\n\t}\n\telse if ( x > 2.0 ) {\n\t\tt = lib$x( (2.0*x) + ( 1.0 / (lib$1( (x*x) + 1.0 ) + x) ) );\n\t}\n\telse {\n\t\txx = x * x;\n\t\tt = lib$v( x + ( xx/(1.0 + lib$1(1.0 + xx)) ) );\n\t}\n\treturn ( sgn ) ? -t : t;\n}\nvar asinh_1 = asinh;\n\nvar lib$A = asinh_1;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar HALF_PI = 1.5707963267948966;\nvar lib$B = HALF_PI;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nfunction evalpoly$3( x ) {\n\tif ( x === 0.0 ) {\n\t\treturn -64.85021904942025;\n\t}\n\treturn -64.85021904942025 + (x * (-122.88666844901361 + (x * (-75.00855792314705 + (x * (-16.157537187333652 + (x * -0.8750608600031904)))))));\n}\nvar polyval_p$1 = evalpoly$3;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nfunction evalpoly$4( x ) {\n\tif ( x === 0.0 ) {\n\t\treturn 194.5506571482614;\n\t}\n\treturn 194.5506571482614 + (x * (485.3903996359137 + (x * (432.88106049129027 + (x * (165.02700983169885 + (x * (24.858464901423062 + (x * 1.0)))))))));\n}\nvar polyval_q$1 = evalpoly$4;\n\nvar MOREBITS$2 = 6.123233995736765886130e-17;\nvar T3P8 = 2.41421356237309504880;\nfunction atan( x ) {\n\tvar flg;\n\tvar sgn;\n\tvar y;\n\tvar z;\n\tif ( lib( x ) || x === 0.0 ) {\n\t\treturn x;\n\t}\n\tif ( x === lib$r ) {\n\t\treturn lib$B;\n\t}\n\tif ( x === lib$t ) {\n\t\treturn -lib$B;\n\t}\n\tif ( x < 0.0 ) {\n\t\tsgn = true;\n\t\tx = -x;\n\t}\n\tflg = 0;\n\tif ( x > T3P8 ) {\n\t\ty = lib$B;\n\t\tflg = 1;\n\t\tx = -( 1.0/x );\n\t}\n\telse if ( x <= 0.66 ) {\n\t\ty = 0.0;\n\t}\n\telse {\n\t\ty = lib$2;\n\t\tflg = 2;\n\t\tx = (x-1.0) / (x+1.0);\n\t}\n\tz = x * x;\n\tz = z*polyval_p$1( z ) / polyval_q$1( z );\n\tz = ( x*z ) + x;\n\tif ( flg === 2 ) {\n\t\tz += 0.5 * MOREBITS$2;\n\t}\n\telse if ( flg === 1 ) {\n\t\tz += MOREBITS$2;\n\t}\n\ty += z;\n\treturn ( sgn ) ? -y : y;\n}\nvar atan_1 = atan;\n\nvar lib$C = atan_1;\n\nvar NEAR_ZERO$1 = 1.0 / (1 << 28);\nfunction atanh( x ) {\n\tvar sgn;\n\tvar t;\n\tif ( lib( x ) ) {\n\t\treturn NaN;\n\t}\n\tif ( x < -1.0 || x > 1.0 ) {\n\t\treturn NaN;\n\t}\n\tif ( x === 1.0 ) {\n\t\treturn lib$r;\n\t}\n\tif ( x === -1.0 ) {\n\t\treturn lib$t;\n\t}\n\tif ( x < 0.0 ) {\n\t\tsgn = true;\n\t\tx = -x;\n\t}\n\tif ( x < NEAR_ZERO$1 ) {\n\t\treturn ( sgn ) ? -x : x;\n\t}\n\tif ( x < 0.5 ) {\n\t\tt = x + x;\n\t\tt = 0.5 * lib$v( t + ( t*x/(1-x) ) );\n\t} else {\n\t\tt = 0.5 * lib$v( (x+x) / (1-x) );\n\t}\n\treturn ( sgn ) ? -t : t;\n}\nvar atanh_1 = atanh;\n\nvar lib$D = atanh_1;\n\nvar indices;\nvar HIGH$2;\nvar LOW;\nif ( lib$o === true ) {\n\tHIGH$2 = 1;\n\tLOW = 0;\n} else {\n\tHIGH$2 = 0;\n\tLOW = 1;\n}\nindices = {\n\t'HIGH': HIGH$2,\n\t'LOW': LOW\n};\nvar indices_1 = indices;\n\nvar FLOAT64_VIEW$2 = new lib$f( 1 );\nvar UINT32_VIEW$2 = new lib$c( FLOAT64_VIEW$2.buffer );\nvar HIGH$3 = indices_1.HIGH;\nvar LOW$1 = indices_1.LOW;\nfunction toWords( out, x ) {\n\tFLOAT64_VIEW$2[ 0 ] = x;\n\tout[ 0 ] = UINT32_VIEW$2[ HIGH$3 ];\n\tout[ 1 ] = UINT32_VIEW$2[ LOW$1 ];\n\treturn out;\n}\nvar to_words = toWords;\n\nfunction toWords$1( out, x ) {\n\tif ( arguments.length === 1 ) {\n\t\treturn to_words( [ 0, 0 ], out );\n\t}\n\treturn to_words( out, x );\n}\nvar main$k = toWords$1;\n\nvar lib$E = main$k;\n\nvar indices$1;\nvar HIGH$4;\nvar LOW$2;\nif ( lib$o === true ) {\n\tHIGH$4 = 1;\n\tLOW$2 = 0;\n} else {\n\tHIGH$4 = 0;\n\tLOW$2 = 1;\n}\nindices$1 = {\n\t'HIGH': HIGH$4,\n\t'LOW': LOW$2\n};\nvar indices_1$1 = indices$1;\n\nvar FLOAT64_VIEW$3 = new lib$f( 1 );\nvar UINT32_VIEW$3 = new lib$c( FLOAT64_VIEW$3.buffer );\nvar HIGH$5 = indices_1$1.HIGH;\nvar LOW$3 = indices_1$1.LOW;\nfunction fromWords( high, low ) {\n\tUINT32_VIEW$3[ HIGH$5 ] = high;\n\tUINT32_VIEW$3[ LOW$3 ] = low;\n\treturn FLOAT64_VIEW$3[ 0 ];\n}\nvar main$l = fromWords;\n\nvar lib$F = main$l;\n\nvar SIGN_MASK = 0x80000000>>>0;\nvar MAGNITUDE_MASK = 0x7fffffff|0;\nvar WORDS = [ 0, 0 ];\nfunction copysign( x, y ) {\n\tvar hx;\n\tvar hy;\n\tlib$E( WORDS, x );\n\thx = WORDS[ 0 ];\n\thx &= MAGNITUDE_MASK;\n\thy = lib$p( y );\n\thy &= SIGN_MASK;\n\thx |= hy;\n\treturn lib$F( hx, WORDS[ 1 ] );\n}\nvar copysign_1 = copysign;\n\nvar lib$G = copysign_1;\n\nfunction signbit( x ) {\n\tvar high = lib$p( x );\n\treturn ( high >>> 31 ) ? true : false;\n}\nvar main$m = signbit;\n\nvar lib$H = main$m;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar PI = 3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679;\nvar lib$I = PI;\n\nfunction atan2( y, x ) {\n\tvar q;\n\tif ( lib( x ) || lib( y ) ) {\n\t\treturn NaN;\n\t}\n\tif ( lib$z( x ) ) {\n\t\tif ( x === lib$r ) {\n\t\t\tif ( lib$z( y ) ) {\n\t\t\t\treturn lib$G( lib$I / 4.0, y );\n\t\t\t}\n\t\t\treturn lib$G( 0.0, y );\n\t\t}\n\t\tif ( lib$z( y ) ) {\n\t\t\treturn lib$G( 3.0*lib$I/4.0, y );\n\t\t}\n\t\treturn lib$G( lib$I, y );\n\t}\n\tif ( lib$z( y ) ) {\n\t\treturn lib$G( lib$I / 2.0, y );\n\t}\n\tif ( y === 0.0 ) {\n\t\tif ( x >= 0.0 && !lib$H( x ) ) {\n\t\t\treturn lib$G( 0.0, y );\n\t\t}\n\t\treturn lib$G( lib$I, y );\n\t}\n\tif ( x === 0.0 ) {\n\t\treturn lib$G( lib$I / 2.0, y );\n\t}\n\tq = lib$C( y / x );\n\tif ( x < 0.0 ) {\n\t\tif ( q <= 0.0 ) {\n\t\t\treturn q + lib$I;\n\t\t}\n\t\treturn q - lib$I;\n\t}\n\treturn q;\n}\nvar main$n = atan2;\n\nvar lib$J = main$n;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar FLOAT64_SMALLEST_NORMAL = 2.2250738585072014e-308;\nvar lib$K = FLOAT64_SMALLEST_NORMAL;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nfunction evalpoly$5( x ) {\n\tif ( x === 0.0 ) {\n\t\treturn 1.87595182427177;\n\t}\n\treturn 1.87595182427177 + (x * (-1.8849797954337717 + (x * (1.6214297201053545 + (x * (-0.758397934778766 + (x * 0.14599619288661245)))))));\n}\nvar polyval_p$2 = evalpoly$5;\n\nvar SIGN_MASK$1 = 0x80000000|0;\nvar ABS_MASK = 0x7fffffff|0;\nvar TWO_54 = 18014398509481984;\nvar ONE = 0x00000001|0;\nvar B1 = 715094163|0;\nvar B2 = 696219795|0;\nfunction cbrt( x ) {\n\tvar high;\n\tvar sgn;\n\tvar hx;\n\tvar r;\n\tvar s;\n\tvar t;\n\tvar w;\n\tif (\n\t\tlib( x ) ||\n\t\tlib$z( x ) ||\n\t\tx === 0.0\n\t) {\n\t\treturn x;\n\t}\n\thx = lib$p( x );\n\tsgn = hx & SIGN_MASK$1;\n\thx &= ABS_MASK;\n\tt = 0.0;\n\tif ( x < lib$K ) {\n\t\tt = TWO_54;\n\t\tt *= x;\n\t\thigh = lib$p( t );\n\t\thigh = ( (high&ABS_MASK)/3 ) + B2;\n\t\tt = lib$F( sgn|high, 0 );\n\t} else {\n\t\thigh = (hx/3) + B1;\n\t\tt = lib$q( t, sgn|high );\n\t}\n\tr = (t*t) * (t/x);\n\tt *= polyval_p$2( r );\n\thigh = lib$p( t );\n\tt = lib$F( high+ONE, 0 );\n\ts = t * t;\n\tr = x / s;\n\tw = t + t;\n\tr = (r - t) / (w + r);\n\tt += t * r;\n\treturn t;\n}\nvar cbrt_1 = cbrt;\n\nvar lib$L = cbrt_1;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nfunction evalpoly$6( x ) {\n\tif ( x === 0.0 ) {\n\t\treturn 0.0416666666666666;\n\t}\n\treturn 0.0416666666666666 + (x * (-0.001388888888887411 + (x * 0.00002480158728947673)));\n}\nvar polyval_c13 = evalpoly$6;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nfunction evalpoly$7( x ) {\n\tif ( x === 0.0 ) {\n\t\treturn -2.7557314351390663e-7;\n\t}\n\treturn -2.7557314351390663e-7 + (x * (2.087572321298175e-9 + (x * -1.1359647557788195e-11)));\n}\nvar polyval_c46 = evalpoly$7;\n\nfunction kernelCos( x, y ) {\n\tvar hz;\n\tvar r;\n\tvar w;\n\tvar z;\n\tz = x * x;\n\tw = z * z;\n\tr = z * polyval_c13( z );\n\tr += w * w * polyval_c46( z );\n\thz = 0.5 * z;\n\tw = 1.0 - hz;\n\treturn w + ( ((1.0-w) - hz) + ((z*r) - (x*y)) );\n}\nvar kernel_cos = kernelCos;\n\nvar lib$M = kernel_cos;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*\n*\n* ## Notice\n*\n* The following copyright, license, and long comment were part of the original implementation available as part of [FreeBSD]{@link https://svnweb.freebsd.org/base/release/9.3.0/lib/msun/src/k_sin.c}. The implementation follows the original, but has been modified for JavaScript.\n*\n* ```text\n* Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.\n*\n* Developed at SunPro, a Sun Microsystems, Inc. business.\n* Permission to use, copy, modify, and distribute this\n* software is freely granted, provided that this notice\n* is preserved.\n* ```\n*/\nvar S1 = -1.66666666666666324348e-01;\nvar S2 = 8.33333333332248946124e-03;\nvar S3 = -1.98412698298579493134e-04;\nvar S4 = 2.75573137070700676789e-06;\nvar S5 = -2.50507602534068634195e-08;\nvar S6 = 1.58969099521155010221e-10;\nfunction kernelSin( x, y ) {\n\tvar r;\n\tvar v;\n\tvar w;\n\tvar z;\n\tz = x * x;\n\tw = z * z;\n\tr = S2 + (z * (S3 + (z*S4))) + (z * w * (S5 + (z*S6)));\n\tv = z * x;\n\tif ( y === 0.0 ) {\n\t\treturn x + (v * (S1 + (z*r)));\n\t}\n\treturn x - (((z*((0.5*y) - (v*r))) - y) - (v*S1));\n}\nvar kernel_sin = kernelSin;\n\nvar lib$N = kernel_sin;\n\nvar LOW$4;\nif ( lib$o === true ) {\n\tLOW$4 = 0;\n} else {\n\tLOW$4 = 1;\n}\nvar low = LOW$4;\n\nvar FLOAT64_VIEW$4 = new lib$f( 1 );\nvar UINT32_VIEW$4 = new lib$c( FLOAT64_VIEW$4.buffer );\nfunction getLowWord( x ) {\n\tFLOAT64_VIEW$4[ 0 ] = x;\n\treturn UINT32_VIEW$4[ low ];\n}\nvar main$o = getLowWord;\n\nvar lib$O = main$o;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar floor = Math.floor;\nvar floor_1 = floor;\n\nvar lib$P = floor_1;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar FLOAT64_MAX_BASE2_EXPONENT = 1023|0;\nvar lib$Q = FLOAT64_MAX_BASE2_EXPONENT;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar FLOAT64_MAX_BASE2_EXPONENT_SUBNORMAL = -1023|0;\nvar lib$R = FLOAT64_MAX_BASE2_EXPONENT_SUBNORMAL;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar FLOAT64_MIN_BASE2_EXPONENT_SUBNORMAL = -1074|0;\nvar lib$S = FLOAT64_MIN_BASE2_EXPONENT_SUBNORMAL;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nfunction abs( x ) {\n\tif ( x < 0.0 ) {\n\t\treturn -x;\n\t}\n\tif ( x === 0.0 ) {\n\t\treturn 0.0;\n\t}\n\treturn x;\n}\nvar abs_1 = abs;\n\nvar lib$T = abs_1;\n\nvar SCALAR = 4503599627370496;\nfunction normalize( out, x ) {\n\tif ( lib( x ) || lib$z( x ) ) {\n\t\tout[ 0 ] = x;\n\t\tout[ 1 ] = 0;\n\t\treturn out;\n\t}\n\tif ( x !== 0.0 && lib$T( x ) < lib$K ) {\n\t\tout[ 0 ] = x * SCALAR;\n\t\tout[ 1 ] = -52;\n\t\treturn out;\n\t}\n\tout[ 0 ] = x;\n\tout[ 1 ] = 0;\n\treturn out;\n}\nvar normalize_1 = normalize;\n\nfunction normalize$1( out, x ) {\n\tif ( arguments.length === 1 ) {\n\t\treturn normalize_1( [ 0.0, 0 ], out );\n\t}\n\treturn normalize_1( out, x );\n}\nvar main$p = normalize$1;\n\nvar lib$U = main$p;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar FLOAT64_HIGH_WORD_EXPONENT_MASK = 0x7ff00000;\nvar lib$V = FLOAT64_HIGH_WORD_EXPONENT_MASK;\n\nfunction exponent( x ) {\n\tvar high = lib$p( x );\n\thigh = ( high & lib$V ) >>> 20;\n\treturn (high - lib$u)|0;\n}\nvar main$q = exponent;\n\nvar lib$W = main$q;\n\nvar TWO52_INV = 2.220446049250313e-16;\nvar CLEAR_EXP_MASK = 0x800fffff>>>0;\nvar FRAC = [ 0.0, 0.0 ];\nvar WORDS$1 = [ 0, 0 ];\nfunction ldexp( frac, exp ) {\n\tvar high;\n\tvar m;\n\tif (\n\t\tfrac === 0.0 ||\n\t\tlib( frac ) ||\n\t\tlib$z( frac )\n\t) {\n\t\treturn frac;\n\t}\n\tlib$U( FRAC, frac );\n\tfrac = FRAC[ 0 ];\n\texp += FRAC[ 1 ];\n\texp += lib$W( frac );\n\tif ( exp < lib$S ) {\n\t\treturn lib$G( 0.0, frac );\n\t}\n\tif ( exp > lib$Q ) {\n\t\tif ( frac < 0.0 ) {\n\t\t\treturn lib$t;\n\t\t}\n\t\treturn lib$r;\n\t}\n\tif ( exp <= lib$R ) {\n\t\texp += 52;\n\t\tm = TWO52_INV;\n\t} else {\n\t\tm = 1.0;\n\t}\n\tlib$E( WORDS$1, frac );\n\thigh = WORDS$1[ 0 ];\n\thigh &= CLEAR_EXP_MASK;\n\thigh |= ((exp+lib$u) << 20);\n\treturn m * lib$F( high, WORDS$1[ 1 ] );\n}\nvar ldexp_1 = ldexp;\n\nvar lib$X = ldexp_1;\n\nvar IPIO2 = [\n\t0xA2F983, 0x6E4E44, 0x1529FC, 0x2757D1, 0xF534DD, 0xC0DB62,\n\t0x95993C, 0x439041, 0xFE5163, 0xABDEBB, 0xC561B7, 0x246E3A,\n\t0x424DD2, 0xE00649, 0x2EEA09, 0xD1921C, 0xFE1DEB, 0x1CB129,\n\t0xA73EE8, 0x8235F5, 0x2EBB44, 0x84E99C, 0x7026B4, 0x5F7E41,\n\t0x3991D6, 0x398353, 0x39F49C, 0x845F8B, 0xBDF928, 0x3B1FF8,\n\t0x97FFDE, 0x05980F, 0xEF2F11, 0x8B5A0A, 0x6D1F6D, 0x367ECF,\n\t0x27CB09, 0xB74F46, 0x3F669E, 0x5FEA2D, 0x7527BA, 0xC7EBE5,\n\t0xF17B3D, 0x0739F7, 0x8A5292, 0xEA6BFB, 0x5FB11F, 0x8D5D08,\n\t0x560330, 0x46FC7B, 0x6BABF0, 0xCFBC20, 0x9AF436, 0x1DA9E3,\n\t0x91615E, 0xE61B08, 0x659985, 0x5F14A0, 0x68408D, 0xFFD880,\n\t0x4D7327, 0x310606, 0x1556CA, 0x73A8C9, 0x60E27B, 0xC08C6B\n];\nvar PIO2 = [\n\t1.57079625129699707031e+00,\n\t7.54978941586159635335e-08,\n\t5.39030252995776476554e-15,\n\t3.28200341580791294123e-22,\n\t1.27065575308067607349e-29,\n\t1.22933308981111328932e-36,\n\t2.73370053816464559624e-44,\n\t2.16741683877804819444e-51\n];\nvar TWO24 = 1.67772160000000000000e+07;\nvar TWON24 = 5.96046447753906250000e-08;\nvar F = zero( new Array( 20 ) );\nvar Q = zero( new Array( 20 ) );\nvar FQ = zero( new Array( 20 ) );\nvar IQ = zero( new Array( 20 ) );\nfunction zero( arr ) {\n\tvar len = arr.length;\n\tvar i;\n\tfor ( i = 0; i < len; i++ ) {\n\t\tarr[ i ] = 0.0;\n\t}\n\treturn arr;\n}\nfunction compute( x, y, jz, q, q0, jk, jv, jx, f ) {\n\tvar carry;\n\tvar fw;\n\tvar ih;\n\tvar jp;\n\tvar i;\n\tvar k;\n\tvar n;\n\tvar j;\n\tvar z;\n\tjp = jk;\n\tz = q[ jz ];\n\tj = jz;\n\tfor ( i = 0; j > 0; i++ ) {\n\t\tfw = ( TWON24 * z )|0;\n\t\tIQ[ i ] = ( z - (TWO24*fw) )|0;\n\t\tz = q[ j-1 ] + fw;\n\t\tj -= 1;\n\t}\n\tz = lib$X( z, q0 );\n\tz -= 8.0 * lib$P( z*0.125 );\n\tn = z|0;\n\tz -= n;\n\tih = 0;\n\tif ( q0 > 0 ) {\n\t\ti = ( IQ[ jz-1 ] >> (24-q0) );\n\t\tn += i;\n\t\tIQ[ jz-1 ] -= ( i << (24-q0) );\n\t\tih = ( IQ[ jz-1 ] >> (23-q0) );\n\t}\n\telse if ( q0 === 0 ) {\n\t\tih = ( IQ[ jz-1 ] >> 23 );\n\t}\n\telse if ( z >= 0.5 ) {\n\t\tih = 2;\n\t}\n\tif ( ih > 0 ) {\n\t\tn += 1;\n\t\tcarry = 0;\n\t\tfor ( i = 0; i < jz; i++ ) {\n\t\t\tj = IQ[ i ];\n\t\t\tif ( carry === 0 ) {\n\t\t\t\tif ( j !== 0 ) {\n\t\t\t\t\tcarry = 1;\n\t\t\t\t\tIQ[ i ] = 0x1000000 - j;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tIQ[ i ] = 0xffffff - j;\n\t\t\t}\n\t\t}\n\t\tif ( q0 > 0 ) {\n\t\t\tswitch ( q0 ) {\n\t\t\tcase 1:\n\t\t\t\tIQ[ jz-1 ] &= 0x7fffff;\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tIQ[ jz-1 ] &= 0x3fffff;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif ( ih === 2 ) {\n\t\t\tz = 1.0 - z;\n\t\t\tif ( carry !== 0 ) {\n\t\t\t\tz -= lib$X( 1.0, q0 );\n\t\t\t}\n\t\t}\n\t}\n\tif ( z === 0.0 ) {\n\t\tj = 0;\n\t\tfor ( i = jz-1; i >= jk; i-- ) {\n\t\t\tj |= IQ[ i ];\n\t\t}\n\t\tif ( j === 0 ) {\n\t\t\tfor ( k = 1; IQ[ jk-k ] === 0; k++ ) {\n\t\t\t}\n\t\t\tfor ( i = jz+1; i <= jz+k; i++ ) {\n\t\t\t\tf[ jx+i ] = IPIO2[ jv+i ];\n\t\t\t\tfw = 0.0;\n\t\t\t\tfor ( j = 0; j <= jx; j++ ) {\n\t\t\t\t\tfw += x[ j ] * f[ jx + (i-j) ];\n\t\t\t\t}\n\t\t\t\tq[ i ] = fw;\n\t\t\t}\n\t\t\tjz += k;\n\t\t\treturn compute( x, y, jz, q, q0, jk, jv, jx, f );\n\t\t}\n\t}\n\tif ( z === 0.0 ) {\n\t\tjz -= 1;\n\t\tq0 -= 24;\n\t\twhile ( IQ[ jz ] === 0 ) {\n\t\t\tjz -= 1;\n\t\t\tq0 -= 24;\n\t\t}\n\t} else {\n\t\tz = lib$X( z, -q0 );\n\t\tif ( z >= TWO24 ) {\n\t\t\tfw = (TWON24*z)|0;\n\t\t\tIQ[ jz ] = ( z - (TWO24*fw) )|0;\n\t\t\tjz += 1;\n\t\t\tq0 += 24;\n\t\t\tIQ[ jz ] = fw;\n\t\t} else {\n\t\t\tIQ[ jz ] = z|0;\n\t\t}\n\t}\n\tfw = lib$X( 1.0, q0 );\n\tfor ( i = jz; i >= 0; i-- ) {\n\t\tq[ i ] = fw * IQ[i];\n\t\tfw *= TWON24;\n\t}\n\tfor ( i = jz; i >= 0; i-- ) {\n\t\tfw = 0.0;\n\t\tfor ( k = 0; k <= jp && k <= jz-i; k++ ) {\n\t\t\tfw += PIO2[ k ] * q[ i+k ];\n\t\t}\n\t\tFQ[ jz-i ] = fw;\n\t}\n\tfw = 0.0;\n\tfor ( i = jz; i >= 0; i-- ) {\n\t\tfw += FQ[ i ];\n\t}\n\tif ( ih === 0 ) {\n\t\ty[ 0 ] = fw;\n\t} else {\n\t\ty[ 0 ] = -fw;\n\t}\n\tfw = FQ[ 0 ] - fw;\n\tfor ( i = 1; i <= jz; i++ ) {\n\t\tfw += FQ[i];\n\t}\n\tif ( ih === 0 ) {\n\t\ty[ 1 ] = fw;\n\t} else {\n\t\ty[ 1 ] = -fw;\n\t}\n\treturn ( n & 7 );\n}\nfunction kernelRempio2( x, y, e0, nx ) {\n\tvar fw;\n\tvar jk;\n\tvar jv;\n\tvar jx;\n\tvar jz;\n\tvar q0;\n\tvar i;\n\tvar j;\n\tvar m;\n\tjk = 4;\n\tjx = nx - 1;\n\tjv = ( (e0 - 3) / 24 )|0;\n\tif ( jv < 0 ) {\n\t\tjv = 0;\n\t}\n\tq0 = e0 - (24 * (jv + 1));\n\tj = jv - jx;\n\tm = jx + jk;\n\tfor ( i = 0; i <= m; i++ ) {\n\t\tif ( j < 0 ) {\n\t\t\tF[ i ] = 0.0;\n\t\t} else {\n\t\t\tF[ i ] = IPIO2[ j ];\n\t\t}\n\t\tj += 1;\n\t}\n\tfor ( i = 0; i <= jk; i++ ) {\n\t\tfw = 0.0;\n\t\tfor ( j = 0; j <= jx; j++ ) {\n\t\t\tfw += x[ j ] * F[ jx + (i-j) ];\n\t\t}\n\t\tQ[ i ] = fw;\n\t}\n\tjz = jk;\n\treturn compute( x, y, jz, Q, q0, jk, jv, jx, F );\n}\nvar kernel_rempio2 = kernelRempio2;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar round = Math.round;\nvar round_1 = round;\n\nvar lib$Y = round_1;\n\nvar INVPIO2 = 6.36619772367581382433e-01;\nvar PIO2_1 = 1.57079632673412561417e+00;\nvar PIO2_1T = 6.07710050650619224932e-11;\nvar PIO2_2 = 6.07710050630396597660e-11;\nvar PIO2_2T = 2.02226624879595063154e-21;\nvar PIO2_3 = 2.02226624871116645580e-21;\nvar PIO2_3T = 8.47842766036889956997e-32;\nvar EXPONENT_MASK = 0x7ff|0;\nfunction rempio2Medium( x, ix, y ) {\n\tvar high;\n\tvar n;\n\tvar t;\n\tvar r;\n\tvar w;\n\tvar i;\n\tvar j;\n\tn = lib$Y( x * INVPIO2 );\n\tr = x - ( n * PIO2_1 );\n\tw = n * PIO2_1T;\n\tj = (ix >> 20)|0;\n\ty[ 0 ] = r - w;\n\thigh = lib$p( y[0] );\n\ti = j - ( (high >> 20) & EXPONENT_MASK );\n\tif ( i > 16 ) {\n\t\tt = r;\n\t\tw = n * PIO2_2;\n\t\tr = t - w;\n\t\tw = (n * PIO2_2T) - ((t-r) - w);\n\t\ty[ 0 ] = r - w;\n\t\thigh = lib$p( y[0] );\n\t\ti = j - ( (high >> 20) & EXPONENT_MASK );\n\t\tif ( i > 49 ) {\n\t\t\tt = r;\n\t\t\tw = n * PIO2_3;\n\t\t\tr = t - w;\n\t\t\tw = (n * PIO2_3T) - ((t-r) - w);\n\t\t\ty[ 0 ] = r - w;\n\t\t}\n\t}\n\ty[ 1 ] = (r - y[0]) - w;\n\treturn n;\n}\nvar rempio2_medium = rempio2Medium;\n\nvar ZERO = 0.00000000000000000000e+00;\nvar TWO24$1 = 1.67772160000000000000e+07;\nvar PIO2_1$1 = 1.57079632673412561417e+00;\nvar PIO2_1T$1 = 6.07710050650619224932e-11;\nvar TWO_PIO2_1T = 2.0 * PIO2_1T$1;\nvar THREE_PIO2_1T = 3.0 * PIO2_1T$1;\nvar FOUR_PIO2_1T = 4.0 * PIO2_1T$1;\nvar ABS_MASK$1 = 0x7fffffff|0;\nvar EXPONENT_MASK$1 = 0x7ff00000|0;\nvar SIGNIFICAND_MASK = 0xfffff|0;\nvar PI_HIGH_WORD_SIGNIFICAND = 0x921fb|0;\nvar PIO4_HIGH_WORD = 0x3fe921fb|0;\nvar THREE_PIO4_HIGH_WORD = 0x4002d97c|0;\nvar FIVE_PIO4_HIGH_WORD = 0x400f6a7a|0;\nvar THREE_PIO2_HIGH_WORD = 0x4012d97c|0;\nvar SEVEN_PIO4_HIGH_WORD = 0x4015fdbc|0;\nvar TWO_PI_HIGH_WORD = 0x401921fb|0;\nvar NINE_PIO4_HIGH_WORD = 0x401c463b|0;\nvar MEDIUM = 0x413921fb|0;\nvar TX = new Array( 3 );\nvar TY = new Array( 2 );\nfunction rempio2( x, y ) {\n\tvar low;\n\tvar e0;\n\tvar hx;\n\tvar ix;\n\tvar nx;\n\tvar i;\n\tvar n;\n\tvar z;\n\thx = lib$p( x );\n\tix = (hx & ABS_MASK$1)|0;\n\tif ( ix <= PIO4_HIGH_WORD ) {\n\t\ty[ 0 ] = x;\n\t\ty[ 1 ] = 0.0;\n\t\treturn 0;\n\t}\n\tif ( ix <= FIVE_PIO4_HIGH_WORD ) {\n\t\tif ( (ix & SIGNIFICAND_MASK) === PI_HIGH_WORD_SIGNIFICAND ) {\n\t\t\treturn rempio2_medium( x, ix, y );\n\t\t}\n\t\tif ( ix <= THREE_PIO4_HIGH_WORD ) {\n\t\t\tif ( x > 0.0 ) {\n\t\t\t\tz = x - PIO2_1$1;\n\t\t\t\ty[ 0 ] = z - PIO2_1T$1;\n\t\t\t\ty[ 1 ] = (z - y[0]) - PIO2_1T$1;\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\tz = x + PIO2_1$1;\n\t\t\ty[ 0 ] = z + PIO2_1T$1;\n\t\t\ty[ 1 ] = (z - y[0]) + PIO2_1T$1;\n\t\t\treturn -1;\n\t\t}\n\t\tif ( x > 0.0 ) {\n\t\t\tz = x - ( 2.0*PIO2_1$1 );\n\t\t\ty[ 0 ] = z - TWO_PIO2_1T;\n\t\t\ty[ 1 ] = (z - y[0]) - TWO_PIO2_1T;\n\t\t\treturn 2;\n\t\t}\n\t\tz = x + ( 2.0*PIO2_1$1 );\n\t\ty[ 0 ] = z + TWO_PIO2_1T;\n\t\ty[ 1 ] = (z - y[0]) + TWO_PIO2_1T;\n\t\treturn -2;\n\t}\n\tif ( ix <= NINE_PIO4_HIGH_WORD ) {\n\t\tif ( ix <= SEVEN_PIO4_HIGH_WORD ) {\n\t\t\tif ( ix === THREE_PIO2_HIGH_WORD ) {\n\t\t\t\treturn rempio2_medium( x, ix, y );\n\t\t\t}\n\t\t\tif ( x > 0.0 ) {\n\t\t\t\tz = x - ( 3.0*PIO2_1$1 );\n\t\t\t\ty[ 0 ] = z - THREE_PIO2_1T;\n\t\t\t\ty[ 1 ] = (z - y[0]) - THREE_PIO2_1T;\n\t\t\t\treturn 3;\n\t\t\t}\n\t\t\tz = x + ( 3.0*PIO2_1$1 );\n\t\t\ty[ 0 ] = z + THREE_PIO2_1T;\n\t\t\ty[ 1 ] = (z - y[0]) + THREE_PIO2_1T;\n\t\t\treturn -3;\n\t\t}\n\t\tif ( ix === TWO_PI_HIGH_WORD ) {\n\t\t\treturn rempio2_medium( x, ix, y );\n\t\t}\n\t\tif ( x > 0.0 ) {\n\t\t\tz = x - ( 4.0*PIO2_1$1 );\n\t\t\ty[ 0 ] = z - FOUR_PIO2_1T;\n\t\t\ty[ 1 ] = (z - y[0]) - FOUR_PIO2_1T;\n\t\t\treturn 4;\n\t\t}\n\t\tz = x + ( 4.0*PIO2_1$1 );\n\t\ty[ 0 ] = z + FOUR_PIO2_1T;\n\t\ty[ 1 ] = (z - y[0]) + FOUR_PIO2_1T;\n\t\treturn -4;\n\t}\n\tif ( ix < MEDIUM ) {\n\t\treturn rempio2_medium( x, ix, y );\n\t}\n\tif ( ix >= EXPONENT_MASK$1 ) {\n\t\ty[ 0 ] = NaN;\n\t\ty[ 1 ] = NaN;\n\t\treturn 0.0;\n\t}\n\tlow = lib$O( x );\n\te0 = (ix >> 20) - 1046;\n\tz = lib$F( ix - ((e0 << 20)|0), low );\n\tfor ( i = 0; i < 2; i++ ) {\n\t\tTX[ i ] = z|0;\n\t\tz = (z - TX[i]) * TWO24$1;\n\t}\n\tTX[ 2 ] = z;\n\tnx = 3;\n\twhile ( TX[ nx-1 ] === ZERO ) {\n\t\tnx -= 1;\n\t}\n\tn = kernel_rempio2( TX, TY, e0, nx);\n\tif ( x < 0.0 ) {\n\t\ty[ 0 ] = -TY[ 0 ];\n\t\ty[ 1 ] = -TY[ 1 ];\n\t\treturn -n;\n\t}\n\ty[ 0 ] = TY[ 0 ];\n\ty[ 1 ] = TY[ 1 ];\n\treturn n;\n}\nvar rempio2_1 = rempio2;\n\nvar lib$Z = rempio2_1;\n\nvar buffer = [ 0.0, 0.0 ];\nvar HIGH_WORD_ABS_MASK = 0x7fffffff|0;\nvar HIGH_WORD_PIO4 = 0x3fe921fb|0;\nvar HIGH_WORD_TWO_NEG_27 = 0x3e400000|0;\nvar HIGH_WORD_EXPONENT_MASK = 0x7ff00000|0;\nfunction cos( x ) {\n\tvar ix;\n\tvar n;\n\tix = lib$p( x );\n\tix &= HIGH_WORD_ABS_MASK;\n\tif ( ix <= HIGH_WORD_PIO4 ) {\n\t\tif ( ix < HIGH_WORD_TWO_NEG_27 ) {\n\t\t\treturn 1.0;\n\t\t}\n\t\treturn lib$M( x, 0.0 );\n\t}\n\tif ( ix >= HIGH_WORD_EXPONENT_MASK ) {\n\t\treturn NaN;\n\t}\n\tn = lib$Z( x, buffer );\n\tswitch ( n & 3 ) {\n\tcase 0:\n\t\treturn lib$M( buffer[ 0 ], buffer[ 1 ] );\n\tcase 1:\n\t\treturn -lib$N( buffer[ 0 ], buffer[ 1 ] );\n\tcase 2:\n\t\treturn -lib$M( buffer[ 0 ], buffer[ 1 ] );\n\tdefault:\n\t\treturn lib$N( buffer[ 0 ], buffer[ 1 ] );\n\t}\n}\nvar cos_1 = cos;\n\nvar lib$_ = cos_1;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar ceil = Math.ceil;\nvar ceil_1 = ceil;\n\nvar lib$$ = ceil_1;\n\nfunction trunc( x ) {\n\tif ( x < 0.0 ) {\n\t\treturn lib$$( x );\n\t}\n\treturn lib$P( x );\n}\nvar trunc_1 = trunc;\n\nvar lib$10 = trunc_1;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nfunction evalpoly$8( x ) {\n\tif ( x === 0.0 ) {\n\t\treturn 0.16666666666666602;\n\t}\n\treturn 0.16666666666666602 + (x * (-0.0027777777777015593 + (x * (0.00006613756321437934 + (x * (-0.0000016533902205465252 + (x * 4.1381367970572385e-8)))))));\n}\nvar polyval_p$3 = evalpoly$8;\n\nfunction expmulti( hi, lo, k ) {\n\tvar r;\n\tvar t;\n\tvar c;\n\tvar y;\n\tr = hi - lo;\n\tt = r * r;\n\tc = r - ( t*polyval_p$3( t ) );\n\ty = 1.0 - ( lo - ( (r*c)/(2.0-c) ) - hi);\n\treturn lib$X( y, k );\n}\nvar expmulti_1 = expmulti;\n\nvar LN2_HI$2 = 6.93147180369123816490e-01;\nvar LN2_LO$2 = 1.90821492927058770002e-10;\nvar LOG2_E = 1.44269504088896338700e+00;\nvar OVERFLOW = 7.09782712893383973096e+02;\nvar UNDERFLOW = -7.45133219101941108420e+02;\nvar NEARZERO = 1.0 / (1 << 28);\nvar NEG_NEARZERO = -NEARZERO;\nfunction exp( x ) {\n\tvar hi;\n\tvar lo;\n\tvar k;\n\tif ( lib( x ) || x === lib$r ) {\n\t\treturn x;\n\t}\n\tif ( x === lib$t ) {\n\t\treturn 0.0;\n\t}\n\tif ( x > OVERFLOW ) {\n\t\treturn lib$r;\n\t}\n\tif ( x < UNDERFLOW ) {\n\t\treturn 0.0;\n\t}\n\tif (\n\t\tx > NEG_NEARZERO &&\n\t\tx < NEARZERO\n\t) {\n\t\treturn 1.0 + x;\n\t}\n\tif ( x < 0.0 ) {\n\t\tk = lib$10( (LOG2_E*x) - 0.5 );\n\t} else {\n\t\tk = lib$10( (LOG2_E*x) + 0.5 );\n\t}\n\thi = x - (k*LN2_HI$2);\n\tlo = k * LN2_LO$2;\n\treturn expmulti_1( hi, lo, k );\n}\nvar exp_1 = exp;\n\nvar lib$11 = exp_1;\n\nfunction cosh( x ) {\n\tif ( lib( x ) ) {\n\t\treturn x;\n\t}\n\tif ( x < 0.0 ) {\n\t\tx = -x;\n\t}\n\tif ( x > 21.0 ) {\n\t\treturn lib$11( x ) / 2.0;\n\t}\n\treturn ( lib$11(x) + lib$11(-x) ) / 2.0;\n}\nvar cosh_1 = cosh;\n\nvar lib$12 = cosh_1;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar HALF_LN2 = 3.46573590279972654709e-01;\nvar lib$13 = HALF_LN2;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nfunction evalpoly$9( x ) {\n\tif ( x === 0.0 ) {\n\t\treturn -0.03333333333333313;\n\t}\n\treturn -0.03333333333333313 + (x * (0.0015873015872548146 + (x * (-0.0000793650757867488 + (x * (0.000004008217827329362 + (x * -2.0109921818362437e-7)))))));\n}\nvar polyval_q$2 = evalpoly$9;\n\nvar OVERFLOW_THRESHOLD = 7.09782712893383973096e+02;\nvar LN2_HI$3 = 6.93147180369123816490e-01;\nvar LN2_LO$3 = 1.90821492927058770002e-10;\nvar LN2_INV = 1.44269504088896338700e+00;\nvar LN2x56 = 3.88162421113569373274e+01;\nvar LN2_HALFX3 = 1.03972077083991796413e+00;\nfunction expm1( x ) {\n\tvar halfX;\n\tvar sign;\n\tvar hi;\n\tvar lo;\n\tvar hx;\n\tvar r1;\n\tvar y;\n\tvar z;\n\tvar c;\n\tvar t;\n\tvar e;\n\tvar k;\n\tif ( x === lib$r || lib( x ) ) {\n\t\treturn x;\n\t}\n\tif ( x === lib$t ) {\n\t\treturn -1.0;\n\t}\n\tif ( x === 0.0 ) {\n\t\treturn x;\n\t}\n\tif ( x < 0.0 ) {\n\t\tsign = true;\n\t\ty = -x;\n\t} else {\n\t\tsign = false;\n\t\ty = x;\n\t}\n\tif ( y >= LN2x56 ) {\n\t\tif ( sign ) {\n\t\t\treturn -1.0;\n\t\t}\n\t\tif ( y >= OVERFLOW_THRESHOLD ) {\n\t\t\treturn lib$r;\n\t\t}\n\t}\n\thx = lib$p( y )|0;\n\tif ( y > lib$13 ) {\n\t\tif ( y < LN2_HALFX3 ) {\n\t\t\tif ( sign ) {\n\t\t\t\thi = x + LN2_HI$3;\n\t\t\t\tlo = -LN2_LO$3;\n\t\t\t\tk = -1;\n\t\t\t} else {\n\t\t\t\thi = x - LN2_HI$3;\n\t\t\t\tlo = LN2_LO$3;\n\t\t\t\tk = 1;\n\t\t\t}\n\t\t} else {\n\t\t\tif ( sign ) {\n\t\t\t\tk = (LN2_INV*x) - 0.5;\n\t\t\t} else {\n\t\t\t\tk = (LN2_INV*x) + 0.5;\n\t\t\t}\n\t\t\tk |= 0;\n\t\t\tt = k;\n\t\t\thi = x - (t*LN2_HI$3);\n\t\t\tlo = t * LN2_LO$3;\n\t\t}\n\t\tx = hi - lo;\n\t\tc = (hi-x) - lo;\n\t}\n\telse if ( hx < 1016070144 ) {\n\t\treturn x;\n\t}\n\telse {\n\t\tk = 0;\n\t}\n\thalfX = 0.5 * x;\n\tz = x * halfX;\n\tr1 = 1.0 + ( z * polyval_q$2( z ) );\n\tt = 3.0 - (r1*halfX);\n\te = z * ( (r1-t) / (6.0 - (x*t)) );\n\tif ( k === 0 ) {\n\t\treturn x - ( (x*e) - z );\n\t}\n\te = ( x * (e-c) ) - c;\n\te -= z;\n\tif ( k === -1 ) {\n\t\treturn ( 0.5*(x-e) )- 0.5;\n\t}\n\tif ( k === 1 ) {\n\t\tif ( x < -0.25 ) {\n\t\t\treturn -2.0 * ( e - (x+0.5) );\n\t\t}\n\t\treturn 1 + ( 2.0 * (x-e) );\n\t}\n\tif ( k <= -2 || k > 56 ) {\n\t\ty = 1.0 - (e-x);\n\t\thi = (lib$p( y ) + (k<<20))|0;\n\t\ty = lib$q( y, hi );\n\t\treturn y - 1.0;\n\t}\n\tt = 1.0;\n\tif ( k < 20 ) {\n\t\thi = (1072693248 - (0x200000>>k))|0;\n\t\tt = lib$q( t, hi );\n\t\ty = t - (e-x);\n\t} else {\n\t\thi = ( (lib$u-k)<<20 )|0;\n\t\tt = lib$q( t, hi );\n\t\ty = x - (e+t);\n\t\ty += 1.0;\n\t}\n\thi = (lib$p( y ) + (k<<20))|0;\n\treturn lib$q( y, hi );\n}\nvar expm1_1 = expm1;\n\nvar lib$14 = expm1_1;\n\nvar LOW$5;\nif ( lib$o === true ) {\n\tLOW$5 = 0;\n} else {\n\tLOW$5 = 1;\n}\nvar low$1 = LOW$5;\n\nvar FLOAT64_VIEW$5 = new lib$f( 1 );\nvar UINT32_VIEW$5 = new lib$c( FLOAT64_VIEW$5.buffer );\nfunction setLowWord( x, low ) {\n\tFLOAT64_VIEW$5[ 0 ] = x;\n\tUINT32_VIEW$5[ low$1 ] = ( low >>> 0 );\n\treturn FLOAT64_VIEW$5[ 0 ];\n}\nvar main$r = setLowWord;\n\nvar lib$15 = main$r;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nfunction evalpoly$a( x ) {\n\tif ( x === 0.0 ) {\n\t\treturn 0.3999999999940942;\n\t}\n\treturn 0.3999999999940942 + (x * (0.22222198432149784 + (x * 0.15313837699209373)));\n}\nvar polyval_p$4 = evalpoly$a;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nfunction evalpoly$b( x ) {\n\tif ( x === 0.0 ) {\n\t\treturn 0.6666666666666735;\n\t}\n\treturn 0.6666666666666735 + (x * (0.2857142874366239 + (x * (0.1818357216161805 + (x * 0.14798198605116586)))));\n}\nvar polyval_q$3 = evalpoly$b;\n\nvar HIGH_SIGNIFICAND_MASK$1 = 0x000fffff|0;\nvar ONE_THIRD$1 = 0.33333333333333333;\nfunction klog( x ) {\n\tvar hfsq;\n\tvar t1;\n\tvar t2;\n\tvar hx;\n\tvar f;\n\tvar s;\n\tvar z;\n\tvar R;\n\tvar w;\n\tvar i;\n\tvar j;\n\thx = lib$p( x );\n\tf = x - 1.0;\n\tif ( ( HIGH_SIGNIFICAND_MASK$1 & (2+hx) ) < 3 ) {\n\t\tif ( f === 0.0 ) {\n\t\t\treturn 0.0;\n\t\t}\n\t\treturn f * f * ( (ONE_THIRD$1*f) - 0.5 );\n\t}\n\ts = f / ( 2.0 + f );\n\tz = s * s;\n\thx &= HIGH_SIGNIFICAND_MASK$1;\n\ti = (hx - 0x6147a)|0;\n\tw = z * z;\n\tj = (0x6b851 - hx)|0;\n\tt1 = w * polyval_p$4( w );\n\tt2 = z * polyval_q$3( w );\n\ti |= j;\n\tR = t2 + t1;\n\tif ( i > 0 ) {\n\t\thfsq = 0.5 * f * f;\n\t\treturn ( s * (hfsq+R) ) - hfsq;\n\t}\n\treturn s * (R-f);\n}\nvar klog_1 = klog;\n\nvar TWO54$1 = 1.80143985094819840000e+16;\nvar IVLN10HI = 4.34294481878168880939e-01;\nvar IVLN10LO = 2.50829467116452752298e-11;\nvar LOG10_2HI = 3.01029995663611771306e-01;\nvar LOG10_2LO = 3.69423907715893078616e-13;\nvar HIGH_SIGNIFICAND_MASK$2 = 0x000fffff|0;\nvar HIGH_MAX_NORMAL_EXP$1 = 0x7ff00000|0;\nvar HIGH_MIN_NORMAL_EXP$1 = 0x00100000|0;\nvar HIGH_BIASED_EXP_0$1 = 0x3ff00000|0;\nfunction log10( x ) {\n\tvar hi;\n\tvar hx;\n\tvar lo;\n\tvar f;\n\tvar i;\n\tvar k;\n\tvar y;\n\tvar z;\n\tif ( lib( x ) || x < 0.0 ) {\n\t\treturn NaN;\n\t}\n\tif ( x === 0.0 ) {\n\t\treturn lib$t;\n\t}\n\thx = lib$p( x );\n\tk = 0|0;\n\tif ( hx < HIGH_MIN_NORMAL_EXP$1 ) {\n\t\tk -= 54|0;\n\t\tx *= TWO54$1;\n\t\thx = lib$p( x );\n\t}\n\tif ( hx >= HIGH_MAX_NORMAL_EXP$1 ) {\n\t\treturn x + x;\n\t}\n\tk += ((hx>>20) - lib$u)|0;\n\thx &= HIGH_SIGNIFICAND_MASK$2;\n\ti = ( (hx+0x95f64)&0x100000 )|0;\n\tx = lib$q( x, hx|(i^HIGH_BIASED_EXP_0$1) );\n\tk += (i>>20)|0;\n\ty = k;\n\tf = klog_1( x );\n\tx -= 1;\n\thi = lib$15( x, 0.0 );\n\tlo = x - hi;\n\tz = (y*LOG10_2LO) + ( (x+f)*IVLN10LO );\n\tz += ( (lo+f)*IVLN10HI ) + ( hi*IVLN10HI );\n\treturn z + ( y*LOG10_2HI );\n}\nvar log10_1 = log10;\n\nvar lib$16 = log10_1;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nfunction evalpoly$c( x ) {\n\tif ( x === 0.0 ) {\n\t\treturn 0.3999999999940942;\n\t}\n\treturn 0.3999999999940942 + (x * (0.22222198432149784 + (x * 0.15313837699209373)));\n}\nvar polyval_p$5 = evalpoly$c;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nfunction evalpoly$d( x ) {\n\tif ( x === 0.0 ) {\n\t\treturn 0.6666666666666735;\n\t}\n\treturn 0.6666666666666735 + (x * (0.2857142874366239 + (x * (0.1818357216161805 + (x * 0.14798198605116586)))));\n}\nvar polyval_q$4 = evalpoly$d;\n\nvar HIGH_SIGNIFICAND_MASK$3 = 0x000fffff|0;\nvar ONE_THIRD$2 = 0.33333333333333333;\nfunction klog$1( x ) {\n\tvar hfsq;\n\tvar t1;\n\tvar t2;\n\tvar hx;\n\tvar f;\n\tvar s;\n\tvar z;\n\tvar R;\n\tvar w;\n\tvar i;\n\tvar j;\n\thx = lib$p( x );\n\tf = x - 1.0;\n\tif ( ( HIGH_SIGNIFICAND_MASK$3 & (2+hx) ) < 3 ) {\n\t\tif ( f === 0.0 ) {\n\t\t\treturn 0.0;\n\t\t}\n\t\treturn f * f * ( ( ONE_THIRD$2*f )- 0.5 );\n\t}\n\ts = f / ( 2.0 + f );\n\tz = s * s;\n\thx &= HIGH_SIGNIFICAND_MASK$3;\n\ti = ( hx - 0x6147a )|0;\n\tw = z * z;\n\tj = ( 0x6b851 - hx )|0;\n\tt1 = w * polyval_p$5( w );\n\tt2 = z * polyval_q$4( w );\n\ti |= j;\n\tR = t2 + t1;\n\tif ( i > 0 ) {\n\t\thfsq = 0.5 * f * f;\n\t\treturn ( s * (hfsq+R) ) - hfsq;\n\t}\n\treturn s * (R-f);\n}\nvar klog_1$1 = klog$1;\n\nvar TWO54$2 = 1.80143985094819840000e+16;\nvar IVLN2HI = 1.44269504072144627571e+00;\nvar IVLN2LO = 1.67517131648865118353e-10;\nvar HIGH_SIGNIFICAND_MASK$4 = 0x000fffff|0;\nvar HIGH_MAX_NORMAL_EXP$2 = 0x7ff00000|0;\nvar HIGH_MIN_NORMAL_EXP$2 = 0x00100000|0;\nvar HIGH_BIASED_EXP_0$2 = 0x3ff00000|0;\nvar ABS_MASK$2 = 0x7fffffff|0;\nvar WORDS$2 = [ 0|0, 0|0 ];\nfunction log2( x ) {\n\tvar hi;\n\tvar lo;\n\tvar hx;\n\tvar lx;\n\tvar f;\n\tvar i;\n\tvar k;\n\tif ( lib( x ) || x < 0.0 ) {\n\t\treturn NaN;\n\t}\n\tlib$E( WORDS$2, x );\n\thx = WORDS$2[ 0 ];\n\tlx = WORDS$2[ 1 ];\n\tk = 0|0;\n\tif ( hx < HIGH_MIN_NORMAL_EXP$2 ) {\n\t\tif ( ( (hx&ABS_MASK$2) | lx ) === 0 ) {\n\t\t\treturn lib$t;\n\t\t}\n\t\tk -= 54|0;\n\t\tx *= TWO54$2;\n\t\thx = lib$p( x );\n\t}\n\tif ( hx >= HIGH_MAX_NORMAL_EXP$2 ) {\n\t\treturn x + x;\n\t}\n\tk += ( (hx>>20) - lib$u )|0;\n\thx &= HIGH_SIGNIFICAND_MASK$4;\n\ti = ( ( hx+0x95f64 ) & 0x100000 )|0;\n\tx = lib$q( x, hx|(i^HIGH_BIASED_EXP_0$2) );\n\tk += (i>>20)|0;\n\tf = klog_1$1( x );\n\tx -= 1;\n\thi = lib$15( x, 0 );\n\tlo = x - hi;\n\treturn ( (x+f)*IVLN2LO ) + ( (lo+f)*IVLN2HI ) + ( hi*IVLN2HI ) + k;\n}\nvar log2_1 = log2;\n\nvar lib$17 = log2_1;\n\nvar ABS_MASK$3 = 0x7fffffff|0;\nvar EXPONENT_MASK$2 = 0x7ff00000|0;\nvar PIO4_HIGH_WORD$1 = 0x3fe921fb|0;\nvar SMALL_HIGH_WORD = 0x3e500000|0;\nvar Y = [ 0.0, 0.0 ];\nfunction sin( x ) {\n\tvar ix;\n\tvar n;\n\tix = lib$p( x );\n\tix &= ABS_MASK$3;\n\tif ( ix <= PIO4_HIGH_WORD$1 ) {\n\t\tif ( ix < SMALL_HIGH_WORD ) {\n\t\t\treturn x;\n\t\t}\n\t\treturn lib$N( x, 0.0 );\n\t}\n\tif ( ix >= EXPONENT_MASK$2 ) {\n\t\treturn NaN;\n\t}\n\tn = lib$Z( x, Y );\n\tswitch ( n & 3 ) {\n\tcase 0:\n\t\treturn lib$N( Y[ 0 ], Y[ 1 ] );\n\tcase 1:\n\t\treturn lib$M( Y[ 0 ], Y[ 1 ] );\n\tcase 2:\n\t\treturn -lib$N( Y[ 0 ], Y[ 1 ] );\n\tdefault:\n\t\treturn -lib$M( Y[ 0 ], Y[ 1 ] );\n\t}\n}\nvar sin_1 = sin;\n\nvar lib$18 = sin_1;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nfunction evalrational$2( x ) {\n\tvar ax;\n\tvar s1;\n\tvar s2;\n\tif ( x === 0.0 ) {\n\t\treturn 0.16666666666666666;\n\t}\n\tif ( x < 0.0 ) {\n\t\tax = -x;\n\t} else {\n\t\tax = x;\n\t}\n\tif ( ax <= 1.0 ) {\n\t\ts1 = -351754.9648081514 + (x * (-11561.443576500522 + (x * (-163.72585752598383 + (x * -0.789474443963537)))));\n\t\ts2 = -2110529.7888489086 + (x * (36157.827983443196 + (x * (-277.7110814206028 + (x * 1.0)))));\n\t} else {\n\t\tx = 1.0 / x;\n\t\ts1 = -0.789474443963537 + (x * (-163.72585752598383 + (x * (-11561.443576500522 + (x * -351754.9648081514)))));\n\t\ts2 = 1.0 + (x * (-277.7110814206028 + (x * (36157.827983443196 + (x * -2110529.7888489086)))));\n\t}\n\treturn s1 / s2;\n}\nvar rational_pq$1 = evalrational$2;\n\nvar MAXLOG = 7.09782712893383996843e2;\nvar MINLOG = -7.08396418532264106224e2;\nvar POS_OVERFLOW = MAXLOG + lib$w;\nvar NEG_OVERFLOW = MINLOG - lib$w;\nvar LARGE = MAXLOG - lib$w;\nfunction sinh( x ) {\n\tvar a;\n\tif ( x === 0.0 ) {\n\t\treturn x;\n\t}\n\ta = lib$T( x );\n\tif ( x > POS_OVERFLOW || x < NEG_OVERFLOW ) {\n\t\treturn ( x > 0.0 ) ? lib$r : lib$t;\n\t}\n\tif ( a > 1.0 ) {\n\t\tif ( a >= LARGE ) {\n\t\t\ta = lib$11( 0.5*a );\n\t\t\ta *= 0.5 * a;\n\t\t\tif ( x < 0.0 ) {\n\t\t\t\ta = -a;\n\t\t\t}\n\t\t\treturn a;\n\t\t}\n\t\ta = lib$11( a );\n\t\ta = (0.5*a) - (0.5/a);\n\t\tif ( x < 0.0 ) {\n\t\t\ta = -a;\n\t\t}\n\t\treturn a;\n\t}\n\ta *= a;\n\treturn x + ( x*a*rational_pq$1( a ) );\n}\nvar sinh_1 = sinh;\n\nvar lib$19 = sinh_1;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nfunction evalpoly$e( x ) {\n\tif ( x === 0.0 ) {\n\t\treturn 0.13333333333320124;\n\t}\n\treturn 0.13333333333320124 + (x * (0.021869488294859542 + (x * (0.0035920791075913124 + (x * (0.0005880412408202641 + (x * (0.00007817944429395571 + (x * -0.000018558637485527546)))))))));\n}\nvar polyval_t_odd = evalpoly$e;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nfunction evalpoly$f( x ) {\n\tif ( x === 0.0 ) {\n\t\treturn 0.05396825397622605;\n\t}\n\treturn 0.05396825397622605 + (x * (0.0088632398235993 + (x * (0.0014562094543252903 + (x * (0.0002464631348184699 + (x * (0.00007140724913826082 + (x * 0.00002590730518636337)))))))));\n}\nvar polyval_t_even = evalpoly$f;\n\nvar PIO4 = 7.85398163397448278999e-01;\nvar PIO4LO = 3.06161699786838301793e-17;\nvar T0 = 3.33333333333334091986e-01;\nvar HIGH_WORD_ABS_MASK$1 = 0x7fffffff|0;\nfunction kernelTan( x, y, k ) {\n\tvar hx;\n\tvar ix;\n\tvar a;\n\tvar r;\n\tvar s;\n\tvar t;\n\tvar v;\n\tvar w;\n\tvar z;\n\thx = lib$p( x );\n\tix = (hx & HIGH_WORD_ABS_MASK$1)|0;\n\tif ( ix >= 0x3FE59428 ) {\n\t\tif ( x < 0 ) {\n\t\t\tx = -x;\n\t\t\ty = -y;\n\t\t}\n\t\tz = PIO4 - x;\n\t\tw = PIO4LO - y;\n\t\tx = z + w;\n\t\ty = 0.0;\n\t}\n\tz = x * x;\n\tw = z * z;\n\tr = polyval_t_odd( w );\n\tv = z * polyval_t_even( w );\n\ts = z * x;\n\tr = y + (z * ((s * (r + v)) + y));\n\tr += T0 * s;\n\tw = x + r;\n\tif ( ix >= 0x3FE59428 ) {\n\t\tv = k;\n\t\treturn ( 1.0 - ( (hx >> 30) & 2 ) ) * ( v - (2.0 * (x - ((w * w / (w + v)) - r)) ));\n\t}\n\tif ( k === 1 ) {\n\t\treturn w;\n\t}\n\tz = w;\n\tlib$15( z, 0 );\n\tv = r - (z - x);\n\ta = -1.0 / w;\n\tt = a;\n\tlib$15( t, 0 );\n\ts = 1.0 + (t * z);\n\treturn t + (a * (s + (t * v)));\n}\nvar kernel_tan = kernelTan;\n\nvar lib$1a = kernel_tan;\n\nvar buffer$1 = [ 0.0, 0.0 ];\nvar HIGH_WORD_ABS_MASK$2 = 0x7fffffff|0;\nvar HIGH_WORD_PIO4$1 = 0x3fe921fb|0;\nvar HIGH_WORD_EXPONENT_MASK$1 = 0x7ff00000|0;\nvar HIGH_WORD_TWO_NEG_27$1 = 0x3e400000|0;\nfunction tan( x ) {\n\tvar ix;\n\tvar n;\n\tix = lib$p( x );\n\tix &= HIGH_WORD_ABS_MASK$2;\n\tif ( ix <= HIGH_WORD_PIO4$1 ) {\n\t\tif ( ix < HIGH_WORD_TWO_NEG_27$1 ) {\n\t\t\treturn x;\n\t\t}\n\t\treturn lib$1a( x, 0.0, 1 );\n\t}\n\tif ( ix >= HIGH_WORD_EXPONENT_MASK$1 ) {\n\t\treturn NaN;\n\t}\n\tn = lib$Z( x, buffer$1 );\n\treturn lib$1a( buffer$1[ 0 ], buffer$1[ 1 ], 1-((n&1)<<1) );\n}\nvar tan_1 = tan;\n\nvar lib$1b = tan_1;\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nfunction evalrational$3( x ) {\n\tvar ax;\n\tvar s1;\n\tvar s2;\n\tif ( x === 0.0 ) {\n\t\treturn -0.3333333333333332;\n\t}\n\tif ( x < 0.0 ) {\n\t\tax = -x;\n\t} else {\n\t\tax = x;\n\t}\n\tif ( ax <= 1.0 ) {\n\t\ts1 = -1614.6876844170845 + (x * (-99.28772310019185 + (x * (-0.9643991794250523 + (x * 0.0)))));\n\t\ts2 = 4844.063053251255 + (x * (2235.4883906010045 + (x * (112.81167849163293 + (x * 1.0)))));\n\t} else {\n\t\tx = 1.0 / x;\n\t\ts1 = 0.0 + (x * (-0.9643991794250523 + (x * (-99.28772310019185 + (x * -1614.6876844170845)))));\n\t\ts2 = 1.0 + (x * (112.81167849163293 + (x * (2235.4883906010045 + (x * 4844.063053251255)))));\n\t}\n\treturn s1 / s2;\n}\nvar rational_pq$2 = evalrational$3;\n\nvar MAXLOG$1 = 8.8029691931113054295988e+01;\nfunction tanh( x ) {\n\tvar s;\n\tvar z;\n\tz = lib$T( x );\n\tif ( z > 0.5*MAXLOG$1 ) {\n\t\treturn ( x < 0.0 ) ? -1.0 : 1.0;\n\t}\n\tif ( z >= 0.625 ) {\n\t\ts = lib$11( 2.0 * z );\n\t\tz = 1.0 - ( 2.0/(s+1.0) );\n\t\tif ( x < 0.0 ) {\n\t\t\tz = -z;\n\t\t}\n\t} else {\n\t\tif ( x === 0.0 ) {\n\t\t\treturn x;\n\t\t}\n\t\ts = x * x;\n\t\tz = x + ( x*s*rational_pq$2( s ) );\n\t}\n\treturn z;\n}\nvar tanh_1 = tanh;\n\nvar lib$1c = tanh_1;\n\nif (typeof globalThis.CroquetMath === \"undefined\") globalThis.CroquetMath = {};\nObject.assign(globalThis.CroquetMath, { acos: lib$4, acosh: lib$y, asin: lib$3, asinh: lib$A, atan: lib$C, atanh: lib$D, atan2: lib$J, cbrt: lib$L, cos: lib$_, cosh: lib$12, exp: lib$11, expm1: lib$14, log: lib$x, log1p: lib$v, log10: lib$16, log2: lib$17, sin: lib$18, sinh: lib$19, tan: lib$1b, tanh: lib$1c });\nconst mathPow = Math.pow;\nfunction isInfinite$1(x) { return x === Infinity || x === -Infinity; }\nfunction isInteger(x) { return Number.isInteger(x); }\nglobalThis.CroquetMath.pow = (x, y) => {\n    if (isNaN(x) || isNaN(y)) return NaN;\n    if (isInfinite$1(x) || isInfinite$1(y)) return mathPow(x, y);\n    if (x === 0 || y === 0) return mathPow(x, y);\n    if (x < 0 && !isInteger(y)) return NaN;\n    if (y === 1) return x;\n    if (y === 2) return x*x;\n    if (y === 3) return x*x*x;\n    if (y === 4) return x*x*x*x;\n    let signResult = 1;\n    if (x < 0) {\n        x *= -1;\n        signResult = mathPow(-1, y);\n    }\n    const absPow = globalThis.CroquetMath.exp(globalThis.CroquetMath.log(x) * y);\n    return absPow * signResult;\n    };\n", "import FastPriorityQueue from \"fastpriorityqueue\";\n\nexport default class PriorityQueue extends FastPriorityQueue {\n    poll() {\n        const result = super.poll();\n        this.array[this.size] = null; // release memory\n        return result;\n    }\n\n    asArray() {\n        const array = [];\n        this.forEach(item => array.push(item));\n        return array;\n    }\n\n    asUnsortedArray() {\n        return this.array.slice(0, this.size);\n    }\n}\n", ";(function (root, factory) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory(require(\"./core\"));\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([\"./core\"], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\tfactory(root.CryptoJS);\n\t}\n}(this, function (CryptoJS) {\n\n\t(function () {\n\t    // Shortcuts\n\t    var C = CryptoJS;\n\t    var C_lib = C.lib;\n\t    var WordArray = C_lib.WordArray;\n\t    var C_enc = C.enc;\n\n\t    /**\n\t     * Base64 encoding strategy.\n\t     */\n\t    var Base64 = C_enc.Base64 = {\n\t        /**\n\t         * Converts a word array to a Base64 string.\n\t         *\n\t         * @param {WordArray} wordArray The word array.\n\t         *\n\t         * @return {string} The Base64 string.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var base64String = CryptoJS.enc.Base64.stringify(wordArray);\n\t         */\n\t        stringify: function (wordArray) {\n\t            // Shortcuts\n\t            var words = wordArray.words;\n\t            var sigBytes = wordArray.sigBytes;\n\t            var map = this._map;\n\n\t            // Clamp excess bits\n\t            wordArray.clamp();\n\n\t            // Convert\n\t            var base64Chars = [];\n\t            for (var i = 0; i < sigBytes; i += 3) {\n\t                var byte1 = (words[i >>> 2]       >>> (24 - (i % 4) * 8))       & 0xff;\n\t                var byte2 = (words[(i + 1) >>> 2] >>> (24 - ((i + 1) % 4) * 8)) & 0xff;\n\t                var byte3 = (words[(i + 2) >>> 2] >>> (24 - ((i + 2) % 4) * 8)) & 0xff;\n\n\t                var triplet = (byte1 << 16) | (byte2 << 8) | byte3;\n\n\t                for (var j = 0; (j < 4) && (i + j * 0.75 < sigBytes); j++) {\n\t                    base64Chars.push(map.charAt((triplet >>> (6 * (3 - j))) & 0x3f));\n\t                }\n\t            }\n\n\t            // Add padding\n\t            var paddingChar = map.charAt(64);\n\t            if (paddingChar) {\n\t                while (base64Chars.length % 4) {\n\t                    base64Chars.push(paddingChar);\n\t                }\n\t            }\n\n\t            return base64Chars.join('');\n\t        },\n\n\t        /**\n\t         * Converts a Base64 string to a word array.\n\t         *\n\t         * @param {string} base64Str The Base64 string.\n\t         *\n\t         * @return {WordArray} The word array.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.enc.Base64.parse(base64String);\n\t         */\n\t        parse: function (base64Str) {\n\t            // Shortcuts\n\t            var base64StrLength = base64Str.length;\n\t            var map = this._map;\n\t            var reverseMap = this._reverseMap;\n\n\t            if (!reverseMap) {\n\t                    reverseMap = this._reverseMap = [];\n\t                    for (var j = 0; j < map.length; j++) {\n\t                        reverseMap[map.charCodeAt(j)] = j;\n\t                    }\n\t            }\n\n\t            // Ignore padding\n\t            var paddingChar = map.charAt(64);\n\t            if (paddingChar) {\n\t                var paddingIndex = base64Str.indexOf(paddingChar);\n\t                if (paddingIndex !== -1) {\n\t                    base64StrLength = paddingIndex;\n\t                }\n\t            }\n\n\t            // Convert\n\t            return parseLoop(base64Str, base64StrLength, reverseMap);\n\n\t        },\n\n\t        _map: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='\n\t    };\n\n\t    function parseLoop(base64Str, base64StrLength, reverseMap) {\n\t      var words = [];\n\t      var nBytes = 0;\n\t      for (var i = 0; i < base64StrLength; i++) {\n\t          if (i % 4) {\n\t              var bits1 = reverseMap[base64Str.charCodeAt(i - 1)] << ((i % 4) * 2);\n\t              var bits2 = reverseMap[base64Str.charCodeAt(i)] >>> (6 - (i % 4) * 2);\n\t              var bitsCombined = bits1 | bits2;\n\t              words[nBytes >>> 2] |= bitsCombined << (24 - (nBytes % 4) * 8);\n\t              nBytes++;\n\t          }\n\t      }\n\t      return WordArray.create(words, nBytes);\n\t    }\n\t}());\n\n\n\treturn CryptoJS.enc.Base64;\n\n}));", ";(function (root, factory) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory(require(\"./core\"));\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([\"./core\"], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\tfactory(root.CryptoJS);\n\t}\n}(this, function (CryptoJS) {\n\n\treturn CryptoJS.enc.Utf8;\n\n}));", ";(function (root, factory) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory(require(\"./core\"));\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([\"./core\"], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\tfactory(root.CryptoJS);\n\t}\n}(this, function (CryptoJS) {\n\n\t(function () {\n\t    // Shortcuts\n\t    var C = CryptoJS;\n\t    var C_lib = C.lib;\n\t    var Base = C_lib.Base;\n\t    var C_enc = C.enc;\n\t    var Utf8 = C_enc.Utf8;\n\t    var C_algo = C.algo;\n\n\t    /**\n\t     * HMAC algorithm.\n\t     */\n\t    var HMAC = C_algo.HMAC = Base.extend({\n\t        /**\n\t         * Initializes a newly created HMAC.\n\t         *\n\t         * @param {Hasher} hasher The hash algorithm to use.\n\t         * @param {WordArray|string} key The secret key.\n\t         *\n\t         * @example\n\t         *\n\t         *     var hmacHasher = CryptoJS.algo.HMAC.create(CryptoJS.algo.SHA256, key);\n\t         */\n\t        init: function (hasher, key) {\n\t            // Init hasher\n\t            hasher = this._hasher = new hasher.init();\n\n\t            // Convert string to WordArray, else assume WordArray already\n\t            if (typeof key == 'string') {\n\t                key = Utf8.parse(key);\n\t            }\n\n\t            // Shortcuts\n\t            var hasherBlockSize = hasher.blockSize;\n\t            var hasherBlockSizeBytes = hasherBlockSize * 4;\n\n\t            // Allow arbitrary length keys\n\t            if (key.sigBytes > hasherBlockSizeBytes) {\n\t                key = hasher.finalize(key);\n\t            }\n\n\t            // Clamp excess bits\n\t            key.clamp();\n\n\t            // Clone key for inner and outer pads\n\t            var oKey = this._oKey = key.clone();\n\t            var iKey = this._iKey = key.clone();\n\n\t            // Shortcuts\n\t            var oKeyWords = oKey.words;\n\t            var iKeyWords = iKey.words;\n\n\t            // XOR keys with pad constants\n\t            for (var i = 0; i < hasherBlockSize; i++) {\n\t                oKeyWords[i] ^= 0x5c5c5c5c;\n\t                iKeyWords[i] ^= 0x36363636;\n\t            }\n\t            oKey.sigBytes = iKey.sigBytes = hasherBlockSizeBytes;\n\n\t            // Set initial values\n\t            this.reset();\n\t        },\n\n\t        /**\n\t         * Resets this HMAC to its initial state.\n\t         *\n\t         * @example\n\t         *\n\t         *     hmacHasher.reset();\n\t         */\n\t        reset: function () {\n\t            // Shortcut\n\t            var hasher = this._hasher;\n\n\t            // Reset\n\t            hasher.reset();\n\t            hasher.update(this._iKey);\n\t        },\n\n\t        /**\n\t         * Updates this HMAC with a message.\n\t         *\n\t         * @param {WordArray|string} messageUpdate The message to append.\n\t         *\n\t         * @return {HMAC} This HMAC instance.\n\t         *\n\t         * @example\n\t         *\n\t         *     hmacHasher.update('message');\n\t         *     hmacHasher.update(wordArray);\n\t         */\n\t        update: function (messageUpdate) {\n\t            this._hasher.update(messageUpdate);\n\n\t            // Chainable\n\t            return this;\n\t        },\n\n\t        /**\n\t         * Finalizes the HMAC computation.\n\t         * Note that the finalize operation is effectively a destructive, read-once operation.\n\t         *\n\t         * @param {WordArray|string} messageUpdate (Optional) A final message update.\n\t         *\n\t         * @return {WordArray} The HMAC.\n\t         *\n\t         * @example\n\t         *\n\t         *     var hmac = hmacHasher.finalize();\n\t         *     var hmac = hmacHasher.finalize('message');\n\t         *     var hmac = hmacHasher.finalize(wordArray);\n\t         */\n\t        finalize: function (messageUpdate) {\n\t            // Shortcut\n\t            var hasher = this._hasher;\n\n\t            // Compute HMAC\n\t            var innerHash = hasher.finalize(messageUpdate);\n\t            hasher.reset();\n\t            var hmac = hasher.finalize(this._oKey.clone().concat(innerHash));\n\n\t            return hmac;\n\t        }\n\t    });\n\t}());\n\n\n}));", ";(function (root, factory, undef) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory(require(\"./core\"), require(\"./sha256\"), require(\"./hmac\"));\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([\"./core\", \"./sha256\", \"./hmac\"], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\tfactory(root.CryptoJS);\n\t}\n}(this, function (CryptoJS) {\n\n\t(function () {\n\t    // Shortcuts\n\t    var C = CryptoJS;\n\t    var C_lib = C.lib;\n\t    var Base = C_lib.Base;\n\t    var WordArray = C_lib.WordArray;\n\t    var C_algo = C.algo;\n\t    var SHA256 = C_algo.SHA256;\n\t    var HMAC = C_algo.HMAC;\n\n\t    /**\n\t     * Password-Based Key Derivation Function 2 algorithm.\n\t     */\n\t    var PBKDF2 = C_algo.PBKDF2 = Base.extend({\n\t        /**\n\t         * Configuration options.\n\t         *\n\t         * @property {number} keySize The key size in words to generate. Default: 4 (128 bits)\n\t         * @property {Hasher} hasher The hasher to use. Default: SHA256\n\t         * @property {number} iterations The number of iterations to perform. Default: 250000\n\t         */\n\t        cfg: Base.extend({\n\t            keySize: 128/32,\n\t            hasher: SHA256,\n\t            iterations: 250000\n\t        }),\n\n\t        /**\n\t         * Initializes a newly created key derivation function.\n\t         *\n\t         * @param {Object} cfg (Optional) The configuration options to use for the derivation.\n\t         *\n\t         * @example\n\t         *\n\t         *     var kdf = CryptoJS.algo.PBKDF2.create();\n\t         *     var kdf = CryptoJS.algo.PBKDF2.create({ keySize: 8 });\n\t         *     var kdf = CryptoJS.algo.PBKDF2.create({ keySize: 8, iterations: 1000 });\n\t         */\n\t        init: function (cfg) {\n\t            this.cfg = this.cfg.extend(cfg);\n\t        },\n\n\t        /**\n\t         * Computes the Password-Based Key Derivation Function 2.\n\t         *\n\t         * @param {WordArray|string} password The password.\n\t         * @param {WordArray|string} salt A salt.\n\t         *\n\t         * @return {WordArray} The derived key.\n\t         *\n\t         * @example\n\t         *\n\t         *     var key = kdf.compute(password, salt);\n\t         */\n\t        compute: function (password, salt) {\n\t            // Shortcut\n\t            var cfg = this.cfg;\n\n\t            // Init HMAC\n\t            var hmac = HMAC.create(cfg.hasher, password);\n\n\t            // Initial values\n\t            var derivedKey = WordArray.create();\n\t            var blockIndex = WordArray.create([0x00000001]);\n\n\t            // Shortcuts\n\t            var derivedKeyWords = derivedKey.words;\n\t            var blockIndexWords = blockIndex.words;\n\t            var keySize = cfg.keySize;\n\t            var iterations = cfg.iterations;\n\n\t            // Generate key\n\t            while (derivedKeyWords.length < keySize) {\n\t                var block = hmac.update(salt).finalize(blockIndex);\n\t                hmac.reset();\n\n\t                // Shortcuts\n\t                var blockWords = block.words;\n\t                var blockWordsLength = blockWords.length;\n\n\t                // Iterations\n\t                var intermediate = block;\n\t                for (var i = 1; i < iterations; i++) {\n\t                    intermediate = hmac.finalize(intermediate);\n\t                    hmac.reset();\n\n\t                    // Shortcut\n\t                    var intermediateWords = intermediate.words;\n\n\t                    // XOR intermediate with block\n\t                    for (var j = 0; j < blockWordsLength; j++) {\n\t                        blockWords[j] ^= intermediateWords[j];\n\t                    }\n\t                }\n\n\t                derivedKey.concat(block);\n\t                blockIndexWords[0]++;\n\t            }\n\t            derivedKey.sigBytes = keySize * 4;\n\n\t            return derivedKey;\n\t        }\n\t    });\n\n\t    /**\n\t     * Computes the Password-Based Key Derivation Function 2.\n\t     *\n\t     * @param {WordArray|string} password The password.\n\t     * @param {WordArray|string} salt A salt.\n\t     * @param {Object} cfg (Optional) The configuration options to use for this computation.\n\t     *\n\t     * @return {WordArray} The derived key.\n\t     *\n\t     * @static\n\t     *\n\t     * @example\n\t     *\n\t     *     var key = CryptoJS.PBKDF2(password, salt);\n\t     *     var key = CryptoJS.PBKDF2(password, salt, { keySize: 8 });\n\t     *     var key = CryptoJS.PBKDF2(password, salt, { keySize: 8, iterations: 1000 });\n\t     */\n\t    C.PBKDF2 = function (password, salt, cfg) {\n\t        return PBKDF2.create(cfg).compute(password, salt);\n\t    };\n\t}());\n\n\n\treturn CryptoJS.PBKDF2;\n\n}));", ";(function (root, factory) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory(require(\"./core\"));\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([\"./core\"], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\tfactory(root.CryptoJS);\n\t}\n}(this, function (CryptoJS) {\n\n\t(function (Math) {\n\t    // Shortcuts\n\t    var C = CryptoJS;\n\t    var C_lib = C.lib;\n\t    var WordArray = C_lib.WordArray;\n\t    var Hasher = C_lib.Hasher;\n\t    var C_algo = C.algo;\n\n\t    // Constants table\n\t    var T = [];\n\n\t    // Compute constants\n\t    (function () {\n\t        for (var i = 0; i < 64; i++) {\n\t            T[i] = (Math.abs(Math.sin(i + 1)) * 0x100000000) | 0;\n\t        }\n\t    }());\n\n\t    /**\n\t     * MD5 hash algorithm.\n\t     */\n\t    var MD5 = C_algo.MD5 = Hasher.extend({\n\t        _doReset: function () {\n\t            this._hash = new WordArray.init([\n\t                0x67452301, 0xefcdab89,\n\t                0x98badcfe, 0x10325476\n\t            ]);\n\t        },\n\n\t        _doProcessBlock: function (M, offset) {\n\t            // Swap endian\n\t            for (var i = 0; i < 16; i++) {\n\t                // Shortcuts\n\t                var offset_i = offset + i;\n\t                var M_offset_i = M[offset_i];\n\n\t                M[offset_i] = (\n\t                    (((M_offset_i << 8)  | (M_offset_i >>> 24)) & 0x00ff00ff) |\n\t                    (((M_offset_i << 24) | (M_offset_i >>> 8))  & 0xff00ff00)\n\t                );\n\t            }\n\n\t            // Shortcuts\n\t            var H = this._hash.words;\n\n\t            var M_offset_0  = M[offset + 0];\n\t            var M_offset_1  = M[offset + 1];\n\t            var M_offset_2  = M[offset + 2];\n\t            var M_offset_3  = M[offset + 3];\n\t            var M_offset_4  = M[offset + 4];\n\t            var M_offset_5  = M[offset + 5];\n\t            var M_offset_6  = M[offset + 6];\n\t            var M_offset_7  = M[offset + 7];\n\t            var M_offset_8  = M[offset + 8];\n\t            var M_offset_9  = M[offset + 9];\n\t            var M_offset_10 = M[offset + 10];\n\t            var M_offset_11 = M[offset + 11];\n\t            var M_offset_12 = M[offset + 12];\n\t            var M_offset_13 = M[offset + 13];\n\t            var M_offset_14 = M[offset + 14];\n\t            var M_offset_15 = M[offset + 15];\n\n\t            // Working variables\n\t            var a = H[0];\n\t            var b = H[1];\n\t            var c = H[2];\n\t            var d = H[3];\n\n\t            // Computation\n\t            a = FF(a, b, c, d, M_offset_0,  7,  T[0]);\n\t            d = FF(d, a, b, c, M_offset_1,  12, T[1]);\n\t            c = FF(c, d, a, b, M_offset_2,  17, T[2]);\n\t            b = FF(b, c, d, a, M_offset_3,  22, T[3]);\n\t            a = FF(a, b, c, d, M_offset_4,  7,  T[4]);\n\t            d = FF(d, a, b, c, M_offset_5,  12, T[5]);\n\t            c = FF(c, d, a, b, M_offset_6,  17, T[6]);\n\t            b = FF(b, c, d, a, M_offset_7,  22, T[7]);\n\t            a = FF(a, b, c, d, M_offset_8,  7,  T[8]);\n\t            d = FF(d, a, b, c, M_offset_9,  12, T[9]);\n\t            c = FF(c, d, a, b, M_offset_10, 17, T[10]);\n\t            b = FF(b, c, d, a, M_offset_11, 22, T[11]);\n\t            a = FF(a, b, c, d, M_offset_12, 7,  T[12]);\n\t            d = FF(d, a, b, c, M_offset_13, 12, T[13]);\n\t            c = FF(c, d, a, b, M_offset_14, 17, T[14]);\n\t            b = FF(b, c, d, a, M_offset_15, 22, T[15]);\n\n\t            a = GG(a, b, c, d, M_offset_1,  5,  T[16]);\n\t            d = GG(d, a, b, c, M_offset_6,  9,  T[17]);\n\t            c = GG(c, d, a, b, M_offset_11, 14, T[18]);\n\t            b = GG(b, c, d, a, M_offset_0,  20, T[19]);\n\t            a = GG(a, b, c, d, M_offset_5,  5,  T[20]);\n\t            d = GG(d, a, b, c, M_offset_10, 9,  T[21]);\n\t            c = GG(c, d, a, b, M_offset_15, 14, T[22]);\n\t            b = GG(b, c, d, a, M_offset_4,  20, T[23]);\n\t            a = GG(a, b, c, d, M_offset_9,  5,  T[24]);\n\t            d = GG(d, a, b, c, M_offset_14, 9,  T[25]);\n\t            c = GG(c, d, a, b, M_offset_3,  14, T[26]);\n\t            b = GG(b, c, d, a, M_offset_8,  20, T[27]);\n\t            a = GG(a, b, c, d, M_offset_13, 5,  T[28]);\n\t            d = GG(d, a, b, c, M_offset_2,  9,  T[29]);\n\t            c = GG(c, d, a, b, M_offset_7,  14, T[30]);\n\t            b = GG(b, c, d, a, M_offset_12, 20, T[31]);\n\n\t            a = HH(a, b, c, d, M_offset_5,  4,  T[32]);\n\t            d = HH(d, a, b, c, M_offset_8,  11, T[33]);\n\t            c = HH(c, d, a, b, M_offset_11, 16, T[34]);\n\t            b = HH(b, c, d, a, M_offset_14, 23, T[35]);\n\t            a = HH(a, b, c, d, M_offset_1,  4,  T[36]);\n\t            d = HH(d, a, b, c, M_offset_4,  11, T[37]);\n\t            c = HH(c, d, a, b, M_offset_7,  16, T[38]);\n\t            b = HH(b, c, d, a, M_offset_10, 23, T[39]);\n\t            a = HH(a, b, c, d, M_offset_13, 4,  T[40]);\n\t            d = HH(d, a, b, c, M_offset_0,  11, T[41]);\n\t            c = HH(c, d, a, b, M_offset_3,  16, T[42]);\n\t            b = HH(b, c, d, a, M_offset_6,  23, T[43]);\n\t            a = HH(a, b, c, d, M_offset_9,  4,  T[44]);\n\t            d = HH(d, a, b, c, M_offset_12, 11, T[45]);\n\t            c = HH(c, d, a, b, M_offset_15, 16, T[46]);\n\t            b = HH(b, c, d, a, M_offset_2,  23, T[47]);\n\n\t            a = II(a, b, c, d, M_offset_0,  6,  T[48]);\n\t            d = II(d, a, b, c, M_offset_7,  10, T[49]);\n\t            c = II(c, d, a, b, M_offset_14, 15, T[50]);\n\t            b = II(b, c, d, a, M_offset_5,  21, T[51]);\n\t            a = II(a, b, c, d, M_offset_12, 6,  T[52]);\n\t            d = II(d, a, b, c, M_offset_3,  10, T[53]);\n\t            c = II(c, d, a, b, M_offset_10, 15, T[54]);\n\t            b = II(b, c, d, a, M_offset_1,  21, T[55]);\n\t            a = II(a, b, c, d, M_offset_8,  6,  T[56]);\n\t            d = II(d, a, b, c, M_offset_15, 10, T[57]);\n\t            c = II(c, d, a, b, M_offset_6,  15, T[58]);\n\t            b = II(b, c, d, a, M_offset_13, 21, T[59]);\n\t            a = II(a, b, c, d, M_offset_4,  6,  T[60]);\n\t            d = II(d, a, b, c, M_offset_11, 10, T[61]);\n\t            c = II(c, d, a, b, M_offset_2,  15, T[62]);\n\t            b = II(b, c, d, a, M_offset_9,  21, T[63]);\n\n\t            // Intermediate hash value\n\t            H[0] = (H[0] + a) | 0;\n\t            H[1] = (H[1] + b) | 0;\n\t            H[2] = (H[2] + c) | 0;\n\t            H[3] = (H[3] + d) | 0;\n\t        },\n\n\t        _doFinalize: function () {\n\t            // Shortcuts\n\t            var data = this._data;\n\t            var dataWords = data.words;\n\n\t            var nBitsTotal = this._nDataBytes * 8;\n\t            var nBitsLeft = data.sigBytes * 8;\n\n\t            // Add padding\n\t            dataWords[nBitsLeft >>> 5] |= 0x80 << (24 - nBitsLeft % 32);\n\n\t            var nBitsTotalH = Math.floor(nBitsTotal / 0x100000000);\n\t            var nBitsTotalL = nBitsTotal;\n\t            dataWords[(((nBitsLeft + 64) >>> 9) << 4) + 15] = (\n\t                (((nBitsTotalH << 8)  | (nBitsTotalH >>> 24)) & 0x00ff00ff) |\n\t                (((nBitsTotalH << 24) | (nBitsTotalH >>> 8))  & 0xff00ff00)\n\t            );\n\t            dataWords[(((nBitsLeft + 64) >>> 9) << 4) + 14] = (\n\t                (((nBitsTotalL << 8)  | (nBitsTotalL >>> 24)) & 0x00ff00ff) |\n\t                (((nBitsTotalL << 24) | (nBitsTotalL >>> 8))  & 0xff00ff00)\n\t            );\n\n\t            data.sigBytes = (dataWords.length + 1) * 4;\n\n\t            // Hash final blocks\n\t            this._process();\n\n\t            // Shortcuts\n\t            var hash = this._hash;\n\t            var H = hash.words;\n\n\t            // Swap endian\n\t            for (var i = 0; i < 4; i++) {\n\t                // Shortcut\n\t                var H_i = H[i];\n\n\t                H[i] = (((H_i << 8)  | (H_i >>> 24)) & 0x00ff00ff) |\n\t                       (((H_i << 24) | (H_i >>> 8))  & 0xff00ff00);\n\t            }\n\n\t            // Return final computed hash\n\t            return hash;\n\t        },\n\n\t        clone: function () {\n\t            var clone = Hasher.clone.call(this);\n\t            clone._hash = this._hash.clone();\n\n\t            return clone;\n\t        }\n\t    });\n\n\t    function FF(a, b, c, d, x, s, t) {\n\t        var n = a + ((b & c) | (~b & d)) + x + t;\n\t        return ((n << s) | (n >>> (32 - s))) + b;\n\t    }\n\n\t    function GG(a, b, c, d, x, s, t) {\n\t        var n = a + ((b & d) | (c & ~d)) + x + t;\n\t        return ((n << s) | (n >>> (32 - s))) + b;\n\t    }\n\n\t    function HH(a, b, c, d, x, s, t) {\n\t        var n = a + (b ^ c ^ d) + x + t;\n\t        return ((n << s) | (n >>> (32 - s))) + b;\n\t    }\n\n\t    function II(a, b, c, d, x, s, t) {\n\t        var n = a + (c ^ (b | ~d)) + x + t;\n\t        return ((n << s) | (n >>> (32 - s))) + b;\n\t    }\n\n\t    /**\n\t     * Shortcut function to the hasher's object interface.\n\t     *\n\t     * @param {WordArray|string} message The message to hash.\n\t     *\n\t     * @return {WordArray} The hash.\n\t     *\n\t     * @static\n\t     *\n\t     * @example\n\t     *\n\t     *     var hash = CryptoJS.MD5('message');\n\t     *     var hash = CryptoJS.MD5(wordArray);\n\t     */\n\t    C.MD5 = Hasher._createHelper(MD5);\n\n\t    /**\n\t     * Shortcut function to the HMAC's object interface.\n\t     *\n\t     * @param {WordArray|string} message The message to hash.\n\t     * @param {WordArray|string} key The secret key.\n\t     *\n\t     * @return {WordArray} The HMAC.\n\t     *\n\t     * @static\n\t     *\n\t     * @example\n\t     *\n\t     *     var hmac = CryptoJS.HmacMD5(message, key);\n\t     */\n\t    C.HmacMD5 = Hasher._createHmacHelper(MD5);\n\t}(Math));\n\n\n\treturn CryptoJS.MD5;\n\n}));", ";(function (root, factory) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory(require(\"./core\"));\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([\"./core\"], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\tfactory(root.CryptoJS);\n\t}\n}(this, function (CryptoJS) {\n\n\t(function () {\n\t    // Shortcuts\n\t    var C = CryptoJS;\n\t    var C_lib = C.lib;\n\t    var WordArray = C_lib.WordArray;\n\t    var Hasher = C_lib.Hasher;\n\t    var C_algo = C.algo;\n\n\t    // Reusable object\n\t    var W = [];\n\n\t    /**\n\t     * SHA-1 hash algorithm.\n\t     */\n\t    var SHA1 = C_algo.SHA1 = Hasher.extend({\n\t        _doReset: function () {\n\t            this._hash = new WordArray.init([\n\t                0x67452301, 0xefcdab89,\n\t                0x98badcfe, 0x10325476,\n\t                0xc3d2e1f0\n\t            ]);\n\t        },\n\n\t        _doProcessBlock: function (M, offset) {\n\t            // Shortcut\n\t            var H = this._hash.words;\n\n\t            // Working variables\n\t            var a = H[0];\n\t            var b = H[1];\n\t            var c = H[2];\n\t            var d = H[3];\n\t            var e = H[4];\n\n\t            // Computation\n\t            for (var i = 0; i < 80; i++) {\n\t                if (i < 16) {\n\t                    W[i] = M[offset + i] | 0;\n\t                } else {\n\t                    var n = W[i - 3] ^ W[i - 8] ^ W[i - 14] ^ W[i - 16];\n\t                    W[i] = (n << 1) | (n >>> 31);\n\t                }\n\n\t                var t = ((a << 5) | (a >>> 27)) + e + W[i];\n\t                if (i < 20) {\n\t                    t += ((b & c) | (~b & d)) + 0x5a827999;\n\t                } else if (i < 40) {\n\t                    t += (b ^ c ^ d) + 0x6ed9eba1;\n\t                } else if (i < 60) {\n\t                    t += ((b & c) | (b & d) | (c & d)) - 0x70e44324;\n\t                } else /* if (i < 80) */ {\n\t                    t += (b ^ c ^ d) - 0x359d3e2a;\n\t                }\n\n\t                e = d;\n\t                d = c;\n\t                c = (b << 30) | (b >>> 2);\n\t                b = a;\n\t                a = t;\n\t            }\n\n\t            // Intermediate hash value\n\t            H[0] = (H[0] + a) | 0;\n\t            H[1] = (H[1] + b) | 0;\n\t            H[2] = (H[2] + c) | 0;\n\t            H[3] = (H[3] + d) | 0;\n\t            H[4] = (H[4] + e) | 0;\n\t        },\n\n\t        _doFinalize: function () {\n\t            // Shortcuts\n\t            var data = this._data;\n\t            var dataWords = data.words;\n\n\t            var nBitsTotal = this._nDataBytes * 8;\n\t            var nBitsLeft = data.sigBytes * 8;\n\n\t            // Add padding\n\t            dataWords[nBitsLeft >>> 5] |= 0x80 << (24 - nBitsLeft % 32);\n\t            dataWords[(((nBitsLeft + 64) >>> 9) << 4) + 14] = Math.floor(nBitsTotal / 0x100000000);\n\t            dataWords[(((nBitsLeft + 64) >>> 9) << 4) + 15] = nBitsTotal;\n\t            data.sigBytes = dataWords.length * 4;\n\n\t            // Hash final blocks\n\t            this._process();\n\n\t            // Return final computed hash\n\t            return this._hash;\n\t        },\n\n\t        clone: function () {\n\t            var clone = Hasher.clone.call(this);\n\t            clone._hash = this._hash.clone();\n\n\t            return clone;\n\t        }\n\t    });\n\n\t    /**\n\t     * Shortcut function to the hasher's object interface.\n\t     *\n\t     * @param {WordArray|string} message The message to hash.\n\t     *\n\t     * @return {WordArray} The hash.\n\t     *\n\t     * @static\n\t     *\n\t     * @example\n\t     *\n\t     *     var hash = CryptoJS.SHA1('message');\n\t     *     var hash = CryptoJS.SHA1(wordArray);\n\t     */\n\t    C.SHA1 = Hasher._createHelper(SHA1);\n\n\t    /**\n\t     * Shortcut function to the HMAC's object interface.\n\t     *\n\t     * @param {WordArray|string} message The message to hash.\n\t     * @param {WordArray|string} key The secret key.\n\t     *\n\t     * @return {WordArray} The HMAC.\n\t     *\n\t     * @static\n\t     *\n\t     * @example\n\t     *\n\t     *     var hmac = CryptoJS.HmacSHA1(message, key);\n\t     */\n\t    C.HmacSHA1 = Hasher._createHmacHelper(SHA1);\n\t}());\n\n\n\treturn CryptoJS.SHA1;\n\n}));", ";(function (root, factory, undef) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory(require(\"./core\"), require(\"./sha1\"), require(\"./hmac\"));\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([\"./core\", \"./sha1\", \"./hmac\"], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\tfactory(root.CryptoJS);\n\t}\n}(this, function (CryptoJS) {\n\n\t(function () {\n\t    // Shortcuts\n\t    var C = CryptoJS;\n\t    var C_lib = C.lib;\n\t    var Base = C_lib.Base;\n\t    var WordArray = C_lib.WordArray;\n\t    var C_algo = C.algo;\n\t    var MD5 = C_algo.MD5;\n\n\t    /**\n\t     * This key derivation function is meant to conform with EVP_BytesToKey.\n\t     * www.openssl.org/docs/crypto/EVP_BytesToKey.html\n\t     */\n\t    var EvpKDF = C_algo.EvpKDF = Base.extend({\n\t        /**\n\t         * Configuration options.\n\t         *\n\t         * @property {number} keySize The key size in words to generate. Default: 4 (128 bits)\n\t         * @property {Hasher} hasher The hash algorithm to use. Default: MD5\n\t         * @property {number} iterations The number of iterations to perform. Default: 1\n\t         */\n\t        cfg: Base.extend({\n\t            keySize: 128/32,\n\t            hasher: MD5,\n\t            iterations: 1\n\t        }),\n\n\t        /**\n\t         * Initializes a newly created key derivation function.\n\t         *\n\t         * @param {Object} cfg (Optional) The configuration options to use for the derivation.\n\t         *\n\t         * @example\n\t         *\n\t         *     var kdf = CryptoJS.algo.EvpKDF.create();\n\t         *     var kdf = CryptoJS.algo.EvpKDF.create({ keySize: 8 });\n\t         *     var kdf = CryptoJS.algo.EvpKDF.create({ keySize: 8, iterations: 1000 });\n\t         */\n\t        init: function (cfg) {\n\t            this.cfg = this.cfg.extend(cfg);\n\t        },\n\n\t        /**\n\t         * Derives a key from a password.\n\t         *\n\t         * @param {WordArray|string} password The password.\n\t         * @param {WordArray|string} salt A salt.\n\t         *\n\t         * @return {WordArray} The derived key.\n\t         *\n\t         * @example\n\t         *\n\t         *     var key = kdf.compute(password, salt);\n\t         */\n\t        compute: function (password, salt) {\n\t            var block;\n\n\t            // Shortcut\n\t            var cfg = this.cfg;\n\n\t            // Init hasher\n\t            var hasher = cfg.hasher.create();\n\n\t            // Initial values\n\t            var derivedKey = WordArray.create();\n\n\t            // Shortcuts\n\t            var derivedKeyWords = derivedKey.words;\n\t            var keySize = cfg.keySize;\n\t            var iterations = cfg.iterations;\n\n\t            // Generate key\n\t            while (derivedKeyWords.length < keySize) {\n\t                if (block) {\n\t                    hasher.update(block);\n\t                }\n\t                block = hasher.update(password).finalize(salt);\n\t                hasher.reset();\n\n\t                // Iterations\n\t                for (var i = 1; i < iterations; i++) {\n\t                    block = hasher.finalize(block);\n\t                    hasher.reset();\n\t                }\n\n\t                derivedKey.concat(block);\n\t            }\n\t            derivedKey.sigBytes = keySize * 4;\n\n\t            return derivedKey;\n\t        }\n\t    });\n\n\t    /**\n\t     * Derives a key from a password.\n\t     *\n\t     * @param {WordArray|string} password The password.\n\t     * @param {WordArray|string} salt A salt.\n\t     * @param {Object} cfg (Optional) The configuration options to use for this computation.\n\t     *\n\t     * @return {WordArray} The derived key.\n\t     *\n\t     * @static\n\t     *\n\t     * @example\n\t     *\n\t     *     var key = CryptoJS.EvpKDF(password, salt);\n\t     *     var key = CryptoJS.EvpKDF(password, salt, { keySize: 8 });\n\t     *     var key = CryptoJS.EvpKDF(password, salt, { keySize: 8, iterations: 1000 });\n\t     */\n\t    C.EvpKDF = function (password, salt, cfg) {\n\t        return EvpKDF.create(cfg).compute(password, salt);\n\t    };\n\t}());\n\n\n\treturn CryptoJS.EvpKDF;\n\n}));", ";(function (root, factory, undef) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory(require(\"./core\"), require(\"./enc-base64\"), require(\"./md5\"), require(\"./evpkdf\"), require(\"./cipher-core\"));\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([\"./core\", \"./enc-base64\", \"./md5\", \"./evpkdf\", \"./cipher-core\"], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\tfactory(root.CryptoJS);\n\t}\n}(this, function (CryptoJS) {\n\n\t(function () {\n\t    // Shortcuts\n\t    var C = CryptoJS;\n\t    var C_lib = C.lib;\n\t    var BlockCipher = C_lib.BlockCipher;\n\t    var C_algo = C.algo;\n\n\t    // Lookup tables\n\t    var SBOX = [];\n\t    var INV_SBOX = [];\n\t    var SUB_MIX_0 = [];\n\t    var SUB_MIX_1 = [];\n\t    var SUB_MIX_2 = [];\n\t    var SUB_MIX_3 = [];\n\t    var INV_SUB_MIX_0 = [];\n\t    var INV_SUB_MIX_1 = [];\n\t    var INV_SUB_MIX_2 = [];\n\t    var INV_SUB_MIX_3 = [];\n\n\t    // Compute lookup tables\n\t    (function () {\n\t        // Compute double table\n\t        var d = [];\n\t        for (var i = 0; i < 256; i++) {\n\t            if (i < 128) {\n\t                d[i] = i << 1;\n\t            } else {\n\t                d[i] = (i << 1) ^ 0x11b;\n\t            }\n\t        }\n\n\t        // Walk GF(2^8)\n\t        var x = 0;\n\t        var xi = 0;\n\t        for (var i = 0; i < 256; i++) {\n\t            // Compute sbox\n\t            var sx = xi ^ (xi << 1) ^ (xi << 2) ^ (xi << 3) ^ (xi << 4);\n\t            sx = (sx >>> 8) ^ (sx & 0xff) ^ 0x63;\n\t            SBOX[x] = sx;\n\t            INV_SBOX[sx] = x;\n\n\t            // Compute multiplication\n\t            var x2 = d[x];\n\t            var x4 = d[x2];\n\t            var x8 = d[x4];\n\n\t            // Compute sub bytes, mix columns tables\n\t            var t = (d[sx] * 0x101) ^ (sx * 0x1010100);\n\t            SUB_MIX_0[x] = (t << 24) | (t >>> 8);\n\t            SUB_MIX_1[x] = (t << 16) | (t >>> 16);\n\t            SUB_MIX_2[x] = (t << 8)  | (t >>> 24);\n\t            SUB_MIX_3[x] = t;\n\n\t            // Compute inv sub bytes, inv mix columns tables\n\t            var t = (x8 * 0x1010101) ^ (x4 * 0x10001) ^ (x2 * 0x101) ^ (x * 0x1010100);\n\t            INV_SUB_MIX_0[sx] = (t << 24) | (t >>> 8);\n\t            INV_SUB_MIX_1[sx] = (t << 16) | (t >>> 16);\n\t            INV_SUB_MIX_2[sx] = (t << 8)  | (t >>> 24);\n\t            INV_SUB_MIX_3[sx] = t;\n\n\t            // Compute next counter\n\t            if (!x) {\n\t                x = xi = 1;\n\t            } else {\n\t                x = x2 ^ d[d[d[x8 ^ x2]]];\n\t                xi ^= d[d[xi]];\n\t            }\n\t        }\n\t    }());\n\n\t    // Precomputed Rcon lookup\n\t    var RCON = [0x00, 0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80, 0x1b, 0x36];\n\n\t    /**\n\t     * AES block cipher algorithm.\n\t     */\n\t    var AES = C_algo.AES = BlockCipher.extend({\n\t        _doReset: function () {\n\t            var t;\n\n\t            // Skip reset of nRounds has been set before and key did not change\n\t            if (this._nRounds && this._keyPriorReset === this._key) {\n\t                return;\n\t            }\n\n\t            // Shortcuts\n\t            var key = this._keyPriorReset = this._key;\n\t            var keyWords = key.words;\n\t            var keySize = key.sigBytes / 4;\n\n\t            // Compute number of rounds\n\t            var nRounds = this._nRounds = keySize + 6;\n\n\t            // Compute number of key schedule rows\n\t            var ksRows = (nRounds + 1) * 4;\n\n\t            // Compute key schedule\n\t            var keySchedule = this._keySchedule = [];\n\t            for (var ksRow = 0; ksRow < ksRows; ksRow++) {\n\t                if (ksRow < keySize) {\n\t                    keySchedule[ksRow] = keyWords[ksRow];\n\t                } else {\n\t                    t = keySchedule[ksRow - 1];\n\n\t                    if (!(ksRow % keySize)) {\n\t                        // Rot word\n\t                        t = (t << 8) | (t >>> 24);\n\n\t                        // Sub word\n\t                        t = (SBOX[t >>> 24] << 24) | (SBOX[(t >>> 16) & 0xff] << 16) | (SBOX[(t >>> 8) & 0xff] << 8) | SBOX[t & 0xff];\n\n\t                        // Mix Rcon\n\t                        t ^= RCON[(ksRow / keySize) | 0] << 24;\n\t                    } else if (keySize > 6 && ksRow % keySize == 4) {\n\t                        // Sub word\n\t                        t = (SBOX[t >>> 24] << 24) | (SBOX[(t >>> 16) & 0xff] << 16) | (SBOX[(t >>> 8) & 0xff] << 8) | SBOX[t & 0xff];\n\t                    }\n\n\t                    keySchedule[ksRow] = keySchedule[ksRow - keySize] ^ t;\n\t                }\n\t            }\n\n\t            // Compute inv key schedule\n\t            var invKeySchedule = this._invKeySchedule = [];\n\t            for (var invKsRow = 0; invKsRow < ksRows; invKsRow++) {\n\t                var ksRow = ksRows - invKsRow;\n\n\t                if (invKsRow % 4) {\n\t                    var t = keySchedule[ksRow];\n\t                } else {\n\t                    var t = keySchedule[ksRow - 4];\n\t                }\n\n\t                if (invKsRow < 4 || ksRow <= 4) {\n\t                    invKeySchedule[invKsRow] = t;\n\t                } else {\n\t                    invKeySchedule[invKsRow] = INV_SUB_MIX_0[SBOX[t >>> 24]] ^ INV_SUB_MIX_1[SBOX[(t >>> 16) & 0xff]] ^\n\t                                               INV_SUB_MIX_2[SBOX[(t >>> 8) & 0xff]] ^ INV_SUB_MIX_3[SBOX[t & 0xff]];\n\t                }\n\t            }\n\t        },\n\n\t        encryptBlock: function (M, offset) {\n\t            this._doCryptBlock(M, offset, this._keySchedule, SUB_MIX_0, SUB_MIX_1, SUB_MIX_2, SUB_MIX_3, SBOX);\n\t        },\n\n\t        decryptBlock: function (M, offset) {\n\t            // Swap 2nd and 4th rows\n\t            var t = M[offset + 1];\n\t            M[offset + 1] = M[offset + 3];\n\t            M[offset + 3] = t;\n\n\t            this._doCryptBlock(M, offset, this._invKeySchedule, INV_SUB_MIX_0, INV_SUB_MIX_1, INV_SUB_MIX_2, INV_SUB_MIX_3, INV_SBOX);\n\n\t            // Inv swap 2nd and 4th rows\n\t            var t = M[offset + 1];\n\t            M[offset + 1] = M[offset + 3];\n\t            M[offset + 3] = t;\n\t        },\n\n\t        _doCryptBlock: function (M, offset, keySchedule, SUB_MIX_0, SUB_MIX_1, SUB_MIX_2, SUB_MIX_3, SBOX) {\n\t            // Shortcut\n\t            var nRounds = this._nRounds;\n\n\t            // Get input, add round key\n\t            var s0 = M[offset]     ^ keySchedule[0];\n\t            var s1 = M[offset + 1] ^ keySchedule[1];\n\t            var s2 = M[offset + 2] ^ keySchedule[2];\n\t            var s3 = M[offset + 3] ^ keySchedule[3];\n\n\t            // Key schedule row counter\n\t            var ksRow = 4;\n\n\t            // Rounds\n\t            for (var round = 1; round < nRounds; round++) {\n\t                // Shift rows, sub bytes, mix columns, add round key\n\t                var t0 = SUB_MIX_0[s0 >>> 24] ^ SUB_MIX_1[(s1 >>> 16) & 0xff] ^ SUB_MIX_2[(s2 >>> 8) & 0xff] ^ SUB_MIX_3[s3 & 0xff] ^ keySchedule[ksRow++];\n\t                var t1 = SUB_MIX_0[s1 >>> 24] ^ SUB_MIX_1[(s2 >>> 16) & 0xff] ^ SUB_MIX_2[(s3 >>> 8) & 0xff] ^ SUB_MIX_3[s0 & 0xff] ^ keySchedule[ksRow++];\n\t                var t2 = SUB_MIX_0[s2 >>> 24] ^ SUB_MIX_1[(s3 >>> 16) & 0xff] ^ SUB_MIX_2[(s0 >>> 8) & 0xff] ^ SUB_MIX_3[s1 & 0xff] ^ keySchedule[ksRow++];\n\t                var t3 = SUB_MIX_0[s3 >>> 24] ^ SUB_MIX_1[(s0 >>> 16) & 0xff] ^ SUB_MIX_2[(s1 >>> 8) & 0xff] ^ SUB_MIX_3[s2 & 0xff] ^ keySchedule[ksRow++];\n\n\t                // Update state\n\t                s0 = t0;\n\t                s1 = t1;\n\t                s2 = t2;\n\t                s3 = t3;\n\t            }\n\n\t            // Shift rows, sub bytes, add round key\n\t            var t0 = ((SBOX[s0 >>> 24] << 24) | (SBOX[(s1 >>> 16) & 0xff] << 16) | (SBOX[(s2 >>> 8) & 0xff] << 8) | SBOX[s3 & 0xff]) ^ keySchedule[ksRow++];\n\t            var t1 = ((SBOX[s1 >>> 24] << 24) | (SBOX[(s2 >>> 16) & 0xff] << 16) | (SBOX[(s3 >>> 8) & 0xff] << 8) | SBOX[s0 & 0xff]) ^ keySchedule[ksRow++];\n\t            var t2 = ((SBOX[s2 >>> 24] << 24) | (SBOX[(s3 >>> 16) & 0xff] << 16) | (SBOX[(s0 >>> 8) & 0xff] << 8) | SBOX[s1 & 0xff]) ^ keySchedule[ksRow++];\n\t            var t3 = ((SBOX[s3 >>> 24] << 24) | (SBOX[(s0 >>> 16) & 0xff] << 16) | (SBOX[(s1 >>> 8) & 0xff] << 8) | SBOX[s2 & 0xff]) ^ keySchedule[ksRow++];\n\n\t            // Set output\n\t            M[offset]     = t0;\n\t            M[offset + 1] = t1;\n\t            M[offset + 2] = t2;\n\t            M[offset + 3] = t3;\n\t        },\n\n\t        keySize: 256/32\n\t    });\n\n\t    /**\n\t     * Shortcut functions to the cipher's object interface.\n\t     *\n\t     * @example\n\t     *\n\t     *     var ciphertext = CryptoJS.AES.encrypt(message, key, cfg);\n\t     *     var plaintext  = CryptoJS.AES.decrypt(ciphertext, key, cfg);\n\t     */\n\t    C.AES = BlockCipher._createHelper(AES);\n\t}());\n\n\n\treturn CryptoJS.AES;\n\n}));", ";(function (root, factory, undef) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory(require(\"./core\"), require(\"./evpkdf\"));\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([\"./core\", \"./evpkdf\"], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\tfactory(root.CryptoJS);\n\t}\n}(this, function (CryptoJS) {\n\n\t/**\n\t * Cipher core components.\n\t */\n\tCryptoJS.lib.Cipher || (function (undefined) {\n\t    // Shortcuts\n\t    var C = CryptoJS;\n\t    var C_lib = C.lib;\n\t    var Base = C_lib.Base;\n\t    var WordArray = C_lib.WordArray;\n\t    var BufferedBlockAlgorithm = C_lib.BufferedBlockAlgorithm;\n\t    var C_enc = C.enc;\n\t    var Utf8 = C_enc.Utf8;\n\t    var Base64 = C_enc.Base64;\n\t    var C_algo = C.algo;\n\t    var EvpKDF = C_algo.EvpKDF;\n\n\t    /**\n\t     * Abstract base cipher template.\n\t     *\n\t     * @property {number} keySize This cipher's key size. Default: 4 (128 bits)\n\t     * @property {number} ivSize This cipher's IV size. Default: 4 (128 bits)\n\t     * @property {number} _ENC_XFORM_MODE A constant representing encryption mode.\n\t     * @property {number} _DEC_XFORM_MODE A constant representing decryption mode.\n\t     */\n\t    var Cipher = C_lib.Cipher = BufferedBlockAlgorithm.extend({\n\t        /**\n\t         * Configuration options.\n\t         *\n\t         * @property {WordArray} iv The IV to use for this operation.\n\t         */\n\t        cfg: Base.extend(),\n\n\t        /**\n\t         * Creates this cipher in encryption mode.\n\t         *\n\t         * @param {WordArray} key The key.\n\t         * @param {Object} cfg (Optional) The configuration options to use for this operation.\n\t         *\n\t         * @return {Cipher} A cipher instance.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var cipher = CryptoJS.algo.AES.createEncryptor(keyWordArray, { iv: ivWordArray });\n\t         */\n\t        createEncryptor: function (key, cfg) {\n\t            return this.create(this._ENC_XFORM_MODE, key, cfg);\n\t        },\n\n\t        /**\n\t         * Creates this cipher in decryption mode.\n\t         *\n\t         * @param {WordArray} key The key.\n\t         * @param {Object} cfg (Optional) The configuration options to use for this operation.\n\t         *\n\t         * @return {Cipher} A cipher instance.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var cipher = CryptoJS.algo.AES.createDecryptor(keyWordArray, { iv: ivWordArray });\n\t         */\n\t        createDecryptor: function (key, cfg) {\n\t            return this.create(this._DEC_XFORM_MODE, key, cfg);\n\t        },\n\n\t        /**\n\t         * Initializes a newly created cipher.\n\t         *\n\t         * @param {number} xformMode Either the encryption or decryption transormation mode constant.\n\t         * @param {WordArray} key The key.\n\t         * @param {Object} cfg (Optional) The configuration options to use for this operation.\n\t         *\n\t         * @example\n\t         *\n\t         *     var cipher = CryptoJS.algo.AES.create(CryptoJS.algo.AES._ENC_XFORM_MODE, keyWordArray, { iv: ivWordArray });\n\t         */\n\t        init: function (xformMode, key, cfg) {\n\t            // Apply config defaults\n\t            this.cfg = this.cfg.extend(cfg);\n\n\t            // Store transform mode and key\n\t            this._xformMode = xformMode;\n\t            this._key = key;\n\n\t            // Set initial values\n\t            this.reset();\n\t        },\n\n\t        /**\n\t         * Resets this cipher to its initial state.\n\t         *\n\t         * @example\n\t         *\n\t         *     cipher.reset();\n\t         */\n\t        reset: function () {\n\t            // Reset data buffer\n\t            BufferedBlockAlgorithm.reset.call(this);\n\n\t            // Perform concrete-cipher logic\n\t            this._doReset();\n\t        },\n\n\t        /**\n\t         * Adds data to be encrypted or decrypted.\n\t         *\n\t         * @param {WordArray|string} dataUpdate The data to encrypt or decrypt.\n\t         *\n\t         * @return {WordArray} The data after processing.\n\t         *\n\t         * @example\n\t         *\n\t         *     var encrypted = cipher.process('data');\n\t         *     var encrypted = cipher.process(wordArray);\n\t         */\n\t        process: function (dataUpdate) {\n\t            // Append\n\t            this._append(dataUpdate);\n\n\t            // Process available blocks\n\t            return this._process();\n\t        },\n\n\t        /**\n\t         * Finalizes the encryption or decryption process.\n\t         * Note that the finalize operation is effectively a destructive, read-once operation.\n\t         *\n\t         * @param {WordArray|string} dataUpdate The final data to encrypt or decrypt.\n\t         *\n\t         * @return {WordArray} The data after final processing.\n\t         *\n\t         * @example\n\t         *\n\t         *     var encrypted = cipher.finalize();\n\t         *     var encrypted = cipher.finalize('data');\n\t         *     var encrypted = cipher.finalize(wordArray);\n\t         */\n\t        finalize: function (dataUpdate) {\n\t            // Final data update\n\t            if (dataUpdate) {\n\t                this._append(dataUpdate);\n\t            }\n\n\t            // Perform concrete-cipher logic\n\t            var finalProcessedData = this._doFinalize();\n\n\t            return finalProcessedData;\n\t        },\n\n\t        keySize: 128/32,\n\n\t        ivSize: 128/32,\n\n\t        _ENC_XFORM_MODE: 1,\n\n\t        _DEC_XFORM_MODE: 2,\n\n\t        /**\n\t         * Creates shortcut functions to a cipher's object interface.\n\t         *\n\t         * @param {Cipher} cipher The cipher to create a helper for.\n\t         *\n\t         * @return {Object} An object with encrypt and decrypt shortcut functions.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var AES = CryptoJS.lib.Cipher._createHelper(CryptoJS.algo.AES);\n\t         */\n\t        _createHelper: (function () {\n\t            function selectCipherStrategy(key) {\n\t                if (typeof key == 'string') {\n\t                    return PasswordBasedCipher;\n\t                } else {\n\t                    return SerializableCipher;\n\t                }\n\t            }\n\n\t            return function (cipher) {\n\t                return {\n\t                    encrypt: function (message, key, cfg) {\n\t                        return selectCipherStrategy(key).encrypt(cipher, message, key, cfg);\n\t                    },\n\n\t                    decrypt: function (ciphertext, key, cfg) {\n\t                        return selectCipherStrategy(key).decrypt(cipher, ciphertext, key, cfg);\n\t                    }\n\t                };\n\t            };\n\t        }())\n\t    });\n\n\t    /**\n\t     * Abstract base stream cipher template.\n\t     *\n\t     * @property {number} blockSize The number of 32-bit words this cipher operates on. Default: 1 (32 bits)\n\t     */\n\t    var StreamCipher = C_lib.StreamCipher = Cipher.extend({\n\t        _doFinalize: function () {\n\t            // Process partial blocks\n\t            var finalProcessedBlocks = this._process(!!'flush');\n\n\t            return finalProcessedBlocks;\n\t        },\n\n\t        blockSize: 1\n\t    });\n\n\t    /**\n\t     * Mode namespace.\n\t     */\n\t    var C_mode = C.mode = {};\n\n\t    /**\n\t     * Abstract base block cipher mode template.\n\t     */\n\t    var BlockCipherMode = C_lib.BlockCipherMode = Base.extend({\n\t        /**\n\t         * Creates this mode for encryption.\n\t         *\n\t         * @param {Cipher} cipher A block cipher instance.\n\t         * @param {Array} iv The IV words.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var mode = CryptoJS.mode.CBC.createEncryptor(cipher, iv.words);\n\t         */\n\t        createEncryptor: function (cipher, iv) {\n\t            return this.Encryptor.create(cipher, iv);\n\t        },\n\n\t        /**\n\t         * Creates this mode for decryption.\n\t         *\n\t         * @param {Cipher} cipher A block cipher instance.\n\t         * @param {Array} iv The IV words.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var mode = CryptoJS.mode.CBC.createDecryptor(cipher, iv.words);\n\t         */\n\t        createDecryptor: function (cipher, iv) {\n\t            return this.Decryptor.create(cipher, iv);\n\t        },\n\n\t        /**\n\t         * Initializes a newly created mode.\n\t         *\n\t         * @param {Cipher} cipher A block cipher instance.\n\t         * @param {Array} iv The IV words.\n\t         *\n\t         * @example\n\t         *\n\t         *     var mode = CryptoJS.mode.CBC.Encryptor.create(cipher, iv.words);\n\t         */\n\t        init: function (cipher, iv) {\n\t            this._cipher = cipher;\n\t            this._iv = iv;\n\t        }\n\t    });\n\n\t    /**\n\t     * Cipher Block Chaining mode.\n\t     */\n\t    var CBC = C_mode.CBC = (function () {\n\t        /**\n\t         * Abstract base CBC mode.\n\t         */\n\t        var CBC = BlockCipherMode.extend();\n\n\t        /**\n\t         * CBC encryptor.\n\t         */\n\t        CBC.Encryptor = CBC.extend({\n\t            /**\n\t             * Processes the data block at offset.\n\t             *\n\t             * @param {Array} words The data words to operate on.\n\t             * @param {number} offset The offset where the block starts.\n\t             *\n\t             * @example\n\t             *\n\t             *     mode.processBlock(data.words, offset);\n\t             */\n\t            processBlock: function (words, offset) {\n\t                // Shortcuts\n\t                var cipher = this._cipher;\n\t                var blockSize = cipher.blockSize;\n\n\t                // XOR and encrypt\n\t                xorBlock.call(this, words, offset, blockSize);\n\t                cipher.encryptBlock(words, offset);\n\n\t                // Remember this block to use with next block\n\t                this._prevBlock = words.slice(offset, offset + blockSize);\n\t            }\n\t        });\n\n\t        /**\n\t         * CBC decryptor.\n\t         */\n\t        CBC.Decryptor = CBC.extend({\n\t            /**\n\t             * Processes the data block at offset.\n\t             *\n\t             * @param {Array} words The data words to operate on.\n\t             * @param {number} offset The offset where the block starts.\n\t             *\n\t             * @example\n\t             *\n\t             *     mode.processBlock(data.words, offset);\n\t             */\n\t            processBlock: function (words, offset) {\n\t                // Shortcuts\n\t                var cipher = this._cipher;\n\t                var blockSize = cipher.blockSize;\n\n\t                // Remember this block to use with next block\n\t                var thisBlock = words.slice(offset, offset + blockSize);\n\n\t                // Decrypt and XOR\n\t                cipher.decryptBlock(words, offset);\n\t                xorBlock.call(this, words, offset, blockSize);\n\n\t                // This block becomes the previous block\n\t                this._prevBlock = thisBlock;\n\t            }\n\t        });\n\n\t        function xorBlock(words, offset, blockSize) {\n\t            var block;\n\n\t            // Shortcut\n\t            var iv = this._iv;\n\n\t            // Choose mixing block\n\t            if (iv) {\n\t                block = iv;\n\n\t                // Remove IV for subsequent blocks\n\t                this._iv = undefined;\n\t            } else {\n\t                block = this._prevBlock;\n\t            }\n\n\t            // XOR blocks\n\t            for (var i = 0; i < blockSize; i++) {\n\t                words[offset + i] ^= block[i];\n\t            }\n\t        }\n\n\t        return CBC;\n\t    }());\n\n\t    /**\n\t     * Padding namespace.\n\t     */\n\t    var C_pad = C.pad = {};\n\n\t    /**\n\t     * PKCS #5/7 padding strategy.\n\t     */\n\t    var Pkcs7 = C_pad.Pkcs7 = {\n\t        /**\n\t         * Pads data using the algorithm defined in PKCS #5/7.\n\t         *\n\t         * @param {WordArray} data The data to pad.\n\t         * @param {number} blockSize The multiple that the data should be padded to.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     CryptoJS.pad.Pkcs7.pad(wordArray, 4);\n\t         */\n\t        pad: function (data, blockSize) {\n\t            // Shortcut\n\t            var blockSizeBytes = blockSize * 4;\n\n\t            // Count padding bytes\n\t            var nPaddingBytes = blockSizeBytes - data.sigBytes % blockSizeBytes;\n\n\t            // Create padding word\n\t            var paddingWord = (nPaddingBytes << 24) | (nPaddingBytes << 16) | (nPaddingBytes << 8) | nPaddingBytes;\n\n\t            // Create padding\n\t            var paddingWords = [];\n\t            for (var i = 0; i < nPaddingBytes; i += 4) {\n\t                paddingWords.push(paddingWord);\n\t            }\n\t            var padding = WordArray.create(paddingWords, nPaddingBytes);\n\n\t            // Add padding\n\t            data.concat(padding);\n\t        },\n\n\t        /**\n\t         * Unpads data that had been padded using the algorithm defined in PKCS #5/7.\n\t         *\n\t         * @param {WordArray} data The data to unpad.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     CryptoJS.pad.Pkcs7.unpad(wordArray);\n\t         */\n\t        unpad: function (data) {\n\t            // Get number of padding bytes from last byte\n\t            var nPaddingBytes = data.words[(data.sigBytes - 1) >>> 2] & 0xff;\n\n\t            // Remove padding\n\t            data.sigBytes -= nPaddingBytes;\n\t        }\n\t    };\n\n\t    /**\n\t     * Abstract base block cipher template.\n\t     *\n\t     * @property {number} blockSize The number of 32-bit words this cipher operates on. Default: 4 (128 bits)\n\t     */\n\t    var BlockCipher = C_lib.BlockCipher = Cipher.extend({\n\t        /**\n\t         * Configuration options.\n\t         *\n\t         * @property {Mode} mode The block mode to use. Default: CBC\n\t         * @property {Padding} padding The padding strategy to use. Default: Pkcs7\n\t         */\n\t        cfg: Cipher.cfg.extend({\n\t            mode: CBC,\n\t            padding: Pkcs7\n\t        }),\n\n\t        reset: function () {\n\t            var modeCreator;\n\n\t            // Reset cipher\n\t            Cipher.reset.call(this);\n\n\t            // Shortcuts\n\t            var cfg = this.cfg;\n\t            var iv = cfg.iv;\n\t            var mode = cfg.mode;\n\n\t            // Reset block mode\n\t            if (this._xformMode == this._ENC_XFORM_MODE) {\n\t                modeCreator = mode.createEncryptor;\n\t            } else /* if (this._xformMode == this._DEC_XFORM_MODE) */ {\n\t                modeCreator = mode.createDecryptor;\n\t                // Keep at least one block in the buffer for unpadding\n\t                this._minBufferSize = 1;\n\t            }\n\n\t            if (this._mode && this._mode.__creator == modeCreator) {\n\t                this._mode.init(this, iv && iv.words);\n\t            } else {\n\t                this._mode = modeCreator.call(mode, this, iv && iv.words);\n\t                this._mode.__creator = modeCreator;\n\t            }\n\t        },\n\n\t        _doProcessBlock: function (words, offset) {\n\t            this._mode.processBlock(words, offset);\n\t        },\n\n\t        _doFinalize: function () {\n\t            var finalProcessedBlocks;\n\n\t            // Shortcut\n\t            var padding = this.cfg.padding;\n\n\t            // Finalize\n\t            if (this._xformMode == this._ENC_XFORM_MODE) {\n\t                // Pad data\n\t                padding.pad(this._data, this.blockSize);\n\n\t                // Process final blocks\n\t                finalProcessedBlocks = this._process(!!'flush');\n\t            } else /* if (this._xformMode == this._DEC_XFORM_MODE) */ {\n\t                // Process final blocks\n\t                finalProcessedBlocks = this._process(!!'flush');\n\n\t                // Unpad data\n\t                padding.unpad(finalProcessedBlocks);\n\t            }\n\n\t            return finalProcessedBlocks;\n\t        },\n\n\t        blockSize: 128/32\n\t    });\n\n\t    /**\n\t     * A collection of cipher parameters.\n\t     *\n\t     * @property {WordArray} ciphertext The raw ciphertext.\n\t     * @property {WordArray} key The key to this ciphertext.\n\t     * @property {WordArray} iv The IV used in the ciphering operation.\n\t     * @property {WordArray} salt The salt used with a key derivation function.\n\t     * @property {Cipher} algorithm The cipher algorithm.\n\t     * @property {Mode} mode The block mode used in the ciphering operation.\n\t     * @property {Padding} padding The padding scheme used in the ciphering operation.\n\t     * @property {number} blockSize The block size of the cipher.\n\t     * @property {Format} formatter The default formatting strategy to convert this cipher params object to a string.\n\t     */\n\t    var CipherParams = C_lib.CipherParams = Base.extend({\n\t        /**\n\t         * Initializes a newly created cipher params object.\n\t         *\n\t         * @param {Object} cipherParams An object with any of the possible cipher parameters.\n\t         *\n\t         * @example\n\t         *\n\t         *     var cipherParams = CryptoJS.lib.CipherParams.create({\n\t         *         ciphertext: ciphertextWordArray,\n\t         *         key: keyWordArray,\n\t         *         iv: ivWordArray,\n\t         *         salt: saltWordArray,\n\t         *         algorithm: CryptoJS.algo.AES,\n\t         *         mode: CryptoJS.mode.CBC,\n\t         *         padding: CryptoJS.pad.PKCS7,\n\t         *         blockSize: 4,\n\t         *         formatter: CryptoJS.format.OpenSSL\n\t         *     });\n\t         */\n\t        init: function (cipherParams) {\n\t            this.mixIn(cipherParams);\n\t        },\n\n\t        /**\n\t         * Converts this cipher params object to a string.\n\t         *\n\t         * @param {Format} formatter (Optional) The formatting strategy to use.\n\t         *\n\t         * @return {string} The stringified cipher params.\n\t         *\n\t         * @throws Error If neither the formatter nor the default formatter is set.\n\t         *\n\t         * @example\n\t         *\n\t         *     var string = cipherParams + '';\n\t         *     var string = cipherParams.toString();\n\t         *     var string = cipherParams.toString(CryptoJS.format.OpenSSL);\n\t         */\n\t        toString: function (formatter) {\n\t            return (formatter || this.formatter).stringify(this);\n\t        }\n\t    });\n\n\t    /**\n\t     * Format namespace.\n\t     */\n\t    var C_format = C.format = {};\n\n\t    /**\n\t     * OpenSSL formatting strategy.\n\t     */\n\t    var OpenSSLFormatter = C_format.OpenSSL = {\n\t        /**\n\t         * Converts a cipher params object to an OpenSSL-compatible string.\n\t         *\n\t         * @param {CipherParams} cipherParams The cipher params object.\n\t         *\n\t         * @return {string} The OpenSSL-compatible string.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var openSSLString = CryptoJS.format.OpenSSL.stringify(cipherParams);\n\t         */\n\t        stringify: function (cipherParams) {\n\t            var wordArray;\n\n\t            // Shortcuts\n\t            var ciphertext = cipherParams.ciphertext;\n\t            var salt = cipherParams.salt;\n\n\t            // Format\n\t            if (salt) {\n\t                wordArray = WordArray.create([0x53616c74, 0x65645f5f]).concat(salt).concat(ciphertext);\n\t            } else {\n\t                wordArray = ciphertext;\n\t            }\n\n\t            return wordArray.toString(Base64);\n\t        },\n\n\t        /**\n\t         * Converts an OpenSSL-compatible string to a cipher params object.\n\t         *\n\t         * @param {string} openSSLStr The OpenSSL-compatible string.\n\t         *\n\t         * @return {CipherParams} The cipher params object.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var cipherParams = CryptoJS.format.OpenSSL.parse(openSSLString);\n\t         */\n\t        parse: function (openSSLStr) {\n\t            var salt;\n\n\t            // Parse base64\n\t            var ciphertext = Base64.parse(openSSLStr);\n\n\t            // Shortcut\n\t            var ciphertextWords = ciphertext.words;\n\n\t            // Test for salt\n\t            if (ciphertextWords[0] == 0x53616c74 && ciphertextWords[1] == 0x65645f5f) {\n\t                // Extract salt\n\t                salt = WordArray.create(ciphertextWords.slice(2, 4));\n\n\t                // Remove salt from ciphertext\n\t                ciphertextWords.splice(0, 4);\n\t                ciphertext.sigBytes -= 16;\n\t            }\n\n\t            return CipherParams.create({ ciphertext: ciphertext, salt: salt });\n\t        }\n\t    };\n\n\t    /**\n\t     * A cipher wrapper that returns ciphertext as a serializable cipher params object.\n\t     */\n\t    var SerializableCipher = C_lib.SerializableCipher = Base.extend({\n\t        /**\n\t         * Configuration options.\n\t         *\n\t         * @property {Formatter} format The formatting strategy to convert cipher param objects to and from a string. Default: OpenSSL\n\t         */\n\t        cfg: Base.extend({\n\t            format: OpenSSLFormatter\n\t        }),\n\n\t        /**\n\t         * Encrypts a message.\n\t         *\n\t         * @param {Cipher} cipher The cipher algorithm to use.\n\t         * @param {WordArray|string} message The message to encrypt.\n\t         * @param {WordArray} key The key.\n\t         * @param {Object} cfg (Optional) The configuration options to use for this operation.\n\t         *\n\t         * @return {CipherParams} A cipher params object.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var ciphertextParams = CryptoJS.lib.SerializableCipher.encrypt(CryptoJS.algo.AES, message, key);\n\t         *     var ciphertextParams = CryptoJS.lib.SerializableCipher.encrypt(CryptoJS.algo.AES, message, key, { iv: iv });\n\t         *     var ciphertextParams = CryptoJS.lib.SerializableCipher.encrypt(CryptoJS.algo.AES, message, key, { iv: iv, format: CryptoJS.format.OpenSSL });\n\t         */\n\t        encrypt: function (cipher, message, key, cfg) {\n\t            // Apply config defaults\n\t            cfg = this.cfg.extend(cfg);\n\n\t            // Encrypt\n\t            var encryptor = cipher.createEncryptor(key, cfg);\n\t            var ciphertext = encryptor.finalize(message);\n\n\t            // Shortcut\n\t            var cipherCfg = encryptor.cfg;\n\n\t            // Create and return serializable cipher params\n\t            return CipherParams.create({\n\t                ciphertext: ciphertext,\n\t                key: key,\n\t                iv: cipherCfg.iv,\n\t                algorithm: cipher,\n\t                mode: cipherCfg.mode,\n\t                padding: cipherCfg.padding,\n\t                blockSize: cipher.blockSize,\n\t                formatter: cfg.format\n\t            });\n\t        },\n\n\t        /**\n\t         * Decrypts serialized ciphertext.\n\t         *\n\t         * @param {Cipher} cipher The cipher algorithm to use.\n\t         * @param {CipherParams|string} ciphertext The ciphertext to decrypt.\n\t         * @param {WordArray} key The key.\n\t         * @param {Object} cfg (Optional) The configuration options to use for this operation.\n\t         *\n\t         * @return {WordArray} The plaintext.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var plaintext = CryptoJS.lib.SerializableCipher.decrypt(CryptoJS.algo.AES, formattedCiphertext, key, { iv: iv, format: CryptoJS.format.OpenSSL });\n\t         *     var plaintext = CryptoJS.lib.SerializableCipher.decrypt(CryptoJS.algo.AES, ciphertextParams, key, { iv: iv, format: CryptoJS.format.OpenSSL });\n\t         */\n\t        decrypt: function (cipher, ciphertext, key, cfg) {\n\t            // Apply config defaults\n\t            cfg = this.cfg.extend(cfg);\n\n\t            // Convert string to CipherParams\n\t            ciphertext = this._parse(ciphertext, cfg.format);\n\n\t            // Decrypt\n\t            var plaintext = cipher.createDecryptor(key, cfg).finalize(ciphertext.ciphertext);\n\n\t            return plaintext;\n\t        },\n\n\t        /**\n\t         * Converts serialized ciphertext to CipherParams,\n\t         * else assumed CipherParams already and returns ciphertext unchanged.\n\t         *\n\t         * @param {CipherParams|string} ciphertext The ciphertext.\n\t         * @param {Formatter} format The formatting strategy to use to parse serialized ciphertext.\n\t         *\n\t         * @return {CipherParams} The unserialized ciphertext.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var ciphertextParams = CryptoJS.lib.SerializableCipher._parse(ciphertextStringOrParams, format);\n\t         */\n\t        _parse: function (ciphertext, format) {\n\t            if (typeof ciphertext == 'string') {\n\t                return format.parse(ciphertext, this);\n\t            } else {\n\t                return ciphertext;\n\t            }\n\t        }\n\t    });\n\n\t    /**\n\t     * Key derivation function namespace.\n\t     */\n\t    var C_kdf = C.kdf = {};\n\n\t    /**\n\t     * OpenSSL key derivation function.\n\t     */\n\t    var OpenSSLKdf = C_kdf.OpenSSL = {\n\t        /**\n\t         * Derives a key and IV from a password.\n\t         *\n\t         * @param {string} password The password to derive from.\n\t         * @param {number} keySize The size in words of the key to generate.\n\t         * @param {number} ivSize The size in words of the IV to generate.\n\t         * @param {WordArray|string} salt (Optional) A 64-bit salt to use. If omitted, a salt will be generated randomly.\n\t         *\n\t         * @return {CipherParams} A cipher params object with the key, IV, and salt.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var derivedParams = CryptoJS.kdf.OpenSSL.execute('Password', 256/32, 128/32);\n\t         *     var derivedParams = CryptoJS.kdf.OpenSSL.execute('Password', 256/32, 128/32, 'saltsalt');\n\t         */\n\t        execute: function (password, keySize, ivSize, salt, hasher) {\n\t            // Generate random salt\n\t            if (!salt) {\n\t                salt = WordArray.random(64/8);\n\t            }\n\n\t            // Derive key and IV\n\t            if (!hasher) {\n\t                var key = EvpKDF.create({ keySize: keySize + ivSize }).compute(password, salt);\n\t            } else {\n\t                var key = EvpKDF.create({ keySize: keySize + ivSize, hasher: hasher }).compute(password, salt);\n\t            }\n\n\n\t            // Separate key and IV\n\t            var iv = WordArray.create(key.words.slice(keySize), ivSize * 4);\n\t            key.sigBytes = keySize * 4;\n\n\t            // Return params\n\t            return CipherParams.create({ key: key, iv: iv, salt: salt });\n\t        }\n\t    };\n\n\t    /**\n\t     * A serializable cipher wrapper that derives the key from a password,\n\t     * and returns ciphertext as a serializable cipher params object.\n\t     */\n\t    var PasswordBasedCipher = C_lib.PasswordBasedCipher = SerializableCipher.extend({\n\t        /**\n\t         * Configuration options.\n\t         *\n\t         * @property {KDF} kdf The key derivation function to use to generate a key and IV from a password. Default: OpenSSL\n\t         */\n\t        cfg: SerializableCipher.cfg.extend({\n\t            kdf: OpenSSLKdf\n\t        }),\n\n\t        /**\n\t         * Encrypts a message using a password.\n\t         *\n\t         * @param {Cipher} cipher The cipher algorithm to use.\n\t         * @param {WordArray|string} message The message to encrypt.\n\t         * @param {string} password The password.\n\t         * @param {Object} cfg (Optional) The configuration options to use for this operation.\n\t         *\n\t         * @return {CipherParams} A cipher params object.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var ciphertextParams = CryptoJS.lib.PasswordBasedCipher.encrypt(CryptoJS.algo.AES, message, 'password');\n\t         *     var ciphertextParams = CryptoJS.lib.PasswordBasedCipher.encrypt(CryptoJS.algo.AES, message, 'password', { format: CryptoJS.format.OpenSSL });\n\t         */\n\t        encrypt: function (cipher, message, password, cfg) {\n\t            // Apply config defaults\n\t            cfg = this.cfg.extend(cfg);\n\n\t            // Derive key and other params\n\t            var derivedParams = cfg.kdf.execute(password, cipher.keySize, cipher.ivSize, cfg.salt, cfg.hasher);\n\n\t            // Add IV to config\n\t            cfg.iv = derivedParams.iv;\n\n\t            // Encrypt\n\t            var ciphertext = SerializableCipher.encrypt.call(this, cipher, message, derivedParams.key, cfg);\n\n\t            // Mix in derived params\n\t            ciphertext.mixIn(derivedParams);\n\n\t            return ciphertext;\n\t        },\n\n\t        /**\n\t         * Decrypts serialized ciphertext using a password.\n\t         *\n\t         * @param {Cipher} cipher The cipher algorithm to use.\n\t         * @param {CipherParams|string} ciphertext The ciphertext to decrypt.\n\t         * @param {string} password The password.\n\t         * @param {Object} cfg (Optional) The configuration options to use for this operation.\n\t         *\n\t         * @return {WordArray} The plaintext.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var plaintext = CryptoJS.lib.PasswordBasedCipher.decrypt(CryptoJS.algo.AES, formattedCiphertext, 'password', { format: CryptoJS.format.OpenSSL });\n\t         *     var plaintext = CryptoJS.lib.PasswordBasedCipher.decrypt(CryptoJS.algo.AES, ciphertextParams, 'password', { format: CryptoJS.format.OpenSSL });\n\t         */\n\t        decrypt: function (cipher, ciphertext, password, cfg) {\n\t            // Apply config defaults\n\t            cfg = this.cfg.extend(cfg);\n\n\t            // Convert string to CipherParams\n\t            ciphertext = this._parse(ciphertext, cfg.format);\n\n\t            // Derive key and other params\n\t            var derivedParams = cfg.kdf.execute(password, cipher.keySize, cipher.ivSize, ciphertext.salt, cfg.hasher);\n\n\t            // Add IV to config\n\t            cfg.iv = derivedParams.iv;\n\n\t            // Decrypt\n\t            var plaintext = SerializableCipher.decrypt.call(this, cipher, ciphertext, derivedParams.key, cfg);\n\n\t            return plaintext;\n\t        }\n\t    });\n\t}());\n\n\n}));", ";(function (root, factory, undef) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory(require(\"./core\"), require(\"./sha256\"), require(\"./hmac\"));\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([\"./core\", \"./sha256\", \"./hmac\"], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\tfactory(root.CryptoJS);\n\t}\n}(this, function (CryptoJS) {\n\n\treturn CryptoJS.HmacSHA256;\n\n}));", "\n/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */\n// (C) 1995-2013 Jean-loup Gailly and Mark Adler\n// (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n//\n// This software is provided 'as-is', without any express or implied\n// warranty. In no event will the authors be held liable for any damages\n// arising from the use of this software.\n//\n// Permission is granted to anyone to use this software for any purpose,\n// including commercial applications, and to alter it and redistribute it\n// freely, subject to the following restrictions:\n//\n// 1. The origin of this software must not be misrepresented; you must not\n//   claim that you wrote the original software. If you use this software\n//   in a product, an acknowledgment in the product documentation would be\n//   appreciated but is not required.\n// 2. Altered source versions must be plainly marked as such, and must not be\n//   misrepresented as being the original software.\n// 3. This notice may not be removed or altered from any source distribution.\n\n/* eslint-disable space-unary-ops */\n\n/* Public constants ==========================================================*/\n/* ===========================================================================*/\n\n\n//const Z_FILTERED          = 1;\n//const Z_HUFFMAN_ONLY      = 2;\n//const Z_RLE               = 3;\nconst Z_FIXED$1               = 4;\n//const Z_DEFAULT_STRATEGY  = 0;\n\n/* Possible values of the data_type field (though see inflate()) */\nconst Z_BINARY              = 0;\nconst Z_TEXT                = 1;\n//const Z_ASCII             = 1; // = Z_TEXT\nconst Z_UNKNOWN$1             = 2;\n\n/*============================================================================*/\n\n\nfunction zero$1(buf) { let len = buf.length; while (--len >= 0) { buf[len] = 0; } }\n\n// From zutil.h\n\nconst STORED_BLOCK = 0;\nconst STATIC_TREES = 1;\nconst DYN_TREES    = 2;\n/* The three kinds of block type */\n\nconst MIN_MATCH$1    = 3;\nconst MAX_MATCH$1    = 258;\n/* The minimum and maximum match lengths */\n\n// From deflate.h\n/* ===========================================================================\n * Internal compression state.\n */\n\nconst LENGTH_CODES$1  = 29;\n/* number of length codes, not counting the special END_BLOCK code */\n\nconst LITERALS$1      = 256;\n/* number of literal bytes 0..255 */\n\nconst L_CODES$1       = LITERALS$1 + 1 + LENGTH_CODES$1;\n/* number of Literal or Length codes, including the END_BLOCK code */\n\nconst D_CODES$1       = 30;\n/* number of distance codes */\n\nconst BL_CODES$1      = 19;\n/* number of codes used to transfer the bit lengths */\n\nconst HEAP_SIZE$1     = 2 * L_CODES$1 + 1;\n/* maximum heap size */\n\nconst MAX_BITS$1      = 15;\n/* All codes must not exceed MAX_BITS bits */\n\nconst Buf_size      = 16;\n/* size of bit buffer in bi_buf */\n\n\n/* ===========================================================================\n * Constants\n */\n\nconst MAX_BL_BITS = 7;\n/* Bit length codes must not exceed MAX_BL_BITS bits */\n\nconst END_BLOCK   = 256;\n/* end of block literal code */\n\nconst REP_3_6     = 16;\n/* repeat previous bit length 3-6 times (2 bits of repeat count) */\n\nconst REPZ_3_10   = 17;\n/* repeat a zero length 3-10 times  (3 bits of repeat count) */\n\nconst REPZ_11_138 = 18;\n/* repeat a zero length 11-138 times  (7 bits of repeat count) */\n\n/* eslint-disable comma-spacing,array-bracket-spacing */\nconst extra_lbits =   /* extra bits for each length code */\n  new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]);\n\nconst extra_dbits =   /* extra bits for each distance code */\n  new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]);\n\nconst extra_blbits =  /* extra bits for each bit length code */\n  new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]);\n\nconst bl_order =\n  new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);\n/* eslint-enable comma-spacing,array-bracket-spacing */\n\n/* The lengths of the bit length codes are sent in order of decreasing\n * probability, to avoid transmitting the lengths for unused bit length codes.\n */\n\n/* ===========================================================================\n * Local data. These are initialized only once.\n */\n\n// We pre-fill arrays with 0 to avoid uninitialized gaps\n\nconst DIST_CODE_LEN = 512; /* see definition of array dist_code below */\n\n// !!!! Use flat array instead of structure, Freq = i*2, Len = i*2+1\nconst static_ltree  = new Array((L_CODES$1 + 2) * 2);\nzero$1(static_ltree);\n/* The static literal tree. Since the bit lengths are imposed, there is no\n * need for the L_CODES extra codes used during heap construction. However\n * The codes 286 and 287 are needed to build a canonical tree (see _tr_init\n * below).\n */\n\nconst static_dtree  = new Array(D_CODES$1 * 2);\nzero$1(static_dtree);\n/* The static distance tree. (Actually a trivial tree since all codes use\n * 5 bits.)\n */\n\nconst _dist_code    = new Array(DIST_CODE_LEN);\nzero$1(_dist_code);\n/* Distance codes. The first 256 values correspond to the distances\n * 3 .. 258, the last 256 values correspond to the top 8 bits of\n * the 15 bit distances.\n */\n\nconst _length_code  = new Array(MAX_MATCH$1 - MIN_MATCH$1 + 1);\nzero$1(_length_code);\n/* length code for each normalized match length (0 == MIN_MATCH) */\n\nconst base_length   = new Array(LENGTH_CODES$1);\nzero$1(base_length);\n/* First normalized length for each code (0 = MIN_MATCH) */\n\nconst base_dist     = new Array(D_CODES$1);\nzero$1(base_dist);\n/* First normalized distance for each code (0 = distance of 1) */\n\n\nfunction StaticTreeDesc(static_tree, extra_bits, extra_base, elems, max_length) {\n\n  this.static_tree  = static_tree;  /* static tree or NULL */\n  this.extra_bits   = extra_bits;   /* extra bits for each code or NULL */\n  this.extra_base   = extra_base;   /* base index for extra_bits */\n  this.elems        = elems;        /* max number of elements in the tree */\n  this.max_length   = max_length;   /* max bit length for the codes */\n\n  // show if `static_tree` has data or dummy - needed for monomorphic objects\n  this.has_stree    = static_tree && static_tree.length;\n}\n\n\nlet static_l_desc;\nlet static_d_desc;\nlet static_bl_desc;\n\n\nfunction TreeDesc(dyn_tree, stat_desc) {\n  this.dyn_tree = dyn_tree;     /* the dynamic tree */\n  this.max_code = 0;            /* largest code with non zero frequency */\n  this.stat_desc = stat_desc;   /* the corresponding static tree */\n}\n\n\n\nconst d_code = (dist) => {\n\n  return dist < 256 ? _dist_code[dist] : _dist_code[256 + (dist >>> 7)];\n};\n\n\n/* ===========================================================================\n * Output a short LSB first on the stream.\n * IN assertion: there is enough room in pendingBuf.\n */\nconst put_short = (s, w) => {\n//    put_byte(s, (uch)((w) & 0xff));\n//    put_byte(s, (uch)((ush)(w) >> 8));\n  s.pending_buf[s.pending++] = (w) & 0xff;\n  s.pending_buf[s.pending++] = (w >>> 8) & 0xff;\n};\n\n\n/* ===========================================================================\n * Send a value on a given number of bits.\n * IN assertion: length <= 16 and value fits in length bits.\n */\nconst send_bits = (s, value, length) => {\n\n  if (s.bi_valid > (Buf_size - length)) {\n    s.bi_buf |= (value << s.bi_valid) & 0xffff;\n    put_short(s, s.bi_buf);\n    s.bi_buf = value >> (Buf_size - s.bi_valid);\n    s.bi_valid += length - Buf_size;\n  } else {\n    s.bi_buf |= (value << s.bi_valid) & 0xffff;\n    s.bi_valid += length;\n  }\n};\n\n\nconst send_code = (s, c, tree) => {\n\n  send_bits(s, tree[c * 2]/*.Code*/, tree[c * 2 + 1]/*.Len*/);\n};\n\n\n/* ===========================================================================\n * Reverse the first len bits of a code, using straightforward code (a faster\n * method would use a table)\n * IN assertion: 1 <= len <= 15\n */\nconst bi_reverse = (code, len) => {\n\n  let res = 0;\n  do {\n    res |= code & 1;\n    code >>>= 1;\n    res <<= 1;\n  } while (--len > 0);\n  return res >>> 1;\n};\n\n\n/* ===========================================================================\n * Flush the bit buffer, keeping at most 7 bits in it.\n */\nconst bi_flush = (s) => {\n\n  if (s.bi_valid === 16) {\n    put_short(s, s.bi_buf);\n    s.bi_buf = 0;\n    s.bi_valid = 0;\n\n  } else if (s.bi_valid >= 8) {\n    s.pending_buf[s.pending++] = s.bi_buf & 0xff;\n    s.bi_buf >>= 8;\n    s.bi_valid -= 8;\n  }\n};\n\n\n/* ===========================================================================\n * Compute the optimal bit lengths for a tree and update the total bit length\n * for the current block.\n * IN assertion: the fields freq and dad are set, heap[heap_max] and\n *    above are the tree nodes sorted by increasing frequency.\n * OUT assertions: the field len is set to the optimal bit length, the\n *     array bl_count contains the frequencies for each bit length.\n *     The length opt_len is updated; static_len is also updated if stree is\n *     not null.\n */\nconst gen_bitlen = (s, desc) => {\n//    deflate_state *s;\n//    tree_desc *desc;    /* the tree descriptor */\n\n  const tree            = desc.dyn_tree;\n  const max_code        = desc.max_code;\n  const stree           = desc.stat_desc.static_tree;\n  const has_stree       = desc.stat_desc.has_stree;\n  const extra           = desc.stat_desc.extra_bits;\n  const base            = desc.stat_desc.extra_base;\n  const max_length      = desc.stat_desc.max_length;\n  let h;              /* heap index */\n  let n, m;           /* iterate over the tree elements */\n  let bits;           /* bit length */\n  let xbits;          /* extra bits */\n  let f;              /* frequency */\n  let overflow = 0;   /* number of elements with bit length too large */\n\n  for (bits = 0; bits <= MAX_BITS$1; bits++) {\n    s.bl_count[bits] = 0;\n  }\n\n  /* In a first pass, compute the optimal bit lengths (which may\n   * overflow in the case of the bit length tree).\n   */\n  tree[s.heap[s.heap_max] * 2 + 1]/*.Len*/ = 0; /* root of the heap */\n\n  for (h = s.heap_max + 1; h < HEAP_SIZE$1; h++) {\n    n = s.heap[h];\n    bits = tree[tree[n * 2 + 1]/*.Dad*/ * 2 + 1]/*.Len*/ + 1;\n    if (bits > max_length) {\n      bits = max_length;\n      overflow++;\n    }\n    tree[n * 2 + 1]/*.Len*/ = bits;\n    /* We overwrite tree[n].Dad which is no longer needed */\n\n    if (n > max_code) { continue; } /* not a leaf node */\n\n    s.bl_count[bits]++;\n    xbits = 0;\n    if (n >= base) {\n      xbits = extra[n - base];\n    }\n    f = tree[n * 2]/*.Freq*/;\n    s.opt_len += f * (bits + xbits);\n    if (has_stree) {\n      s.static_len += f * (stree[n * 2 + 1]/*.Len*/ + xbits);\n    }\n  }\n  if (overflow === 0) { return; }\n\n  // Tracev((stderr,\"\\nbit length overflow\\n\"));\n  /* This happens for example on obj2 and pic of the Calgary corpus */\n\n  /* Find the first bit length which could increase: */\n  do {\n    bits = max_length - 1;\n    while (s.bl_count[bits] === 0) { bits--; }\n    s.bl_count[bits]--;      /* move one leaf down the tree */\n    s.bl_count[bits + 1] += 2; /* move one overflow item as its brother */\n    s.bl_count[max_length]--;\n    /* The brother of the overflow item also moves one step up,\n     * but this does not affect bl_count[max_length]\n     */\n    overflow -= 2;\n  } while (overflow > 0);\n\n  /* Now recompute all bit lengths, scanning in increasing frequency.\n   * h is still equal to HEAP_SIZE. (It is simpler to reconstruct all\n   * lengths instead of fixing only the wrong ones. This idea is taken\n   * from 'ar' written by Haruhiko Okumura.)\n   */\n  for (bits = max_length; bits !== 0; bits--) {\n    n = s.bl_count[bits];\n    while (n !== 0) {\n      m = s.heap[--h];\n      if (m > max_code) { continue; }\n      if (tree[m * 2 + 1]/*.Len*/ !== bits) {\n        // Tracev((stderr,\"code %d bits %d->%d\\n\", m, tree[m].Len, bits));\n        s.opt_len += (bits - tree[m * 2 + 1]/*.Len*/) * tree[m * 2]/*.Freq*/;\n        tree[m * 2 + 1]/*.Len*/ = bits;\n      }\n      n--;\n    }\n  }\n};\n\n\n/* ===========================================================================\n * Generate the codes for a given tree and bit counts (which need not be\n * optimal).\n * IN assertion: the array bl_count contains the bit length statistics for\n * the given tree and the field len is set for all tree elements.\n * OUT assertion: the field code is set for all tree elements of non\n *     zero code length.\n */\nconst gen_codes = (tree, max_code, bl_count) => {\n//    ct_data *tree;             /* the tree to decorate */\n//    int max_code;              /* largest code with non zero frequency */\n//    ushf *bl_count;            /* number of codes at each bit length */\n\n  const next_code = new Array(MAX_BITS$1 + 1); /* next code value for each bit length */\n  let code = 0;              /* running code value */\n  let bits;                  /* bit index */\n  let n;                     /* code index */\n\n  /* The distribution counts are first used to generate the code values\n   * without bit reversal.\n   */\n  for (bits = 1; bits <= MAX_BITS$1; bits++) {\n    code = (code + bl_count[bits - 1]) << 1;\n    next_code[bits] = code;\n  }\n  /* Check that the bit counts in bl_count are consistent. The last code\n   * must be all ones.\n   */\n  //Assert (code + bl_count[MAX_BITS]-1 == (1<<MAX_BITS)-1,\n  //        \"inconsistent bit counts\");\n  //Tracev((stderr,\"\\ngen_codes: max_code %d \", max_code));\n\n  for (n = 0;  n <= max_code; n++) {\n    let len = tree[n * 2 + 1]/*.Len*/;\n    if (len === 0) { continue; }\n    /* Now reverse the bits */\n    tree[n * 2]/*.Code*/ = bi_reverse(next_code[len]++, len);\n\n    //Tracecv(tree != static_ltree, (stderr,\"\\nn %3d %c l %2d c %4x (%x) \",\n    //     n, (isgraph(n) ? n : ' '), len, tree[n].Code, next_code[len]-1));\n  }\n};\n\n\n/* ===========================================================================\n * Initialize the various 'constant' tables.\n */\nconst tr_static_init = () => {\n\n  let n;        /* iterates over tree elements */\n  let bits;     /* bit counter */\n  let length;   /* length value */\n  let code;     /* code value */\n  let dist;     /* distance index */\n  const bl_count = new Array(MAX_BITS$1 + 1);\n  /* number of codes at each bit length for an optimal tree */\n\n  // do check in _tr_init()\n  //if (static_init_done) return;\n\n  /* For some embedded targets, global variables are not initialized: */\n/*#ifdef NO_INIT_GLOBAL_POINTERS\n  static_l_desc.static_tree = static_ltree;\n  static_l_desc.extra_bits = extra_lbits;\n  static_d_desc.static_tree = static_dtree;\n  static_d_desc.extra_bits = extra_dbits;\n  static_bl_desc.extra_bits = extra_blbits;\n#endif*/\n\n  /* Initialize the mapping length (0..255) -> length code (0..28) */\n  length = 0;\n  for (code = 0; code < LENGTH_CODES$1 - 1; code++) {\n    base_length[code] = length;\n    for (n = 0; n < (1 << extra_lbits[code]); n++) {\n      _length_code[length++] = code;\n    }\n  }\n  //Assert (length == 256, \"tr_static_init: length != 256\");\n  /* Note that the length 255 (match length 258) can be represented\n   * in two different ways: code 284 + 5 bits or code 285, so we\n   * overwrite length_code[255] to use the best encoding:\n   */\n  _length_code[length - 1] = code;\n\n  /* Initialize the mapping dist (0..32K) -> dist code (0..29) */\n  dist = 0;\n  for (code = 0; code < 16; code++) {\n    base_dist[code] = dist;\n    for (n = 0; n < (1 << extra_dbits[code]); n++) {\n      _dist_code[dist++] = code;\n    }\n  }\n  //Assert (dist == 256, \"tr_static_init: dist != 256\");\n  dist >>= 7; /* from now on, all distances are divided by 128 */\n  for (; code < D_CODES$1; code++) {\n    base_dist[code] = dist << 7;\n    for (n = 0; n < (1 << (extra_dbits[code] - 7)); n++) {\n      _dist_code[256 + dist++] = code;\n    }\n  }\n  //Assert (dist == 256, \"tr_static_init: 256+dist != 512\");\n\n  /* Construct the codes of the static literal tree */\n  for (bits = 0; bits <= MAX_BITS$1; bits++) {\n    bl_count[bits] = 0;\n  }\n\n  n = 0;\n  while (n <= 143) {\n    static_ltree[n * 2 + 1]/*.Len*/ = 8;\n    n++;\n    bl_count[8]++;\n  }\n  while (n <= 255) {\n    static_ltree[n * 2 + 1]/*.Len*/ = 9;\n    n++;\n    bl_count[9]++;\n  }\n  while (n <= 279) {\n    static_ltree[n * 2 + 1]/*.Len*/ = 7;\n    n++;\n    bl_count[7]++;\n  }\n  while (n <= 287) {\n    static_ltree[n * 2 + 1]/*.Len*/ = 8;\n    n++;\n    bl_count[8]++;\n  }\n  /* Codes 286 and 287 do not exist, but we must include them in the\n   * tree construction to get a canonical Huffman tree (longest code\n   * all ones)\n   */\n  gen_codes(static_ltree, L_CODES$1 + 1, bl_count);\n\n  /* The static distance tree is trivial: */\n  for (n = 0; n < D_CODES$1; n++) {\n    static_dtree[n * 2 + 1]/*.Len*/ = 5;\n    static_dtree[n * 2]/*.Code*/ = bi_reverse(n, 5);\n  }\n\n  // Now data ready and we can init static trees\n  static_l_desc = new StaticTreeDesc(static_ltree, extra_lbits, LITERALS$1 + 1, L_CODES$1, MAX_BITS$1);\n  static_d_desc = new StaticTreeDesc(static_dtree, extra_dbits, 0,          D_CODES$1, MAX_BITS$1);\n  static_bl_desc = new StaticTreeDesc(new Array(0), extra_blbits, 0,         BL_CODES$1, MAX_BL_BITS);\n\n  //static_init_done = true;\n};\n\n\n/* ===========================================================================\n * Initialize a new block.\n */\nconst init_block = (s) => {\n\n  let n; /* iterates over tree elements */\n\n  /* Initialize the trees. */\n  for (n = 0; n < L_CODES$1;  n++) { s.dyn_ltree[n * 2]/*.Freq*/ = 0; }\n  for (n = 0; n < D_CODES$1;  n++) { s.dyn_dtree[n * 2]/*.Freq*/ = 0; }\n  for (n = 0; n < BL_CODES$1; n++) { s.bl_tree[n * 2]/*.Freq*/ = 0; }\n\n  s.dyn_ltree[END_BLOCK * 2]/*.Freq*/ = 1;\n  s.opt_len = s.static_len = 0;\n  s.sym_next = s.matches = 0;\n};\n\n\n/* ===========================================================================\n * Flush the bit buffer and align the output on a byte boundary\n */\nconst bi_windup = (s) =>\n{\n  if (s.bi_valid > 8) {\n    put_short(s, s.bi_buf);\n  } else if (s.bi_valid > 0) {\n    //put_byte(s, (Byte)s->bi_buf);\n    s.pending_buf[s.pending++] = s.bi_buf;\n  }\n  s.bi_buf = 0;\n  s.bi_valid = 0;\n};\n\n/* ===========================================================================\n * Compares to subtrees, using the tree depth as tie breaker when\n * the subtrees have equal frequency. This minimizes the worst case length.\n */\nconst smaller = (tree, n, m, depth) => {\n\n  const _n2 = n * 2;\n  const _m2 = m * 2;\n  return (tree[_n2]/*.Freq*/ < tree[_m2]/*.Freq*/ ||\n         (tree[_n2]/*.Freq*/ === tree[_m2]/*.Freq*/ && depth[n] <= depth[m]));\n};\n\n/* ===========================================================================\n * Restore the heap property by moving down the tree starting at node k,\n * exchanging a node with the smallest of its two sons if necessary, stopping\n * when the heap property is re-established (each father smaller than its\n * two sons).\n */\nconst pqdownheap = (s, tree, k) => {\n//    deflate_state *s;\n//    ct_data *tree;  /* the tree to restore */\n//    int k;               /* node to move down */\n\n  const v = s.heap[k];\n  let j = k << 1;  /* left son of k */\n  while (j <= s.heap_len) {\n    /* Set j to the smallest of the two sons: */\n    if (j < s.heap_len &&\n      smaller(tree, s.heap[j + 1], s.heap[j], s.depth)) {\n      j++;\n    }\n    /* Exit if v is smaller than both sons */\n    if (smaller(tree, v, s.heap[j], s.depth)) { break; }\n\n    /* Exchange v with the smallest son */\n    s.heap[k] = s.heap[j];\n    k = j;\n\n    /* And continue down the tree, setting j to the left son of k */\n    j <<= 1;\n  }\n  s.heap[k] = v;\n};\n\n\n// inlined manually\n// const SMALLEST = 1;\n\n/* ===========================================================================\n * Send the block data compressed using the given Huffman trees\n */\nconst compress_block = (s, ltree, dtree) => {\n//    deflate_state *s;\n//    const ct_data *ltree; /* literal tree */\n//    const ct_data *dtree; /* distance tree */\n\n  let dist;           /* distance of matched string */\n  let lc;             /* match length or unmatched char (if dist == 0) */\n  let sx = 0;         /* running index in sym_buf */\n  let code;           /* the code to send */\n  let extra;          /* number of extra bits to send */\n\n  if (s.sym_next !== 0) {\n    do {\n      dist = s.pending_buf[s.sym_buf + sx++] & 0xff;\n      dist += (s.pending_buf[s.sym_buf + sx++] & 0xff) << 8;\n      lc = s.pending_buf[s.sym_buf + sx++];\n      if (dist === 0) {\n        send_code(s, lc, ltree); /* send a literal byte */\n        //Tracecv(isgraph(lc), (stderr,\" '%c' \", lc));\n      } else {\n        /* Here, lc is the match length - MIN_MATCH */\n        code = _length_code[lc];\n        send_code(s, code + LITERALS$1 + 1, ltree); /* send the length code */\n        extra = extra_lbits[code];\n        if (extra !== 0) {\n          lc -= base_length[code];\n          send_bits(s, lc, extra);       /* send the extra length bits */\n        }\n        dist--; /* dist is now the match distance - 1 */\n        code = d_code(dist);\n        //Assert (code < D_CODES, \"bad d_code\");\n\n        send_code(s, code, dtree);       /* send the distance code */\n        extra = extra_dbits[code];\n        if (extra !== 0) {\n          dist -= base_dist[code];\n          send_bits(s, dist, extra);   /* send the extra distance bits */\n        }\n      } /* literal or match pair ? */\n\n      /* Check that the overlay between pending_buf and sym_buf is ok: */\n      //Assert(s->pending < s->lit_bufsize + sx, \"pendingBuf overflow\");\n\n    } while (sx < s.sym_next);\n  }\n\n  send_code(s, END_BLOCK, ltree);\n};\n\n\n/* ===========================================================================\n * Construct one Huffman tree and assigns the code bit strings and lengths.\n * Update the total bit length for the current block.\n * IN assertion: the field freq is set for all tree elements.\n * OUT assertions: the fields len and code are set to the optimal bit length\n *     and corresponding code. The length opt_len is updated; static_len is\n *     also updated if stree is not null. The field max_code is set.\n */\nconst build_tree = (s, desc) => {\n//    deflate_state *s;\n//    tree_desc *desc; /* the tree descriptor */\n\n  const tree     = desc.dyn_tree;\n  const stree    = desc.stat_desc.static_tree;\n  const has_stree = desc.stat_desc.has_stree;\n  const elems    = desc.stat_desc.elems;\n  let n, m;          /* iterate over heap elements */\n  let max_code = -1; /* largest code with non zero frequency */\n  let node;          /* new node being created */\n\n  /* Construct the initial heap, with least frequent element in\n   * heap[SMALLEST]. The sons of heap[n] are heap[2*n] and heap[2*n+1].\n   * heap[0] is not used.\n   */\n  s.heap_len = 0;\n  s.heap_max = HEAP_SIZE$1;\n\n  for (n = 0; n < elems; n++) {\n    if (tree[n * 2]/*.Freq*/ !== 0) {\n      s.heap[++s.heap_len] = max_code = n;\n      s.depth[n] = 0;\n\n    } else {\n      tree[n * 2 + 1]/*.Len*/ = 0;\n    }\n  }\n\n  /* The pkzip format requires that at least one distance code exists,\n   * and that at least one bit should be sent even if there is only one\n   * possible code. So to avoid special checks later on we force at least\n   * two codes of non zero frequency.\n   */\n  while (s.heap_len < 2) {\n    node = s.heap[++s.heap_len] = (max_code < 2 ? ++max_code : 0);\n    tree[node * 2]/*.Freq*/ = 1;\n    s.depth[node] = 0;\n    s.opt_len--;\n\n    if (has_stree) {\n      s.static_len -= stree[node * 2 + 1]/*.Len*/;\n    }\n    /* node is 0 or 1 so it does not have extra bits */\n  }\n  desc.max_code = max_code;\n\n  /* The elements heap[heap_len/2+1 .. heap_len] are leaves of the tree,\n   * establish sub-heaps of increasing lengths:\n   */\n  for (n = (s.heap_len >> 1/*int /2*/); n >= 1; n--) { pqdownheap(s, tree, n); }\n\n  /* Construct the Huffman tree by repeatedly combining the least two\n   * frequent nodes.\n   */\n  node = elems;              /* next internal node of the tree */\n  do {\n    //pqremove(s, tree, n);  /* n = node of least frequency */\n    /*** pqremove ***/\n    n = s.heap[1/*SMALLEST*/];\n    s.heap[1/*SMALLEST*/] = s.heap[s.heap_len--];\n    pqdownheap(s, tree, 1/*SMALLEST*/);\n    /***/\n\n    m = s.heap[1/*SMALLEST*/]; /* m = node of next least frequency */\n\n    s.heap[--s.heap_max] = n; /* keep the nodes sorted by frequency */\n    s.heap[--s.heap_max] = m;\n\n    /* Create a new node father of n and m */\n    tree[node * 2]/*.Freq*/ = tree[n * 2]/*.Freq*/ + tree[m * 2]/*.Freq*/;\n    s.depth[node] = (s.depth[n] >= s.depth[m] ? s.depth[n] : s.depth[m]) + 1;\n    tree[n * 2 + 1]/*.Dad*/ = tree[m * 2 + 1]/*.Dad*/ = node;\n\n    /* and insert the new node in the heap */\n    s.heap[1/*SMALLEST*/] = node++;\n    pqdownheap(s, tree, 1/*SMALLEST*/);\n\n  } while (s.heap_len >= 2);\n\n  s.heap[--s.heap_max] = s.heap[1/*SMALLEST*/];\n\n  /* At this point, the fields freq and dad are set. We can now\n   * generate the bit lengths.\n   */\n  gen_bitlen(s, desc);\n\n  /* The field len is now set, we can generate the bit codes */\n  gen_codes(tree, max_code, s.bl_count);\n};\n\n\n/* ===========================================================================\n * Scan a literal or distance tree to determine the frequencies of the codes\n * in the bit length tree.\n */\nconst scan_tree = (s, tree, max_code) => {\n//    deflate_state *s;\n//    ct_data *tree;   /* the tree to be scanned */\n//    int max_code;    /* and its largest code of non zero frequency */\n\n  let n;                     /* iterates over all tree elements */\n  let prevlen = -1;          /* last emitted length */\n  let curlen;                /* length of current code */\n\n  let nextlen = tree[0 * 2 + 1]/*.Len*/; /* length of next code */\n\n  let count = 0;             /* repeat count of the current code */\n  let max_count = 7;         /* max repeat count */\n  let min_count = 4;         /* min repeat count */\n\n  if (nextlen === 0) {\n    max_count = 138;\n    min_count = 3;\n  }\n  tree[(max_code + 1) * 2 + 1]/*.Len*/ = 0xffff; /* guard */\n\n  for (n = 0; n <= max_code; n++) {\n    curlen = nextlen;\n    nextlen = tree[(n + 1) * 2 + 1]/*.Len*/;\n\n    if (++count < max_count && curlen === nextlen) {\n      continue;\n\n    } else if (count < min_count) {\n      s.bl_tree[curlen * 2]/*.Freq*/ += count;\n\n    } else if (curlen !== 0) {\n\n      if (curlen !== prevlen) { s.bl_tree[curlen * 2]/*.Freq*/++; }\n      s.bl_tree[REP_3_6 * 2]/*.Freq*/++;\n\n    } else if (count <= 10) {\n      s.bl_tree[REPZ_3_10 * 2]/*.Freq*/++;\n\n    } else {\n      s.bl_tree[REPZ_11_138 * 2]/*.Freq*/++;\n    }\n\n    count = 0;\n    prevlen = curlen;\n\n    if (nextlen === 0) {\n      max_count = 138;\n      min_count = 3;\n\n    } else if (curlen === nextlen) {\n      max_count = 6;\n      min_count = 3;\n\n    } else {\n      max_count = 7;\n      min_count = 4;\n    }\n  }\n};\n\n\n/* ===========================================================================\n * Send a literal or distance tree in compressed form, using the codes in\n * bl_tree.\n */\nconst send_tree = (s, tree, max_code) => {\n//    deflate_state *s;\n//    ct_data *tree; /* the tree to be scanned */\n//    int max_code;       /* and its largest code of non zero frequency */\n\n  let n;                     /* iterates over all tree elements */\n  let prevlen = -1;          /* last emitted length */\n  let curlen;                /* length of current code */\n\n  let nextlen = tree[0 * 2 + 1]/*.Len*/; /* length of next code */\n\n  let count = 0;             /* repeat count of the current code */\n  let max_count = 7;         /* max repeat count */\n  let min_count = 4;         /* min repeat count */\n\n  /* tree[max_code+1].Len = -1; */  /* guard already set */\n  if (nextlen === 0) {\n    max_count = 138;\n    min_count = 3;\n  }\n\n  for (n = 0; n <= max_code; n++) {\n    curlen = nextlen;\n    nextlen = tree[(n + 1) * 2 + 1]/*.Len*/;\n\n    if (++count < max_count && curlen === nextlen) {\n      continue;\n\n    } else if (count < min_count) {\n      do { send_code(s, curlen, s.bl_tree); } while (--count !== 0);\n\n    } else if (curlen !== 0) {\n      if (curlen !== prevlen) {\n        send_code(s, curlen, s.bl_tree);\n        count--;\n      }\n      //Assert(count >= 3 && count <= 6, \" 3_6?\");\n      send_code(s, REP_3_6, s.bl_tree);\n      send_bits(s, count - 3, 2);\n\n    } else if (count <= 10) {\n      send_code(s, REPZ_3_10, s.bl_tree);\n      send_bits(s, count - 3, 3);\n\n    } else {\n      send_code(s, REPZ_11_138, s.bl_tree);\n      send_bits(s, count - 11, 7);\n    }\n\n    count = 0;\n    prevlen = curlen;\n    if (nextlen === 0) {\n      max_count = 138;\n      min_count = 3;\n\n    } else if (curlen === nextlen) {\n      max_count = 6;\n      min_count = 3;\n\n    } else {\n      max_count = 7;\n      min_count = 4;\n    }\n  }\n};\n\n\n/* ===========================================================================\n * Construct the Huffman tree for the bit lengths and return the index in\n * bl_order of the last bit length code to send.\n */\nconst build_bl_tree = (s) => {\n\n  let max_blindex;  /* index of last bit length code of non zero freq */\n\n  /* Determine the bit length frequencies for literal and distance trees */\n  scan_tree(s, s.dyn_ltree, s.l_desc.max_code);\n  scan_tree(s, s.dyn_dtree, s.d_desc.max_code);\n\n  /* Build the bit length tree: */\n  build_tree(s, s.bl_desc);\n  /* opt_len now includes the length of the tree representations, except\n   * the lengths of the bit lengths codes and the 5+5+4 bits for the counts.\n   */\n\n  /* Determine the number of bit length codes to send. The pkzip format\n   * requires that at least 4 bit length codes be sent. (appnote.txt says\n   * 3 but the actual value used is 4.)\n   */\n  for (max_blindex = BL_CODES$1 - 1; max_blindex >= 3; max_blindex--) {\n    if (s.bl_tree[bl_order[max_blindex] * 2 + 1]/*.Len*/ !== 0) {\n      break;\n    }\n  }\n  /* Update opt_len to include the bit length tree and counts */\n  s.opt_len += 3 * (max_blindex + 1) + 5 + 5 + 4;\n  //Tracev((stderr, \"\\ndyn trees: dyn %ld, stat %ld\",\n  //        s->opt_len, s->static_len));\n\n  return max_blindex;\n};\n\n\n/* ===========================================================================\n * Send the header for a block using dynamic Huffman trees: the counts, the\n * lengths of the bit length codes, the literal tree and the distance tree.\n * IN assertion: lcodes >= 257, dcodes >= 1, blcodes >= 4.\n */\nconst send_all_trees = (s, lcodes, dcodes, blcodes) => {\n//    deflate_state *s;\n//    int lcodes, dcodes, blcodes; /* number of codes for each tree */\n\n  let rank;                    /* index in bl_order */\n\n  //Assert (lcodes >= 257 && dcodes >= 1 && blcodes >= 4, \"not enough codes\");\n  //Assert (lcodes <= L_CODES && dcodes <= D_CODES && blcodes <= BL_CODES,\n  //        \"too many codes\");\n  //Tracev((stderr, \"\\nbl counts: \"));\n  send_bits(s, lcodes - 257, 5); /* not +255 as stated in appnote.txt */\n  send_bits(s, dcodes - 1,   5);\n  send_bits(s, blcodes - 4,  4); /* not -3 as stated in appnote.txt */\n  for (rank = 0; rank < blcodes; rank++) {\n    //Tracev((stderr, \"\\nbl code %2d \", bl_order[rank]));\n    send_bits(s, s.bl_tree[bl_order[rank] * 2 + 1]/*.Len*/, 3);\n  }\n  //Tracev((stderr, \"\\nbl tree: sent %ld\", s->bits_sent));\n\n  send_tree(s, s.dyn_ltree, lcodes - 1); /* literal tree */\n  //Tracev((stderr, \"\\nlit tree: sent %ld\", s->bits_sent));\n\n  send_tree(s, s.dyn_dtree, dcodes - 1); /* distance tree */\n  //Tracev((stderr, \"\\ndist tree: sent %ld\", s->bits_sent));\n};\n\n\n/* ===========================================================================\n * Check if the data type is TEXT or BINARY, using the following algorithm:\n * - TEXT if the two conditions below are satisfied:\n *    a) There are no non-portable control characters belonging to the\n *       \"block list\" (0..6, 14..25, 28..31).\n *    b) There is at least one printable character belonging to the\n *       \"allow list\" (9 {TAB}, 10 {LF}, 13 {CR}, 32..255).\n * - BINARY otherwise.\n * - The following partially-portable control characters form a\n *   \"gray list\" that is ignored in this detection algorithm:\n *   (7 {BEL}, 8 {BS}, 11 {VT}, 12 {FF}, 26 {SUB}, 27 {ESC}).\n * IN assertion: the fields Freq of dyn_ltree are set.\n */\nconst detect_data_type = (s) => {\n  /* block_mask is the bit mask of block-listed bytes\n   * set bits 0..6, 14..25, and 28..31\n   * 0xf3ffc07f = binary 11110011111111111100000001111111\n   */\n  let block_mask = 0xf3ffc07f;\n  let n;\n\n  /* Check for non-textual (\"block-listed\") bytes. */\n  for (n = 0; n <= 31; n++, block_mask >>>= 1) {\n    if ((block_mask & 1) && (s.dyn_ltree[n * 2]/*.Freq*/ !== 0)) {\n      return Z_BINARY;\n    }\n  }\n\n  /* Check for textual (\"allow-listed\") bytes. */\n  if (s.dyn_ltree[9 * 2]/*.Freq*/ !== 0 || s.dyn_ltree[10 * 2]/*.Freq*/ !== 0 ||\n      s.dyn_ltree[13 * 2]/*.Freq*/ !== 0) {\n    return Z_TEXT;\n  }\n  for (n = 32; n < LITERALS$1; n++) {\n    if (s.dyn_ltree[n * 2]/*.Freq*/ !== 0) {\n      return Z_TEXT;\n    }\n  }\n\n  /* There are no \"block-listed\" or \"allow-listed\" bytes:\n   * this stream either is empty or has tolerated (\"gray-listed\") bytes only.\n   */\n  return Z_BINARY;\n};\n\n\nlet static_init_done = false;\n\n/* ===========================================================================\n * Initialize the tree data structures for a new zlib stream.\n */\nconst _tr_init$1 = (s) =>\n{\n\n  if (!static_init_done) {\n    tr_static_init();\n    static_init_done = true;\n  }\n\n  s.l_desc  = new TreeDesc(s.dyn_ltree, static_l_desc);\n  s.d_desc  = new TreeDesc(s.dyn_dtree, static_d_desc);\n  s.bl_desc = new TreeDesc(s.bl_tree, static_bl_desc);\n\n  s.bi_buf = 0;\n  s.bi_valid = 0;\n\n  /* Initialize the first block of the first file: */\n  init_block(s);\n};\n\n\n/* ===========================================================================\n * Send a stored block\n */\nconst _tr_stored_block$1 = (s, buf, stored_len, last) => {\n//DeflateState *s;\n//charf *buf;       /* input block */\n//ulg stored_len;   /* length of input block */\n//int last;         /* one if this is the last block for a file */\n\n  send_bits(s, (STORED_BLOCK << 1) + (last ? 1 : 0), 3);    /* send block type */\n  bi_windup(s);        /* align on byte boundary */\n  put_short(s, stored_len);\n  put_short(s, ~stored_len);\n  if (stored_len) {\n    s.pending_buf.set(s.window.subarray(buf, buf + stored_len), s.pending);\n  }\n  s.pending += stored_len;\n};\n\n\n/* ===========================================================================\n * Send one empty static block to give enough lookahead for inflate.\n * This takes 10 bits, of which 7 may remain in the bit buffer.\n */\nconst _tr_align$1 = (s) => {\n  send_bits(s, STATIC_TREES << 1, 3);\n  send_code(s, END_BLOCK, static_ltree);\n  bi_flush(s);\n};\n\n\n/* ===========================================================================\n * Determine the best encoding for the current block: dynamic trees, static\n * trees or store, and write out the encoded block.\n */\nconst _tr_flush_block$1 = (s, buf, stored_len, last) => {\n//DeflateState *s;\n//charf *buf;       /* input block, or NULL if too old */\n//ulg stored_len;   /* length of input block */\n//int last;         /* one if this is the last block for a file */\n\n  let opt_lenb, static_lenb;  /* opt_len and static_len in bytes */\n  let max_blindex = 0;        /* index of last bit length code of non zero freq */\n\n  /* Build the Huffman trees unless a stored block is forced */\n  if (s.level > 0) {\n\n    /* Check if the file is binary or text */\n    if (s.strm.data_type === Z_UNKNOWN$1) {\n      s.strm.data_type = detect_data_type(s);\n    }\n\n    /* Construct the literal and distance trees */\n    build_tree(s, s.l_desc);\n    // Tracev((stderr, \"\\nlit data: dyn %ld, stat %ld\", s->opt_len,\n    //        s->static_len));\n\n    build_tree(s, s.d_desc);\n    // Tracev((stderr, \"\\ndist data: dyn %ld, stat %ld\", s->opt_len,\n    //        s->static_len));\n    /* At this point, opt_len and static_len are the total bit lengths of\n     * the compressed block data, excluding the tree representations.\n     */\n\n    /* Build the bit length tree for the above two trees, and get the index\n     * in bl_order of the last bit length code to send.\n     */\n    max_blindex = build_bl_tree(s);\n\n    /* Determine the best encoding. Compute the block lengths in bytes. */\n    opt_lenb = (s.opt_len + 3 + 7) >>> 3;\n    static_lenb = (s.static_len + 3 + 7) >>> 3;\n\n    // Tracev((stderr, \"\\nopt %lu(%lu) stat %lu(%lu) stored %lu lit %u \",\n    //        opt_lenb, s->opt_len, static_lenb, s->static_len, stored_len,\n    //        s->sym_next / 3));\n\n    if (static_lenb <= opt_lenb) { opt_lenb = static_lenb; }\n\n  } else {\n    // Assert(buf != (char*)0, \"lost buf\");\n    opt_lenb = static_lenb = stored_len + 5; /* force a stored block */\n  }\n\n  if ((stored_len + 4 <= opt_lenb) && (buf !== -1)) {\n    /* 4: two words for the lengths */\n\n    /* The test buf != NULL is only necessary if LIT_BUFSIZE > WSIZE.\n     * Otherwise we can't have processed more than WSIZE input bytes since\n     * the last block flush, because compression would have been\n     * successful. If LIT_BUFSIZE <= WSIZE, it is never too late to\n     * transform a block into a stored block.\n     */\n    _tr_stored_block$1(s, buf, stored_len, last);\n\n  } else if (s.strategy === Z_FIXED$1 || static_lenb === opt_lenb) {\n\n    send_bits(s, (STATIC_TREES << 1) + (last ? 1 : 0), 3);\n    compress_block(s, static_ltree, static_dtree);\n\n  } else {\n    send_bits(s, (DYN_TREES << 1) + (last ? 1 : 0), 3);\n    send_all_trees(s, s.l_desc.max_code + 1, s.d_desc.max_code + 1, max_blindex + 1);\n    compress_block(s, s.dyn_ltree, s.dyn_dtree);\n  }\n  // Assert (s->compressed_len == s->bits_sent, \"bad compressed size\");\n  /* The above check is made mod 2^32, for files larger than 512 MB\n   * and uLong implemented on 32 bits.\n   */\n  init_block(s);\n\n  if (last) {\n    bi_windup(s);\n  }\n  // Tracev((stderr,\"\\ncomprlen %lu(%lu) \", s->compressed_len>>3,\n  //       s->compressed_len-7*last));\n};\n\n/* ===========================================================================\n * Save the match info and tally the frequency counts. Return true if\n * the current block must be flushed.\n */\nconst _tr_tally$1 = (s, dist, lc) => {\n//    deflate_state *s;\n//    unsigned dist;  /* distance of matched string */\n//    unsigned lc;    /* match length-MIN_MATCH or unmatched char (if dist==0) */\n\n  s.pending_buf[s.sym_buf + s.sym_next++] = dist;\n  s.pending_buf[s.sym_buf + s.sym_next++] = dist >> 8;\n  s.pending_buf[s.sym_buf + s.sym_next++] = lc;\n  if (dist === 0) {\n    /* lc is the unmatched char */\n    s.dyn_ltree[lc * 2]/*.Freq*/++;\n  } else {\n    s.matches++;\n    /* Here, lc is the match length - MIN_MATCH */\n    dist--;             /* dist = match distance - 1 */\n    //Assert((ush)dist < (ush)MAX_DIST(s) &&\n    //       (ush)lc <= (ush)(MAX_MATCH-MIN_MATCH) &&\n    //       (ush)d_code(dist) < (ush)D_CODES,  \"_tr_tally: bad match\");\n\n    s.dyn_ltree[(_length_code[lc] + LITERALS$1 + 1) * 2]/*.Freq*/++;\n    s.dyn_dtree[d_code(dist) * 2]/*.Freq*/++;\n  }\n\n  return (s.sym_next === s.sym_end);\n};\n\nvar _tr_init_1  = _tr_init$1;\nvar _tr_stored_block_1 = _tr_stored_block$1;\nvar _tr_flush_block_1  = _tr_flush_block$1;\nvar _tr_tally_1 = _tr_tally$1;\nvar _tr_align_1 = _tr_align$1;\n\nvar trees = {\n\t_tr_init: _tr_init_1,\n\t_tr_stored_block: _tr_stored_block_1,\n\t_tr_flush_block: _tr_flush_block_1,\n\t_tr_tally: _tr_tally_1,\n\t_tr_align: _tr_align_1\n};\n\n// Note: adler32 takes 12% for level 0 and 2% for level 6.\n// It isn't worth it to make additional optimizations as in original.\n// Small size is preferable.\n\n// (C) 1995-2013 Jean-loup Gailly and Mark Adler\n// (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n//\n// This software is provided 'as-is', without any express or implied\n// warranty. In no event will the authors be held liable for any damages\n// arising from the use of this software.\n//\n// Permission is granted to anyone to use this software for any purpose,\n// including commercial applications, and to alter it and redistribute it\n// freely, subject to the following restrictions:\n//\n// 1. The origin of this software must not be misrepresented; you must not\n//   claim that you wrote the original software. If you use this software\n//   in a product, an acknowledgment in the product documentation would be\n//   appreciated but is not required.\n// 2. Altered source versions must be plainly marked as such, and must not be\n//   misrepresented as being the original software.\n// 3. This notice may not be removed or altered from any source distribution.\n\nconst adler32 = (adler, buf, len, pos) => {\n  let s1 = (adler & 0xffff) |0,\n      s2 = ((adler >>> 16) & 0xffff) |0,\n      n = 0;\n\n  while (len !== 0) {\n    // Set limit ~ twice less than 5552, to keep\n    // s2 in 31-bits, because we force signed ints.\n    // in other case %= will fail.\n    n = len > 2000 ? 2000 : len;\n    len -= n;\n\n    do {\n      s1 = (s1 + buf[pos++]) |0;\n      s2 = (s2 + s1) |0;\n    } while (--n);\n\n    s1 %= 65521;\n    s2 %= 65521;\n  }\n\n  return (s1 | (s2 << 16)) |0;\n};\n\n\nvar adler32_1 = adler32;\n\n// Note: we can't get significant speed boost here.\n// So write code to minimize size - no pregenerated tables\n// and array tools dependencies.\n\n// (C) 1995-2013 Jean-loup Gailly and Mark Adler\n// (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n//\n// This software is provided 'as-is', without any express or implied\n// warranty. In no event will the authors be held liable for any damages\n// arising from the use of this software.\n//\n// Permission is granted to anyone to use this software for any purpose,\n// including commercial applications, and to alter it and redistribute it\n// freely, subject to the following restrictions:\n//\n// 1. The origin of this software must not be misrepresented; you must not\n//   claim that you wrote the original software. If you use this software\n//   in a product, an acknowledgment in the product documentation would be\n//   appreciated but is not required.\n// 2. Altered source versions must be plainly marked as such, and must not be\n//   misrepresented as being the original software.\n// 3. This notice may not be removed or altered from any source distribution.\n\n// Use ordinary array, since untyped makes no boost here\nconst makeTable = () => {\n  let c, table = [];\n\n  for (var n = 0; n < 256; n++) {\n    c = n;\n    for (var k = 0; k < 8; k++) {\n      c = ((c & 1) ? (0xEDB88320 ^ (c >>> 1)) : (c >>> 1));\n    }\n    table[n] = c;\n  }\n\n  return table;\n};\n\n// Create table on load. Just 255 signed longs. Not a problem.\nconst crcTable = new Uint32Array(makeTable());\n\n\nconst crc32 = (crc, buf, len, pos) => {\n  const t = crcTable;\n  const end = pos + len;\n\n  crc ^= -1;\n\n  for (let i = pos; i < end; i++) {\n    crc = (crc >>> 8) ^ t[(crc ^ buf[i]) & 0xFF];\n  }\n\n  return (crc ^ (-1)); // >>> 0;\n};\n\n\nvar crc32_1 = crc32;\n\n// (C) 1995-2013 Jean-loup Gailly and Mark Adler\n// (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n//\n// This software is provided 'as-is', without any express or implied\n// warranty. In no event will the authors be held liable for any damages\n// arising from the use of this software.\n//\n// Permission is granted to anyone to use this software for any purpose,\n// including commercial applications, and to alter it and redistribute it\n// freely, subject to the following restrictions:\n//\n// 1. The origin of this software must not be misrepresented; you must not\n//   claim that you wrote the original software. If you use this software\n//   in a product, an acknowledgment in the product documentation would be\n//   appreciated but is not required.\n// 2. Altered source versions must be plainly marked as such, and must not be\n//   misrepresented as being the original software.\n// 3. This notice may not be removed or altered from any source distribution.\n\nvar messages = {\n  2:      'need dictionary',     /* Z_NEED_DICT       2  */\n  1:      'stream end',          /* Z_STREAM_END      1  */\n  0:      '',                    /* Z_OK              0  */\n  '-1':   'file error',          /* Z_ERRNO         (-1) */\n  '-2':   'stream error',        /* Z_STREAM_ERROR  (-2) */\n  '-3':   'data error',          /* Z_DATA_ERROR    (-3) */\n  '-4':   'insufficient memory', /* Z_MEM_ERROR     (-4) */\n  '-5':   'buffer error',        /* Z_BUF_ERROR     (-5) */\n  '-6':   'incompatible version' /* Z_VERSION_ERROR (-6) */\n};\n\n// (C) 1995-2013 Jean-loup Gailly and Mark Adler\n// (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n//\n// This software is provided 'as-is', without any express or implied\n// warranty. In no event will the authors be held liable for any damages\n// arising from the use of this software.\n//\n// Permission is granted to anyone to use this software for any purpose,\n// including commercial applications, and to alter it and redistribute it\n// freely, subject to the following restrictions:\n//\n// 1. The origin of this software must not be misrepresented; you must not\n//   claim that you wrote the original software. If you use this software\n//   in a product, an acknowledgment in the product documentation would be\n//   appreciated but is not required.\n// 2. Altered source versions must be plainly marked as such, and must not be\n//   misrepresented as being the original software.\n// 3. This notice may not be removed or altered from any source distribution.\n\nvar constants$2 = {\n\n  /* Allowed flush values; see deflate() and inflate() below for details */\n  Z_NO_FLUSH:         0,\n  Z_PARTIAL_FLUSH:    1,\n  Z_SYNC_FLUSH:       2,\n  Z_FULL_FLUSH:       3,\n  Z_FINISH:           4,\n  Z_BLOCK:            5,\n  Z_TREES:            6,\n\n  /* Return codes for the compression/decompression functions. Negative values\n  * are errors, positive values are used for special but normal events.\n  */\n  Z_OK:               0,\n  Z_STREAM_END:       1,\n  Z_NEED_DICT:        2,\n  Z_ERRNO:           -1,\n  Z_STREAM_ERROR:    -2,\n  Z_DATA_ERROR:      -3,\n  Z_MEM_ERROR:       -4,\n  Z_BUF_ERROR:       -5,\n  //Z_VERSION_ERROR: -6,\n\n  /* compression levels */\n  Z_NO_COMPRESSION:         0,\n  Z_BEST_SPEED:             1,\n  Z_BEST_COMPRESSION:       9,\n  Z_DEFAULT_COMPRESSION:   -1,\n\n\n  Z_FILTERED:               1,\n  Z_HUFFMAN_ONLY:           2,\n  Z_RLE:                    3,\n  Z_FIXED:                  4,\n  Z_DEFAULT_STRATEGY:       0,\n\n  /* Possible values of the data_type field (though see inflate()) */\n  Z_BINARY:                 0,\n  Z_TEXT:                   1,\n  //Z_ASCII:                1, // = Z_TEXT (deprecated)\n  Z_UNKNOWN:                2,\n\n  /* The deflate compression method */\n  Z_DEFLATED:               8\n  //Z_NULL:                 null // Use -1 or null inline, depending on var type\n};\n\n// (C) 1995-2013 Jean-loup Gailly and Mark Adler\n// (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n//\n// This software is provided 'as-is', without any express or implied\n// warranty. In no event will the authors be held liable for any damages\n// arising from the use of this software.\n//\n// Permission is granted to anyone to use this software for any purpose,\n// including commercial applications, and to alter it and redistribute it\n// freely, subject to the following restrictions:\n//\n// 1. The origin of this software must not be misrepresented; you must not\n//   claim that you wrote the original software. If you use this software\n//   in a product, an acknowledgment in the product documentation would be\n//   appreciated but is not required.\n// 2. Altered source versions must be plainly marked as such, and must not be\n//   misrepresented as being the original software.\n// 3. This notice may not be removed or altered from any source distribution.\n\nconst { _tr_init, _tr_stored_block, _tr_flush_block, _tr_tally, _tr_align } = trees;\n\n\n\n\n/* Public constants ==========================================================*/\n/* ===========================================================================*/\n\nconst {\n  Z_NO_FLUSH: Z_NO_FLUSH$2, Z_PARTIAL_FLUSH, Z_FULL_FLUSH: Z_FULL_FLUSH$1, Z_FINISH: Z_FINISH$3, Z_BLOCK: Z_BLOCK$1,\n  Z_OK: Z_OK$3, Z_STREAM_END: Z_STREAM_END$3, Z_STREAM_ERROR: Z_STREAM_ERROR$2, Z_DATA_ERROR: Z_DATA_ERROR$2, Z_BUF_ERROR: Z_BUF_ERROR$1,\n  Z_DEFAULT_COMPRESSION: Z_DEFAULT_COMPRESSION$1,\n  Z_FILTERED, Z_HUFFMAN_ONLY, Z_RLE, Z_FIXED, Z_DEFAULT_STRATEGY: Z_DEFAULT_STRATEGY$1,\n  Z_UNKNOWN,\n  Z_DEFLATED: Z_DEFLATED$2\n} = constants$2;\n\n/*============================================================================*/\n\n\nconst MAX_MEM_LEVEL = 9;\n/* Maximum value for memLevel in deflateInit2 */\nconst MAX_WBITS$1 = 15;\n/* 32K LZ77 window */\nconst DEF_MEM_LEVEL = 8;\n\n\nconst LENGTH_CODES  = 29;\n/* number of length codes, not counting the special END_BLOCK code */\nconst LITERALS      = 256;\n/* number of literal bytes 0..255 */\nconst L_CODES       = LITERALS + 1 + LENGTH_CODES;\n/* number of Literal or Length codes, including the END_BLOCK code */\nconst D_CODES       = 30;\n/* number of distance codes */\nconst BL_CODES      = 19;\n/* number of codes used to transfer the bit lengths */\nconst HEAP_SIZE     = 2 * L_CODES + 1;\n/* maximum heap size */\nconst MAX_BITS  = 15;\n/* All codes must not exceed MAX_BITS bits */\n\nconst MIN_MATCH = 3;\nconst MAX_MATCH = 258;\nconst MIN_LOOKAHEAD = (MAX_MATCH + MIN_MATCH + 1);\n\nconst PRESET_DICT = 0x20;\n\nconst INIT_STATE    =  42;    /* zlib header -> BUSY_STATE */\n//#ifdef GZIP\nconst GZIP_STATE    =  57;    /* gzip header -> BUSY_STATE | EXTRA_STATE */\n//#endif\nconst EXTRA_STATE   =  69;    /* gzip extra block -> NAME_STATE */\nconst NAME_STATE    =  73;    /* gzip file name -> COMMENT_STATE */\nconst COMMENT_STATE =  91;    /* gzip comment -> HCRC_STATE */\nconst HCRC_STATE    = 103;    /* gzip header CRC -> BUSY_STATE */\nconst BUSY_STATE    = 113;    /* deflate -> FINISH_STATE */\nconst FINISH_STATE  = 666;    /* stream complete */\n\nconst BS_NEED_MORE      = 1; /* block not completed, need more input or more output */\nconst BS_BLOCK_DONE     = 2; /* block flush performed */\nconst BS_FINISH_STARTED = 3; /* finish started, need only more output at next deflate */\nconst BS_FINISH_DONE    = 4; /* finish done, accept no more input or output */\n\nconst OS_CODE = 0x03; // Unix :) . Don't detect, use this default.\n\nconst err = (strm, errorCode) => {\n  strm.msg = messages[errorCode];\n  return errorCode;\n};\n\nconst rank = (f) => {\n  return ((f) * 2) - ((f) > 4 ? 9 : 0);\n};\n\nconst zero = (buf) => {\n  let len = buf.length; while (--len >= 0) { buf[len] = 0; }\n};\n\n/* ===========================================================================\n * Slide the hash table when sliding the window down (could be avoided with 32\n * bit values at the expense of memory usage). We slide even when level == 0 to\n * keep the hash table consistent if we switch back to level > 0 later.\n */\nconst slide_hash = (s) => {\n  let n, m;\n  let p;\n  let wsize = s.w_size;\n\n  n = s.hash_size;\n  p = n;\n  do {\n    m = s.head[--p];\n    s.head[p] = (m >= wsize ? m - wsize : 0);\n  } while (--n);\n  n = wsize;\n//#ifndef FASTEST\n  p = n;\n  do {\n    m = s.prev[--p];\n    s.prev[p] = (m >= wsize ? m - wsize : 0);\n    /* If n is not on any hash chain, prev[n] is garbage but\n     * its value will never be used.\n     */\n  } while (--n);\n//#endif\n};\n\n/* eslint-disable new-cap */\nlet HASH_ZLIB = (s, prev, data) => ((prev << s.hash_shift) ^ data) & s.hash_mask;\n// This hash causes less collisions, https://github.com/nodeca/pako/issues/135\n// But breaks binary compatibility\n//let HASH_FAST = (s, prev, data) => ((prev << 8) + (prev >> 8) + (data << 4)) & s.hash_mask;\nlet HASH = HASH_ZLIB;\n\n\n/* =========================================================================\n * Flush as much pending output as possible. All deflate() output, except for\n * some deflate_stored() output, goes through this function so some\n * applications may wish to modify it to avoid allocating a large\n * strm->next_out buffer and copying into it. (See also read_buf()).\n */\nconst flush_pending = (strm) => {\n  const s = strm.state;\n\n  //_tr_flush_bits(s);\n  let len = s.pending;\n  if (len > strm.avail_out) {\n    len = strm.avail_out;\n  }\n  if (len === 0) { return; }\n\n  strm.output.set(s.pending_buf.subarray(s.pending_out, s.pending_out + len), strm.next_out);\n  strm.next_out  += len;\n  s.pending_out  += len;\n  strm.total_out += len;\n  strm.avail_out -= len;\n  s.pending      -= len;\n  if (s.pending === 0) {\n    s.pending_out = 0;\n  }\n};\n\n\nconst flush_block_only = (s, last) => {\n  _tr_flush_block(s, (s.block_start >= 0 ? s.block_start : -1), s.strstart - s.block_start, last);\n  s.block_start = s.strstart;\n  flush_pending(s.strm);\n};\n\n\nconst put_byte = (s, b) => {\n  s.pending_buf[s.pending++] = b;\n};\n\n\n/* =========================================================================\n * Put a short in the pending buffer. The 16-bit value is put in MSB order.\n * IN assertion: the stream state is correct and there is enough room in\n * pending_buf.\n */\nconst putShortMSB = (s, b) => {\n\n  //  put_byte(s, (Byte)(b >> 8));\n//  put_byte(s, (Byte)(b & 0xff));\n  s.pending_buf[s.pending++] = (b >>> 8) & 0xff;\n  s.pending_buf[s.pending++] = b & 0xff;\n};\n\n\n/* ===========================================================================\n * Read a new buffer from the current input stream, update the adler32\n * and total number of bytes read.  All deflate() input goes through\n * this function so some applications may wish to modify it to avoid\n * allocating a large strm->input buffer and copying from it.\n * (See also flush_pending()).\n */\nconst read_buf = (strm, buf, start, size) => {\n\n  let len = strm.avail_in;\n\n  if (len > size) { len = size; }\n  if (len === 0) { return 0; }\n\n  strm.avail_in -= len;\n\n  // zmemcpy(buf, strm->next_in, len);\n  buf.set(strm.input.subarray(strm.next_in, strm.next_in + len), start);\n  if (strm.state.wrap === 1) {\n    strm.adler = adler32_1(strm.adler, buf, len, start);\n  }\n\n  else if (strm.state.wrap === 2) {\n    strm.adler = crc32_1(strm.adler, buf, len, start);\n  }\n\n  strm.next_in += len;\n  strm.total_in += len;\n\n  return len;\n};\n\n\n/* ===========================================================================\n * Set match_start to the longest match starting at the given string and\n * return its length. Matches shorter or equal to prev_length are discarded,\n * in which case the result is equal to prev_length and match_start is\n * garbage.\n * IN assertions: cur_match is the head of the hash chain for the current\n *   string (strstart) and its distance is <= MAX_DIST, and prev_length >= 1\n * OUT assertion: the match length is not greater than s->lookahead.\n */\nconst longest_match = (s, cur_match) => {\n\n  let chain_length = s.max_chain_length;      /* max hash chain length */\n  let scan = s.strstart; /* current string */\n  let match;                       /* matched string */\n  let len;                           /* length of current match */\n  let best_len = s.prev_length;              /* best match length so far */\n  let nice_match = s.nice_match;             /* stop if match long enough */\n  const limit = (s.strstart > (s.w_size - MIN_LOOKAHEAD)) ?\n      s.strstart - (s.w_size - MIN_LOOKAHEAD) : 0/*NIL*/;\n\n  const _win = s.window; // shortcut\n\n  const wmask = s.w_mask;\n  const prev  = s.prev;\n\n  /* Stop when cur_match becomes <= limit. To simplify the code,\n   * we prevent matches with the string of window index 0.\n   */\n\n  const strend = s.strstart + MAX_MATCH;\n  let scan_end1  = _win[scan + best_len - 1];\n  let scan_end   = _win[scan + best_len];\n\n  /* The code is optimized for HASH_BITS >= 8 and MAX_MATCH-2 multiple of 16.\n   * It is easy to get rid of this optimization if necessary.\n   */\n  // Assert(s->hash_bits >= 8 && MAX_MATCH == 258, \"Code too clever\");\n\n  /* Do not waste too much time if we already have a good match: */\n  if (s.prev_length >= s.good_match) {\n    chain_length >>= 2;\n  }\n  /* Do not look for matches beyond the end of the input. This is necessary\n   * to make deflate deterministic.\n   */\n  if (nice_match > s.lookahead) { nice_match = s.lookahead; }\n\n  // Assert((ulg)s->strstart <= s->window_size-MIN_LOOKAHEAD, \"need lookahead\");\n\n  do {\n    // Assert(cur_match < s->strstart, \"no future\");\n    match = cur_match;\n\n    /* Skip to next match if the match length cannot increase\n     * or if the match length is less than 2.  Note that the checks below\n     * for insufficient lookahead only occur occasionally for performance\n     * reasons.  Therefore uninitialized memory will be accessed, and\n     * conditional jumps will be made that depend on those values.\n     * However the length of the match is limited to the lookahead, so\n     * the output of deflate is not affected by the uninitialized values.\n     */\n\n    if (_win[match + best_len]     !== scan_end  ||\n        _win[match + best_len - 1] !== scan_end1 ||\n        _win[match]                !== _win[scan] ||\n        _win[++match]              !== _win[scan + 1]) {\n      continue;\n    }\n\n    /* The check at best_len-1 can be removed because it will be made\n     * again later. (This heuristic is not always a win.)\n     * It is not necessary to compare scan[2] and match[2] since they\n     * are always equal when the other bytes match, given that\n     * the hash keys are equal and that HASH_BITS >= 8.\n     */\n    scan += 2;\n    match++;\n    // Assert(*scan == *match, \"match[2]?\");\n\n    /* We check for insufficient lookahead only every 8th comparison;\n     * the 256th check will be made at strstart+258.\n     */\n    do {\n      /*jshint noempty:false*/\n    } while (_win[++scan] === _win[++match] && _win[++scan] === _win[++match] &&\n             _win[++scan] === _win[++match] && _win[++scan] === _win[++match] &&\n             _win[++scan] === _win[++match] && _win[++scan] === _win[++match] &&\n             _win[++scan] === _win[++match] && _win[++scan] === _win[++match] &&\n             scan < strend);\n\n    // Assert(scan <= s->window+(unsigned)(s->window_size-1), \"wild scan\");\n\n    len = MAX_MATCH - (strend - scan);\n    scan = strend - MAX_MATCH;\n\n    if (len > best_len) {\n      s.match_start = cur_match;\n      best_len = len;\n      if (len >= nice_match) {\n        break;\n      }\n      scan_end1  = _win[scan + best_len - 1];\n      scan_end   = _win[scan + best_len];\n    }\n  } while ((cur_match = prev[cur_match & wmask]) > limit && --chain_length !== 0);\n\n  if (best_len <= s.lookahead) {\n    return best_len;\n  }\n  return s.lookahead;\n};\n\n\n/* ===========================================================================\n * Fill the window when the lookahead becomes insufficient.\n * Updates strstart and lookahead.\n *\n * IN assertion: lookahead < MIN_LOOKAHEAD\n * OUT assertions: strstart <= window_size-MIN_LOOKAHEAD\n *    At least one byte has been read, or avail_in == 0; reads are\n *    performed for at least two bytes (required for the zip translate_eol\n *    option -- not supported here).\n */\nconst fill_window = (s) => {\n\n  const _w_size = s.w_size;\n  let n, more, str;\n\n  //Assert(s->lookahead < MIN_LOOKAHEAD, \"already enough lookahead\");\n\n  do {\n    more = s.window_size - s.lookahead - s.strstart;\n\n    // JS ints have 32 bit, block below not needed\n    /* Deal with !@#$% 64K limit: */\n    //if (sizeof(int) <= 2) {\n    //    if (more == 0 && s->strstart == 0 && s->lookahead == 0) {\n    //        more = wsize;\n    //\n    //  } else if (more == (unsigned)(-1)) {\n    //        /* Very unlikely, but possible on 16 bit machine if\n    //         * strstart == 0 && lookahead == 1 (input done a byte at time)\n    //         */\n    //        more--;\n    //    }\n    //}\n\n\n    /* If the window is almost full and there is insufficient lookahead,\n     * move the upper half to the lower one to make room in the upper half.\n     */\n    if (s.strstart >= _w_size + (_w_size - MIN_LOOKAHEAD)) {\n\n      s.window.set(s.window.subarray(_w_size, _w_size + _w_size - more), 0);\n      s.match_start -= _w_size;\n      s.strstart -= _w_size;\n      /* we now have strstart >= MAX_DIST */\n      s.block_start -= _w_size;\n      if (s.insert > s.strstart) {\n        s.insert = s.strstart;\n      }\n      slide_hash(s);\n      more += _w_size;\n    }\n    if (s.strm.avail_in === 0) {\n      break;\n    }\n\n    /* If there was no sliding:\n     *    strstart <= WSIZE+MAX_DIST-1 && lookahead <= MIN_LOOKAHEAD - 1 &&\n     *    more == window_size - lookahead - strstart\n     * => more >= window_size - (MIN_LOOKAHEAD-1 + WSIZE + MAX_DIST-1)\n     * => more >= window_size - 2*WSIZE + 2\n     * In the BIG_MEM or MMAP case (not yet supported),\n     *   window_size == input_size + MIN_LOOKAHEAD  &&\n     *   strstart + s->lookahead <= input_size => more >= MIN_LOOKAHEAD.\n     * Otherwise, window_size == 2*WSIZE so more >= 2.\n     * If there was sliding, more >= WSIZE. So in all cases, more >= 2.\n     */\n    //Assert(more >= 2, \"more < 2\");\n    n = read_buf(s.strm, s.window, s.strstart + s.lookahead, more);\n    s.lookahead += n;\n\n    /* Initialize the hash value now that we have some input: */\n    if (s.lookahead + s.insert >= MIN_MATCH) {\n      str = s.strstart - s.insert;\n      s.ins_h = s.window[str];\n\n      /* UPDATE_HASH(s, s->ins_h, s->window[str + 1]); */\n      s.ins_h = HASH(s, s.ins_h, s.window[str + 1]);\n//#if MIN_MATCH != 3\n//        Call update_hash() MIN_MATCH-3 more times\n//#endif\n      while (s.insert) {\n        /* UPDATE_HASH(s, s->ins_h, s->window[str + MIN_MATCH-1]); */\n        s.ins_h = HASH(s, s.ins_h, s.window[str + MIN_MATCH - 1]);\n\n        s.prev[str & s.w_mask] = s.head[s.ins_h];\n        s.head[s.ins_h] = str;\n        str++;\n        s.insert--;\n        if (s.lookahead + s.insert < MIN_MATCH) {\n          break;\n        }\n      }\n    }\n    /* If the whole input has less than MIN_MATCH bytes, ins_h is garbage,\n     * but this is not important since only literal bytes will be emitted.\n     */\n\n  } while (s.lookahead < MIN_LOOKAHEAD && s.strm.avail_in !== 0);\n\n  /* If the WIN_INIT bytes after the end of the current data have never been\n   * written, then zero those bytes in order to avoid memory check reports of\n   * the use of uninitialized (or uninitialised as Julian writes) bytes by\n   * the longest match routines.  Update the high water mark for the next\n   * time through here.  WIN_INIT is set to MAX_MATCH since the longest match\n   * routines allow scanning to strstart + MAX_MATCH, ignoring lookahead.\n   */\n//  if (s.high_water < s.window_size) {\n//    const curr = s.strstart + s.lookahead;\n//    let init = 0;\n//\n//    if (s.high_water < curr) {\n//      /* Previous high water mark below current data -- zero WIN_INIT\n//       * bytes or up to end of window, whichever is less.\n//       */\n//      init = s.window_size - curr;\n//      if (init > WIN_INIT)\n//        init = WIN_INIT;\n//      zmemzero(s->window + curr, (unsigned)init);\n//      s->high_water = curr + init;\n//    }\n//    else if (s->high_water < (ulg)curr + WIN_INIT) {\n//      /* High water mark at or above current data, but below current data\n//       * plus WIN_INIT -- zero out to current data plus WIN_INIT, or up\n//       * to end of window, whichever is less.\n//       */\n//      init = (ulg)curr + WIN_INIT - s->high_water;\n//      if (init > s->window_size - s->high_water)\n//        init = s->window_size - s->high_water;\n//      zmemzero(s->window + s->high_water, (unsigned)init);\n//      s->high_water += init;\n//    }\n//  }\n//\n//  Assert((ulg)s->strstart <= s->window_size - MIN_LOOKAHEAD,\n//    \"not enough room for search\");\n};\n\n/* ===========================================================================\n * Copy without compression as much as possible from the input stream, return\n * the current block state.\n *\n * In case deflateParams() is used to later switch to a non-zero compression\n * level, s->matches (otherwise unused when storing) keeps track of the number\n * of hash table slides to perform. If s->matches is 1, then one hash table\n * slide will be done when switching. If s->matches is 2, the maximum value\n * allowed here, then the hash table will be cleared, since two or more slides\n * is the same as a clear.\n *\n * deflate_stored() is written to minimize the number of times an input byte is\n * copied. It is most efficient with large input and output buffers, which\n * maximizes the opportunites to have a single copy from next_in to next_out.\n */\nconst deflate_stored = (s, flush) => {\n\n  /* Smallest worthy block size when not flushing or finishing. By default\n   * this is 32K. This can be as small as 507 bytes for memLevel == 1. For\n   * large input and output buffers, the stored block size will be larger.\n   */\n  let min_block = s.pending_buf_size - 5 > s.w_size ? s.w_size : s.pending_buf_size - 5;\n\n  /* Copy as many min_block or larger stored blocks directly to next_out as\n   * possible. If flushing, copy the remaining available input to next_out as\n   * stored blocks, if there is enough space.\n   */\n  let len, left, have, last = 0;\n  let used = s.strm.avail_in;\n  do {\n    /* Set len to the maximum size block that we can copy directly with the\n     * available input data and output space. Set left to how much of that\n     * would be copied from what's left in the window.\n     */\n    len = 65535/* MAX_STORED */;     /* maximum deflate stored block length */\n    have = (s.bi_valid + 42) >> 3;     /* number of header bytes */\n    if (s.strm.avail_out < have) {         /* need room for header */\n      break;\n    }\n      /* maximum stored block length that will fit in avail_out: */\n    have = s.strm.avail_out - have;\n    left = s.strstart - s.block_start;  /* bytes left in window */\n    if (len > left + s.strm.avail_in) {\n      len = left + s.strm.avail_in;   /* limit len to the input */\n    }\n    if (len > have) {\n      len = have;             /* limit len to the output */\n    }\n\n    /* If the stored block would be less than min_block in length, or if\n     * unable to copy all of the available input when flushing, then try\n     * copying to the window and the pending buffer instead. Also don't\n     * write an empty block when flushing -- deflate() does that.\n     */\n    if (len < min_block && ((len === 0 && flush !== Z_FINISH$3) ||\n                        flush === Z_NO_FLUSH$2 ||\n                        len !== left + s.strm.avail_in)) {\n      break;\n    }\n\n    /* Make a dummy stored block in pending to get the header bytes,\n     * including any pending bits. This also updates the debugging counts.\n     */\n    last = flush === Z_FINISH$3 && len === left + s.strm.avail_in ? 1 : 0;\n    _tr_stored_block(s, 0, 0, last);\n\n    /* Replace the lengths in the dummy stored block with len. */\n    s.pending_buf[s.pending - 4] = len;\n    s.pending_buf[s.pending - 3] = len >> 8;\n    s.pending_buf[s.pending - 2] = ~len;\n    s.pending_buf[s.pending - 1] = ~len >> 8;\n\n    /* Write the stored block header bytes. */\n    flush_pending(s.strm);\n\n//#ifdef ZLIB_DEBUG\n//    /* Update debugging counts for the data about to be copied. */\n//    s->compressed_len += len << 3;\n//    s->bits_sent += len << 3;\n//#endif\n\n    /* Copy uncompressed bytes from the window to next_out. */\n    if (left) {\n      if (left > len) {\n        left = len;\n      }\n      //zmemcpy(s->strm->next_out, s->window + s->block_start, left);\n      s.strm.output.set(s.window.subarray(s.block_start, s.block_start + left), s.strm.next_out);\n      s.strm.next_out += left;\n      s.strm.avail_out -= left;\n      s.strm.total_out += left;\n      s.block_start += left;\n      len -= left;\n    }\n\n    /* Copy uncompressed bytes directly from next_in to next_out, updating\n     * the check value.\n     */\n    if (len) {\n      read_buf(s.strm, s.strm.output, s.strm.next_out, len);\n      s.strm.next_out += len;\n      s.strm.avail_out -= len;\n      s.strm.total_out += len;\n    }\n  } while (last === 0);\n\n  /* Update the sliding window with the last s->w_size bytes of the copied\n   * data, or append all of the copied data to the existing window if less\n   * than s->w_size bytes were copied. Also update the number of bytes to\n   * insert in the hash tables, in the event that deflateParams() switches to\n   * a non-zero compression level.\n   */\n  used -= s.strm.avail_in;    /* number of input bytes directly copied */\n  if (used) {\n    /* If any input was used, then no unused input remains in the window,\n     * therefore s->block_start == s->strstart.\n     */\n    if (used >= s.w_size) {  /* supplant the previous history */\n      s.matches = 2;     /* clear hash */\n      //zmemcpy(s->window, s->strm->next_in - s->w_size, s->w_size);\n      s.window.set(s.strm.input.subarray(s.strm.next_in - s.w_size, s.strm.next_in), 0);\n      s.strstart = s.w_size;\n      s.insert = s.strstart;\n    }\n    else {\n      if (s.window_size - s.strstart <= used) {\n        /* Slide the window down. */\n        s.strstart -= s.w_size;\n        //zmemcpy(s->window, s->window + s->w_size, s->strstart);\n        s.window.set(s.window.subarray(s.w_size, s.w_size + s.strstart), 0);\n        if (s.matches < 2) {\n          s.matches++;   /* add a pending slide_hash() */\n        }\n        if (s.insert > s.strstart) {\n          s.insert = s.strstart;\n        }\n      }\n      //zmemcpy(s->window + s->strstart, s->strm->next_in - used, used);\n      s.window.set(s.strm.input.subarray(s.strm.next_in - used, s.strm.next_in), s.strstart);\n      s.strstart += used;\n      s.insert += used > s.w_size - s.insert ? s.w_size - s.insert : used;\n    }\n    s.block_start = s.strstart;\n  }\n  if (s.high_water < s.strstart) {\n    s.high_water = s.strstart;\n  }\n\n  /* If the last block was written to next_out, then done. */\n  if (last) {\n    return BS_FINISH_DONE;\n  }\n\n  /* If flushing and all input has been consumed, then done. */\n  if (flush !== Z_NO_FLUSH$2 && flush !== Z_FINISH$3 &&\n    s.strm.avail_in === 0 && s.strstart === s.block_start) {\n    return BS_BLOCK_DONE;\n  }\n\n  /* Fill the window with any remaining input. */\n  have = s.window_size - s.strstart;\n  if (s.strm.avail_in > have && s.block_start >= s.w_size) {\n    /* Slide the window down. */\n    s.block_start -= s.w_size;\n    s.strstart -= s.w_size;\n    //zmemcpy(s->window, s->window + s->w_size, s->strstart);\n    s.window.set(s.window.subarray(s.w_size, s.w_size + s.strstart), 0);\n    if (s.matches < 2) {\n      s.matches++;       /* add a pending slide_hash() */\n    }\n    have += s.w_size;      /* more space now */\n    if (s.insert > s.strstart) {\n      s.insert = s.strstart;\n    }\n  }\n  if (have > s.strm.avail_in) {\n    have = s.strm.avail_in;\n  }\n  if (have) {\n    read_buf(s.strm, s.window, s.strstart, have);\n    s.strstart += have;\n    s.insert += have > s.w_size - s.insert ? s.w_size - s.insert : have;\n  }\n  if (s.high_water < s.strstart) {\n    s.high_water = s.strstart;\n  }\n\n  /* There was not enough avail_out to write a complete worthy or flushed\n   * stored block to next_out. Write a stored block to pending instead, if we\n   * have enough input for a worthy block, or if flushing and there is enough\n   * room for the remaining input as a stored block in the pending buffer.\n   */\n  have = (s.bi_valid + 42) >> 3;     /* number of header bytes */\n    /* maximum stored block length that will fit in pending: */\n  have = s.pending_buf_size - have > 65535/* MAX_STORED */ ? 65535/* MAX_STORED */ : s.pending_buf_size - have;\n  min_block = have > s.w_size ? s.w_size : have;\n  left = s.strstart - s.block_start;\n  if (left >= min_block ||\n     ((left || flush === Z_FINISH$3) && flush !== Z_NO_FLUSH$2 &&\n     s.strm.avail_in === 0 && left <= have)) {\n    len = left > have ? have : left;\n    last = flush === Z_FINISH$3 && s.strm.avail_in === 0 &&\n         len === left ? 1 : 0;\n    _tr_stored_block(s, s.block_start, len, last);\n    s.block_start += len;\n    flush_pending(s.strm);\n  }\n\n  /* We've done all we can with the available input and output. */\n  return last ? BS_FINISH_STARTED : BS_NEED_MORE;\n};\n\n\n/* ===========================================================================\n * Compress as much as possible from the input stream, return the current\n * block state.\n * This function does not perform lazy evaluation of matches and inserts\n * new strings in the dictionary only for unmatched strings or for short\n * matches. It is used only for the fast compression options.\n */\nconst deflate_fast = (s, flush) => {\n\n  let hash_head;        /* head of the hash chain */\n  let bflush;           /* set if current block must be flushed */\n\n  for (;;) {\n    /* Make sure that we always have enough lookahead, except\n     * at the end of the input file. We need MAX_MATCH bytes\n     * for the next match, plus MIN_MATCH bytes to insert the\n     * string following the next match.\n     */\n    if (s.lookahead < MIN_LOOKAHEAD) {\n      fill_window(s);\n      if (s.lookahead < MIN_LOOKAHEAD && flush === Z_NO_FLUSH$2) {\n        return BS_NEED_MORE;\n      }\n      if (s.lookahead === 0) {\n        break; /* flush the current block */\n      }\n    }\n\n    /* Insert the string window[strstart .. strstart+2] in the\n     * dictionary, and set hash_head to the head of the hash chain:\n     */\n    hash_head = 0/*NIL*/;\n    if (s.lookahead >= MIN_MATCH) {\n      /*** INSERT_STRING(s, s.strstart, hash_head); ***/\n      s.ins_h = HASH(s, s.ins_h, s.window[s.strstart + MIN_MATCH - 1]);\n      hash_head = s.prev[s.strstart & s.w_mask] = s.head[s.ins_h];\n      s.head[s.ins_h] = s.strstart;\n      /***/\n    }\n\n    /* Find the longest match, discarding those <= prev_length.\n     * At this point we have always match_length < MIN_MATCH\n     */\n    if (hash_head !== 0/*NIL*/ && ((s.strstart - hash_head) <= (s.w_size - MIN_LOOKAHEAD))) {\n      /* To simplify the code, we prevent matches with the string\n       * of window index 0 (in particular we have to avoid a match\n       * of the string with itself at the start of the input file).\n       */\n      s.match_length = longest_match(s, hash_head);\n      /* longest_match() sets match_start */\n    }\n    if (s.match_length >= MIN_MATCH) {\n      // check_match(s, s.strstart, s.match_start, s.match_length); // for debug only\n\n      /*** _tr_tally_dist(s, s.strstart - s.match_start,\n                     s.match_length - MIN_MATCH, bflush); ***/\n      bflush = _tr_tally(s, s.strstart - s.match_start, s.match_length - MIN_MATCH);\n\n      s.lookahead -= s.match_length;\n\n      /* Insert new strings in the hash table only if the match length\n       * is not too large. This saves time but degrades compression.\n       */\n      if (s.match_length <= s.max_lazy_match/*max_insert_length*/ && s.lookahead >= MIN_MATCH) {\n        s.match_length--; /* string at strstart already in table */\n        do {\n          s.strstart++;\n          /*** INSERT_STRING(s, s.strstart, hash_head); ***/\n          s.ins_h = HASH(s, s.ins_h, s.window[s.strstart + MIN_MATCH - 1]);\n          hash_head = s.prev[s.strstart & s.w_mask] = s.head[s.ins_h];\n          s.head[s.ins_h] = s.strstart;\n          /***/\n          /* strstart never exceeds WSIZE-MAX_MATCH, so there are\n           * always MIN_MATCH bytes ahead.\n           */\n        } while (--s.match_length !== 0);\n        s.strstart++;\n      } else\n      {\n        s.strstart += s.match_length;\n        s.match_length = 0;\n        s.ins_h = s.window[s.strstart];\n        /* UPDATE_HASH(s, s.ins_h, s.window[s.strstart+1]); */\n        s.ins_h = HASH(s, s.ins_h, s.window[s.strstart + 1]);\n\n//#if MIN_MATCH != 3\n//                Call UPDATE_HASH() MIN_MATCH-3 more times\n//#endif\n        /* If lookahead < MIN_MATCH, ins_h is garbage, but it does not\n         * matter since it will be recomputed at next deflate call.\n         */\n      }\n    } else {\n      /* No match, output a literal byte */\n      //Tracevv((stderr,\"%c\", s.window[s.strstart]));\n      /*** _tr_tally_lit(s, s.window[s.strstart], bflush); ***/\n      bflush = _tr_tally(s, 0, s.window[s.strstart]);\n\n      s.lookahead--;\n      s.strstart++;\n    }\n    if (bflush) {\n      /*** FLUSH_BLOCK(s, 0); ***/\n      flush_block_only(s, false);\n      if (s.strm.avail_out === 0) {\n        return BS_NEED_MORE;\n      }\n      /***/\n    }\n  }\n  s.insert = ((s.strstart < (MIN_MATCH - 1)) ? s.strstart : MIN_MATCH - 1);\n  if (flush === Z_FINISH$3) {\n    /*** FLUSH_BLOCK(s, 1); ***/\n    flush_block_only(s, true);\n    if (s.strm.avail_out === 0) {\n      return BS_FINISH_STARTED;\n    }\n    /***/\n    return BS_FINISH_DONE;\n  }\n  if (s.sym_next) {\n    /*** FLUSH_BLOCK(s, 0); ***/\n    flush_block_only(s, false);\n    if (s.strm.avail_out === 0) {\n      return BS_NEED_MORE;\n    }\n    /***/\n  }\n  return BS_BLOCK_DONE;\n};\n\n/* ===========================================================================\n * Same as above, but achieves better compression. We use a lazy\n * evaluation for matches: a match is finally adopted only if there is\n * no better match at the next window position.\n */\nconst deflate_slow = (s, flush) => {\n\n  let hash_head;          /* head of hash chain */\n  let bflush;              /* set if current block must be flushed */\n\n  let max_insert;\n\n  /* Process the input block. */\n  for (;;) {\n    /* Make sure that we always have enough lookahead, except\n     * at the end of the input file. We need MAX_MATCH bytes\n     * for the next match, plus MIN_MATCH bytes to insert the\n     * string following the next match.\n     */\n    if (s.lookahead < MIN_LOOKAHEAD) {\n      fill_window(s);\n      if (s.lookahead < MIN_LOOKAHEAD && flush === Z_NO_FLUSH$2) {\n        return BS_NEED_MORE;\n      }\n      if (s.lookahead === 0) { break; } /* flush the current block */\n    }\n\n    /* Insert the string window[strstart .. strstart+2] in the\n     * dictionary, and set hash_head to the head of the hash chain:\n     */\n    hash_head = 0/*NIL*/;\n    if (s.lookahead >= MIN_MATCH) {\n      /*** INSERT_STRING(s, s.strstart, hash_head); ***/\n      s.ins_h = HASH(s, s.ins_h, s.window[s.strstart + MIN_MATCH - 1]);\n      hash_head = s.prev[s.strstart & s.w_mask] = s.head[s.ins_h];\n      s.head[s.ins_h] = s.strstart;\n      /***/\n    }\n\n    /* Find the longest match, discarding those <= prev_length.\n     */\n    s.prev_length = s.match_length;\n    s.prev_match = s.match_start;\n    s.match_length = MIN_MATCH - 1;\n\n    if (hash_head !== 0/*NIL*/ && s.prev_length < s.max_lazy_match &&\n        s.strstart - hash_head <= (s.w_size - MIN_LOOKAHEAD)/*MAX_DIST(s)*/) {\n      /* To simplify the code, we prevent matches with the string\n       * of window index 0 (in particular we have to avoid a match\n       * of the string with itself at the start of the input file).\n       */\n      s.match_length = longest_match(s, hash_head);\n      /* longest_match() sets match_start */\n\n      if (s.match_length <= 5 &&\n         (s.strategy === Z_FILTERED || (s.match_length === MIN_MATCH && s.strstart - s.match_start > 4096/*TOO_FAR*/))) {\n\n        /* If prev_match is also MIN_MATCH, match_start is garbage\n         * but we will ignore the current match anyway.\n         */\n        s.match_length = MIN_MATCH - 1;\n      }\n    }\n    /* If there was a match at the previous step and the current\n     * match is not better, output the previous match:\n     */\n    if (s.prev_length >= MIN_MATCH && s.match_length <= s.prev_length) {\n      max_insert = s.strstart + s.lookahead - MIN_MATCH;\n      /* Do not insert strings in hash table beyond this. */\n\n      //check_match(s, s.strstart-1, s.prev_match, s.prev_length);\n\n      /***_tr_tally_dist(s, s.strstart - 1 - s.prev_match,\n                     s.prev_length - MIN_MATCH, bflush);***/\n      bflush = _tr_tally(s, s.strstart - 1 - s.prev_match, s.prev_length - MIN_MATCH);\n      /* Insert in hash table all strings up to the end of the match.\n       * strstart-1 and strstart are already inserted. If there is not\n       * enough lookahead, the last two strings are not inserted in\n       * the hash table.\n       */\n      s.lookahead -= s.prev_length - 1;\n      s.prev_length -= 2;\n      do {\n        if (++s.strstart <= max_insert) {\n          /*** INSERT_STRING(s, s.strstart, hash_head); ***/\n          s.ins_h = HASH(s, s.ins_h, s.window[s.strstart + MIN_MATCH - 1]);\n          hash_head = s.prev[s.strstart & s.w_mask] = s.head[s.ins_h];\n          s.head[s.ins_h] = s.strstart;\n          /***/\n        }\n      } while (--s.prev_length !== 0);\n      s.match_available = 0;\n      s.match_length = MIN_MATCH - 1;\n      s.strstart++;\n\n      if (bflush) {\n        /*** FLUSH_BLOCK(s, 0); ***/\n        flush_block_only(s, false);\n        if (s.strm.avail_out === 0) {\n          return BS_NEED_MORE;\n        }\n        /***/\n      }\n\n    } else if (s.match_available) {\n      /* If there was no match at the previous position, output a\n       * single literal. If there was a match but the current match\n       * is longer, truncate the previous match to a single literal.\n       */\n      //Tracevv((stderr,\"%c\", s->window[s->strstart-1]));\n      /*** _tr_tally_lit(s, s.window[s.strstart-1], bflush); ***/\n      bflush = _tr_tally(s, 0, s.window[s.strstart - 1]);\n\n      if (bflush) {\n        /*** FLUSH_BLOCK_ONLY(s, 0) ***/\n        flush_block_only(s, false);\n        /***/\n      }\n      s.strstart++;\n      s.lookahead--;\n      if (s.strm.avail_out === 0) {\n        return BS_NEED_MORE;\n      }\n    } else {\n      /* There is no previous match to compare with, wait for\n       * the next step to decide.\n       */\n      s.match_available = 1;\n      s.strstart++;\n      s.lookahead--;\n    }\n  }\n  //Assert (flush != Z_NO_FLUSH, \"no flush?\");\n  if (s.match_available) {\n    //Tracevv((stderr,\"%c\", s->window[s->strstart-1]));\n    /*** _tr_tally_lit(s, s.window[s.strstart-1], bflush); ***/\n    bflush = _tr_tally(s, 0, s.window[s.strstart - 1]);\n\n    s.match_available = 0;\n  }\n  s.insert = s.strstart < MIN_MATCH - 1 ? s.strstart : MIN_MATCH - 1;\n  if (flush === Z_FINISH$3) {\n    /*** FLUSH_BLOCK(s, 1); ***/\n    flush_block_only(s, true);\n    if (s.strm.avail_out === 0) {\n      return BS_FINISH_STARTED;\n    }\n    /***/\n    return BS_FINISH_DONE;\n  }\n  if (s.sym_next) {\n    /*** FLUSH_BLOCK(s, 0); ***/\n    flush_block_only(s, false);\n    if (s.strm.avail_out === 0) {\n      return BS_NEED_MORE;\n    }\n    /***/\n  }\n\n  return BS_BLOCK_DONE;\n};\n\n\n/* ===========================================================================\n * For Z_RLE, simply look for runs of bytes, generate matches only of distance\n * one.  Do not maintain a hash table.  (It will be regenerated if this run of\n * deflate switches away from Z_RLE.)\n */\nconst deflate_rle = (s, flush) => {\n\n  let bflush;            /* set if current block must be flushed */\n  let prev;              /* byte at distance one to match */\n  let scan, strend;      /* scan goes up to strend for length of run */\n\n  const _win = s.window;\n\n  for (;;) {\n    /* Make sure that we always have enough lookahead, except\n     * at the end of the input file. We need MAX_MATCH bytes\n     * for the longest run, plus one for the unrolled loop.\n     */\n    if (s.lookahead <= MAX_MATCH) {\n      fill_window(s);\n      if (s.lookahead <= MAX_MATCH && flush === Z_NO_FLUSH$2) {\n        return BS_NEED_MORE;\n      }\n      if (s.lookahead === 0) { break; } /* flush the current block */\n    }\n\n    /* See how many times the previous byte repeats */\n    s.match_length = 0;\n    if (s.lookahead >= MIN_MATCH && s.strstart > 0) {\n      scan = s.strstart - 1;\n      prev = _win[scan];\n      if (prev === _win[++scan] && prev === _win[++scan] && prev === _win[++scan]) {\n        strend = s.strstart + MAX_MATCH;\n        do {\n          /*jshint noempty:false*/\n        } while (prev === _win[++scan] && prev === _win[++scan] &&\n                 prev === _win[++scan] && prev === _win[++scan] &&\n                 prev === _win[++scan] && prev === _win[++scan] &&\n                 prev === _win[++scan] && prev === _win[++scan] &&\n                 scan < strend);\n        s.match_length = MAX_MATCH - (strend - scan);\n        if (s.match_length > s.lookahead) {\n          s.match_length = s.lookahead;\n        }\n      }\n      //Assert(scan <= s->window+(uInt)(s->window_size-1), \"wild scan\");\n    }\n\n    /* Emit match if have run of MIN_MATCH or longer, else emit literal */\n    if (s.match_length >= MIN_MATCH) {\n      //check_match(s, s.strstart, s.strstart - 1, s.match_length);\n\n      /*** _tr_tally_dist(s, 1, s.match_length - MIN_MATCH, bflush); ***/\n      bflush = _tr_tally(s, 1, s.match_length - MIN_MATCH);\n\n      s.lookahead -= s.match_length;\n      s.strstart += s.match_length;\n      s.match_length = 0;\n    } else {\n      /* No match, output a literal byte */\n      //Tracevv((stderr,\"%c\", s->window[s->strstart]));\n      /*** _tr_tally_lit(s, s.window[s.strstart], bflush); ***/\n      bflush = _tr_tally(s, 0, s.window[s.strstart]);\n\n      s.lookahead--;\n      s.strstart++;\n    }\n    if (bflush) {\n      /*** FLUSH_BLOCK(s, 0); ***/\n      flush_block_only(s, false);\n      if (s.strm.avail_out === 0) {\n        return BS_NEED_MORE;\n      }\n      /***/\n    }\n  }\n  s.insert = 0;\n  if (flush === Z_FINISH$3) {\n    /*** FLUSH_BLOCK(s, 1); ***/\n    flush_block_only(s, true);\n    if (s.strm.avail_out === 0) {\n      return BS_FINISH_STARTED;\n    }\n    /***/\n    return BS_FINISH_DONE;\n  }\n  if (s.sym_next) {\n    /*** FLUSH_BLOCK(s, 0); ***/\n    flush_block_only(s, false);\n    if (s.strm.avail_out === 0) {\n      return BS_NEED_MORE;\n    }\n    /***/\n  }\n  return BS_BLOCK_DONE;\n};\n\n/* ===========================================================================\n * For Z_HUFFMAN_ONLY, do not look for matches.  Do not maintain a hash table.\n * (It will be regenerated if this run of deflate switches away from Huffman.)\n */\nconst deflate_huff = (s, flush) => {\n\n  let bflush;             /* set if current block must be flushed */\n\n  for (;;) {\n    /* Make sure that we have a literal to write. */\n    if (s.lookahead === 0) {\n      fill_window(s);\n      if (s.lookahead === 0) {\n        if (flush === Z_NO_FLUSH$2) {\n          return BS_NEED_MORE;\n        }\n        break;      /* flush the current block */\n      }\n    }\n\n    /* Output a literal byte */\n    s.match_length = 0;\n    //Tracevv((stderr,\"%c\", s->window[s->strstart]));\n    /*** _tr_tally_lit(s, s.window[s.strstart], bflush); ***/\n    bflush = _tr_tally(s, 0, s.window[s.strstart]);\n    s.lookahead--;\n    s.strstart++;\n    if (bflush) {\n      /*** FLUSH_BLOCK(s, 0); ***/\n      flush_block_only(s, false);\n      if (s.strm.avail_out === 0) {\n        return BS_NEED_MORE;\n      }\n      /***/\n    }\n  }\n  s.insert = 0;\n  if (flush === Z_FINISH$3) {\n    /*** FLUSH_BLOCK(s, 1); ***/\n    flush_block_only(s, true);\n    if (s.strm.avail_out === 0) {\n      return BS_FINISH_STARTED;\n    }\n    /***/\n    return BS_FINISH_DONE;\n  }\n  if (s.sym_next) {\n    /*** FLUSH_BLOCK(s, 0); ***/\n    flush_block_only(s, false);\n    if (s.strm.avail_out === 0) {\n      return BS_NEED_MORE;\n    }\n    /***/\n  }\n  return BS_BLOCK_DONE;\n};\n\n/* Values for max_lazy_match, good_match and max_chain_length, depending on\n * the desired pack level (0..9). The values given below have been tuned to\n * exclude worst case performance for pathological files. Better values may be\n * found for specific files.\n */\nfunction Config(good_length, max_lazy, nice_length, max_chain, func) {\n\n  this.good_length = good_length;\n  this.max_lazy = max_lazy;\n  this.nice_length = nice_length;\n  this.max_chain = max_chain;\n  this.func = func;\n}\n\nconst configuration_table = [\n  /*      good lazy nice chain */\n  new Config(0, 0, 0, 0, deflate_stored),          /* 0 store only */\n  new Config(4, 4, 8, 4, deflate_fast),            /* 1 max speed, no lazy matches */\n  new Config(4, 5, 16, 8, deflate_fast),           /* 2 */\n  new Config(4, 6, 32, 32, deflate_fast),          /* 3 */\n\n  new Config(4, 4, 16, 16, deflate_slow),          /* 4 lazy matches */\n  new Config(8, 16, 32, 32, deflate_slow),         /* 5 */\n  new Config(8, 16, 128, 128, deflate_slow),       /* 6 */\n  new Config(8, 32, 128, 256, deflate_slow),       /* 7 */\n  new Config(32, 128, 258, 1024, deflate_slow),    /* 8 */\n  new Config(32, 258, 258, 4096, deflate_slow)     /* 9 max compression */\n];\n\n\n/* ===========================================================================\n * Initialize the \"longest match\" routines for a new zlib stream\n */\nconst lm_init = (s) => {\n\n  s.window_size = 2 * s.w_size;\n\n  /*** CLEAR_HASH(s); ***/\n  zero(s.head); // Fill with NIL (= 0);\n\n  /* Set the default configuration parameters:\n   */\n  s.max_lazy_match = configuration_table[s.level].max_lazy;\n  s.good_match = configuration_table[s.level].good_length;\n  s.nice_match = configuration_table[s.level].nice_length;\n  s.max_chain_length = configuration_table[s.level].max_chain;\n\n  s.strstart = 0;\n  s.block_start = 0;\n  s.lookahead = 0;\n  s.insert = 0;\n  s.match_length = s.prev_length = MIN_MATCH - 1;\n  s.match_available = 0;\n  s.ins_h = 0;\n};\n\n\nfunction DeflateState() {\n  this.strm = null;            /* pointer back to this zlib stream */\n  this.status = 0;            /* as the name implies */\n  this.pending_buf = null;      /* output still pending */\n  this.pending_buf_size = 0;  /* size of pending_buf */\n  this.pending_out = 0;       /* next pending byte to output to the stream */\n  this.pending = 0;           /* nb of bytes in the pending buffer */\n  this.wrap = 0;              /* bit 0 true for zlib, bit 1 true for gzip */\n  this.gzhead = null;         /* gzip header information to write */\n  this.gzindex = 0;           /* where in extra, name, or comment */\n  this.method = Z_DEFLATED$2; /* can only be DEFLATED */\n  this.last_flush = -1;   /* value of flush param for previous deflate call */\n\n  this.w_size = 0;  /* LZ77 window size (32K by default) */\n  this.w_bits = 0;  /* log2(w_size)  (8..16) */\n  this.w_mask = 0;  /* w_size - 1 */\n\n  this.window = null;\n  /* Sliding window. Input bytes are read into the second half of the window,\n   * and move to the first half later to keep a dictionary of at least wSize\n   * bytes. With this organization, matches are limited to a distance of\n   * wSize-MAX_MATCH bytes, but this ensures that IO is always\n   * performed with a length multiple of the block size.\n   */\n\n  this.window_size = 0;\n  /* Actual size of window: 2*wSize, except when the user input buffer\n   * is directly used as sliding window.\n   */\n\n  this.prev = null;\n  /* Link to older string with same hash index. To limit the size of this\n   * array to 64K, this link is maintained only for the last 32K strings.\n   * An index in this array is thus a window index modulo 32K.\n   */\n\n  this.head = null;   /* Heads of the hash chains or NIL. */\n\n  this.ins_h = 0;       /* hash index of string to be inserted */\n  this.hash_size = 0;   /* number of elements in hash table */\n  this.hash_bits = 0;   /* log2(hash_size) */\n  this.hash_mask = 0;   /* hash_size-1 */\n\n  this.hash_shift = 0;\n  /* Number of bits by which ins_h must be shifted at each input\n   * step. It must be such that after MIN_MATCH steps, the oldest\n   * byte no longer takes part in the hash key, that is:\n   *   hash_shift * MIN_MATCH >= hash_bits\n   */\n\n  this.block_start = 0;\n  /* Window position at the beginning of the current output block. Gets\n   * negative when the window is moved backwards.\n   */\n\n  this.match_length = 0;      /* length of best match */\n  this.prev_match = 0;        /* previous match */\n  this.match_available = 0;   /* set if previous match exists */\n  this.strstart = 0;          /* start of string to insert */\n  this.match_start = 0;       /* start of matching string */\n  this.lookahead = 0;         /* number of valid bytes ahead in window */\n\n  this.prev_length = 0;\n  /* Length of the best match at previous step. Matches not greater than this\n   * are discarded. This is used in the lazy match evaluation.\n   */\n\n  this.max_chain_length = 0;\n  /* To speed up deflation, hash chains are never searched beyond this\n   * length.  A higher limit improves compression ratio but degrades the\n   * speed.\n   */\n\n  this.max_lazy_match = 0;\n  /* Attempt to find a better match only when the current match is strictly\n   * smaller than this value. This mechanism is used only for compression\n   * levels >= 4.\n   */\n  // That's alias to max_lazy_match, don't use directly\n  //this.max_insert_length = 0;\n  /* Insert new strings in the hash table only if the match length is not\n   * greater than this length. This saves time but degrades compression.\n   * max_insert_length is used only for compression levels <= 3.\n   */\n\n  this.level = 0;     /* compression level (1..9) */\n  this.strategy = 0;  /* favor or force Huffman coding*/\n\n  this.good_match = 0;\n  /* Use a faster search when the previous match is longer than this */\n\n  this.nice_match = 0; /* Stop searching when current match exceeds this */\n\n              /* used by trees.c: */\n\n  /* Didn't use ct_data typedef below to suppress compiler warning */\n\n  // struct ct_data_s dyn_ltree[HEAP_SIZE];   /* literal and length tree */\n  // struct ct_data_s dyn_dtree[2*D_CODES+1]; /* distance tree */\n  // struct ct_data_s bl_tree[2*BL_CODES+1];  /* Huffman tree for bit lengths */\n\n  // Use flat array of DOUBLE size, with interleaved fata,\n  // because JS does not support effective\n  this.dyn_ltree  = new Uint16Array(HEAP_SIZE * 2);\n  this.dyn_dtree  = new Uint16Array((2 * D_CODES + 1) * 2);\n  this.bl_tree    = new Uint16Array((2 * BL_CODES + 1) * 2);\n  zero(this.dyn_ltree);\n  zero(this.dyn_dtree);\n  zero(this.bl_tree);\n\n  this.l_desc   = null;         /* desc. for literal tree */\n  this.d_desc   = null;         /* desc. for distance tree */\n  this.bl_desc  = null;         /* desc. for bit length tree */\n\n  //ush bl_count[MAX_BITS+1];\n  this.bl_count = new Uint16Array(MAX_BITS + 1);\n  /* number of codes at each bit length for an optimal tree */\n\n  //int heap[2*L_CODES+1];      /* heap used to build the Huffman trees */\n  this.heap = new Uint16Array(2 * L_CODES + 1);  /* heap used to build the Huffman trees */\n  zero(this.heap);\n\n  this.heap_len = 0;               /* number of elements in the heap */\n  this.heap_max = 0;               /* element of largest frequency */\n  /* The sons of heap[n] are heap[2*n] and heap[2*n+1]. heap[0] is not used.\n   * The same heap array is used to build all trees.\n   */\n\n  this.depth = new Uint16Array(2 * L_CODES + 1); //uch depth[2*L_CODES+1];\n  zero(this.depth);\n  /* Depth of each subtree used as tie breaker for trees of equal frequency\n   */\n\n  this.sym_buf = 0;        /* buffer for distances and literals/lengths */\n\n  this.lit_bufsize = 0;\n  /* Size of match buffer for literals/lengths.  There are 4 reasons for\n   * limiting lit_bufsize to 64K:\n   *   - frequencies can be kept in 16 bit counters\n   *   - if compression is not successful for the first block, all input\n   *     data is still in the window so we can still emit a stored block even\n   *     when input comes from standard input.  (This can also be done for\n   *     all blocks if lit_bufsize is not greater than 32K.)\n   *   - if compression is not successful for a file smaller than 64K, we can\n   *     even emit a stored file instead of a stored block (saving 5 bytes).\n   *     This is applicable only for zip (not gzip or zlib).\n   *   - creating new Huffman trees less frequently may not provide fast\n   *     adaptation to changes in the input data statistics. (Take for\n   *     example a binary file with poorly compressible code followed by\n   *     a highly compressible string table.) Smaller buffer sizes give\n   *     fast adaptation but have of course the overhead of transmitting\n   *     trees more frequently.\n   *   - I can't count above 4\n   */\n\n  this.sym_next = 0;      /* running index in sym_buf */\n  this.sym_end = 0;       /* symbol table full when sym_next reaches this */\n\n  this.opt_len = 0;       /* bit length of current block with optimal trees */\n  this.static_len = 0;    /* bit length of current block with static trees */\n  this.matches = 0;       /* number of string matches in current block */\n  this.insert = 0;        /* bytes at end of window left to insert */\n\n\n  this.bi_buf = 0;\n  /* Output buffer. bits are inserted starting at the bottom (least\n   * significant bits).\n   */\n  this.bi_valid = 0;\n  /* Number of valid bits in bi_buf.  All bits above the last valid bit\n   * are always zero.\n   */\n\n  // Used for window memory init. We safely ignore it for JS. That makes\n  // sense only for pointers and memory check tools.\n  //this.high_water = 0;\n  /* High water mark offset in window for initialized bytes -- bytes above\n   * this are set to zero in order to avoid memory check warnings when\n   * longest match routines access bytes past the input.  This is then\n   * updated to the new high water mark.\n   */\n}\n\n\n/* =========================================================================\n * Check for a valid deflate stream state. Return 0 if ok, 1 if not.\n */\nconst deflateStateCheck = (strm) => {\n\n  if (!strm) {\n    return 1;\n  }\n  const s = strm.state;\n  if (!s || s.strm !== strm || (s.status !== INIT_STATE &&\n//#ifdef GZIP\n                                s.status !== GZIP_STATE &&\n//#endif\n                                s.status !== EXTRA_STATE &&\n                                s.status !== NAME_STATE &&\n                                s.status !== COMMENT_STATE &&\n                                s.status !== HCRC_STATE &&\n                                s.status !== BUSY_STATE &&\n                                s.status !== FINISH_STATE)) {\n    return 1;\n  }\n  return 0;\n};\n\n\nconst deflateResetKeep = (strm) => {\n\n  if (deflateStateCheck(strm)) {\n    return err(strm, Z_STREAM_ERROR$2);\n  }\n\n  strm.total_in = strm.total_out = 0;\n  strm.data_type = Z_UNKNOWN;\n\n  const s = strm.state;\n  s.pending = 0;\n  s.pending_out = 0;\n\n  if (s.wrap < 0) {\n    s.wrap = -s.wrap;\n    /* was made negative by deflate(..., Z_FINISH); */\n  }\n  s.status =\n//#ifdef GZIP\n    s.wrap === 2 ? GZIP_STATE :\n//#endif\n    s.wrap ? INIT_STATE : BUSY_STATE;\n  strm.adler = (s.wrap === 2) ?\n    0  // crc32(0, Z_NULL, 0)\n  :\n    1; // adler32(0, Z_NULL, 0)\n  s.last_flush = -2;\n  _tr_init(s);\n  return Z_OK$3;\n};\n\n\nconst deflateReset = (strm) => {\n\n  const ret = deflateResetKeep(strm);\n  if (ret === Z_OK$3) {\n    lm_init(strm.state);\n  }\n  return ret;\n};\n\n\nconst deflateSetHeader = (strm, head) => {\n\n  if (deflateStateCheck(strm) || strm.state.wrap !== 2) {\n    return Z_STREAM_ERROR$2;\n  }\n  strm.state.gzhead = head;\n  return Z_OK$3;\n};\n\n\nconst deflateInit2 = (strm, level, method, windowBits, memLevel, strategy) => {\n\n  if (!strm) { // === Z_NULL\n    return Z_STREAM_ERROR$2;\n  }\n  let wrap = 1;\n\n  if (level === Z_DEFAULT_COMPRESSION$1) {\n    level = 6;\n  }\n\n  if (windowBits < 0) { /* suppress zlib wrapper */\n    wrap = 0;\n    windowBits = -windowBits;\n  }\n\n  else if (windowBits > 15) {\n    wrap = 2;           /* write gzip wrapper instead */\n    windowBits -= 16;\n  }\n\n\n  if (memLevel < 1 || memLevel > MAX_MEM_LEVEL || method !== Z_DEFLATED$2 ||\n    windowBits < 8 || windowBits > 15 || level < 0 || level > 9 ||\n    strategy < 0 || strategy > Z_FIXED || (windowBits === 8 && wrap !== 1)) {\n    return err(strm, Z_STREAM_ERROR$2);\n  }\n\n\n  if (windowBits === 8) {\n    windowBits = 9;\n  }\n  /* until 256-byte window bug fixed */\n\n  const s = new DeflateState();\n\n  strm.state = s;\n  s.strm = strm;\n  s.status = INIT_STATE;     /* to pass state test in deflateReset() */\n\n  s.wrap = wrap;\n  s.gzhead = null;\n  s.w_bits = windowBits;\n  s.w_size = 1 << s.w_bits;\n  s.w_mask = s.w_size - 1;\n\n  s.hash_bits = memLevel + 7;\n  s.hash_size = 1 << s.hash_bits;\n  s.hash_mask = s.hash_size - 1;\n  s.hash_shift = ~~((s.hash_bits + MIN_MATCH - 1) / MIN_MATCH);\n\n  s.window = new Uint8Array(s.w_size * 2);\n  s.head = new Uint16Array(s.hash_size);\n  s.prev = new Uint16Array(s.w_size);\n\n  // Don't need mem init magic for JS.\n  //s.high_water = 0;  /* nothing written to s->window yet */\n\n  s.lit_bufsize = 1 << (memLevel + 6); /* 16K elements by default */\n\n  /* We overlay pending_buf and sym_buf. This works since the average size\n   * for length/distance pairs over any compressed block is assured to be 31\n   * bits or less.\n   *\n   * Analysis: The longest fixed codes are a length code of 8 bits plus 5\n   * extra bits, for lengths 131 to 257. The longest fixed distance codes are\n   * 5 bits plus 13 extra bits, for distances 16385 to 32768. The longest\n   * possible fixed-codes length/distance pair is then 31 bits total.\n   *\n   * sym_buf starts one-fourth of the way into pending_buf. So there are\n   * three bytes in sym_buf for every four bytes in pending_buf. Each symbol\n   * in sym_buf is three bytes -- two for the distance and one for the\n   * literal/length. As each symbol is consumed, the pointer to the next\n   * sym_buf value to read moves forward three bytes. From that symbol, up to\n   * 31 bits are written to pending_buf. The closest the written pending_buf\n   * bits gets to the next sym_buf symbol to read is just before the last\n   * code is written. At that time, 31*(n-2) bits have been written, just\n   * after 24*(n-2) bits have been consumed from sym_buf. sym_buf starts at\n   * 8*n bits into pending_buf. (Note that the symbol buffer fills when n-1\n   * symbols are written.) The closest the writing gets to what is unread is\n   * then n+14 bits. Here n is lit_bufsize, which is 16384 by default, and\n   * can range from 128 to 32768.\n   *\n   * Therefore, at a minimum, there are 142 bits of space between what is\n   * written and what is read in the overlain buffers, so the symbols cannot\n   * be overwritten by the compressed data. That space is actually 139 bits,\n   * due to the three-bit fixed-code block header.\n   *\n   * That covers the case where either Z_FIXED is specified, forcing fixed\n   * codes, or when the use of fixed codes is chosen, because that choice\n   * results in a smaller compressed block than dynamic codes. That latter\n   * condition then assures that the above analysis also covers all dynamic\n   * blocks. A dynamic-code block will only be chosen to be emitted if it has\n   * fewer bits than a fixed-code block would for the same set of symbols.\n   * Therefore its average symbol length is assured to be less than 31. So\n   * the compressed data for a dynamic block also cannot overwrite the\n   * symbols from which it is being constructed.\n   */\n\n  s.pending_buf_size = s.lit_bufsize * 4;\n  s.pending_buf = new Uint8Array(s.pending_buf_size);\n\n  // It is offset from `s.pending_buf` (size is `s.lit_bufsize * 2`)\n  //s->sym_buf = s->pending_buf + s->lit_bufsize;\n  s.sym_buf = s.lit_bufsize;\n\n  //s->sym_end = (s->lit_bufsize - 1) * 3;\n  s.sym_end = (s.lit_bufsize - 1) * 3;\n  /* We avoid equality with lit_bufsize*3 because of wraparound at 64K\n   * on 16 bit machines and because stored blocks are restricted to\n   * 64K-1 bytes.\n   */\n\n  s.level = level;\n  s.strategy = strategy;\n  s.method = method;\n\n  return deflateReset(strm);\n};\n\nconst deflateInit = (strm, level) => {\n\n  return deflateInit2(strm, level, Z_DEFLATED$2, MAX_WBITS$1, DEF_MEM_LEVEL, Z_DEFAULT_STRATEGY$1);\n};\n\n\n/* ========================================================================= */\nconst deflate$2 = (strm, flush) => {\n\n  if (deflateStateCheck(strm) || flush > Z_BLOCK$1 || flush < 0) {\n    return strm ? err(strm, Z_STREAM_ERROR$2) : Z_STREAM_ERROR$2;\n  }\n\n  const s = strm.state;\n\n  if (!strm.output ||\n      (strm.avail_in !== 0 && !strm.input) ||\n      (s.status === FINISH_STATE && flush !== Z_FINISH$3)) {\n    return err(strm, (strm.avail_out === 0) ? Z_BUF_ERROR$1 : Z_STREAM_ERROR$2);\n  }\n\n  const old_flush = s.last_flush;\n  s.last_flush = flush;\n\n  /* Flush as much pending output as possible */\n  if (s.pending !== 0) {\n    flush_pending(strm);\n    if (strm.avail_out === 0) {\n      /* Since avail_out is 0, deflate will be called again with\n       * more output space, but possibly with both pending and\n       * avail_in equal to zero. There won't be anything to do,\n       * but this is not an error situation so make sure we\n       * return OK instead of BUF_ERROR at next call of deflate:\n       */\n      s.last_flush = -1;\n      return Z_OK$3;\n    }\n\n    /* Make sure there is something to do and avoid duplicate consecutive\n     * flushes. For repeated and useless calls with Z_FINISH, we keep\n     * returning Z_STREAM_END instead of Z_BUF_ERROR.\n     */\n  } else if (strm.avail_in === 0 && rank(flush) <= rank(old_flush) &&\n    flush !== Z_FINISH$3) {\n    return err(strm, Z_BUF_ERROR$1);\n  }\n\n  /* User must not provide more input after the first FINISH: */\n  if (s.status === FINISH_STATE && strm.avail_in !== 0) {\n    return err(strm, Z_BUF_ERROR$1);\n  }\n\n  /* Write the header */\n  if (s.status === INIT_STATE && s.wrap === 0) {\n    s.status = BUSY_STATE;\n  }\n  if (s.status === INIT_STATE) {\n    /* zlib header */\n    let header = (Z_DEFLATED$2 + ((s.w_bits - 8) << 4)) << 8;\n    let level_flags = -1;\n\n    if (s.strategy >= Z_HUFFMAN_ONLY || s.level < 2) {\n      level_flags = 0;\n    } else if (s.level < 6) {\n      level_flags = 1;\n    } else if (s.level === 6) {\n      level_flags = 2;\n    } else {\n      level_flags = 3;\n    }\n    header |= (level_flags << 6);\n    if (s.strstart !== 0) { header |= PRESET_DICT; }\n    header += 31 - (header % 31);\n\n    putShortMSB(s, header);\n\n    /* Save the adler32 of the preset dictionary: */\n    if (s.strstart !== 0) {\n      putShortMSB(s, strm.adler >>> 16);\n      putShortMSB(s, strm.adler & 0xffff);\n    }\n    strm.adler = 1; // adler32(0L, Z_NULL, 0);\n    s.status = BUSY_STATE;\n\n    /* Compression must start with an empty pending buffer */\n    flush_pending(strm);\n    if (s.pending !== 0) {\n      s.last_flush = -1;\n      return Z_OK$3;\n    }\n  }\n//#ifdef GZIP\n  if (s.status === GZIP_STATE) {\n    /* gzip header */\n    strm.adler = 0;  //crc32(0L, Z_NULL, 0);\n    put_byte(s, 31);\n    put_byte(s, 139);\n    put_byte(s, 8);\n    if (!s.gzhead) { // s->gzhead == Z_NULL\n      put_byte(s, 0);\n      put_byte(s, 0);\n      put_byte(s, 0);\n      put_byte(s, 0);\n      put_byte(s, 0);\n      put_byte(s, s.level === 9 ? 2 :\n                  (s.strategy >= Z_HUFFMAN_ONLY || s.level < 2 ?\n                   4 : 0));\n      put_byte(s, OS_CODE);\n      s.status = BUSY_STATE;\n\n      /* Compression must start with an empty pending buffer */\n      flush_pending(strm);\n      if (s.pending !== 0) {\n        s.last_flush = -1;\n        return Z_OK$3;\n      }\n    }\n    else {\n      put_byte(s, (s.gzhead.text ? 1 : 0) +\n                  (s.gzhead.hcrc ? 2 : 0) +\n                  (!s.gzhead.extra ? 0 : 4) +\n                  (!s.gzhead.name ? 0 : 8) +\n                  (!s.gzhead.comment ? 0 : 16)\n      );\n      put_byte(s, s.gzhead.time & 0xff);\n      put_byte(s, (s.gzhead.time >> 8) & 0xff);\n      put_byte(s, (s.gzhead.time >> 16) & 0xff);\n      put_byte(s, (s.gzhead.time >> 24) & 0xff);\n      put_byte(s, s.level === 9 ? 2 :\n                  (s.strategy >= Z_HUFFMAN_ONLY || s.level < 2 ?\n                   4 : 0));\n      put_byte(s, s.gzhead.os & 0xff);\n      if (s.gzhead.extra && s.gzhead.extra.length) {\n        put_byte(s, s.gzhead.extra.length & 0xff);\n        put_byte(s, (s.gzhead.extra.length >> 8) & 0xff);\n      }\n      if (s.gzhead.hcrc) {\n        strm.adler = crc32_1(strm.adler, s.pending_buf, s.pending, 0);\n      }\n      s.gzindex = 0;\n      s.status = EXTRA_STATE;\n    }\n  }\n  if (s.status === EXTRA_STATE) {\n    if (s.gzhead.extra/* != Z_NULL*/) {\n      let beg = s.pending;   /* start of bytes to update crc */\n      let left = (s.gzhead.extra.length & 0xffff) - s.gzindex;\n      while (s.pending + left > s.pending_buf_size) {\n        let copy = s.pending_buf_size - s.pending;\n        // zmemcpy(s.pending_buf + s.pending,\n        //    s.gzhead.extra + s.gzindex, copy);\n        s.pending_buf.set(s.gzhead.extra.subarray(s.gzindex, s.gzindex + copy), s.pending);\n        s.pending = s.pending_buf_size;\n        //--- HCRC_UPDATE(beg) ---//\n        if (s.gzhead.hcrc && s.pending > beg) {\n          strm.adler = crc32_1(strm.adler, s.pending_buf, s.pending - beg, beg);\n        }\n        //---//\n        s.gzindex += copy;\n        flush_pending(strm);\n        if (s.pending !== 0) {\n          s.last_flush = -1;\n          return Z_OK$3;\n        }\n        beg = 0;\n        left -= copy;\n      }\n      // JS specific: s.gzhead.extra may be TypedArray or Array for backward compatibility\n      //              TypedArray.slice and TypedArray.from don't exist in IE10-IE11\n      let gzhead_extra = new Uint8Array(s.gzhead.extra);\n      // zmemcpy(s->pending_buf + s->pending,\n      //     s->gzhead->extra + s->gzindex, left);\n      s.pending_buf.set(gzhead_extra.subarray(s.gzindex, s.gzindex + left), s.pending);\n      s.pending += left;\n      //--- HCRC_UPDATE(beg) ---//\n      if (s.gzhead.hcrc && s.pending > beg) {\n        strm.adler = crc32_1(strm.adler, s.pending_buf, s.pending - beg, beg);\n      }\n      //---//\n      s.gzindex = 0;\n    }\n    s.status = NAME_STATE;\n  }\n  if (s.status === NAME_STATE) {\n    if (s.gzhead.name/* != Z_NULL*/) {\n      let beg = s.pending;   /* start of bytes to update crc */\n      let val;\n      do {\n        if (s.pending === s.pending_buf_size) {\n          //--- HCRC_UPDATE(beg) ---//\n          if (s.gzhead.hcrc && s.pending > beg) {\n            strm.adler = crc32_1(strm.adler, s.pending_buf, s.pending - beg, beg);\n          }\n          //---//\n          flush_pending(strm);\n          if (s.pending !== 0) {\n            s.last_flush = -1;\n            return Z_OK$3;\n          }\n          beg = 0;\n        }\n        // JS specific: little magic to add zero terminator to end of string\n        if (s.gzindex < s.gzhead.name.length) {\n          val = s.gzhead.name.charCodeAt(s.gzindex++) & 0xff;\n        } else {\n          val = 0;\n        }\n        put_byte(s, val);\n      } while (val !== 0);\n      //--- HCRC_UPDATE(beg) ---//\n      if (s.gzhead.hcrc && s.pending > beg) {\n        strm.adler = crc32_1(strm.adler, s.pending_buf, s.pending - beg, beg);\n      }\n      //---//\n      s.gzindex = 0;\n    }\n    s.status = COMMENT_STATE;\n  }\n  if (s.status === COMMENT_STATE) {\n    if (s.gzhead.comment/* != Z_NULL*/) {\n      let beg = s.pending;   /* start of bytes to update crc */\n      let val;\n      do {\n        if (s.pending === s.pending_buf_size) {\n          //--- HCRC_UPDATE(beg) ---//\n          if (s.gzhead.hcrc && s.pending > beg) {\n            strm.adler = crc32_1(strm.adler, s.pending_buf, s.pending - beg, beg);\n          }\n          //---//\n          flush_pending(strm);\n          if (s.pending !== 0) {\n            s.last_flush = -1;\n            return Z_OK$3;\n          }\n          beg = 0;\n        }\n        // JS specific: little magic to add zero terminator to end of string\n        if (s.gzindex < s.gzhead.comment.length) {\n          val = s.gzhead.comment.charCodeAt(s.gzindex++) & 0xff;\n        } else {\n          val = 0;\n        }\n        put_byte(s, val);\n      } while (val !== 0);\n      //--- HCRC_UPDATE(beg) ---//\n      if (s.gzhead.hcrc && s.pending > beg) {\n        strm.adler = crc32_1(strm.adler, s.pending_buf, s.pending - beg, beg);\n      }\n      //---//\n    }\n    s.status = HCRC_STATE;\n  }\n  if (s.status === HCRC_STATE) {\n    if (s.gzhead.hcrc) {\n      if (s.pending + 2 > s.pending_buf_size) {\n        flush_pending(strm);\n        if (s.pending !== 0) {\n          s.last_flush = -1;\n          return Z_OK$3;\n        }\n      }\n      put_byte(s, strm.adler & 0xff);\n      put_byte(s, (strm.adler >> 8) & 0xff);\n      strm.adler = 0; //crc32(0L, Z_NULL, 0);\n    }\n    s.status = BUSY_STATE;\n\n    /* Compression must start with an empty pending buffer */\n    flush_pending(strm);\n    if (s.pending !== 0) {\n      s.last_flush = -1;\n      return Z_OK$3;\n    }\n  }\n//#endif\n\n  /* Start a new block or continue the current one.\n   */\n  if (strm.avail_in !== 0 || s.lookahead !== 0 ||\n    (flush !== Z_NO_FLUSH$2 && s.status !== FINISH_STATE)) {\n    let bstate = s.level === 0 ? deflate_stored(s, flush) :\n                 s.strategy === Z_HUFFMAN_ONLY ? deflate_huff(s, flush) :\n                 s.strategy === Z_RLE ? deflate_rle(s, flush) :\n                 configuration_table[s.level].func(s, flush);\n\n    if (bstate === BS_FINISH_STARTED || bstate === BS_FINISH_DONE) {\n      s.status = FINISH_STATE;\n    }\n    if (bstate === BS_NEED_MORE || bstate === BS_FINISH_STARTED) {\n      if (strm.avail_out === 0) {\n        s.last_flush = -1;\n        /* avoid BUF_ERROR next call, see above */\n      }\n      return Z_OK$3;\n      /* If flush != Z_NO_FLUSH && avail_out == 0, the next call\n       * of deflate should use the same flush parameter to make sure\n       * that the flush is complete. So we don't have to output an\n       * empty block here, this will be done at next call. This also\n       * ensures that for a very small output buffer, we emit at most\n       * one empty block.\n       */\n    }\n    if (bstate === BS_BLOCK_DONE) {\n      if (flush === Z_PARTIAL_FLUSH) {\n        _tr_align(s);\n      }\n      else if (flush !== Z_BLOCK$1) { /* FULL_FLUSH or SYNC_FLUSH */\n\n        _tr_stored_block(s, 0, 0, false);\n        /* For a full flush, this empty block will be recognized\n         * as a special marker by inflate_sync().\n         */\n        if (flush === Z_FULL_FLUSH$1) {\n          /*** CLEAR_HASH(s); ***/             /* forget history */\n          zero(s.head); // Fill with NIL (= 0);\n\n          if (s.lookahead === 0) {\n            s.strstart = 0;\n            s.block_start = 0;\n            s.insert = 0;\n          }\n        }\n      }\n      flush_pending(strm);\n      if (strm.avail_out === 0) {\n        s.last_flush = -1; /* avoid BUF_ERROR at next call, see above */\n        return Z_OK$3;\n      }\n    }\n  }\n\n  if (flush !== Z_FINISH$3) { return Z_OK$3; }\n  if (s.wrap <= 0) { return Z_STREAM_END$3; }\n\n  /* Write the trailer */\n  if (s.wrap === 2) {\n    put_byte(s, strm.adler & 0xff);\n    put_byte(s, (strm.adler >> 8) & 0xff);\n    put_byte(s, (strm.adler >> 16) & 0xff);\n    put_byte(s, (strm.adler >> 24) & 0xff);\n    put_byte(s, strm.total_in & 0xff);\n    put_byte(s, (strm.total_in >> 8) & 0xff);\n    put_byte(s, (strm.total_in >> 16) & 0xff);\n    put_byte(s, (strm.total_in >> 24) & 0xff);\n  }\n  else\n  {\n    putShortMSB(s, strm.adler >>> 16);\n    putShortMSB(s, strm.adler & 0xffff);\n  }\n\n  flush_pending(strm);\n  /* If avail_out is zero, the application will call deflate again\n   * to flush the rest.\n   */\n  if (s.wrap > 0) { s.wrap = -s.wrap; }\n  /* write the trailer only once! */\n  return s.pending !== 0 ? Z_OK$3 : Z_STREAM_END$3;\n};\n\n\nconst deflateEnd = (strm) => {\n\n  if (deflateStateCheck(strm)) {\n    return Z_STREAM_ERROR$2;\n  }\n\n  const status = strm.state.status;\n\n  strm.state = null;\n\n  return status === BUSY_STATE ? err(strm, Z_DATA_ERROR$2) : Z_OK$3;\n};\n\n\n/* =========================================================================\n * Initializes the compression dictionary from the given byte\n * sequence without producing any compressed output.\n */\nconst deflateSetDictionary = (strm, dictionary) => {\n\n  let dictLength = dictionary.length;\n\n  if (deflateStateCheck(strm)) {\n    return Z_STREAM_ERROR$2;\n  }\n\n  const s = strm.state;\n  const wrap = s.wrap;\n\n  if (wrap === 2 || (wrap === 1 && s.status !== INIT_STATE) || s.lookahead) {\n    return Z_STREAM_ERROR$2;\n  }\n\n  /* when using zlib wrappers, compute Adler-32 for provided dictionary */\n  if (wrap === 1) {\n    /* adler32(strm->adler, dictionary, dictLength); */\n    strm.adler = adler32_1(strm.adler, dictionary, dictLength, 0);\n  }\n\n  s.wrap = 0;   /* avoid computing Adler-32 in read_buf */\n\n  /* if dictionary would fill window, just replace the history */\n  if (dictLength >= s.w_size) {\n    if (wrap === 0) {            /* already empty otherwise */\n      /*** CLEAR_HASH(s); ***/\n      zero(s.head); // Fill with NIL (= 0);\n      s.strstart = 0;\n      s.block_start = 0;\n      s.insert = 0;\n    }\n    /* use the tail */\n    // dictionary = dictionary.slice(dictLength - s.w_size);\n    let tmpDict = new Uint8Array(s.w_size);\n    tmpDict.set(dictionary.subarray(dictLength - s.w_size, dictLength), 0);\n    dictionary = tmpDict;\n    dictLength = s.w_size;\n  }\n  /* insert dictionary into window and hash */\n  const avail = strm.avail_in;\n  const next = strm.next_in;\n  const input = strm.input;\n  strm.avail_in = dictLength;\n  strm.next_in = 0;\n  strm.input = dictionary;\n  fill_window(s);\n  while (s.lookahead >= MIN_MATCH) {\n    let str = s.strstart;\n    let n = s.lookahead - (MIN_MATCH - 1);\n    do {\n      /* UPDATE_HASH(s, s->ins_h, s->window[str + MIN_MATCH-1]); */\n      s.ins_h = HASH(s, s.ins_h, s.window[str + MIN_MATCH - 1]);\n\n      s.prev[str & s.w_mask] = s.head[s.ins_h];\n\n      s.head[s.ins_h] = str;\n      str++;\n    } while (--n);\n    s.strstart = str;\n    s.lookahead = MIN_MATCH - 1;\n    fill_window(s);\n  }\n  s.strstart += s.lookahead;\n  s.block_start = s.strstart;\n  s.insert = s.lookahead;\n  s.lookahead = 0;\n  s.match_length = s.prev_length = MIN_MATCH - 1;\n  s.match_available = 0;\n  strm.next_in = next;\n  strm.input = input;\n  strm.avail_in = avail;\n  s.wrap = wrap;\n  return Z_OK$3;\n};\n\n\nvar deflateInit_1 = deflateInit;\nvar deflateInit2_1 = deflateInit2;\nvar deflateReset_1 = deflateReset;\nvar deflateResetKeep_1 = deflateResetKeep;\nvar deflateSetHeader_1 = deflateSetHeader;\nvar deflate_2$1 = deflate$2;\nvar deflateEnd_1 = deflateEnd;\nvar deflateSetDictionary_1 = deflateSetDictionary;\nvar deflateInfo = 'pako deflate (from Nodeca project)';\n\n/* Not implemented\nmodule.exports.deflateBound = deflateBound;\nmodule.exports.deflateCopy = deflateCopy;\nmodule.exports.deflateGetDictionary = deflateGetDictionary;\nmodule.exports.deflateParams = deflateParams;\nmodule.exports.deflatePending = deflatePending;\nmodule.exports.deflatePrime = deflatePrime;\nmodule.exports.deflateTune = deflateTune;\n*/\n\nvar deflate_1$2 = {\n\tdeflateInit: deflateInit_1,\n\tdeflateInit2: deflateInit2_1,\n\tdeflateReset: deflateReset_1,\n\tdeflateResetKeep: deflateResetKeep_1,\n\tdeflateSetHeader: deflateSetHeader_1,\n\tdeflate: deflate_2$1,\n\tdeflateEnd: deflateEnd_1,\n\tdeflateSetDictionary: deflateSetDictionary_1,\n\tdeflateInfo: deflateInfo\n};\n\nconst _has = (obj, key) => {\n  return Object.prototype.hasOwnProperty.call(obj, key);\n};\n\nvar assign = function (obj /*from1, from2, from3, ...*/) {\n  const sources = Array.prototype.slice.call(arguments, 1);\n  while (sources.length) {\n    const source = sources.shift();\n    if (!source) { continue; }\n\n    if (typeof source !== 'object') {\n      throw new TypeError(source + 'must be non-object');\n    }\n\n    for (const p in source) {\n      if (_has(source, p)) {\n        obj[p] = source[p];\n      }\n    }\n  }\n\n  return obj;\n};\n\n\n// Join array of chunks to single array.\nvar flattenChunks = (chunks) => {\n  // calculate data length\n  let len = 0;\n\n  for (let i = 0, l = chunks.length; i < l; i++) {\n    len += chunks[i].length;\n  }\n\n  // join chunks\n  const result = new Uint8Array(len);\n\n  for (let i = 0, pos = 0, l = chunks.length; i < l; i++) {\n    let chunk = chunks[i];\n    result.set(chunk, pos);\n    pos += chunk.length;\n  }\n\n  return result;\n};\n\nvar common = {\n\tassign: assign,\n\tflattenChunks: flattenChunks\n};\n\n// String encode/decode helpers\n\n\n// Quick check if we can use fast array to bin string conversion\n//\n// - apply(Array) can fail on Android 2.2\n// - apply(Uint8Array) can fail on iOS 5.1 Safari\n//\nlet STR_APPLY_UIA_OK = true;\n\ntry { String.fromCharCode.apply(null, new Uint8Array(1)); } catch (__) { STR_APPLY_UIA_OK = false; }\n\n\n// Table with utf8 lengths (calculated by first byte of sequence)\n// Note, that 5 & 6-byte values and some 4-byte values can not be represented in JS,\n// because max possible codepoint is 0x10ffff\nconst _utf8len = new Uint8Array(256);\nfor (let q = 0; q < 256; q++) {\n  _utf8len[q] = (q >= 252 ? 6 : q >= 248 ? 5 : q >= 240 ? 4 : q >= 224 ? 3 : q >= 192 ? 2 : 1);\n}\n_utf8len[254] = _utf8len[254] = 1; // Invalid sequence start\n\n\n// convert string to array (typed, when possible)\nvar string2buf = (str) => {\n  if (typeof TextEncoder === 'function' && TextEncoder.prototype.encode) {\n    return new TextEncoder().encode(str);\n  }\n\n  let buf, c, c2, m_pos, i, str_len = str.length, buf_len = 0;\n\n  // count binary size\n  for (m_pos = 0; m_pos < str_len; m_pos++) {\n    c = str.charCodeAt(m_pos);\n    if ((c & 0xfc00) === 0xd800 && (m_pos + 1 < str_len)) {\n      c2 = str.charCodeAt(m_pos + 1);\n      if ((c2 & 0xfc00) === 0xdc00) {\n        c = 0x10000 + ((c - 0xd800) << 10) + (c2 - 0xdc00);\n        m_pos++;\n      }\n    }\n    buf_len += c < 0x80 ? 1 : c < 0x800 ? 2 : c < 0x10000 ? 3 : 4;\n  }\n\n  // allocate buffer\n  buf = new Uint8Array(buf_len);\n\n  // convert\n  for (i = 0, m_pos = 0; i < buf_len; m_pos++) {\n    c = str.charCodeAt(m_pos);\n    if ((c & 0xfc00) === 0xd800 && (m_pos + 1 < str_len)) {\n      c2 = str.charCodeAt(m_pos + 1);\n      if ((c2 & 0xfc00) === 0xdc00) {\n        c = 0x10000 + ((c - 0xd800) << 10) + (c2 - 0xdc00);\n        m_pos++;\n      }\n    }\n    if (c < 0x80) {\n      /* one byte */\n      buf[i++] = c;\n    } else if (c < 0x800) {\n      /* two bytes */\n      buf[i++] = 0xC0 | (c >>> 6);\n      buf[i++] = 0x80 | (c & 0x3f);\n    } else if (c < 0x10000) {\n      /* three bytes */\n      buf[i++] = 0xE0 | (c >>> 12);\n      buf[i++] = 0x80 | (c >>> 6 & 0x3f);\n      buf[i++] = 0x80 | (c & 0x3f);\n    } else {\n      /* four bytes */\n      buf[i++] = 0xf0 | (c >>> 18);\n      buf[i++] = 0x80 | (c >>> 12 & 0x3f);\n      buf[i++] = 0x80 | (c >>> 6 & 0x3f);\n      buf[i++] = 0x80 | (c & 0x3f);\n    }\n  }\n\n  return buf;\n};\n\n// Helper\nconst buf2binstring = (buf, len) => {\n  // On Chrome, the arguments in a function call that are allowed is `65534`.\n  // If the length of the buffer is smaller than that, we can use this optimization,\n  // otherwise we will take a slower path.\n  if (len < 65534) {\n    if (buf.subarray && STR_APPLY_UIA_OK) {\n      return String.fromCharCode.apply(null, buf.length === len ? buf : buf.subarray(0, len));\n    }\n  }\n\n  let result = '';\n  for (let i = 0; i < len; i++) {\n    result += String.fromCharCode(buf[i]);\n  }\n  return result;\n};\n\n\n// convert array to string\nvar buf2string = (buf, max) => {\n  const len = max || buf.length;\n\n  if (typeof TextDecoder === 'function' && TextDecoder.prototype.decode) {\n    return new TextDecoder().decode(buf.subarray(0, max));\n  }\n\n  let i, out;\n\n  // Reserve max possible length (2 words per char)\n  // NB: by unknown reasons, Array is significantly faster for\n  //     String.fromCharCode.apply than Uint16Array.\n  const utf16buf = new Array(len * 2);\n\n  for (out = 0, i = 0; i < len;) {\n    let c = buf[i++];\n    // quick process ascii\n    if (c < 0x80) { utf16buf[out++] = c; continue; }\n\n    let c_len = _utf8len[c];\n    // skip 5 & 6 byte codes\n    if (c_len > 4) { utf16buf[out++] = 0xfffd; i += c_len - 1; continue; }\n\n    // apply mask on first byte\n    c &= c_len === 2 ? 0x1f : c_len === 3 ? 0x0f : 0x07;\n    // join the rest\n    while (c_len > 1 && i < len) {\n      c = (c << 6) | (buf[i++] & 0x3f);\n      c_len--;\n    }\n\n    // terminated by end of string?\n    if (c_len > 1) { utf16buf[out++] = 0xfffd; continue; }\n\n    if (c < 0x10000) {\n      utf16buf[out++] = c;\n    } else {\n      c -= 0x10000;\n      utf16buf[out++] = 0xd800 | ((c >> 10) & 0x3ff);\n      utf16buf[out++] = 0xdc00 | (c & 0x3ff);\n    }\n  }\n\n  return buf2binstring(utf16buf, out);\n};\n\n\n// Calculate max possible position in utf8 buffer,\n// that will not break sequence. If that's not possible\n// - (very small limits) return max size as is.\n//\n// buf[] - utf8 bytes array\n// max   - length limit (mandatory);\nvar utf8border = (buf, max) => {\n\n  max = max || buf.length;\n  if (max > buf.length) { max = buf.length; }\n\n  // go back from last position, until start of sequence found\n  let pos = max - 1;\n  while (pos >= 0 && (buf[pos] & 0xC0) === 0x80) { pos--; }\n\n  // Very small and broken sequence,\n  // return max, because we should return something anyway.\n  if (pos < 0) { return max; }\n\n  // If we came to start of buffer - that means buffer is too small,\n  // return max too.\n  if (pos === 0) { return max; }\n\n  return (pos + _utf8len[buf[pos]] > max) ? pos : max;\n};\n\nvar strings = {\n\tstring2buf: string2buf,\n\tbuf2string: buf2string,\n\tutf8border: utf8border\n};\n\n// (C) 1995-2013 Jean-loup Gailly and Mark Adler\n// (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n//\n// This software is provided 'as-is', without any express or implied\n// warranty. In no event will the authors be held liable for any damages\n// arising from the use of this software.\n//\n// Permission is granted to anyone to use this software for any purpose,\n// including commercial applications, and to alter it and redistribute it\n// freely, subject to the following restrictions:\n//\n// 1. The origin of this software must not be misrepresented; you must not\n//   claim that you wrote the original software. If you use this software\n//   in a product, an acknowledgment in the product documentation would be\n//   appreciated but is not required.\n// 2. Altered source versions must be plainly marked as such, and must not be\n//   misrepresented as being the original software.\n// 3. This notice may not be removed or altered from any source distribution.\n\nfunction ZStream() {\n  /* next input byte */\n  this.input = null; // JS specific, because we have no pointers\n  this.next_in = 0;\n  /* number of bytes available at input */\n  this.avail_in = 0;\n  /* total number of input bytes read so far */\n  this.total_in = 0;\n  /* next output byte should be put there */\n  this.output = null; // JS specific, because we have no pointers\n  this.next_out = 0;\n  /* remaining free space at output */\n  this.avail_out = 0;\n  /* total number of bytes output so far */\n  this.total_out = 0;\n  /* last error message, NULL if no error */\n  this.msg = ''/*Z_NULL*/;\n  /* not visible by applications */\n  this.state = null;\n  /* best guess about the data type: binary or text */\n  this.data_type = 2/*Z_UNKNOWN*/;\n  /* adler32 value of the uncompressed data */\n  this.adler = 0;\n}\n\nvar zstream = ZStream;\n\nconst toString$1 = Object.prototype.toString;\n\n/* Public constants ==========================================================*/\n/* ===========================================================================*/\n\nconst {\n  Z_NO_FLUSH: Z_NO_FLUSH$1, Z_SYNC_FLUSH, Z_FULL_FLUSH, Z_FINISH: Z_FINISH$2,\n  Z_OK: Z_OK$2, Z_STREAM_END: Z_STREAM_END$2,\n  Z_DEFAULT_COMPRESSION,\n  Z_DEFAULT_STRATEGY,\n  Z_DEFLATED: Z_DEFLATED$1\n} = constants$2;\n\n/* ===========================================================================*/\n\n\n/**\n * class Deflate\n *\n * Generic JS-style wrapper for zlib calls. If you don't need\n * streaming behaviour - use more simple functions: [[deflate]],\n * [[deflateRaw]] and [[gzip]].\n **/\n\n/* internal\n * Deflate.chunks -> Array\n *\n * Chunks of output data, if [[Deflate#onData]] not overridden.\n **/\n\n/**\n * Deflate.result -> Uint8Array\n *\n * Compressed result, generated by default [[Deflate#onData]]\n * and [[Deflate#onEnd]] handlers. Filled after you push last chunk\n * (call [[Deflate#push]] with `Z_FINISH` / `true` param).\n **/\n\n/**\n * Deflate.err -> Number\n *\n * Error code after deflate finished. 0 (Z_OK) on success.\n * You will not need it in real life, because deflate errors\n * are possible only on wrong options or bad `onData` / `onEnd`\n * custom handlers.\n **/\n\n/**\n * Deflate.msg -> String\n *\n * Error message, if [[Deflate.err]] != 0\n **/\n\n\n/**\n * new Deflate(options)\n * - options (Object): zlib deflate options.\n *\n * Creates new deflator instance with specified params. Throws exception\n * on bad params. Supported options:\n *\n * - `level`\n * - `windowBits`\n * - `memLevel`\n * - `strategy`\n * - `dictionary`\n *\n * [http://zlib.net/manual.html#Advanced](http://zlib.net/manual.html#Advanced)\n * for more information on these.\n *\n * Additional options, for internal needs:\n *\n * - `chunkSize` - size of generated data chunks (16K by default)\n * - `raw` (Boolean) - do raw deflate\n * - `gzip` (Boolean) - create gzip wrapper\n * - `header` (Object) - custom header for gzip\n *   - `text` (Boolean) - true if compressed data believed to be text\n *   - `time` (Number) - modification time, unix timestamp\n *   - `os` (Number) - operation system code\n *   - `extra` (Array) - array of bytes with extra data (max 65536)\n *   - `name` (String) - file name (binary string)\n *   - `comment` (String) - comment (binary string)\n *   - `hcrc` (Boolean) - true if header crc should be added\n *\n * ##### Example:\n *\n * ```javascript\n * const pako = require('pako')\n *   , chunk1 = new Uint8Array([1,2,3,4,5,6,7,8,9])\n *   , chunk2 = new Uint8Array([10,11,12,13,14,15,16,17,18,19]);\n *\n * const deflate = new pako.Deflate({ level: 3});\n *\n * deflate.push(chunk1, false);\n * deflate.push(chunk2, true);  // true -> last chunk\n *\n * if (deflate.err) { throw new Error(deflate.err); }\n *\n * console.log(deflate.result);\n * ```\n **/\nfunction Deflate$1(options) {\n  this.options = common.assign({\n    level: Z_DEFAULT_COMPRESSION,\n    method: Z_DEFLATED$1,\n    chunkSize: 16384,\n    windowBits: 15,\n    memLevel: 8,\n    strategy: Z_DEFAULT_STRATEGY\n  }, options || {});\n\n  let opt = this.options;\n\n  if (opt.raw && (opt.windowBits > 0)) {\n    opt.windowBits = -opt.windowBits;\n  }\n\n  else if (opt.gzip && (opt.windowBits > 0) && (opt.windowBits < 16)) {\n    opt.windowBits += 16;\n  }\n\n  this.err    = 0;      // error code, if happens (0 = Z_OK)\n  this.msg    = '';     // error message\n  this.ended  = false;  // used to avoid multiple onEnd() calls\n  this.chunks = [];     // chunks of compressed data\n\n  this.strm = new zstream();\n  this.strm.avail_out = 0;\n\n  let status = deflate_1$2.deflateInit2(\n    this.strm,\n    opt.level,\n    opt.method,\n    opt.windowBits,\n    opt.memLevel,\n    opt.strategy\n  );\n\n  if (status !== Z_OK$2) {\n    throw new Error(messages[status]);\n  }\n\n  if (opt.header) {\n    deflate_1$2.deflateSetHeader(this.strm, opt.header);\n  }\n\n  if (opt.dictionary) {\n    let dict;\n    // Convert data if needed\n    if (typeof opt.dictionary === 'string') {\n      // If we need to compress text, change encoding to utf8.\n      dict = strings.string2buf(opt.dictionary);\n    } else if (toString$1.call(opt.dictionary) === '[object ArrayBuffer]') {\n      dict = new Uint8Array(opt.dictionary);\n    } else {\n      dict = opt.dictionary;\n    }\n\n    status = deflate_1$2.deflateSetDictionary(this.strm, dict);\n\n    if (status !== Z_OK$2) {\n      throw new Error(messages[status]);\n    }\n\n    this._dict_set = true;\n  }\n}\n\n/**\n * Deflate#push(data[, flush_mode]) -> Boolean\n * - data (Uint8Array|ArrayBuffer|String): input data. Strings will be\n *   converted to utf8 byte sequence.\n * - flush_mode (Number|Boolean): 0..6 for corresponding Z_NO_FLUSH..Z_TREE modes.\n *   See constants. Skipped or `false` means Z_NO_FLUSH, `true` means Z_FINISH.\n *\n * Sends input data to deflate pipe, generating [[Deflate#onData]] calls with\n * new compressed chunks. Returns `true` on success. The last data block must\n * have `flush_mode` Z_FINISH (or `true`). That will flush internal pending\n * buffers and call [[Deflate#onEnd]].\n *\n * On fail call [[Deflate#onEnd]] with error code and return false.\n *\n * ##### Example\n *\n * ```javascript\n * push(chunk, false); // push one of data chunks\n * ...\n * push(chunk, true);  // push last chunk\n * ```\n **/\nDeflate$1.prototype.push = function (data, flush_mode) {\n  const strm = this.strm;\n  const chunkSize = this.options.chunkSize;\n  let status, _flush_mode;\n\n  if (this.ended) { return false; }\n\n  if (flush_mode === ~~flush_mode) _flush_mode = flush_mode;\n  else _flush_mode = flush_mode === true ? Z_FINISH$2 : Z_NO_FLUSH$1;\n\n  // Convert data if needed\n  if (typeof data === 'string') {\n    // If we need to compress text, change encoding to utf8.\n    strm.input = strings.string2buf(data);\n  } else if (toString$1.call(data) === '[object ArrayBuffer]') {\n    strm.input = new Uint8Array(data);\n  } else {\n    strm.input = data;\n  }\n\n  strm.next_in = 0;\n  strm.avail_in = strm.input.length;\n\n  for (;;) {\n    if (strm.avail_out === 0) {\n      strm.output = new Uint8Array(chunkSize);\n      strm.next_out = 0;\n      strm.avail_out = chunkSize;\n    }\n\n    // Make sure avail_out > 6 to avoid repeating markers\n    if ((_flush_mode === Z_SYNC_FLUSH || _flush_mode === Z_FULL_FLUSH) && strm.avail_out <= 6) {\n      this.onData(strm.output.subarray(0, strm.next_out));\n      strm.avail_out = 0;\n      continue;\n    }\n\n    status = deflate_1$2.deflate(strm, _flush_mode);\n\n    // Ended => flush and finish\n    if (status === Z_STREAM_END$2) {\n      if (strm.next_out > 0) {\n        this.onData(strm.output.subarray(0, strm.next_out));\n      }\n      status = deflate_1$2.deflateEnd(this.strm);\n      this.onEnd(status);\n      this.ended = true;\n      return status === Z_OK$2;\n    }\n\n    // Flush if out buffer full\n    if (strm.avail_out === 0) {\n      this.onData(strm.output);\n      continue;\n    }\n\n    // Flush if requested and has data\n    if (_flush_mode > 0 && strm.next_out > 0) {\n      this.onData(strm.output.subarray(0, strm.next_out));\n      strm.avail_out = 0;\n      continue;\n    }\n\n    if (strm.avail_in === 0) break;\n  }\n\n  return true;\n};\n\n\n/**\n * Deflate#onData(chunk) -> Void\n * - chunk (Uint8Array): output data.\n *\n * By default, stores data blocks in `chunks[]` property and glue\n * those in `onEnd`. Override this handler, if you need another behaviour.\n **/\nDeflate$1.prototype.onData = function (chunk) {\n  this.chunks.push(chunk);\n};\n\n\n/**\n * Deflate#onEnd(status) -> Void\n * - status (Number): deflate status. 0 (Z_OK) on success,\n *   other if not.\n *\n * Called once after you tell deflate that the input stream is\n * complete (Z_FINISH). By default - join collected chunks,\n * free memory and fill `results` / `err` properties.\n **/\nDeflate$1.prototype.onEnd = function (status) {\n  // On success - join\n  if (status === Z_OK$2) {\n    this.result = common.flattenChunks(this.chunks);\n  }\n  this.chunks = [];\n  this.err = status;\n  this.msg = this.strm.msg;\n};\n\n\n/**\n * deflate(data[, options]) -> Uint8Array\n * - data (Uint8Array|ArrayBuffer|String): input data to compress.\n * - options (Object): zlib deflate options.\n *\n * Compress `data` with deflate algorithm and `options`.\n *\n * Supported options are:\n *\n * - level\n * - windowBits\n * - memLevel\n * - strategy\n * - dictionary\n *\n * [http://zlib.net/manual.html#Advanced](http://zlib.net/manual.html#Advanced)\n * for more information on these.\n *\n * Sugar (options):\n *\n * - `raw` (Boolean) - say that we work with raw stream, if you don't wish to specify\n *   negative windowBits implicitly.\n *\n * ##### Example:\n *\n * ```javascript\n * const pako = require('pako')\n * const data = new Uint8Array([1,2,3,4,5,6,7,8,9]);\n *\n * console.log(pako.deflate(data));\n * ```\n **/\nfunction deflate$1(input, options) {\n  const deflator = new Deflate$1(options);\n\n  deflator.push(input, true);\n\n  // That will never happens, if you don't cheat with options :)\n  if (deflator.err) { throw deflator.msg || messages[deflator.err]; }\n\n  return deflator.result;\n}\n\n\n/**\n * deflateRaw(data[, options]) -> Uint8Array\n * - data (Uint8Array|ArrayBuffer|String): input data to compress.\n * - options (Object): zlib deflate options.\n *\n * The same as [[deflate]], but creates raw data, without wrapper\n * (header and adler32 crc).\n **/\nfunction deflateRaw$1(input, options) {\n  options = options || {};\n  options.raw = true;\n  return deflate$1(input, options);\n}\n\n\n/**\n * gzip(data[, options]) -> Uint8Array\n * - data (Uint8Array|ArrayBuffer|String): input data to compress.\n * - options (Object): zlib deflate options.\n *\n * The same as [[deflate]], but create gzip wrapper instead of\n * deflate one.\n **/\nfunction gzip$1(input, options) {\n  options = options || {};\n  options.gzip = true;\n  return deflate$1(input, options);\n}\n\n\nvar Deflate_1$1 = Deflate$1;\nvar deflate_2 = deflate$1;\nvar deflateRaw_1$1 = deflateRaw$1;\nvar gzip_1$1 = gzip$1;\nvar constants$1 = constants$2;\n\nvar deflate_1$1 = {\n\tDeflate: Deflate_1$1,\n\tdeflate: deflate_2,\n\tdeflateRaw: deflateRaw_1$1,\n\tgzip: gzip_1$1,\n\tconstants: constants$1\n};\n\n// (C) 1995-2013 Jean-loup Gailly and Mark Adler\n// (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n//\n// This software is provided 'as-is', without any express or implied\n// warranty. In no event will the authors be held liable for any damages\n// arising from the use of this software.\n//\n// Permission is granted to anyone to use this software for any purpose,\n// including commercial applications, and to alter it and redistribute it\n// freely, subject to the following restrictions:\n//\n// 1. The origin of this software must not be misrepresented; you must not\n//   claim that you wrote the original software. If you use this software\n//   in a product, an acknowledgment in the product documentation would be\n//   appreciated but is not required.\n// 2. Altered source versions must be plainly marked as such, and must not be\n//   misrepresented as being the original software.\n// 3. This notice may not be removed or altered from any source distribution.\n\n// See state defs from inflate.js\nconst BAD$1 = 16209;       /* got a data error -- remain here until reset */\nconst TYPE$1 = 16191;      /* i: waiting for type bits, including last-flag bit */\n\n/*\n   Decode literal, length, and distance codes and write out the resulting\n   literal and match bytes until either not enough input or output is\n   available, an end-of-block is encountered, or a data error is encountered.\n   When large enough input and output buffers are supplied to inflate(), for\n   example, a 16K input buffer and a 64K output buffer, more than 95% of the\n   inflate execution time is spent in this routine.\n\n   Entry assumptions:\n\n        state.mode === LEN\n        strm.avail_in >= 6\n        strm.avail_out >= 258\n        start >= strm.avail_out\n        state.bits < 8\n\n   On return, state.mode is one of:\n\n        LEN -- ran out of enough output space or enough available input\n        TYPE -- reached end of block code, inflate() to interpret next block\n        BAD -- error in block data\n\n   Notes:\n\n    - The maximum input bits used by a length/distance pair is 15 bits for the\n      length code, 5 bits for the length extra, 15 bits for the distance code,\n      and 13 bits for the distance extra.  This totals 48 bits, or six bytes.\n      Therefore if strm.avail_in >= 6, then there is enough input to avoid\n      checking for available input while decoding.\n\n    - The maximum bytes that a single length/distance pair can output is 258\n      bytes, which is the maximum length that can be coded.  inflate_fast()\n      requires strm.avail_out >= 258 for each loop to avoid checking for\n      output space.\n */\nvar inffast = function inflate_fast(strm, start) {\n  let _in;                    /* local strm.input */\n  let last;                   /* have enough input while in < last */\n  let _out;                   /* local strm.output */\n  let beg;                    /* inflate()'s initial strm.output */\n  let end;                    /* while out < end, enough space available */\n//#ifdef INFLATE_STRICT\n  let dmax;                   /* maximum distance from zlib header */\n//#endif\n  let wsize;                  /* window size or zero if not using window */\n  let whave;                  /* valid bytes in the window */\n  let wnext;                  /* window write index */\n  // Use `s_window` instead `window`, avoid conflict with instrumentation tools\n  let s_window;               /* allocated sliding window, if wsize != 0 */\n  let hold;                   /* local strm.hold */\n  let bits;                   /* local strm.bits */\n  let lcode;                  /* local strm.lencode */\n  let dcode;                  /* local strm.distcode */\n  let lmask;                  /* mask for first level of length codes */\n  let dmask;                  /* mask for first level of distance codes */\n  let here;                   /* retrieved table entry */\n  let op;                     /* code bits, operation, extra bits, or */\n                              /*  window position, window bytes to copy */\n  let len;                    /* match length, unused bytes */\n  let dist;                   /* match distance */\n  let from;                   /* where to copy match from */\n  let from_source;\n\n\n  let input, output; // JS specific, because we have no pointers\n\n  /* copy state to local variables */\n  const state = strm.state;\n  //here = state.here;\n  _in = strm.next_in;\n  input = strm.input;\n  last = _in + (strm.avail_in - 5);\n  _out = strm.next_out;\n  output = strm.output;\n  beg = _out - (start - strm.avail_out);\n  end = _out + (strm.avail_out - 257);\n//#ifdef INFLATE_STRICT\n  dmax = state.dmax;\n//#endif\n  wsize = state.wsize;\n  whave = state.whave;\n  wnext = state.wnext;\n  s_window = state.window;\n  hold = state.hold;\n  bits = state.bits;\n  lcode = state.lencode;\n  dcode = state.distcode;\n  lmask = (1 << state.lenbits) - 1;\n  dmask = (1 << state.distbits) - 1;\n\n\n  /* decode literals and length/distances until end-of-block or not enough\n     input data or output space */\n\n  top:\n  do {\n    if (bits < 15) {\n      hold += input[_in++] << bits;\n      bits += 8;\n      hold += input[_in++] << bits;\n      bits += 8;\n    }\n\n    here = lcode[hold & lmask];\n\n    dolen:\n    for (;;) { // Goto emulation\n      op = here >>> 24/*here.bits*/;\n      hold >>>= op;\n      bits -= op;\n      op = (here >>> 16) & 0xff/*here.op*/;\n      if (op === 0) {                          /* literal */\n        //Tracevv((stderr, here.val >= 0x20 && here.val < 0x7f ?\n        //        \"inflate:         literal '%c'\\n\" :\n        //        \"inflate:         literal 0x%02x\\n\", here.val));\n        output[_out++] = here & 0xffff/*here.val*/;\n      }\n      else if (op & 16) {                     /* length base */\n        len = here & 0xffff/*here.val*/;\n        op &= 15;                           /* number of extra bits */\n        if (op) {\n          if (bits < op) {\n            hold += input[_in++] << bits;\n            bits += 8;\n          }\n          len += hold & ((1 << op) - 1);\n          hold >>>= op;\n          bits -= op;\n        }\n        //Tracevv((stderr, \"inflate:         length %u\\n\", len));\n        if (bits < 15) {\n          hold += input[_in++] << bits;\n          bits += 8;\n          hold += input[_in++] << bits;\n          bits += 8;\n        }\n        here = dcode[hold & dmask];\n\n        dodist:\n        for (;;) { // goto emulation\n          op = here >>> 24/*here.bits*/;\n          hold >>>= op;\n          bits -= op;\n          op = (here >>> 16) & 0xff/*here.op*/;\n\n          if (op & 16) {                      /* distance base */\n            dist = here & 0xffff/*here.val*/;\n            op &= 15;                       /* number of extra bits */\n            if (bits < op) {\n              hold += input[_in++] << bits;\n              bits += 8;\n              if (bits < op) {\n                hold += input[_in++] << bits;\n                bits += 8;\n              }\n            }\n            dist += hold & ((1 << op) - 1);\n//#ifdef INFLATE_STRICT\n            if (dist > dmax) {\n              strm.msg = 'invalid distance too far back';\n              state.mode = BAD$1;\n              break top;\n            }\n//#endif\n            hold >>>= op;\n            bits -= op;\n            //Tracevv((stderr, \"inflate:         distance %u\\n\", dist));\n            op = _out - beg;                /* max distance in output */\n            if (dist > op) {                /* see if copy from window */\n              op = dist - op;               /* distance back in window */\n              if (op > whave) {\n                if (state.sane) {\n                  strm.msg = 'invalid distance too far back';\n                  state.mode = BAD$1;\n                  break top;\n                }\n\n// (!) This block is disabled in zlib defaults,\n// don't enable it for binary compatibility\n//#ifdef INFLATE_ALLOW_INVALID_DISTANCE_TOOFAR_ARRR\n//                if (len <= op - whave) {\n//                  do {\n//                    output[_out++] = 0;\n//                  } while (--len);\n//                  continue top;\n//                }\n//                len -= op - whave;\n//                do {\n//                  output[_out++] = 0;\n//                } while (--op > whave);\n//                if (op === 0) {\n//                  from = _out - dist;\n//                  do {\n//                    output[_out++] = output[from++];\n//                  } while (--len);\n//                  continue top;\n//                }\n//#endif\n              }\n              from = 0; // window index\n              from_source = s_window;\n              if (wnext === 0) {           /* very common case */\n                from += wsize - op;\n                if (op < len) {         /* some from window */\n                  len -= op;\n                  do {\n                    output[_out++] = s_window[from++];\n                  } while (--op);\n                  from = _out - dist;  /* rest from output */\n                  from_source = output;\n                }\n              }\n              else if (wnext < op) {      /* wrap around window */\n                from += wsize + wnext - op;\n                op -= wnext;\n                if (op < len) {         /* some from end of window */\n                  len -= op;\n                  do {\n                    output[_out++] = s_window[from++];\n                  } while (--op);\n                  from = 0;\n                  if (wnext < len) {  /* some from start of window */\n                    op = wnext;\n                    len -= op;\n                    do {\n                      output[_out++] = s_window[from++];\n                    } while (--op);\n                    from = _out - dist;      /* rest from output */\n                    from_source = output;\n                  }\n                }\n              }\n              else {                      /* contiguous in window */\n                from += wnext - op;\n                if (op < len) {         /* some from window */\n                  len -= op;\n                  do {\n                    output[_out++] = s_window[from++];\n                  } while (--op);\n                  from = _out - dist;  /* rest from output */\n                  from_source = output;\n                }\n              }\n              while (len > 2) {\n                output[_out++] = from_source[from++];\n                output[_out++] = from_source[from++];\n                output[_out++] = from_source[from++];\n                len -= 3;\n              }\n              if (len) {\n                output[_out++] = from_source[from++];\n                if (len > 1) {\n                  output[_out++] = from_source[from++];\n                }\n              }\n            }\n            else {\n              from = _out - dist;          /* copy direct from output */\n              do {                        /* minimum length is three */\n                output[_out++] = output[from++];\n                output[_out++] = output[from++];\n                output[_out++] = output[from++];\n                len -= 3;\n              } while (len > 2);\n              if (len) {\n                output[_out++] = output[from++];\n                if (len > 1) {\n                  output[_out++] = output[from++];\n                }\n              }\n            }\n          }\n          else if ((op & 64) === 0) {          /* 2nd level distance code */\n            here = dcode[(here & 0xffff)/*here.val*/ + (hold & ((1 << op) - 1))];\n            continue dodist;\n          }\n          else {\n            strm.msg = 'invalid distance code';\n            state.mode = BAD$1;\n            break top;\n          }\n\n          break; // need to emulate goto via \"continue\"\n        }\n      }\n      else if ((op & 64) === 0) {              /* 2nd level length code */\n        here = lcode[(here & 0xffff)/*here.val*/ + (hold & ((1 << op) - 1))];\n        continue dolen;\n      }\n      else if (op & 32) {                     /* end-of-block */\n        //Tracevv((stderr, \"inflate:         end of block\\n\"));\n        state.mode = TYPE$1;\n        break top;\n      }\n      else {\n        strm.msg = 'invalid literal/length code';\n        state.mode = BAD$1;\n        break top;\n      }\n\n      break; // need to emulate goto via \"continue\"\n    }\n  } while (_in < last && _out < end);\n\n  /* return unused bytes (on entry, bits < 8, so in won't go too far back) */\n  len = bits >> 3;\n  _in -= len;\n  bits -= len << 3;\n  hold &= (1 << bits) - 1;\n\n  /* update state and return */\n  strm.next_in = _in;\n  strm.next_out = _out;\n  strm.avail_in = (_in < last ? 5 + (last - _in) : 5 - (_in - last));\n  strm.avail_out = (_out < end ? 257 + (end - _out) : 257 - (_out - end));\n  state.hold = hold;\n  state.bits = bits;\n  return;\n};\n\n// (C) 1995-2013 Jean-loup Gailly and Mark Adler\n// (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n//\n// This software is provided 'as-is', without any express or implied\n// warranty. In no event will the authors be held liable for any damages\n// arising from the use of this software.\n//\n// Permission is granted to anyone to use this software for any purpose,\n// including commercial applications, and to alter it and redistribute it\n// freely, subject to the following restrictions:\n//\n// 1. The origin of this software must not be misrepresented; you must not\n//   claim that you wrote the original software. If you use this software\n//   in a product, an acknowledgment in the product documentation would be\n//   appreciated but is not required.\n// 2. Altered source versions must be plainly marked as such, and must not be\n//   misrepresented as being the original software.\n// 3. This notice may not be removed or altered from any source distribution.\n\nconst MAXBITS = 15;\nconst ENOUGH_LENS$1 = 852;\nconst ENOUGH_DISTS$1 = 592;\n//const ENOUGH = (ENOUGH_LENS+ENOUGH_DISTS);\n\nconst CODES$1 = 0;\nconst LENS$1 = 1;\nconst DISTS$1 = 2;\n\nconst lbase = new Uint16Array([ /* Length codes 257..285 base */\n  3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31,\n  35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258, 0, 0\n]);\n\nconst lext = new Uint8Array([ /* Length codes 257..285 extra */\n  16, 16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 18, 18, 18, 18,\n  19, 19, 19, 19, 20, 20, 20, 20, 21, 21, 21, 21, 16, 72, 78\n]);\n\nconst dbase = new Uint16Array([ /* Distance codes 0..29 base */\n  1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193,\n  257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145,\n  8193, 12289, 16385, 24577, 0, 0\n]);\n\nconst dext = new Uint8Array([ /* Distance codes 0..29 extra */\n  16, 16, 16, 16, 17, 17, 18, 18, 19, 19, 20, 20, 21, 21, 22, 22,\n  23, 23, 24, 24, 25, 25, 26, 26, 27, 27,\n  28, 28, 29, 29, 64, 64\n]);\n\nconst inflate_table = (type, lens, lens_index, codes, table, table_index, work, opts) =>\n{\n  const bits = opts.bits;\n      //here = opts.here; /* table entry for duplication */\n\n  let len = 0;               /* a code's length in bits */\n  let sym = 0;               /* index of code symbols */\n  let min = 0, max = 0;          /* minimum and maximum code lengths */\n  let root = 0;              /* number of index bits for root table */\n  let curr = 0;              /* number of index bits for current table */\n  let drop = 0;              /* code bits to drop for sub-table */\n  let left = 0;                   /* number of prefix codes available */\n  let used = 0;              /* code entries in table used */\n  let huff = 0;              /* Huffman code */\n  let incr;              /* for incrementing code, index */\n  let fill;              /* index for replicating entries */\n  let low;               /* low bits for current root entry */\n  let mask;              /* mask for low root bits */\n  let next;             /* next available space in table */\n  let base = null;     /* base value table to use */\n//  let shoextra;    /* extra bits table to use */\n  let match;                  /* use base and extra for symbol >= match */\n  const count = new Uint16Array(MAXBITS + 1); //[MAXBITS+1];    /* number of codes of each length */\n  const offs = new Uint16Array(MAXBITS + 1); //[MAXBITS+1];     /* offsets in table for each length */\n  let extra = null;\n\n  let here_bits, here_op, here_val;\n\n  /*\n   Process a set of code lengths to create a canonical Huffman code.  The\n   code lengths are lens[0..codes-1].  Each length corresponds to the\n   symbols 0..codes-1.  The Huffman code is generated by first sorting the\n   symbols by length from short to long, and retaining the symbol order\n   for codes with equal lengths.  Then the code starts with all zero bits\n   for the first code of the shortest length, and the codes are integer\n   increments for the same length, and zeros are appended as the length\n   increases.  For the deflate format, these bits are stored backwards\n   from their more natural integer increment ordering, and so when the\n   decoding tables are built in the large loop below, the integer codes\n   are incremented backwards.\n\n   This routine assumes, but does not check, that all of the entries in\n   lens[] are in the range 0..MAXBITS.  The caller must assure this.\n   1..MAXBITS is interpreted as that code length.  zero means that that\n   symbol does not occur in this code.\n\n   The codes are sorted by computing a count of codes for each length,\n   creating from that a table of starting indices for each length in the\n   sorted table, and then entering the symbols in order in the sorted\n   table.  The sorted table is work[], with that space being provided by\n   the caller.\n\n   The length counts are used for other purposes as well, i.e. finding\n   the minimum and maximum length codes, determining if there are any\n   codes at all, checking for a valid set of lengths, and looking ahead\n   at length counts to determine sub-table sizes when building the\n   decoding tables.\n   */\n\n  /* accumulate lengths for codes (assumes lens[] all in 0..MAXBITS) */\n  for (len = 0; len <= MAXBITS; len++) {\n    count[len] = 0;\n  }\n  for (sym = 0; sym < codes; sym++) {\n    count[lens[lens_index + sym]]++;\n  }\n\n  /* bound code lengths, force root to be within code lengths */\n  root = bits;\n  for (max = MAXBITS; max >= 1; max--) {\n    if (count[max] !== 0) { break; }\n  }\n  if (root > max) {\n    root = max;\n  }\n  if (max === 0) {                     /* no symbols to code at all */\n    //table.op[opts.table_index] = 64;  //here.op = (var char)64;    /* invalid code marker */\n    //table.bits[opts.table_index] = 1;   //here.bits = (var char)1;\n    //table.val[opts.table_index++] = 0;   //here.val = (var short)0;\n    table[table_index++] = (1 << 24) | (64 << 16) | 0;\n\n\n    //table.op[opts.table_index] = 64;\n    //table.bits[opts.table_index] = 1;\n    //table.val[opts.table_index++] = 0;\n    table[table_index++] = (1 << 24) | (64 << 16) | 0;\n\n    opts.bits = 1;\n    return 0;     /* no symbols, but wait for decoding to report error */\n  }\n  for (min = 1; min < max; min++) {\n    if (count[min] !== 0) { break; }\n  }\n  if (root < min) {\n    root = min;\n  }\n\n  /* check for an over-subscribed or incomplete set of lengths */\n  left = 1;\n  for (len = 1; len <= MAXBITS; len++) {\n    left <<= 1;\n    left -= count[len];\n    if (left < 0) {\n      return -1;\n    }        /* over-subscribed */\n  }\n  if (left > 0 && (type === CODES$1 || max !== 1)) {\n    return -1;                      /* incomplete set */\n  }\n\n  /* generate offsets into symbol table for each length for sorting */\n  offs[1] = 0;\n  for (len = 1; len < MAXBITS; len++) {\n    offs[len + 1] = offs[len] + count[len];\n  }\n\n  /* sort symbols by length, by symbol order within each length */\n  for (sym = 0; sym < codes; sym++) {\n    if (lens[lens_index + sym] !== 0) {\n      work[offs[lens[lens_index + sym]]++] = sym;\n    }\n  }\n\n  /*\n   Create and fill in decoding tables.  In this loop, the table being\n   filled is at next and has curr index bits.  The code being used is huff\n   with length len.  That code is converted to an index by dropping drop\n   bits off of the bottom.  For codes where len is less than drop + curr,\n   those top drop + curr - len bits are incremented through all values to\n   fill the table with replicated entries.\n\n   root is the number of index bits for the root table.  When len exceeds\n   root, sub-tables are created pointed to by the root entry with an index\n   of the low root bits of huff.  This is saved in low to check for when a\n   new sub-table should be started.  drop is zero when the root table is\n   being filled, and drop is root when sub-tables are being filled.\n\n   When a new sub-table is needed, it is necessary to look ahead in the\n   code lengths to determine what size sub-table is needed.  The length\n   counts are used for this, and so count[] is decremented as codes are\n   entered in the tables.\n\n   used keeps track of how many table entries have been allocated from the\n   provided *table space.  It is checked for LENS and DIST tables against\n   the constants ENOUGH_LENS and ENOUGH_DISTS to guard against changes in\n   the initial root table size constants.  See the comments in inftrees.h\n   for more information.\n\n   sym increments through all symbols, and the loop terminates when\n   all codes of length max, i.e. all codes, have been processed.  This\n   routine permits incomplete codes, so another loop after this one fills\n   in the rest of the decoding tables with invalid code markers.\n   */\n\n  /* set up for code type */\n  // poor man optimization - use if-else instead of switch,\n  // to avoid deopts in old v8\n  if (type === CODES$1) {\n    base = extra = work;    /* dummy value--not used */\n    match = 20;\n\n  } else if (type === LENS$1) {\n    base = lbase;\n    extra = lext;\n    match = 257;\n\n  } else {                    /* DISTS */\n    base = dbase;\n    extra = dext;\n    match = 0;\n  }\n\n  /* initialize opts for loop */\n  huff = 0;                   /* starting code */\n  sym = 0;                    /* starting code symbol */\n  len = min;                  /* starting code length */\n  next = table_index;              /* current table to fill in */\n  curr = root;                /* current table index bits */\n  drop = 0;                   /* current bits to drop from code for index */\n  low = -1;                   /* trigger new sub-table when len > root */\n  used = 1 << root;          /* use root table entries */\n  mask = used - 1;            /* mask for comparing low */\n\n  /* check available table space */\n  if ((type === LENS$1 && used > ENOUGH_LENS$1) ||\n    (type === DISTS$1 && used > ENOUGH_DISTS$1)) {\n    return 1;\n  }\n\n  /* process all codes and make table entries */\n  for (;;) {\n    /* create table entry */\n    here_bits = len - drop;\n    if (work[sym] + 1 < match) {\n      here_op = 0;\n      here_val = work[sym];\n    }\n    else if (work[sym] >= match) {\n      here_op = extra[work[sym] - match];\n      here_val = base[work[sym] - match];\n    }\n    else {\n      here_op = 32 + 64;         /* end of block */\n      here_val = 0;\n    }\n\n    /* replicate for those indices with low len bits equal to huff */\n    incr = 1 << (len - drop);\n    fill = 1 << curr;\n    min = fill;                 /* save offset to next table */\n    do {\n      fill -= incr;\n      table[next + (huff >> drop) + fill] = (here_bits << 24) | (here_op << 16) | here_val |0;\n    } while (fill !== 0);\n\n    /* backwards increment the len-bit code huff */\n    incr = 1 << (len - 1);\n    while (huff & incr) {\n      incr >>= 1;\n    }\n    if (incr !== 0) {\n      huff &= incr - 1;\n      huff += incr;\n    } else {\n      huff = 0;\n    }\n\n    /* go to next symbol, update count, len */\n    sym++;\n    if (--count[len] === 0) {\n      if (len === max) { break; }\n      len = lens[lens_index + work[sym]];\n    }\n\n    /* create new sub-table if needed */\n    if (len > root && (huff & mask) !== low) {\n      /* if first time, transition to sub-tables */\n      if (drop === 0) {\n        drop = root;\n      }\n\n      /* increment past last table */\n      next += min;            /* here min is 1 << curr */\n\n      /* determine length of next table */\n      curr = len - drop;\n      left = 1 << curr;\n      while (curr + drop < max) {\n        left -= count[curr + drop];\n        if (left <= 0) { break; }\n        curr++;\n        left <<= 1;\n      }\n\n      /* check for enough space */\n      used += 1 << curr;\n      if ((type === LENS$1 && used > ENOUGH_LENS$1) ||\n        (type === DISTS$1 && used > ENOUGH_DISTS$1)) {\n        return 1;\n      }\n\n      /* point entry in root table to sub-table */\n      low = huff & mask;\n      /*table.op[low] = curr;\n      table.bits[low] = root;\n      table.val[low] = next - opts.table_index;*/\n      table[low] = (root << 24) | (curr << 16) | (next - table_index) |0;\n    }\n  }\n\n  /* fill in remaining table entry if code is incomplete (guaranteed to have\n   at most one remaining entry, since if the code is incomplete, the\n   maximum code length that was allowed to get this far is one bit) */\n  if (huff !== 0) {\n    //table.op[next + huff] = 64;            /* invalid code marker */\n    //table.bits[next + huff] = len - drop;\n    //table.val[next + huff] = 0;\n    table[next + huff] = ((len - drop) << 24) | (64 << 16) |0;\n  }\n\n  /* set return parameters */\n  //opts.table_index += used;\n  opts.bits = root;\n  return 0;\n};\n\n\nvar inftrees = inflate_table;\n\n// (C) 1995-2013 Jean-loup Gailly and Mark Adler\n// (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n//\n// This software is provided 'as-is', without any express or implied\n// warranty. In no event will the authors be held liable for any damages\n// arising from the use of this software.\n//\n// Permission is granted to anyone to use this software for any purpose,\n// including commercial applications, and to alter it and redistribute it\n// freely, subject to the following restrictions:\n//\n// 1. The origin of this software must not be misrepresented; you must not\n//   claim that you wrote the original software. If you use this software\n//   in a product, an acknowledgment in the product documentation would be\n//   appreciated but is not required.\n// 2. Altered source versions must be plainly marked as such, and must not be\n//   misrepresented as being the original software.\n// 3. This notice may not be removed or altered from any source distribution.\n\n\n\n\n\n\nconst CODES = 0;\nconst LENS = 1;\nconst DISTS = 2;\n\n/* Public constants ==========================================================*/\n/* ===========================================================================*/\n\nconst {\n  Z_FINISH: Z_FINISH$1, Z_BLOCK, Z_TREES,\n  Z_OK: Z_OK$1, Z_STREAM_END: Z_STREAM_END$1, Z_NEED_DICT: Z_NEED_DICT$1, Z_STREAM_ERROR: Z_STREAM_ERROR$1, Z_DATA_ERROR: Z_DATA_ERROR$1, Z_MEM_ERROR: Z_MEM_ERROR$1, Z_BUF_ERROR,\n  Z_DEFLATED\n} = constants$2;\n\n\n/* STATES ====================================================================*/\n/* ===========================================================================*/\n\n\nconst    HEAD = 16180;       /* i: waiting for magic header */\nconst    FLAGS = 16181;      /* i: waiting for method and flags (gzip) */\nconst    TIME = 16182;       /* i: waiting for modification time (gzip) */\nconst    OS = 16183;         /* i: waiting for extra flags and operating system (gzip) */\nconst    EXLEN = 16184;      /* i: waiting for extra length (gzip) */\nconst    EXTRA = 16185;      /* i: waiting for extra bytes (gzip) */\nconst    NAME = 16186;       /* i: waiting for end of file name (gzip) */\nconst    COMMENT = 16187;    /* i: waiting for end of comment (gzip) */\nconst    HCRC = 16188;       /* i: waiting for header crc (gzip) */\nconst    DICTID = 16189;    /* i: waiting for dictionary check value */\nconst    DICT = 16190;      /* waiting for inflateSetDictionary() call */\nconst        TYPE = 16191;      /* i: waiting for type bits, including last-flag bit */\nconst        TYPEDO = 16192;    /* i: same, but skip check to exit inflate on new block */\nconst        STORED = 16193;    /* i: waiting for stored size (length and complement) */\nconst        COPY_ = 16194;     /* i/o: same as COPY below, but only first time in */\nconst        COPY = 16195;      /* i/o: waiting for input or output to copy stored block */\nconst        TABLE = 16196;     /* i: waiting for dynamic block table lengths */\nconst        LENLENS = 16197;   /* i: waiting for code length code lengths */\nconst        CODELENS = 16198;  /* i: waiting for length/lit and distance code lengths */\nconst            LEN_ = 16199;      /* i: same as LEN below, but only first time in */\nconst            LEN = 16200;       /* i: waiting for length/lit/eob code */\nconst            LENEXT = 16201;    /* i: waiting for length extra bits */\nconst            DIST = 16202;      /* i: waiting for distance code */\nconst            DISTEXT = 16203;   /* i: waiting for distance extra bits */\nconst            MATCH = 16204;     /* o: waiting for output space to copy string */\nconst            LIT = 16205;       /* o: waiting for output space to write literal */\nconst    CHECK = 16206;     /* i: waiting for 32-bit check value */\nconst    LENGTH = 16207;    /* i: waiting for 32-bit length (gzip) */\nconst    DONE = 16208;      /* finished check, done -- remain here until reset */\nconst    BAD = 16209;       /* got a data error -- remain here until reset */\nconst    MEM = 16210;       /* got an inflate() memory error -- remain here until reset */\nconst    SYNC = 16211;      /* looking for synchronization bytes to restart inflate() */\n\n/* ===========================================================================*/\n\n\n\nconst ENOUGH_LENS = 852;\nconst ENOUGH_DISTS = 592;\n//const ENOUGH =  (ENOUGH_LENS+ENOUGH_DISTS);\n\nconst MAX_WBITS = 15;\n/* 32K LZ77 window */\nconst DEF_WBITS = MAX_WBITS;\n\n\nconst zswap32 = (q) => {\n\n  return  (((q >>> 24) & 0xff) +\n          ((q >>> 8) & 0xff00) +\n          ((q & 0xff00) << 8) +\n          ((q & 0xff) << 24));\n};\n\n\nfunction InflateState() {\n  this.strm = null;           /* pointer back to this zlib stream */\n  this.mode = 0;              /* current inflate mode */\n  this.last = false;          /* true if processing last block */\n  this.wrap = 0;              /* bit 0 true for zlib, bit 1 true for gzip,\n                                 bit 2 true to validate check value */\n  this.havedict = false;      /* true if dictionary provided */\n  this.flags = 0;             /* gzip header method and flags (0 if zlib), or\n                                 -1 if raw or no header yet */\n  this.dmax = 0;              /* zlib header max distance (INFLATE_STRICT) */\n  this.check = 0;             /* protected copy of check value */\n  this.total = 0;             /* protected copy of output count */\n  // TODO: may be {}\n  this.head = null;           /* where to save gzip header information */\n\n  /* sliding window */\n  this.wbits = 0;             /* log base 2 of requested window size */\n  this.wsize = 0;             /* window size or zero if not using window */\n  this.whave = 0;             /* valid bytes in the window */\n  this.wnext = 0;             /* window write index */\n  this.window = null;         /* allocated sliding window, if needed */\n\n  /* bit accumulator */\n  this.hold = 0;              /* input bit accumulator */\n  this.bits = 0;              /* number of bits in \"in\" */\n\n  /* for string and stored block copying */\n  this.length = 0;            /* literal or length of data to copy */\n  this.offset = 0;            /* distance back to copy string from */\n\n  /* for table and code decoding */\n  this.extra = 0;             /* extra bits needed */\n\n  /* fixed and dynamic code tables */\n  this.lencode = null;          /* starting table for length/literal codes */\n  this.distcode = null;         /* starting table for distance codes */\n  this.lenbits = 0;           /* index bits for lencode */\n  this.distbits = 0;          /* index bits for distcode */\n\n  /* dynamic table building */\n  this.ncode = 0;             /* number of code length code lengths */\n  this.nlen = 0;              /* number of length code lengths */\n  this.ndist = 0;             /* number of distance code lengths */\n  this.have = 0;              /* number of code lengths in lens[] */\n  this.next = null;              /* next available space in codes[] */\n\n  this.lens = new Uint16Array(320); /* temporary storage for code lengths */\n  this.work = new Uint16Array(288); /* work area for code table building */\n\n  /*\n   because we don't have pointers in js, we use lencode and distcode directly\n   as buffers so we don't need codes\n  */\n  //this.codes = new Int32Array(ENOUGH);       /* space for code tables */\n  this.lendyn = null;              /* dynamic table for length/literal codes (JS specific) */\n  this.distdyn = null;             /* dynamic table for distance codes (JS specific) */\n  this.sane = 0;                   /* if false, allow invalid distance too far */\n  this.back = 0;                   /* bits back of last unprocessed length/lit */\n  this.was = 0;                    /* initial length of match */\n}\n\n\nconst inflateStateCheck = (strm) => {\n\n  if (!strm) {\n    return 1;\n  }\n  const state = strm.state;\n  if (!state || state.strm !== strm ||\n    state.mode < HEAD || state.mode > SYNC) {\n    return 1;\n  }\n  return 0;\n};\n\n\nconst inflateResetKeep = (strm) => {\n\n  if (inflateStateCheck(strm)) { return Z_STREAM_ERROR$1; }\n  const state = strm.state;\n  strm.total_in = strm.total_out = state.total = 0;\n  strm.msg = ''; /*Z_NULL*/\n  if (state.wrap) {       /* to support ill-conceived Java test suite */\n    strm.adler = state.wrap & 1;\n  }\n  state.mode = HEAD;\n  state.last = 0;\n  state.havedict = 0;\n  state.flags = -1;\n  state.dmax = 32768;\n  state.head = null/*Z_NULL*/;\n  state.hold = 0;\n  state.bits = 0;\n  //state.lencode = state.distcode = state.next = state.codes;\n  state.lencode = state.lendyn = new Int32Array(ENOUGH_LENS);\n  state.distcode = state.distdyn = new Int32Array(ENOUGH_DISTS);\n\n  state.sane = 1;\n  state.back = -1;\n  //Tracev((stderr, \"inflate: reset\\n\"));\n  return Z_OK$1;\n};\n\n\nconst inflateReset = (strm) => {\n\n  if (inflateStateCheck(strm)) { return Z_STREAM_ERROR$1; }\n  const state = strm.state;\n  state.wsize = 0;\n  state.whave = 0;\n  state.wnext = 0;\n  return inflateResetKeep(strm);\n\n};\n\n\nconst inflateReset2 = (strm, windowBits) => {\n  let wrap;\n\n  /* get the state */\n  if (inflateStateCheck(strm)) { return Z_STREAM_ERROR$1; }\n  const state = strm.state;\n\n  /* extract wrap request from windowBits parameter */\n  if (windowBits < 0) {\n    wrap = 0;\n    windowBits = -windowBits;\n  }\n  else {\n    wrap = (windowBits >> 4) + 5;\n    if (windowBits < 48) {\n      windowBits &= 15;\n    }\n  }\n\n  /* set number of window bits, free window if different */\n  if (windowBits && (windowBits < 8 || windowBits > 15)) {\n    return Z_STREAM_ERROR$1;\n  }\n  if (state.window !== null && state.wbits !== windowBits) {\n    state.window = null;\n  }\n\n  /* update state and reset the rest of it */\n  state.wrap = wrap;\n  state.wbits = windowBits;\n  return inflateReset(strm);\n};\n\n\nconst inflateInit2 = (strm, windowBits) => {\n\n  if (!strm) { return Z_STREAM_ERROR$1; }\n  //strm.msg = Z_NULL;                 /* in case we return an error */\n\n  const state = new InflateState();\n\n  //if (state === Z_NULL) return Z_MEM_ERROR;\n  //Tracev((stderr, \"inflate: allocated\\n\"));\n  strm.state = state;\n  state.strm = strm;\n  state.window = null/*Z_NULL*/;\n  state.mode = HEAD;     /* to pass state test in inflateReset2() */\n  const ret = inflateReset2(strm, windowBits);\n  if (ret !== Z_OK$1) {\n    strm.state = null/*Z_NULL*/;\n  }\n  return ret;\n};\n\n\nconst inflateInit = (strm) => {\n\n  return inflateInit2(strm, DEF_WBITS);\n};\n\n\n/*\n Return state with length and distance decoding tables and index sizes set to\n fixed code decoding.  Normally this returns fixed tables from inffixed.h.\n If BUILDFIXED is defined, then instead this routine builds the tables the\n first time it's called, and returns those tables the first time and\n thereafter.  This reduces the size of the code by about 2K bytes, in\n exchange for a little execution time.  However, BUILDFIXED should not be\n used for threaded applications, since the rewriting of the tables and virgin\n may not be thread-safe.\n */\nlet virgin = true;\n\nlet lenfix, distfix; // We have no pointers in JS, so keep tables separate\n\n\nconst fixedtables = (state) => {\n\n  /* build fixed huffman tables if first call (may not be thread safe) */\n  if (virgin) {\n    lenfix = new Int32Array(512);\n    distfix = new Int32Array(32);\n\n    /* literal/length table */\n    let sym = 0;\n    while (sym < 144) { state.lens[sym++] = 8; }\n    while (sym < 256) { state.lens[sym++] = 9; }\n    while (sym < 280) { state.lens[sym++] = 7; }\n    while (sym < 288) { state.lens[sym++] = 8; }\n\n    inftrees(LENS,  state.lens, 0, 288, lenfix,   0, state.work, { bits: 9 });\n\n    /* distance table */\n    sym = 0;\n    while (sym < 32) { state.lens[sym++] = 5; }\n\n    inftrees(DISTS, state.lens, 0, 32,   distfix, 0, state.work, { bits: 5 });\n\n    /* do this just once */\n    virgin = false;\n  }\n\n  state.lencode = lenfix;\n  state.lenbits = 9;\n  state.distcode = distfix;\n  state.distbits = 5;\n};\n\n\n/*\n Update the window with the last wsize (normally 32K) bytes written before\n returning.  If window does not exist yet, create it.  This is only called\n when a window is already in use, or when output has been written during this\n inflate call, but the end of the deflate stream has not been reached yet.\n It is also called to create a window for dictionary data when a dictionary\n is loaded.\n\n Providing output buffers larger than 32K to inflate() should provide a speed\n advantage, since only the last 32K of output is copied to the sliding window\n upon return from inflate(), and since all distances after the first 32K of\n output will fall in the output data, making match copies simpler and faster.\n The advantage may be dependent on the size of the processor's data caches.\n */\nconst updatewindow = (strm, src, end, copy) => {\n\n  let dist;\n  const state = strm.state;\n\n  /* if it hasn't been done already, allocate space for the window */\n  if (state.window === null) {\n    state.wsize = 1 << state.wbits;\n    state.wnext = 0;\n    state.whave = 0;\n\n    state.window = new Uint8Array(state.wsize);\n  }\n\n  /* copy state->wsize or less output bytes into the circular window */\n  if (copy >= state.wsize) {\n    state.window.set(src.subarray(end - state.wsize, end), 0);\n    state.wnext = 0;\n    state.whave = state.wsize;\n  }\n  else {\n    dist = state.wsize - state.wnext;\n    if (dist > copy) {\n      dist = copy;\n    }\n    //zmemcpy(state->window + state->wnext, end - copy, dist);\n    state.window.set(src.subarray(end - copy, end - copy + dist), state.wnext);\n    copy -= dist;\n    if (copy) {\n      //zmemcpy(state->window, end - copy, copy);\n      state.window.set(src.subarray(end - copy, end), 0);\n      state.wnext = copy;\n      state.whave = state.wsize;\n    }\n    else {\n      state.wnext += dist;\n      if (state.wnext === state.wsize) { state.wnext = 0; }\n      if (state.whave < state.wsize) { state.whave += dist; }\n    }\n  }\n  return 0;\n};\n\n\nconst inflate$2 = (strm, flush) => {\n\n  let state;\n  let input, output;          // input/output buffers\n  let next;                   /* next input INDEX */\n  let put;                    /* next output INDEX */\n  let have, left;             /* available input and output */\n  let hold;                   /* bit buffer */\n  let bits;                   /* bits in bit buffer */\n  let _in, _out;              /* save starting available input and output */\n  let copy;                   /* number of stored or match bytes to copy */\n  let from;                   /* where to copy match bytes from */\n  let from_source;\n  let here = 0;               /* current decoding table entry */\n  let here_bits, here_op, here_val; // paked \"here\" denormalized (JS specific)\n  //let last;                   /* parent table entry */\n  let last_bits, last_op, last_val; // paked \"last\" denormalized (JS specific)\n  let len;                    /* length to copy for repeats, bits to drop */\n  let ret;                    /* return code */\n  const hbuf = new Uint8Array(4);    /* buffer for gzip header crc calculation */\n  let opts;\n\n  let n; // temporary variable for NEED_BITS\n\n  const order = /* permutation of code lengths */\n    new Uint8Array([ 16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15 ]);\n\n\n  if (inflateStateCheck(strm) || !strm.output ||\n      (!strm.input && strm.avail_in !== 0)) {\n    return Z_STREAM_ERROR$1;\n  }\n\n  state = strm.state;\n  if (state.mode === TYPE) { state.mode = TYPEDO; }    /* skip check */\n\n\n  //--- LOAD() ---\n  put = strm.next_out;\n  output = strm.output;\n  left = strm.avail_out;\n  next = strm.next_in;\n  input = strm.input;\n  have = strm.avail_in;\n  hold = state.hold;\n  bits = state.bits;\n  //---\n\n  _in = have;\n  _out = left;\n  ret = Z_OK$1;\n\n  inf_leave: // goto emulation\n  for (;;) {\n    switch (state.mode) {\n      case HEAD:\n        if (state.wrap === 0) {\n          state.mode = TYPEDO;\n          break;\n        }\n        //=== NEEDBITS(16);\n        while (bits < 16) {\n          if (have === 0) { break inf_leave; }\n          have--;\n          hold += input[next++] << bits;\n          bits += 8;\n        }\n        //===//\n        if ((state.wrap & 2) && hold === 0x8b1f) {  /* gzip header */\n          if (state.wbits === 0) {\n            state.wbits = 15;\n          }\n          state.check = 0/*crc32(0L, Z_NULL, 0)*/;\n          //=== CRC2(state.check, hold);\n          hbuf[0] = hold & 0xff;\n          hbuf[1] = (hold >>> 8) & 0xff;\n          state.check = crc32_1(state.check, hbuf, 2, 0);\n          //===//\n\n          //=== INITBITS();\n          hold = 0;\n          bits = 0;\n          //===//\n          state.mode = FLAGS;\n          break;\n        }\n        if (state.head) {\n          state.head.done = false;\n        }\n        if (!(state.wrap & 1) ||   /* check if zlib header allowed */\n          (((hold & 0xff)/*BITS(8)*/ << 8) + (hold >> 8)) % 31) {\n          strm.msg = 'incorrect header check';\n          state.mode = BAD;\n          break;\n        }\n        if ((hold & 0x0f)/*BITS(4)*/ !== Z_DEFLATED) {\n          strm.msg = 'unknown compression method';\n          state.mode = BAD;\n          break;\n        }\n        //--- DROPBITS(4) ---//\n        hold >>>= 4;\n        bits -= 4;\n        //---//\n        len = (hold & 0x0f)/*BITS(4)*/ + 8;\n        if (state.wbits === 0) {\n          state.wbits = len;\n        }\n        if (len > 15 || len > state.wbits) {\n          strm.msg = 'invalid window size';\n          state.mode = BAD;\n          break;\n        }\n\n        // !!! pako patch. Force use `options.windowBits` if passed.\n        // Required to always use max window size by default.\n        state.dmax = 1 << state.wbits;\n        //state.dmax = 1 << len;\n\n        state.flags = 0;               /* indicate zlib header */\n        //Tracev((stderr, \"inflate:   zlib header ok\\n\"));\n        strm.adler = state.check = 1/*adler32(0L, Z_NULL, 0)*/;\n        state.mode = hold & 0x200 ? DICTID : TYPE;\n        //=== INITBITS();\n        hold = 0;\n        bits = 0;\n        //===//\n        break;\n      case FLAGS:\n        //=== NEEDBITS(16); */\n        while (bits < 16) {\n          if (have === 0) { break inf_leave; }\n          have--;\n          hold += input[next++] << bits;\n          bits += 8;\n        }\n        //===//\n        state.flags = hold;\n        if ((state.flags & 0xff) !== Z_DEFLATED) {\n          strm.msg = 'unknown compression method';\n          state.mode = BAD;\n          break;\n        }\n        if (state.flags & 0xe000) {\n          strm.msg = 'unknown header flags set';\n          state.mode = BAD;\n          break;\n        }\n        if (state.head) {\n          state.head.text = ((hold >> 8) & 1);\n        }\n        if ((state.flags & 0x0200) && (state.wrap & 4)) {\n          //=== CRC2(state.check, hold);\n          hbuf[0] = hold & 0xff;\n          hbuf[1] = (hold >>> 8) & 0xff;\n          state.check = crc32_1(state.check, hbuf, 2, 0);\n          //===//\n        }\n        //=== INITBITS();\n        hold = 0;\n        bits = 0;\n        //===//\n        state.mode = TIME;\n        /* falls through */\n      case TIME:\n        //=== NEEDBITS(32); */\n        while (bits < 32) {\n          if (have === 0) { break inf_leave; }\n          have--;\n          hold += input[next++] << bits;\n          bits += 8;\n        }\n        //===//\n        if (state.head) {\n          state.head.time = hold;\n        }\n        if ((state.flags & 0x0200) && (state.wrap & 4)) {\n          //=== CRC4(state.check, hold)\n          hbuf[0] = hold & 0xff;\n          hbuf[1] = (hold >>> 8) & 0xff;\n          hbuf[2] = (hold >>> 16) & 0xff;\n          hbuf[3] = (hold >>> 24) & 0xff;\n          state.check = crc32_1(state.check, hbuf, 4, 0);\n          //===\n        }\n        //=== INITBITS();\n        hold = 0;\n        bits = 0;\n        //===//\n        state.mode = OS;\n        /* falls through */\n      case OS:\n        //=== NEEDBITS(16); */\n        while (bits < 16) {\n          if (have === 0) { break inf_leave; }\n          have--;\n          hold += input[next++] << bits;\n          bits += 8;\n        }\n        //===//\n        if (state.head) {\n          state.head.xflags = (hold & 0xff);\n          state.head.os = (hold >> 8);\n        }\n        if ((state.flags & 0x0200) && (state.wrap & 4)) {\n          //=== CRC2(state.check, hold);\n          hbuf[0] = hold & 0xff;\n          hbuf[1] = (hold >>> 8) & 0xff;\n          state.check = crc32_1(state.check, hbuf, 2, 0);\n          //===//\n        }\n        //=== INITBITS();\n        hold = 0;\n        bits = 0;\n        //===//\n        state.mode = EXLEN;\n        /* falls through */\n      case EXLEN:\n        if (state.flags & 0x0400) {\n          //=== NEEDBITS(16); */\n          while (bits < 16) {\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n          }\n          //===//\n          state.length = hold;\n          if (state.head) {\n            state.head.extra_len = hold;\n          }\n          if ((state.flags & 0x0200) && (state.wrap & 4)) {\n            //=== CRC2(state.check, hold);\n            hbuf[0] = hold & 0xff;\n            hbuf[1] = (hold >>> 8) & 0xff;\n            state.check = crc32_1(state.check, hbuf, 2, 0);\n            //===//\n          }\n          //=== INITBITS();\n          hold = 0;\n          bits = 0;\n          //===//\n        }\n        else if (state.head) {\n          state.head.extra = null/*Z_NULL*/;\n        }\n        state.mode = EXTRA;\n        /* falls through */\n      case EXTRA:\n        if (state.flags & 0x0400) {\n          copy = state.length;\n          if (copy > have) { copy = have; }\n          if (copy) {\n            if (state.head) {\n              len = state.head.extra_len - state.length;\n              if (!state.head.extra) {\n                // Use untyped array for more convenient processing later\n                state.head.extra = new Uint8Array(state.head.extra_len);\n              }\n              state.head.extra.set(\n                input.subarray(\n                  next,\n                  // extra field is limited to 65536 bytes\n                  // - no need for additional size check\n                  next + copy\n                ),\n                /*len + copy > state.head.extra_max - len ? state.head.extra_max : copy,*/\n                len\n              );\n              //zmemcpy(state.head.extra + len, next,\n              //        len + copy > state.head.extra_max ?\n              //        state.head.extra_max - len : copy);\n            }\n            if ((state.flags & 0x0200) && (state.wrap & 4)) {\n              state.check = crc32_1(state.check, input, copy, next);\n            }\n            have -= copy;\n            next += copy;\n            state.length -= copy;\n          }\n          if (state.length) { break inf_leave; }\n        }\n        state.length = 0;\n        state.mode = NAME;\n        /* falls through */\n      case NAME:\n        if (state.flags & 0x0800) {\n          if (have === 0) { break inf_leave; }\n          copy = 0;\n          do {\n            // TODO: 2 or 1 bytes?\n            len = input[next + copy++];\n            /* use constant limit because in js we should not preallocate memory */\n            if (state.head && len &&\n                (state.length < 65536 /*state.head.name_max*/)) {\n              state.head.name += String.fromCharCode(len);\n            }\n          } while (len && copy < have);\n\n          if ((state.flags & 0x0200) && (state.wrap & 4)) {\n            state.check = crc32_1(state.check, input, copy, next);\n          }\n          have -= copy;\n          next += copy;\n          if (len) { break inf_leave; }\n        }\n        else if (state.head) {\n          state.head.name = null;\n        }\n        state.length = 0;\n        state.mode = COMMENT;\n        /* falls through */\n      case COMMENT:\n        if (state.flags & 0x1000) {\n          if (have === 0) { break inf_leave; }\n          copy = 0;\n          do {\n            len = input[next + copy++];\n            /* use constant limit because in js we should not preallocate memory */\n            if (state.head && len &&\n                (state.length < 65536 /*state.head.comm_max*/)) {\n              state.head.comment += String.fromCharCode(len);\n            }\n          } while (len && copy < have);\n          if ((state.flags & 0x0200) && (state.wrap & 4)) {\n            state.check = crc32_1(state.check, input, copy, next);\n          }\n          have -= copy;\n          next += copy;\n          if (len) { break inf_leave; }\n        }\n        else if (state.head) {\n          state.head.comment = null;\n        }\n        state.mode = HCRC;\n        /* falls through */\n      case HCRC:\n        if (state.flags & 0x0200) {\n          //=== NEEDBITS(16); */\n          while (bits < 16) {\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n          }\n          //===//\n          if ((state.wrap & 4) && hold !== (state.check & 0xffff)) {\n            strm.msg = 'header crc mismatch';\n            state.mode = BAD;\n            break;\n          }\n          //=== INITBITS();\n          hold = 0;\n          bits = 0;\n          //===//\n        }\n        if (state.head) {\n          state.head.hcrc = ((state.flags >> 9) & 1);\n          state.head.done = true;\n        }\n        strm.adler = state.check = 0;\n        state.mode = TYPE;\n        break;\n      case DICTID:\n        //=== NEEDBITS(32); */\n        while (bits < 32) {\n          if (have === 0) { break inf_leave; }\n          have--;\n          hold += input[next++] << bits;\n          bits += 8;\n        }\n        //===//\n        strm.adler = state.check = zswap32(hold);\n        //=== INITBITS();\n        hold = 0;\n        bits = 0;\n        //===//\n        state.mode = DICT;\n        /* falls through */\n      case DICT:\n        if (state.havedict === 0) {\n          //--- RESTORE() ---\n          strm.next_out = put;\n          strm.avail_out = left;\n          strm.next_in = next;\n          strm.avail_in = have;\n          state.hold = hold;\n          state.bits = bits;\n          //---\n          return Z_NEED_DICT$1;\n        }\n        strm.adler = state.check = 1/*adler32(0L, Z_NULL, 0)*/;\n        state.mode = TYPE;\n        /* falls through */\n      case TYPE:\n        if (flush === Z_BLOCK || flush === Z_TREES) { break inf_leave; }\n        /* falls through */\n      case TYPEDO:\n        if (state.last) {\n          //--- BYTEBITS() ---//\n          hold >>>= bits & 7;\n          bits -= bits & 7;\n          //---//\n          state.mode = CHECK;\n          break;\n        }\n        //=== NEEDBITS(3); */\n        while (bits < 3) {\n          if (have === 0) { break inf_leave; }\n          have--;\n          hold += input[next++] << bits;\n          bits += 8;\n        }\n        //===//\n        state.last = (hold & 0x01)/*BITS(1)*/;\n        //--- DROPBITS(1) ---//\n        hold >>>= 1;\n        bits -= 1;\n        //---//\n\n        switch ((hold & 0x03)/*BITS(2)*/) {\n          case 0:                             /* stored block */\n            //Tracev((stderr, \"inflate:     stored block%s\\n\",\n            //        state.last ? \" (last)\" : \"\"));\n            state.mode = STORED;\n            break;\n          case 1:                             /* fixed block */\n            fixedtables(state);\n            //Tracev((stderr, \"inflate:     fixed codes block%s\\n\",\n            //        state.last ? \" (last)\" : \"\"));\n            state.mode = LEN_;             /* decode codes */\n            if (flush === Z_TREES) {\n              //--- DROPBITS(2) ---//\n              hold >>>= 2;\n              bits -= 2;\n              //---//\n              break inf_leave;\n            }\n            break;\n          case 2:                             /* dynamic block */\n            //Tracev((stderr, \"inflate:     dynamic codes block%s\\n\",\n            //        state.last ? \" (last)\" : \"\"));\n            state.mode = TABLE;\n            break;\n          case 3:\n            strm.msg = 'invalid block type';\n            state.mode = BAD;\n        }\n        //--- DROPBITS(2) ---//\n        hold >>>= 2;\n        bits -= 2;\n        //---//\n        break;\n      case STORED:\n        //--- BYTEBITS() ---// /* go to byte boundary */\n        hold >>>= bits & 7;\n        bits -= bits & 7;\n        //---//\n        //=== NEEDBITS(32); */\n        while (bits < 32) {\n          if (have === 0) { break inf_leave; }\n          have--;\n          hold += input[next++] << bits;\n          bits += 8;\n        }\n        //===//\n        if ((hold & 0xffff) !== ((hold >>> 16) ^ 0xffff)) {\n          strm.msg = 'invalid stored block lengths';\n          state.mode = BAD;\n          break;\n        }\n        state.length = hold & 0xffff;\n        //Tracev((stderr, \"inflate:       stored length %u\\n\",\n        //        state.length));\n        //=== INITBITS();\n        hold = 0;\n        bits = 0;\n        //===//\n        state.mode = COPY_;\n        if (flush === Z_TREES) { break inf_leave; }\n        /* falls through */\n      case COPY_:\n        state.mode = COPY;\n        /* falls through */\n      case COPY:\n        copy = state.length;\n        if (copy) {\n          if (copy > have) { copy = have; }\n          if (copy > left) { copy = left; }\n          if (copy === 0) { break inf_leave; }\n          //--- zmemcpy(put, next, copy); ---\n          output.set(input.subarray(next, next + copy), put);\n          //---//\n          have -= copy;\n          next += copy;\n          left -= copy;\n          put += copy;\n          state.length -= copy;\n          break;\n        }\n        //Tracev((stderr, \"inflate:       stored end\\n\"));\n        state.mode = TYPE;\n        break;\n      case TABLE:\n        //=== NEEDBITS(14); */\n        while (bits < 14) {\n          if (have === 0) { break inf_leave; }\n          have--;\n          hold += input[next++] << bits;\n          bits += 8;\n        }\n        //===//\n        state.nlen = (hold & 0x1f)/*BITS(5)*/ + 257;\n        //--- DROPBITS(5) ---//\n        hold >>>= 5;\n        bits -= 5;\n        //---//\n        state.ndist = (hold & 0x1f)/*BITS(5)*/ + 1;\n        //--- DROPBITS(5) ---//\n        hold >>>= 5;\n        bits -= 5;\n        //---//\n        state.ncode = (hold & 0x0f)/*BITS(4)*/ + 4;\n        //--- DROPBITS(4) ---//\n        hold >>>= 4;\n        bits -= 4;\n        //---//\n//#ifndef PKZIP_BUG_WORKAROUND\n        if (state.nlen > 286 || state.ndist > 30) {\n          strm.msg = 'too many length or distance symbols';\n          state.mode = BAD;\n          break;\n        }\n//#endif\n        //Tracev((stderr, \"inflate:       table sizes ok\\n\"));\n        state.have = 0;\n        state.mode = LENLENS;\n        /* falls through */\n      case LENLENS:\n        while (state.have < state.ncode) {\n          //=== NEEDBITS(3);\n          while (bits < 3) {\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n          }\n          //===//\n          state.lens[order[state.have++]] = (hold & 0x07);//BITS(3);\n          //--- DROPBITS(3) ---//\n          hold >>>= 3;\n          bits -= 3;\n          //---//\n        }\n        while (state.have < 19) {\n          state.lens[order[state.have++]] = 0;\n        }\n        // We have separate tables & no pointers. 2 commented lines below not needed.\n        //state.next = state.codes;\n        //state.lencode = state.next;\n        // Switch to use dynamic table\n        state.lencode = state.lendyn;\n        state.lenbits = 7;\n\n        opts = { bits: state.lenbits };\n        ret = inftrees(CODES, state.lens, 0, 19, state.lencode, 0, state.work, opts);\n        state.lenbits = opts.bits;\n\n        if (ret) {\n          strm.msg = 'invalid code lengths set';\n          state.mode = BAD;\n          break;\n        }\n        //Tracev((stderr, \"inflate:       code lengths ok\\n\"));\n        state.have = 0;\n        state.mode = CODELENS;\n        /* falls through */\n      case CODELENS:\n        while (state.have < state.nlen + state.ndist) {\n          for (;;) {\n            here = state.lencode[hold & ((1 << state.lenbits) - 1)];/*BITS(state.lenbits)*/\n            here_bits = here >>> 24;\n            here_op = (here >>> 16) & 0xff;\n            here_val = here & 0xffff;\n\n            if ((here_bits) <= bits) { break; }\n            //--- PULLBYTE() ---//\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n            //---//\n          }\n          if (here_val < 16) {\n            //--- DROPBITS(here.bits) ---//\n            hold >>>= here_bits;\n            bits -= here_bits;\n            //---//\n            state.lens[state.have++] = here_val;\n          }\n          else {\n            if (here_val === 16) {\n              //=== NEEDBITS(here.bits + 2);\n              n = here_bits + 2;\n              while (bits < n) {\n                if (have === 0) { break inf_leave; }\n                have--;\n                hold += input[next++] << bits;\n                bits += 8;\n              }\n              //===//\n              //--- DROPBITS(here.bits) ---//\n              hold >>>= here_bits;\n              bits -= here_bits;\n              //---//\n              if (state.have === 0) {\n                strm.msg = 'invalid bit length repeat';\n                state.mode = BAD;\n                break;\n              }\n              len = state.lens[state.have - 1];\n              copy = 3 + (hold & 0x03);//BITS(2);\n              //--- DROPBITS(2) ---//\n              hold >>>= 2;\n              bits -= 2;\n              //---//\n            }\n            else if (here_val === 17) {\n              //=== NEEDBITS(here.bits + 3);\n              n = here_bits + 3;\n              while (bits < n) {\n                if (have === 0) { break inf_leave; }\n                have--;\n                hold += input[next++] << bits;\n                bits += 8;\n              }\n              //===//\n              //--- DROPBITS(here.bits) ---//\n              hold >>>= here_bits;\n              bits -= here_bits;\n              //---//\n              len = 0;\n              copy = 3 + (hold & 0x07);//BITS(3);\n              //--- DROPBITS(3) ---//\n              hold >>>= 3;\n              bits -= 3;\n              //---//\n            }\n            else {\n              //=== NEEDBITS(here.bits + 7);\n              n = here_bits + 7;\n              while (bits < n) {\n                if (have === 0) { break inf_leave; }\n                have--;\n                hold += input[next++] << bits;\n                bits += 8;\n              }\n              //===//\n              //--- DROPBITS(here.bits) ---//\n              hold >>>= here_bits;\n              bits -= here_bits;\n              //---//\n              len = 0;\n              copy = 11 + (hold & 0x7f);//BITS(7);\n              //--- DROPBITS(7) ---//\n              hold >>>= 7;\n              bits -= 7;\n              //---//\n            }\n            if (state.have + copy > state.nlen + state.ndist) {\n              strm.msg = 'invalid bit length repeat';\n              state.mode = BAD;\n              break;\n            }\n            while (copy--) {\n              state.lens[state.have++] = len;\n            }\n          }\n        }\n\n        /* handle error breaks in while */\n        if (state.mode === BAD) { break; }\n\n        /* check for end-of-block code (better have one) */\n        if (state.lens[256] === 0) {\n          strm.msg = 'invalid code -- missing end-of-block';\n          state.mode = BAD;\n          break;\n        }\n\n        /* build code tables -- note: do not change the lenbits or distbits\n           values here (9 and 6) without reading the comments in inftrees.h\n           concerning the ENOUGH constants, which depend on those values */\n        state.lenbits = 9;\n\n        opts = { bits: state.lenbits };\n        ret = inftrees(LENS, state.lens, 0, state.nlen, state.lencode, 0, state.work, opts);\n        // We have separate tables & no pointers. 2 commented lines below not needed.\n        // state.next_index = opts.table_index;\n        state.lenbits = opts.bits;\n        // state.lencode = state.next;\n\n        if (ret) {\n          strm.msg = 'invalid literal/lengths set';\n          state.mode = BAD;\n          break;\n        }\n\n        state.distbits = 6;\n        //state.distcode.copy(state.codes);\n        // Switch to use dynamic table\n        state.distcode = state.distdyn;\n        opts = { bits: state.distbits };\n        ret = inftrees(DISTS, state.lens, state.nlen, state.ndist, state.distcode, 0, state.work, opts);\n        // We have separate tables & no pointers. 2 commented lines below not needed.\n        // state.next_index = opts.table_index;\n        state.distbits = opts.bits;\n        // state.distcode = state.next;\n\n        if (ret) {\n          strm.msg = 'invalid distances set';\n          state.mode = BAD;\n          break;\n        }\n        //Tracev((stderr, 'inflate:       codes ok\\n'));\n        state.mode = LEN_;\n        if (flush === Z_TREES) { break inf_leave; }\n        /* falls through */\n      case LEN_:\n        state.mode = LEN;\n        /* falls through */\n      case LEN:\n        if (have >= 6 && left >= 258) {\n          //--- RESTORE() ---\n          strm.next_out = put;\n          strm.avail_out = left;\n          strm.next_in = next;\n          strm.avail_in = have;\n          state.hold = hold;\n          state.bits = bits;\n          //---\n          inffast(strm, _out);\n          //--- LOAD() ---\n          put = strm.next_out;\n          output = strm.output;\n          left = strm.avail_out;\n          next = strm.next_in;\n          input = strm.input;\n          have = strm.avail_in;\n          hold = state.hold;\n          bits = state.bits;\n          //---\n\n          if (state.mode === TYPE) {\n            state.back = -1;\n          }\n          break;\n        }\n        state.back = 0;\n        for (;;) {\n          here = state.lencode[hold & ((1 << state.lenbits) - 1)];  /*BITS(state.lenbits)*/\n          here_bits = here >>> 24;\n          here_op = (here >>> 16) & 0xff;\n          here_val = here & 0xffff;\n\n          if (here_bits <= bits) { break; }\n          //--- PULLBYTE() ---//\n          if (have === 0) { break inf_leave; }\n          have--;\n          hold += input[next++] << bits;\n          bits += 8;\n          //---//\n        }\n        if (here_op && (here_op & 0xf0) === 0) {\n          last_bits = here_bits;\n          last_op = here_op;\n          last_val = here_val;\n          for (;;) {\n            here = state.lencode[last_val +\n                    ((hold & ((1 << (last_bits + last_op)) - 1))/*BITS(last.bits + last.op)*/ >> last_bits)];\n            here_bits = here >>> 24;\n            here_op = (here >>> 16) & 0xff;\n            here_val = here & 0xffff;\n\n            if ((last_bits + here_bits) <= bits) { break; }\n            //--- PULLBYTE() ---//\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n            //---//\n          }\n          //--- DROPBITS(last.bits) ---//\n          hold >>>= last_bits;\n          bits -= last_bits;\n          //---//\n          state.back += last_bits;\n        }\n        //--- DROPBITS(here.bits) ---//\n        hold >>>= here_bits;\n        bits -= here_bits;\n        //---//\n        state.back += here_bits;\n        state.length = here_val;\n        if (here_op === 0) {\n          //Tracevv((stderr, here.val >= 0x20 && here.val < 0x7f ?\n          //        \"inflate:         literal '%c'\\n\" :\n          //        \"inflate:         literal 0x%02x\\n\", here.val));\n          state.mode = LIT;\n          break;\n        }\n        if (here_op & 32) {\n          //Tracevv((stderr, \"inflate:         end of block\\n\"));\n          state.back = -1;\n          state.mode = TYPE;\n          break;\n        }\n        if (here_op & 64) {\n          strm.msg = 'invalid literal/length code';\n          state.mode = BAD;\n          break;\n        }\n        state.extra = here_op & 15;\n        state.mode = LENEXT;\n        /* falls through */\n      case LENEXT:\n        if (state.extra) {\n          //=== NEEDBITS(state.extra);\n          n = state.extra;\n          while (bits < n) {\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n          }\n          //===//\n          state.length += hold & ((1 << state.extra) - 1)/*BITS(state.extra)*/;\n          //--- DROPBITS(state.extra) ---//\n          hold >>>= state.extra;\n          bits -= state.extra;\n          //---//\n          state.back += state.extra;\n        }\n        //Tracevv((stderr, \"inflate:         length %u\\n\", state.length));\n        state.was = state.length;\n        state.mode = DIST;\n        /* falls through */\n      case DIST:\n        for (;;) {\n          here = state.distcode[hold & ((1 << state.distbits) - 1)];/*BITS(state.distbits)*/\n          here_bits = here >>> 24;\n          here_op = (here >>> 16) & 0xff;\n          here_val = here & 0xffff;\n\n          if ((here_bits) <= bits) { break; }\n          //--- PULLBYTE() ---//\n          if (have === 0) { break inf_leave; }\n          have--;\n          hold += input[next++] << bits;\n          bits += 8;\n          //---//\n        }\n        if ((here_op & 0xf0) === 0) {\n          last_bits = here_bits;\n          last_op = here_op;\n          last_val = here_val;\n          for (;;) {\n            here = state.distcode[last_val +\n                    ((hold & ((1 << (last_bits + last_op)) - 1))/*BITS(last.bits + last.op)*/ >> last_bits)];\n            here_bits = here >>> 24;\n            here_op = (here >>> 16) & 0xff;\n            here_val = here & 0xffff;\n\n            if ((last_bits + here_bits) <= bits) { break; }\n            //--- PULLBYTE() ---//\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n            //---//\n          }\n          //--- DROPBITS(last.bits) ---//\n          hold >>>= last_bits;\n          bits -= last_bits;\n          //---//\n          state.back += last_bits;\n        }\n        //--- DROPBITS(here.bits) ---//\n        hold >>>= here_bits;\n        bits -= here_bits;\n        //---//\n        state.back += here_bits;\n        if (here_op & 64) {\n          strm.msg = 'invalid distance code';\n          state.mode = BAD;\n          break;\n        }\n        state.offset = here_val;\n        state.extra = (here_op) & 15;\n        state.mode = DISTEXT;\n        /* falls through */\n      case DISTEXT:\n        if (state.extra) {\n          //=== NEEDBITS(state.extra);\n          n = state.extra;\n          while (bits < n) {\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n          }\n          //===//\n          state.offset += hold & ((1 << state.extra) - 1)/*BITS(state.extra)*/;\n          //--- DROPBITS(state.extra) ---//\n          hold >>>= state.extra;\n          bits -= state.extra;\n          //---//\n          state.back += state.extra;\n        }\n//#ifdef INFLATE_STRICT\n        if (state.offset > state.dmax) {\n          strm.msg = 'invalid distance too far back';\n          state.mode = BAD;\n          break;\n        }\n//#endif\n        //Tracevv((stderr, \"inflate:         distance %u\\n\", state.offset));\n        state.mode = MATCH;\n        /* falls through */\n      case MATCH:\n        if (left === 0) { break inf_leave; }\n        copy = _out - left;\n        if (state.offset > copy) {         /* copy from window */\n          copy = state.offset - copy;\n          if (copy > state.whave) {\n            if (state.sane) {\n              strm.msg = 'invalid distance too far back';\n              state.mode = BAD;\n              break;\n            }\n// (!) This block is disabled in zlib defaults,\n// don't enable it for binary compatibility\n//#ifdef INFLATE_ALLOW_INVALID_DISTANCE_TOOFAR_ARRR\n//          Trace((stderr, \"inflate.c too far\\n\"));\n//          copy -= state.whave;\n//          if (copy > state.length) { copy = state.length; }\n//          if (copy > left) { copy = left; }\n//          left -= copy;\n//          state.length -= copy;\n//          do {\n//            output[put++] = 0;\n//          } while (--copy);\n//          if (state.length === 0) { state.mode = LEN; }\n//          break;\n//#endif\n          }\n          if (copy > state.wnext) {\n            copy -= state.wnext;\n            from = state.wsize - copy;\n          }\n          else {\n            from = state.wnext - copy;\n          }\n          if (copy > state.length) { copy = state.length; }\n          from_source = state.window;\n        }\n        else {                              /* copy from output */\n          from_source = output;\n          from = put - state.offset;\n          copy = state.length;\n        }\n        if (copy > left) { copy = left; }\n        left -= copy;\n        state.length -= copy;\n        do {\n          output[put++] = from_source[from++];\n        } while (--copy);\n        if (state.length === 0) { state.mode = LEN; }\n        break;\n      case LIT:\n        if (left === 0) { break inf_leave; }\n        output[put++] = state.length;\n        left--;\n        state.mode = LEN;\n        break;\n      case CHECK:\n        if (state.wrap) {\n          //=== NEEDBITS(32);\n          while (bits < 32) {\n            if (have === 0) { break inf_leave; }\n            have--;\n            // Use '|' instead of '+' to make sure that result is signed\n            hold |= input[next++] << bits;\n            bits += 8;\n          }\n          //===//\n          _out -= left;\n          strm.total_out += _out;\n          state.total += _out;\n          if ((state.wrap & 4) && _out) {\n            strm.adler = state.check =\n                /*UPDATE_CHECK(state.check, put - _out, _out);*/\n                (state.flags ? crc32_1(state.check, output, _out, put - _out) : adler32_1(state.check, output, _out, put - _out));\n\n          }\n          _out = left;\n          // NB: crc32 stored as signed 32-bit int, zswap32 returns signed too\n          if ((state.wrap & 4) && (state.flags ? hold : zswap32(hold)) !== state.check) {\n            strm.msg = 'incorrect data check';\n            state.mode = BAD;\n            break;\n          }\n          //=== INITBITS();\n          hold = 0;\n          bits = 0;\n          //===//\n          //Tracev((stderr, \"inflate:   check matches trailer\\n\"));\n        }\n        state.mode = LENGTH;\n        /* falls through */\n      case LENGTH:\n        if (state.wrap && state.flags) {\n          //=== NEEDBITS(32);\n          while (bits < 32) {\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n          }\n          //===//\n          if ((state.wrap & 4) && hold !== (state.total & 0xffffffff)) {\n            strm.msg = 'incorrect length check';\n            state.mode = BAD;\n            break;\n          }\n          //=== INITBITS();\n          hold = 0;\n          bits = 0;\n          //===//\n          //Tracev((stderr, \"inflate:   length matches trailer\\n\"));\n        }\n        state.mode = DONE;\n        /* falls through */\n      case DONE:\n        ret = Z_STREAM_END$1;\n        break inf_leave;\n      case BAD:\n        ret = Z_DATA_ERROR$1;\n        break inf_leave;\n      case MEM:\n        return Z_MEM_ERROR$1;\n      case SYNC:\n        /* falls through */\n      default:\n        return Z_STREAM_ERROR$1;\n    }\n  }\n\n  // inf_leave <- here is real place for \"goto inf_leave\", emulated via \"break inf_leave\"\n\n  /*\n     Return from inflate(), updating the total counts and the check value.\n     If there was no progress during the inflate() call, return a buffer\n     error.  Call updatewindow() to create and/or update the window state.\n     Note: a memory error from inflate() is non-recoverable.\n   */\n\n  //--- RESTORE() ---\n  strm.next_out = put;\n  strm.avail_out = left;\n  strm.next_in = next;\n  strm.avail_in = have;\n  state.hold = hold;\n  state.bits = bits;\n  //---\n\n  if (state.wsize || (_out !== strm.avail_out && state.mode < BAD &&\n                      (state.mode < CHECK || flush !== Z_FINISH$1))) {\n    if (updatewindow(strm, strm.output, strm.next_out, _out - strm.avail_out)) ;\n  }\n  _in -= strm.avail_in;\n  _out -= strm.avail_out;\n  strm.total_in += _in;\n  strm.total_out += _out;\n  state.total += _out;\n  if ((state.wrap & 4) && _out) {\n    strm.adler = state.check = /*UPDATE_CHECK(state.check, strm.next_out - _out, _out);*/\n      (state.flags ? crc32_1(state.check, output, _out, strm.next_out - _out) : adler32_1(state.check, output, _out, strm.next_out - _out));\n  }\n  strm.data_type = state.bits + (state.last ? 64 : 0) +\n                    (state.mode === TYPE ? 128 : 0) +\n                    (state.mode === LEN_ || state.mode === COPY_ ? 256 : 0);\n  if (((_in === 0 && _out === 0) || flush === Z_FINISH$1) && ret === Z_OK$1) {\n    ret = Z_BUF_ERROR;\n  }\n  return ret;\n};\n\n\nconst inflateEnd = (strm) => {\n\n  if (inflateStateCheck(strm)) {\n    return Z_STREAM_ERROR$1;\n  }\n\n  let state = strm.state;\n  if (state.window) {\n    state.window = null;\n  }\n  strm.state = null;\n  return Z_OK$1;\n};\n\n\nconst inflateGetHeader = (strm, head) => {\n\n  /* check state */\n  if (inflateStateCheck(strm)) { return Z_STREAM_ERROR$1; }\n  const state = strm.state;\n  if ((state.wrap & 2) === 0) { return Z_STREAM_ERROR$1; }\n\n  /* save header structure */\n  state.head = head;\n  head.done = false;\n  return Z_OK$1;\n};\n\n\nconst inflateSetDictionary = (strm, dictionary) => {\n  const dictLength = dictionary.length;\n\n  let state;\n  let dictid;\n  let ret;\n\n  /* check state */\n  if (inflateStateCheck(strm)) { return Z_STREAM_ERROR$1; }\n  state = strm.state;\n\n  if (state.wrap !== 0 && state.mode !== DICT) {\n    return Z_STREAM_ERROR$1;\n  }\n\n  /* check for correct dictionary identifier */\n  if (state.mode === DICT) {\n    dictid = 1; /* adler32(0, null, 0)*/\n    /* dictid = adler32(dictid, dictionary, dictLength); */\n    dictid = adler32_1(dictid, dictionary, dictLength, 0);\n    if (dictid !== state.check) {\n      return Z_DATA_ERROR$1;\n    }\n  }\n  /* copy dictionary to window using updatewindow(), which will amend the\n   existing dictionary if appropriate */\n  ret = updatewindow(strm, dictionary, dictLength, dictLength);\n  if (ret) {\n    state.mode = MEM;\n    return Z_MEM_ERROR$1;\n  }\n  state.havedict = 1;\n  // Tracev((stderr, \"inflate:   dictionary set\\n\"));\n  return Z_OK$1;\n};\n\n\nvar inflateReset_1 = inflateReset;\nvar inflateReset2_1 = inflateReset2;\nvar inflateResetKeep_1 = inflateResetKeep;\nvar inflateInit_1 = inflateInit;\nvar inflateInit2_1 = inflateInit2;\nvar inflate_2$1 = inflate$2;\nvar inflateEnd_1 = inflateEnd;\nvar inflateGetHeader_1 = inflateGetHeader;\nvar inflateSetDictionary_1 = inflateSetDictionary;\nvar inflateInfo = 'pako inflate (from Nodeca project)';\n\n/* Not implemented\nmodule.exports.inflateCodesUsed = inflateCodesUsed;\nmodule.exports.inflateCopy = inflateCopy;\nmodule.exports.inflateGetDictionary = inflateGetDictionary;\nmodule.exports.inflateMark = inflateMark;\nmodule.exports.inflatePrime = inflatePrime;\nmodule.exports.inflateSync = inflateSync;\nmodule.exports.inflateSyncPoint = inflateSyncPoint;\nmodule.exports.inflateUndermine = inflateUndermine;\nmodule.exports.inflateValidate = inflateValidate;\n*/\n\nvar inflate_1$2 = {\n\tinflateReset: inflateReset_1,\n\tinflateReset2: inflateReset2_1,\n\tinflateResetKeep: inflateResetKeep_1,\n\tinflateInit: inflateInit_1,\n\tinflateInit2: inflateInit2_1,\n\tinflate: inflate_2$1,\n\tinflateEnd: inflateEnd_1,\n\tinflateGetHeader: inflateGetHeader_1,\n\tinflateSetDictionary: inflateSetDictionary_1,\n\tinflateInfo: inflateInfo\n};\n\n// (C) 1995-2013 Jean-loup Gailly and Mark Adler\n// (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n//\n// This software is provided 'as-is', without any express or implied\n// warranty. In no event will the authors be held liable for any damages\n// arising from the use of this software.\n//\n// Permission is granted to anyone to use this software for any purpose,\n// including commercial applications, and to alter it and redistribute it\n// freely, subject to the following restrictions:\n//\n// 1. The origin of this software must not be misrepresented; you must not\n//   claim that you wrote the original software. If you use this software\n//   in a product, an acknowledgment in the product documentation would be\n//   appreciated but is not required.\n// 2. Altered source versions must be plainly marked as such, and must not be\n//   misrepresented as being the original software.\n// 3. This notice may not be removed or altered from any source distribution.\n\nfunction GZheader() {\n  /* true if compressed data believed to be text */\n  this.text       = 0;\n  /* modification time */\n  this.time       = 0;\n  /* extra flags (not used when writing a gzip file) */\n  this.xflags     = 0;\n  /* operating system */\n  this.os         = 0;\n  /* pointer to extra field or Z_NULL if none */\n  this.extra      = null;\n  /* extra field length (valid if extra != Z_NULL) */\n  this.extra_len  = 0; // Actually, we don't need it in JS,\n                       // but leave for few code modifications\n\n  //\n  // Setup limits is not necessary because in js we should not preallocate memory\n  // for inflate use constant limit in 65536 bytes\n  //\n\n  /* space at extra (only when reading header) */\n  // this.extra_max  = 0;\n  /* pointer to zero-terminated file name or Z_NULL */\n  this.name       = '';\n  /* space at name (only when reading header) */\n  // this.name_max   = 0;\n  /* pointer to zero-terminated comment or Z_NULL */\n  this.comment    = '';\n  /* space at comment (only when reading header) */\n  // this.comm_max   = 0;\n  /* true if there was or will be a header crc */\n  this.hcrc       = 0;\n  /* true when done reading gzip header (not used when writing a gzip file) */\n  this.done       = false;\n}\n\nvar gzheader = GZheader;\n\nconst toString = Object.prototype.toString;\n\n/* Public constants ==========================================================*/\n/* ===========================================================================*/\n\nconst {\n  Z_NO_FLUSH, Z_FINISH,\n  Z_OK, Z_STREAM_END, Z_NEED_DICT, Z_STREAM_ERROR, Z_DATA_ERROR, Z_MEM_ERROR\n} = constants$2;\n\n/* ===========================================================================*/\n\n\n/**\n * class Inflate\n *\n * Generic JS-style wrapper for zlib calls. If you don't need\n * streaming behaviour - use more simple functions: [[inflate]]\n * and [[inflateRaw]].\n **/\n\n/* internal\n * inflate.chunks -> Array\n *\n * Chunks of output data, if [[Inflate#onData]] not overridden.\n **/\n\n/**\n * Inflate.result -> Uint8Array|String\n *\n * Uncompressed result, generated by default [[Inflate#onData]]\n * and [[Inflate#onEnd]] handlers. Filled after you push last chunk\n * (call [[Inflate#push]] with `Z_FINISH` / `true` param).\n **/\n\n/**\n * Inflate.err -> Number\n *\n * Error code after inflate finished. 0 (Z_OK) on success.\n * Should be checked if broken data possible.\n **/\n\n/**\n * Inflate.msg -> String\n *\n * Error message, if [[Inflate.err]] != 0\n **/\n\n\n/**\n * new Inflate(options)\n * - options (Object): zlib inflate options.\n *\n * Creates new inflator instance with specified params. Throws exception\n * on bad params. Supported options:\n *\n * - `windowBits`\n * - `dictionary`\n *\n * [http://zlib.net/manual.html#Advanced](http://zlib.net/manual.html#Advanced)\n * for more information on these.\n *\n * Additional options, for internal needs:\n *\n * - `chunkSize` - size of generated data chunks (16K by default)\n * - `raw` (Boolean) - do raw inflate\n * - `to` (String) - if equal to 'string', then result will be converted\n *   from utf8 to utf16 (javascript) string. When string output requested,\n *   chunk length can differ from `chunkSize`, depending on content.\n *\n * By default, when no options set, autodetect deflate/gzip data format via\n * wrapper header.\n *\n * ##### Example:\n *\n * ```javascript\n * const pako = require('pako')\n * const chunk1 = new Uint8Array([1,2,3,4,5,6,7,8,9])\n * const chunk2 = new Uint8Array([10,11,12,13,14,15,16,17,18,19]);\n *\n * const inflate = new pako.Inflate({ level: 3});\n *\n * inflate.push(chunk1, false);\n * inflate.push(chunk2, true);  // true -> last chunk\n *\n * if (inflate.err) { throw new Error(inflate.err); }\n *\n * console.log(inflate.result);\n * ```\n **/\nfunction Inflate$1(options) {\n  this.options = common.assign({\n    chunkSize: 1024 * 64,\n    windowBits: 15,\n    to: ''\n  }, options || {});\n\n  const opt = this.options;\n\n  // Force window size for `raw` data, if not set directly,\n  // because we have no header for autodetect.\n  if (opt.raw && (opt.windowBits >= 0) && (opt.windowBits < 16)) {\n    opt.windowBits = -opt.windowBits;\n    if (opt.windowBits === 0) { opt.windowBits = -15; }\n  }\n\n  // If `windowBits` not defined (and mode not raw) - set autodetect flag for gzip/deflate\n  if ((opt.windowBits >= 0) && (opt.windowBits < 16) &&\n      !(options && options.windowBits)) {\n    opt.windowBits += 32;\n  }\n\n  // Gzip header has no info about windows size, we can do autodetect only\n  // for deflate. So, if window size not set, force it to max when gzip possible\n  if ((opt.windowBits > 15) && (opt.windowBits < 48)) {\n    // bit 3 (16) -> gzipped data\n    // bit 4 (32) -> autodetect gzip/deflate\n    if ((opt.windowBits & 15) === 0) {\n      opt.windowBits |= 15;\n    }\n  }\n\n  this.err    = 0;      // error code, if happens (0 = Z_OK)\n  this.msg    = '';     // error message\n  this.ended  = false;  // used to avoid multiple onEnd() calls\n  this.chunks = [];     // chunks of compressed data\n\n  this.strm   = new zstream();\n  this.strm.avail_out = 0;\n\n  let status  = inflate_1$2.inflateInit2(\n    this.strm,\n    opt.windowBits\n  );\n\n  if (status !== Z_OK) {\n    throw new Error(messages[status]);\n  }\n\n  this.header = new gzheader();\n\n  inflate_1$2.inflateGetHeader(this.strm, this.header);\n\n  // Setup dictionary\n  if (opt.dictionary) {\n    // Convert data if needed\n    if (typeof opt.dictionary === 'string') {\n      opt.dictionary = strings.string2buf(opt.dictionary);\n    } else if (toString.call(opt.dictionary) === '[object ArrayBuffer]') {\n      opt.dictionary = new Uint8Array(opt.dictionary);\n    }\n    if (opt.raw) { //In raw mode we need to set the dictionary early\n      status = inflate_1$2.inflateSetDictionary(this.strm, opt.dictionary);\n      if (status !== Z_OK) {\n        throw new Error(messages[status]);\n      }\n    }\n  }\n}\n\n/**\n * Inflate#push(data[, flush_mode]) -> Boolean\n * - data (Uint8Array|ArrayBuffer): input data\n * - flush_mode (Number|Boolean): 0..6 for corresponding Z_NO_FLUSH..Z_TREE\n *   flush modes. See constants. Skipped or `false` means Z_NO_FLUSH,\n *   `true` means Z_FINISH.\n *\n * Sends input data to inflate pipe, generating [[Inflate#onData]] calls with\n * new output chunks. Returns `true` on success. If end of stream detected,\n * [[Inflate#onEnd]] will be called.\n *\n * `flush_mode` is not needed for normal operation, because end of stream\n * detected automatically. You may try to use it for advanced things, but\n * this functionality was not tested.\n *\n * On fail call [[Inflate#onEnd]] with error code and return false.\n *\n * ##### Example\n *\n * ```javascript\n * push(chunk, false); // push one of data chunks\n * ...\n * push(chunk, true);  // push last chunk\n * ```\n **/\nInflate$1.prototype.push = function (data, flush_mode) {\n  const strm = this.strm;\n  const chunkSize = this.options.chunkSize;\n  const dictionary = this.options.dictionary;\n  let status, _flush_mode, last_avail_out;\n\n  if (this.ended) return false;\n\n  if (flush_mode === ~~flush_mode) _flush_mode = flush_mode;\n  else _flush_mode = flush_mode === true ? Z_FINISH : Z_NO_FLUSH;\n\n  // Convert data if needed\n  if (toString.call(data) === '[object ArrayBuffer]') {\n    strm.input = new Uint8Array(data);\n  } else {\n    strm.input = data;\n  }\n\n  strm.next_in = 0;\n  strm.avail_in = strm.input.length;\n\n  for (;;) {\n    if (strm.avail_out === 0) {\n      strm.output = new Uint8Array(chunkSize);\n      strm.next_out = 0;\n      strm.avail_out = chunkSize;\n    }\n\n    status = inflate_1$2.inflate(strm, _flush_mode);\n\n    if (status === Z_NEED_DICT && dictionary) {\n      status = inflate_1$2.inflateSetDictionary(strm, dictionary);\n\n      if (status === Z_OK) {\n        status = inflate_1$2.inflate(strm, _flush_mode);\n      } else if (status === Z_DATA_ERROR) {\n        // Replace code with more verbose\n        status = Z_NEED_DICT;\n      }\n    }\n\n    // Skip snyc markers if more data follows and not raw mode\n    while (strm.avail_in > 0 &&\n           status === Z_STREAM_END &&\n           strm.state.wrap > 0 &&\n           data[strm.next_in] !== 0)\n    {\n      inflate_1$2.inflateReset(strm);\n      status = inflate_1$2.inflate(strm, _flush_mode);\n    }\n\n    switch (status) {\n      case Z_STREAM_ERROR:\n      case Z_DATA_ERROR:\n      case Z_NEED_DICT:\n      case Z_MEM_ERROR:\n        this.onEnd(status);\n        this.ended = true;\n        return false;\n    }\n\n    // Remember real `avail_out` value, because we may patch out buffer content\n    // to align utf8 strings boundaries.\n    last_avail_out = strm.avail_out;\n\n    if (strm.next_out) {\n      if (strm.avail_out === 0 || status === Z_STREAM_END) {\n\n        if (this.options.to === 'string') {\n\n          let next_out_utf8 = strings.utf8border(strm.output, strm.next_out);\n\n          let tail = strm.next_out - next_out_utf8;\n          let utf8str = strings.buf2string(strm.output, next_out_utf8);\n\n          // move tail & realign counters\n          strm.next_out = tail;\n          strm.avail_out = chunkSize - tail;\n          if (tail) strm.output.set(strm.output.subarray(next_out_utf8, next_out_utf8 + tail), 0);\n\n          this.onData(utf8str);\n\n        } else {\n          this.onData(strm.output.length === strm.next_out ? strm.output : strm.output.subarray(0, strm.next_out));\n        }\n      }\n    }\n\n    // Must repeat iteration if out buffer is full\n    if (status === Z_OK && last_avail_out === 0) continue;\n\n    // Finalize if end of stream reached.\n    if (status === Z_STREAM_END) {\n      status = inflate_1$2.inflateEnd(this.strm);\n      this.onEnd(status);\n      this.ended = true;\n      return true;\n    }\n\n    if (strm.avail_in === 0) break;\n  }\n\n  return true;\n};\n\n\n/**\n * Inflate#onData(chunk) -> Void\n * - chunk (Uint8Array|String): output data. When string output requested,\n *   each chunk will be string.\n *\n * By default, stores data blocks in `chunks[]` property and glue\n * those in `onEnd`. Override this handler, if you need another behaviour.\n **/\nInflate$1.prototype.onData = function (chunk) {\n  this.chunks.push(chunk);\n};\n\n\n/**\n * Inflate#onEnd(status) -> Void\n * - status (Number): inflate status. 0 (Z_OK) on success,\n *   other if not.\n *\n * Called either after you tell inflate that the input stream is\n * complete (Z_FINISH). By default - join collected chunks,\n * free memory and fill `results` / `err` properties.\n **/\nInflate$1.prototype.onEnd = function (status) {\n  // On success - join\n  if (status === Z_OK) {\n    if (this.options.to === 'string') {\n      this.result = this.chunks.join('');\n    } else {\n      this.result = common.flattenChunks(this.chunks);\n    }\n  }\n  this.chunks = [];\n  this.err = status;\n  this.msg = this.strm.msg;\n};\n\n\n/**\n * inflate(data[, options]) -> Uint8Array|String\n * - data (Uint8Array|ArrayBuffer): input data to decompress.\n * - options (Object): zlib inflate options.\n *\n * Decompress `data` with inflate/ungzip and `options`. Autodetect\n * format via wrapper header by default. That's why we don't provide\n * separate `ungzip` method.\n *\n * Supported options are:\n *\n * - windowBits\n *\n * [http://zlib.net/manual.html#Advanced](http://zlib.net/manual.html#Advanced)\n * for more information.\n *\n * Sugar (options):\n *\n * - `raw` (Boolean) - say that we work with raw stream, if you don't wish to specify\n *   negative windowBits implicitly.\n * - `to` (String) - if equal to 'string', then result will be converted\n *   from utf8 to utf16 (javascript) string. When string output requested,\n *   chunk length can differ from `chunkSize`, depending on content.\n *\n *\n * ##### Example:\n *\n * ```javascript\n * const pako = require('pako');\n * const input = pako.deflate(new Uint8Array([1,2,3,4,5,6,7,8,9]));\n * let output;\n *\n * try {\n *   output = pako.inflate(input);\n * } catch (err) {\n *   console.log(err);\n * }\n * ```\n **/\nfunction inflate$1(input, options) {\n  const inflator = new Inflate$1(options);\n\n  inflator.push(input);\n\n  // That will never happens, if you don't cheat with options :)\n  if (inflator.err) throw inflator.msg || messages[inflator.err];\n\n  return inflator.result;\n}\n\n\n/**\n * inflateRaw(data[, options]) -> Uint8Array|String\n * - data (Uint8Array|ArrayBuffer): input data to decompress.\n * - options (Object): zlib inflate options.\n *\n * The same as [[inflate]], but creates raw data, without wrapper\n * (header and adler32 crc).\n **/\nfunction inflateRaw$1(input, options) {\n  options = options || {};\n  options.raw = true;\n  return inflate$1(input, options);\n}\n\n\n/**\n * ungzip(data[, options]) -> Uint8Array|String\n * - data (Uint8Array|ArrayBuffer): input data to decompress.\n * - options (Object): zlib inflate options.\n *\n * Just shortcut to [[inflate]], because it autodetects format\n * by header.content. Done for convenience.\n **/\n\n\nvar Inflate_1$1 = Inflate$1;\nvar inflate_2 = inflate$1;\nvar inflateRaw_1$1 = inflateRaw$1;\nvar ungzip$1 = inflate$1;\nvar constants = constants$2;\n\nvar inflate_1$1 = {\n\tInflate: Inflate_1$1,\n\tinflate: inflate_2,\n\tinflateRaw: inflateRaw_1$1,\n\tungzip: ungzip$1,\n\tconstants: constants\n};\n\nconst { Deflate, deflate, deflateRaw, gzip } = deflate_1$1;\n\nconst { Inflate, inflate, inflateRaw, ungzip } = inflate_1$1;\n\n\n\nvar Deflate_1 = Deflate;\nvar deflate_1 = deflate;\nvar deflateRaw_1 = deflateRaw;\nvar gzip_1 = gzip;\nvar Inflate_1 = Inflate;\nvar inflate_1 = inflate;\nvar inflateRaw_1 = inflateRaw;\nvar ungzip_1 = ungzip;\nvar constants_1 = constants$2;\n\nvar pako = {\n\tDeflate: Deflate_1,\n\tdeflate: deflate_1,\n\tdeflateRaw: deflateRaw_1,\n\tgzip: gzip_1,\n\tInflate: Inflate_1,\n\tinflate: inflate_1,\n\tinflateRaw: inflateRaw_1,\n\tungzip: ungzip_1,\n\tconstants: constants_1\n};\n\nexport { Deflate_1 as Deflate, Inflate_1 as Inflate, constants_1 as constants, pako as default, deflate_1 as deflate, deflateRaw_1 as deflateRaw, gzip_1 as gzip, inflate_1 as inflate, inflateRaw_1 as inflateRaw, ungzip_1 as ungzip };\n", "const LATENCY = 50;\n\nexport class OfflineSocket {\n    constructor() {\n        this.url = \"(offline)\";\n        this.readyState = WebSocket.CONNECTING;\n        this.bufferedAmount = 0;\n        setTimeout(() => {\n            this.readyState = WebSocket.OPEN;\n            if (this.onopen) this.onopen();\n        }, LATENCY);\n        this.start = Date.now();\n    }\n\n    send(data) {\n        const {id, action, args} = JSON.parse(data);\n        switch (action) {\n            case 'JOIN': {\n                this.id = id;\n                this.ticks = args.ticks.tick;\n                this.seq = -16 >>> 0;\n                this.reply('SYNC', { messages: [], time: this.time, seq: this.seq, tove: args.tove, reflector: \"offline\"});\n                this.reply('RECV', [this.time, ++this.seq, {what: 'users', joined: [args.user], active: 1, total: 1}]);\n                this.tick();\n                return;\n            }\n            case 'SEND': {\n                const msg = [...args];\n                msg[0] = this.time;\n                msg[1] = ++this.seq;\n                this.reply('RECV', msg);\n                return;\n            }\n            case 'PULSE':\n                return;\n            default: throw Error(\"Offline unhandled \" + action);\n        }\n    }\n\n    close(code, reason) {\n        this.readyState = WebSocket.CLOSING;\n        setTimeout(() => {\n            this.readyState = WebSocket.CLOSED;\n            if (this.onclose) this.onclose({code, reason});\n        }, LATENCY);\n    }\n\n    get time() { return Date.now() - this.start; }\n\n    tick() {\n        clearInterval(this.ticker);\n        this.ticker = setInterval(() => {\n            this.reply('TICK', {time: this.time});\n        }, this.ticks);\n    }\n\n    reply(action, args) {\n        setTimeout(() => {\n            if (this.onmessage) this.onmessage({\n                data: JSON.stringify({id: this.id, action, args})\n            });\n        }, LATENCY);\n    }\n}\n", "import { App } from \"./_HTML_MODULE_\"; // eslint-disable-line import/no-unresolved\nimport urlOptions from \"./_URLOPTIONS_MODULE_\"; // eslint-disable-line import/no-unresolved\n\nconst ICE_NEGOTIATION_MAX = 15_000; // maximum ms between sending our offer and the data channel being operational.  analogous to the controller's JOIN_FAILED_DELAY, between sending of JOIN and receipt of SYNC.\n\n/* eslint-disable-next-line */\nconst NODE = _IS_NODE_; // replaced by rollup\nconst FIREFOX = !NODE && !!globalThis.navigator?.userAgent.toLowerCase().includes('firefox');\n\nlet DEBUG = {\n    get connection() {\n        // replace with static value on first call\n        DEBUG = { connection: urlOptions.has(\"debug\", \"connection\", false) };\n        return DEBUG.connection;\n    }\n};\n\nfunction getRandomString(length) {\n    return Math.random()\n        .toString(36)\n        .substring(2, 2 + length);\n}\n\nexport class CroquetWebRTCConnection {\n    static get name() { return `${App.libName}WebRTCConnection`; }\n\n    constructor(registryURL) {\n        this.clientId = getRandomString(4); // used locally to tag console messages for debug purposes; gets appended with a numeric id from SessionRunner on connection\n        if (DEBUG.connection) console.log(`${this.clientId} WebRTCConnection created`);\n\n        this.pc = null;\n        this.dataChannel = null;\n        this.signaling = null;\n        this.connectionTypes = {}; // { local: t, remote: t }\n\n        // handlers supplied by the Controller (Connection).  'open' and\n        // 'message' depend on the state of the data channel alone, while\n        // 'error' and 'close' are triggered by:\n        //   - the signalling channel\n        //   - the RTCPeerConnection\n        //   - the RTCDataChannel\n        this.onopen = null;\n        this.onmessage = null;\n        this.onerror = null;\n        this.onclose = null;\n\n        // the controller also supplies a custom handler for a WebRTC\n        // connection, because it happens in two stages: establishing\n        // the socket, then negotiating and opening the data channel.\n        // onconnected serves the latter stage.\n        this.onconnected = null;\n        this.twoStageConnection = true;\n\n        this.url = \"synchronizer\"; // dummy value for logging\n        this.bufferedAmount = 0; // keep the PULSE logic happy\n\n        this.openConnection(registryURL); // async, awaiting opening of the signalling socket - which gives the controller time to attach event handlers (onopen, onerror etc)\n    }\n\n    isConnecting() {\n        return this.signaling?.readyState === WebSocket.OPEN;\n    }\n\n    async openConnection(registryURL) {\n        try {\n            /* eslint-disable-next-line */\n            _ENSURE_RTCPEERCONNECTION_\n\n            await this.openSignalingChannel(registryURL); // will never resolve if open fails\n            if (DEBUG.connection) console.log(`${this.clientId} signaling ready`);\n            if (this.onopen) this.onopen(); // tell the controller that it has a socket (though not yet a connection to the synchronizer)\n            await this.createPeerConnection(); // slow the first time, while fetching ICE server list\n            if (DEBUG.connection) console.log(`${this.clientId} peer connection created`);\n\n            this.dataChannel = this.pc.createDataChannel(`client-${this.clientId}`);\n            if (DEBUG.connection) console.log(`${this.clientId} data channel created`);\n            this.dataChannel.onopen = evt => this.onDataChannelOpen(evt);\n            this.dataChannel.onmessage = evt => this.onDataChannelMessage(evt);\n            this.dataChannel.onclosing = evt => this.onDataChannelClosing(evt);\n            this.dataChannel.onclose = evt => this.onDataChannelClose(evt);\n            this.dataChannel.onerror = evt => this.onDataChannelError(evt);\n\n            const offer = await this.pc.createOffer();\n            if (this.signaling?.readyState !== WebSocket.OPEN) return; // already lost the connection\n\n            // set a deadline by which we expect to have completed ICE negotiation\n            // and started using the data channel.  if the deadline expires, it\n            // could just be because we're waiting for a response from a STUN or\n            // TURN server that is in fact unreachable (as seen on Firefox through\n            // VPN).  if dataChannelFlowing is already true, we proceed on the\n            // assumption that negotiation has succeeded anyway.\n            this.negotiationTimeout = setTimeout(() => {\n                delete this.negotiationTimeout;\n                if (this.dataChannelFlowing) {\n                    // negotiation appears to have succeeded.  schedule signalling\n                    // closure if not already taken care of.\n                    if (!this.signalingCloseScheduled) {\n                        if (DEBUG.connection) console.log(`${this.clientId} ICE negotiation timed out but appears to have succeeded`);\n                        this.scheduleSignalingClose();\n                    }\n                } else {\n                    // it appears that negotiation hasn't succeeded.  tell the\n                    // controller to scrap the connection altogether and try again.\n                    this.synchronizerDisconnected(4003, \"ICE negotiation timed out\");\n                }\n            }, ICE_NEGOTIATION_MAX);\n\n            this.signalToSessionRunner({ type: 'offer', sdp: offer.sdp });\n            await this.pc.setLocalDescription(offer);\n\n            // for some reason, the sctp property of the connection isn't set immediately\n            // in createDataChannel... but after the calls above it seems to be reliably there.\n            // ...except in Firefox.  Firefox just doesn't implement this stuff like the others.\n            if (!this.pc.sctp) return; // probably Firefox\n\n            // it also turns out that - at least in Chrome - the end of negotiation (signalled by\n            // dataChannel's open event) happens some time before the transport's selected-pair\n            // property is updated with the final choice.  so we watch all the choices as they're\n            // made, whatever the current connection state.\n            const iceTransport = this.pc.sctp.transport.iceTransport;\n            iceTransport.onselectedcandidatepairchange = e => {\n                // not supported on Firefox\n                if (DEBUG.connection) console.log(`${this.clientId} ICE candidate pair changed`);\n                const pair = iceTransport.getSelectedCandidatePair();\n                this.connectionTypes.local = pair.local.type;\n                this.connectionTypes.remote = pair.remote.type;\n                this.logConnectionState();\n            };\n        } catch (e) { this.synchronizerDisconnected(e.code || 4003, e.message); } // 4003 => RECONNECT\n    }\n\n    openSignalingChannel(registryURL) {\n        if (this.signaling) {\n            console.warn(`${this.clientId} signaling channel already open`);\n            return Promise.resolve();\n        }\n\n        this.synchronizerGatheringComplete = false;\n        this.localGatheringComplete = false;\n        this.dataChannelFlowing = false;\n        this.signalingCloseScheduled = false;\n        this.signalingKey = Math.random(); // so we don't get confused by multiple openings and closings\n\n        return new Promise(resolve => {\n            this.signaling = new WebSocket(registryURL);\n            this.signaling.onopen = () => {\n                // because the registry will open the socket even if only to\n                // report an error, we wait to receive a 'READY' message (below)\n                // before resolving the promise to mark the socket as usable.\n                if (DEBUG.connection) console.log(`${this.clientId} signaling socket opened`);\n            };\n            this.signaling.onmessage = rawMsg => {\n                const msgData = JSON.parse(rawMsg.data);\n                if (msgData.what === 'READY') {\n                    // sent by the SessionRunner to indicate socket acceptance.\n                    // now includes the SessionRunner-assigned client id, and\n                    // an array of ICE servers.\n                    this.clientId += `_${msgData.id}`;\n                    this.iceServers = msgData.iceServers;\n                    resolve();\n                    return;\n                }\n                // handling for errors passed through signalling\n                // (which will be followed immediately by socket closure from\n                // the far end)\n                if (msgData.what === 'ERROR') {\n                    console.error(`${this.clientId} registry error: ${msgData.reason}`);\n                    return;\n                }\n\n                // otherwise it's either an ICE message or an unexpected registry error\n                if (!msgData.type) {\n                    console.error(`${this.clientId} unexpected message: ${rawMsg.data}`);\n                    return;\n                }\n\n                if (DEBUG.connection) console.log(`${this.clientId} received signal of type \"${msgData.type}\"`);\n                switch (msgData.type) {\n                    case 'answer':\n                        this.handleAnswer(msgData); // async\n                        break;\n                    case 'candidate':\n                        this.handleCandidate(msgData); // async\n                        break;\n                    case 'gathering-complete':\n                        this.synchronizerGatheringComplete = true;\n                        break;\n                    default:\n                        if (DEBUG.connection) console.log(`${this.clientId} unhandled: ${msgData.type}`);\n                        break;\n                }\n            };\n            this.signaling.onclose = e => {\n                // if we closed the socket on purpose, this handler will have\n                // been removed - so this represents an unexpected closure,\n                // presumably by the session registry (for example, on finding\n                // that there is no synchronizer to serve the session).\n                if (DEBUG.connection) console.log(`${this.clientId} signaling socket closed unexpectedly (${e.code})`);\n                this.synchronizerDisconnected(e.code, e.reason);\n            };\n            this.signaling.onerror = e => {\n                // as discussed at https://stackoverflow.com/questions/38181156/websockets-is-an-error-event-always-followed-by-a-close-event,\n                // an error during opening is not *necessarily* followed by a close\n                // event.  so our synchronizerError() handling forces closure anyway.\n                if (DEBUG.connection) console.log(`${this.clientId} signaling socket error`, e);\n                this.synchronizerError();\n            };\n        });\n    }\n\n    clearNegotiationTimeout() {\n        if (this.negotiationTimeout) {\n            clearTimeout(this.negotiationTimeout);\n            delete this.negotiationTimeout;\n        }\n    }\n\n    signalToSessionRunner(msg) {\n        const msgStr = JSON.stringify(msg);\n        try {\n            this.signaling.send(msgStr);\n        } catch (e) {\n            console.error(`${this.clientId} WebRTC signaling send error`, e);\n            // a socket-send error could just be a malformed message,\n            // so don't invoke synchronizerError() which would trash the\n            // connection.\n        }\n    }\n\n    async logConnectionState() {\n        // @@ on at least Firefox and Node we can't rely on the onselectedcandidatepairchange\n        // event to find the connection types\n        if ((FIREFOX || NODE) && this.pc) {\n            try {\n                const stats = await this.pc.getStats();\n                if (stats) {\n                    let selectedPairId = null;\n                    for (const stat of stats.values()) {\n                        if (stat.type === \"transport\") {\n                            selectedPairId = stat.selectedCandidatePairId;\n                            break;\n                        }\n                    }\n                    let candidatePair = stats.get(selectedPairId);\n                    if (!candidatePair) {\n                        for (const stat of stats.values()) {\n                            if (stat.type === \"candidate-pair\" && stat.selected) {\n                                candidatePair = stat;\n                                break;\n                            }\n                        }\n                    }\n                    if (candidatePair) {\n                        this.connectionTypes.local = stats.get(candidatePair.localCandidateId).candidateType;\n                        this.connectionTypes.remote = stats.get(candidatePair.remoteCandidateId).candidateType;\n                    }\n                }\n            } catch (e) { /* */ }\n        }\n\n        const clientType = this.connectionTypes.local || '';\n        const syncType = this.connectionTypes.remote || '';\n        if (DEBUG.connection) console.log(`${this.clientId} RTCDataChannel connection state: \"${this.dataChannel.readyState}\" (client connection=\"${clientType}\"; synchronizer connection=\"${syncType}\")`);\n        if (this.signaling?.readyState === WebSocket.OPEN) {\n            const message = {\n                type: 'selectedCandidatePair',\n                clientType,\n                syncType\n            };\n            this.signalToSessionRunner(message);\n        }\n    }\n\n    close(_code, _message) {\n        // sent by connection.closeConnection, triggered by various error\n        // conditions in the controller or related to the connection itself\n        // (e.g., dormancy detection).\n        // the controller will be acting on the supplied code to decide whether\n        // to trigger an automatic reconnection.\n        this.cleanUpConnection();\n    }\n\n    synchronizerDisconnected(code = 1006, reason = 'connection to synchronizer lost') {\n        // triggered by a 'close' event from the signalling channel or data\n        // channel, or timeout of the ICE negotiation.\n        // in the particular case of a synchronizer-requested closure, we should\n        // have already received a code and reason.\n        if (this.synchronizerCloseReason) {\n            code = this.synchronizerCloseReason[0];\n            reason = this.synchronizerCloseReason[1];\n        }\n        this.cleanUpConnection();\n        if (this.onclose) this.onclose({ code, reason });\n    }\n\n    synchronizerError(errorDetail) {\n        // the controller assumes that with any reported error, the connection to\n        // the synchronizer will be lost.  make sure that's the case.\n        if (this.onerror) this.onerror();\n        this.synchronizerDisconnected(undefined, errorDetail); // ensures that the controller's onclose is called\n    }\n\n    cleanUpConnection() {\n        this.closeSignalingChannel();\n        const { pc } = this;\n        if (pc) {\n            this.pc = null; // prevent recursion\n            pc.close();\n            clearInterval(this.peerConnectionStatsInterval);\n        }\n        this.dataChannel = null;\n    }\n\n    closeSignalingChannel() {\n        // closure either means that data-channel negotiation has completed\n        // successfully, or that there was some kind of error during negotiation\n        // that we are treating as fatal.\n        this.clearNegotiationTimeout();\n        if (this.signaling) {\n            this.signaling.onclose = null; // don't trigger\n            this.signaling.onerror = null;\n            this.signaling.close();\n            this.signaling = null;\n        }\n    }\n\n    async createPeerConnection() {\n        const { iceServers } = this;\n        const iceReportedErrors = new Set(); // do our own filtering\n        const pc = this.pc = new globalThis.RTCPeerConnection({ iceServers });\n        pc.onnegotiationneeded = _e => {\n            if (pc !== this.pc) return;\n            if (DEBUG.connection) console.log(`${this.clientId} negotiationneeded event fired`);\n        };\n        pc.onsignalingstatechange = _e => {\n            if (pc !== this.pc) return;\n            if (DEBUG.connection) console.log(`${this.clientId} signaling state: \"${pc.signalingState}\"`);\n        };\n        pc.onconnectionstatechange = _e => {\n            if (pc !== this.pc) return;\n            const { connectionState, iceConnectionState } = pc;\n            if (DEBUG.connection) console.log(`${this.clientId} connection state: \"${connectionState}\" (cf. ICE connection state: \"${iceConnectionState}\")`);\n            if (connectionState === 'disconnected' || connectionState === 'failed') this.synchronizerDisconnected();\n        };\n        pc.oniceconnectionstatechange = _e => {\n            if (pc !== this.pc) return;\n            const state = pc.iceConnectionState;\n            const dataChannelState = this.dataChannel.readyState;\n            if (DEBUG.connection) console.log(`${this.clientId} ICE connection state: \"${state}\"; data channel: \"${dataChannelState}\"`);\n            // if (state === 'disconnected') {\n                /* note from https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/iceConnectionState:\n                Checks to ensure that components are still connected failed for at least one component of the RTCPeerConnection. This is a less stringent test than failed and may trigger intermittently and resolve just as spontaneously on less reliable networks, or during temporary disconnections. When the problem resolves, the connection may return to the connected state.\n                */\n                // this.synchronizerDisconnected();  by the above reasoning, no.\n            // }\n            if (state === 'failed') {\n                // in principle this would be an opportunity to restart ICE over the\n                // existing signalling connection\n                // https://developer.mozilla.org/en-US/docs/Web/API/WebRTC_API/Perfect_negotiation\n                // this.pc.restartIce();   - with this, followed by issuing a new offer.\n                // but for us it seems simpler to restart from scratch.\n                this.synchronizerDisconnected(4003, 'ICE negotiation failed'); // 4003 => RECONNECT\n            }\n        };\n        pc.onicegatheringstatechange = e => {\n            if (pc !== this.pc) return;\n            // on Node (node-datachannel), this event is how we hear about completion\n            // of local-candidate gathering (rather than generation of a null candidate).\n            const state = pc.iceGatheringState;\n            if (DEBUG.connection) console.log(`${this.clientId} ICE gathering state: \"${state}\"`);\n            if (state === 'complete') this.localGatheringComplete = true;\n        };\n        pc.onicecandidate = e => {\n            if (pc !== this.pc) return;\n            // an ICE candidate (or null) has been generated locally.  our synchronizer's\n            // node-datachannel API can't handle empty or null candidates (even though\n            // the protocol says they can be used to indicate the end of the candidates)\n            // - so we don't bother forwarding them.  but note that we've finished\n            // gathering candidates, and can close the signalling connection if the\n            // synchronizer has finished too.\n            if (!e.candidate) {\n                this.localGatheringComplete = true;\n                return;\n            }\n\n            // also ignore if the signalling connection has been lost.\n            if (this.signaling?.readyState === WebSocket.OPEN) {\n                const message = {\n                    type: 'candidate',\n                    candidate: e.candidate.candidate,\n                    sdpMid: e.candidate.sdpMid,\n                    sdpMLineIndex: e.candidate.sdpMLineIndex\n                };\n                this.signalToSessionRunner(message);\n            }\n        };\n        pc.onicecandidateerror = e => {\n            if (pc !== this.pc) return;\n            // it appears that these are generally not fatal (see https://www.webrtc-developers.com/oups-i-got-an-ice-error-701/).\n            // report and carry on.\n            // NB: although ICE is meant to not report an error twice for a given URL,\n            // on Chrome it appears to ignore that.  so filter things ourselves.\n            if (DEBUG.connection) {\n                const errorKey = `${e.errorCode}|${e.url}`;\n                if (!iceReportedErrors.has(errorKey)) {\n                    if (e.errorCode === 701) console.log(`${this.clientId} ICE 701 warning on ${e.url}`);\n                    else console.log(`${this.clientId} ICE error from ${e.url}: ${e.errorCode} ${e.errorText}`);\n                    iceReportedErrors.add(errorKey);\n                }\n            }\n        };\n    }\n\n    async handleAnswer(answer) {\n        // answer from remote\n        if (!this.pc) {\n            console.error('no peerconnection');\n            return;\n        }\n        await this.pc.setRemoteDescription(answer);\n    }\n\n    async handleCandidate(candidate) {\n        // ICE candidate from remote\n        if (!this.pc) {\n            console.error('no peerconnection');\n            return;\n        }\n\n        if (!candidate.candidate) {\n            await this.pc.addIceCandidate(null);\n        } else {\n            await this.pc.addIceCandidate(candidate);\n        }\n    }\n\n    send(data) {\n        // if (DEBUG.connection) console.log(\"attempt to send\", data, !!this.dataChannel);\n        if (this.dataChannel) {\n            this.dataChannel.send(data);\n        } else {\n            console.warn(`${this.clientId} no data channel to send: ${data}`);\n        }\n    }\n\n    onDataChannelOpen(event) {\n        if (DEBUG.connection) console.log(`${this.clientId} RTCDataChannel open`);\n        if (this.onconnected) this.onconnected();\n        this.logConnectionState();\n    }\n\n    onDataChannelMessage(event) {\n        if (!this.onmessage) return;\n\n        // once messages are flowing and candidate gathering is complete at\n        // both ends, make sure the signalling channel is closed.\n        // we check this here, rather than on some connection-status change,\n        // to guarantee that the synchronizer has this channel in its server.clients\n        // and therefore won't kill the entire peer connection when the signalling\n        // shuts down.\n        // because Chrome, at least, has a habit of choosing a candidate pair\n        // early then switching later, we delay this handling by 1 second to\n        // increase the probability that ICE has indeed fully settled.\n        // jun 2024: first seen in Firefox clients running through a VPN: candidate\n        // generation can be held up around 10 seconds for some connection methods,\n        // so the signal for end of gathering (an event, or a null candidate) can be\n        // delayed even though negotiation has succeeded.\n        // on expiry of ICE_NEGOTIATION_MAXIMUM we now proceed with closure of the\n        // signalling channel if the connection appears to be up and running.\n        this.dataChannelFlowing = true;\n        if (!this.signalingCloseScheduled && this.synchronizerGatheringComplete && this.localGatheringComplete) {\n            this.clearNegotiationTimeout(); // negotiation has successfully completed\n            this.scheduleSignalingClose();\n        }\n\n        const msg = event.data;\n        // special case: if we receive \"!ping@<time>\", immediately return \"!pong@<time>\"\n        if (msg.startsWith('!ping')) {\n            this.send(msg.replace('ping', 'pong'));\n            return;\n        }\n        // special case: \"!close|code|reason\" indicates reason for an imminent closure\n        if (msg.startsWith('!close')) {\n            const parts = msg.split('|');\n            this.synchronizerCloseReason = [Number(parts[1]), parts[2]];\n            return;\n        }\n\n        // if (DEBUG.connection) console.log(`Received message: ${msg}`);\n        this.onmessage(event);\n    }\n\n    onDataChannelError(event) {\n        console.error(`${this.clientId} RTCDataChannel error`, event);\n        this.synchronizerError(event.errorDetail); // will also close the connection\n    }\n\n    onDataChannelClosing(_event) {\n        // unexpected drop in the data channel.\n        // this event sometimes (??) arrives as soon as the remote end goes away -\n        // whereas the next event (ICE connection state => \"disconnected\")\n        // isn't triggered for another 5 or 6 seconds.\n        if (!this.pc) return; // connection has already gone\n\n        if (DEBUG.connection) console.log(`${this.clientId} data channel closing`);\n        this.synchronizerDisconnected();\n    }\n\n    onDataChannelClose(_event) {\n        // unexpected drop in the data channel\n        if (!this.pc) return; // connection has already gone\n\n        if (DEBUG.connection) console.log(`${this.clientId} data channel closed`);\n        this.synchronizerDisconnected();\n    }\n\n    scheduleSignalingClose() {\n        this.signalingCloseScheduled = true;\n        if (DEBUG.connection) console.log(`${this.clientId} signaling channel closure scheduled`);\n        const { signalingKey } = this;\n        setTimeout(() => {\n            if (signalingKey === this.signalingKey) {\n                if (DEBUG.connection) console.log(`${this.clientId} closing signaling channel`);\n                this.closeSignalingChannel();\n            }\n        }, 1000);\n\n    }\n\n    async defunct_readConnectionType() {\n        // could be helpful if the onselectedcandidatepairchange approach turns out\n        // not to work on some platform.  but beware calling this too soon after the\n        // connection opens.\n        const stats = await this.pc.getStats();\n        if (stats) {\n            let selectedPairId = null;\n            for (const [key, stat] of stats) {\n                if (stat.type === \"transport\") {\n                    selectedPairId = stat.selectedCandidatePairId;\n                    break;\n                }\n            }\n            let candidatePair = stats.get(selectedPairId);\n            if (!candidatePair) {\n                for (const [key, stat] of stats) {\n                    if (stat.type === \"candidate-pair\" && stat.selected) {\n                        candidatePair = stat;\n                        break;\n                    }\n                }\n            }\n\n            if (candidatePair) {\n                for (const [key, stat] of stats) {\n                    if (key === candidatePair.remoteCandidateId) {\n                        return stat.candidateType;\n                    }\n                }\n            }\n        }\n        return \"\";\n    }\n\n}\n", "/* global croquet_build_process */\n\nimport stableStringify from \"fast-json-stable-stringify\";\nimport { algo } from \"crypto-js/core\";\nimport Base64 from \"crypto-js/enc-base64\";\nimport Utf8 from \"crypto-js/enc-utf8\";\nimport PBKDF2 from \"crypto-js/pbkdf2\";\nimport AES from \"crypto-js/aes\";\nimport WordArray from \"crypto-js/lib-typedarrays\";\nimport HmacSHA256 from \"crypto-js/hmac-sha256\";\nimport pako from \"pako\"; // gzip-aware compressor\nimport { OfflineSocket } from \"./offline\";\nimport { CroquetWebRTCConnection } from \"./webrtc\";\n\n// the rollup config will replace the line below with an import in the case of a Node.js build\n// _ENSURE_WEBSOCKET_\n\nimport { Stats } from \"./_STATS_MODULE_\"; // eslint-disable-line import/no-unresolved\nimport urlOptions from \"./_URLOPTIONS_MODULE_\"; // eslint-disable-line import/no-unresolved\nimport { App, displayStatus, displayAppError } from \"./_HTML_MODULE_\"; // eslint-disable-line import/no-unresolved\nimport { hashNameAndOptions, hashSessionAndCode, hashString, cryptoJsWordArrayToUint8Array } from \"./hashing\";\nimport { inViewRealm } from \"./realms\";\nimport { viewDomain } from \"./domain\";\nimport VirtualMachine, { Message, inSequence, propertyAccessor } from \"./vm\";\n/* eslint-disable-next-line import/order,import/no-unresolved */\nimport UploadWorkerFactory from \"web-worker:./upload\";      // generated by rollup\n\n/** @typedef { import(\"./model\").default } Model */\n/** @typedef { {} } Session */\n\n// when reflector has a new feature, we increment this value\n// only newer clients get to use it\nconst PROTOCOL_VERSION = 1;\n\nexport const CROQUET_VERSION = croquet_build_process.env.CROQUET_VERSION || \"<unknown>\";\nconst NODE = croquet_build_process.env.CROQUET_PLATFORM === \"node\";\n\n// use dev reflectors for pre-release SDKs, unless dev=false given\n// (only needed for periods when code changes below require dev reflectors,\n// comment out once deployed to production reflectors)\n// if (!(\"dev\" in urlOptions) && (CROQUET_VERSION === \"<unknown>\" || CROQUET_VERSION.includes('-'))) urlOptions.dev = true;\n\n// dev reflectors are used for pages served from /dev\n// everything else uses api.croquet.io/reflector/v1\n// ...unless overridden by a \"backend\" url option\n// ...unless overridden by a \"reflector=<url|region>\" url option, which sets the specified url or region\n\nconst CLOUDFLARE_REFLECTOR = \"wss://croquet.network/reflector/\";\nconst DEV_CLOUDFLARE_REFLECTOR = \"wss://croquet.network/reflector/dev/\";\n\nconst OLD_UPLOAD_SERVER = \"https://croquet.io/files/v1\";    // url base of files created before we had API keys\nconst OLD_DOWNLOAD_SERVER = \"https://files.croquet.io\";     // downloads from old bucket (rewritten from old upload url)\nexport const OLD_DATA_SERVER = OLD_DOWNLOAD_SERVER;\n\nlet DEBUG = null;\n\nfunction logVersion() {\n    if (NODE) console.log(\"Croquet \" + CROQUET_VERSION);\n    else console.log(\"%cCroquet%c %c\" + CROQUET_VERSION, \"color:#F0493E\", \"color:inherit\", `color:${CROQUET_VERSION.includes('+') ? \"#909\" : \"inherit\"}`);\n}\n\nfunction initOptions() {\n    if (!globalThis.__MULTISYNQ__) logVersion();\n    // to capture whatever was passed to the latest Session.join({debug:...})\n    // call we simply redo this every time establishSession() is called\n    // TODO: turn this into a reasonable API\n    // enable some opts by default via dev flag or being on localhost-equivalent\n    const appOnCroquetIo = !NODE && window.location.hostname.match(/^(.*\\.)?croquet\\.io$/i);\n    const appOnCroquetIoDev = appOnCroquetIo && window.location.pathname.startsWith(\"/dev/\");\n    // const devOrLocal = urlOptions.dev || (urlOptions.dev !== false && \"localhost\");\n    const devOrCroquetIoDev = urlOptions.dev || (urlOptions.dev !== false && appOnCroquetIoDev);\n    DEBUG = {\n        messages: urlOptions.has(\"debug\", \"messages\", false),               // received messages\n        sends: urlOptions.has(\"debug\", \"sends\", false),                     // sent messages\n        publish: urlOptions.has(\"debug\", \"publish\", false),                 // published events\n        events: urlOptions.has(\"debug\", \"events\", false),                   // subscribed events\n        ticks: urlOptions.has(\"debug\", \"ticks\", false),                     // received ticks\n        pong: urlOptions.has(\"debug\", \"pong\", false),                       // received PONGs\n        snapshot: urlOptions.has(\"debug\", \"snapshot\", false),               // snapshotting, uploading etc\n        session: urlOptions.has(\"debug\", \"session\", false),                 // session logging\n        initsnapshot: urlOptions.has(\"debug\", \"initsnapshot\", true),        // check snapshotting after initFn\n        reflector: urlOptions.has(\"debug\", \"reflector\", devOrCroquetIoDev), // use dev reflector\n        offline: urlOptions.has(\"debug\", \"offline\", false),                 // short-circuit all requests\n    };\n    if (DEBUG.offline) App.showMessage(`${App.libName}: offline mode enabled, no multiuser`, { level: \"warning\"});\n    if (urlOptions.box) {\n        let url = new URL(urlOptions.box, window.location).href;\n        if (!url.endsWith(\"/\")) url += \"/\";\n        urlOptions.reflector = url + \"reflector\";\n        urlOptions.files = url + \"files\";\n    }\n}\n\nfunction setDebug(options={}) {\n    if (!DEBUG) initOptions();\n    if (typeof options === \"string\") {\n        options = Object.fromEntries(options.split(\",\").map(option => [option.replace(/^no/, \"\"), !options.startsWith(\"no\")]));\n    }\n    for (const [key, value] of Object.entries(options)) {\n        if (key in DEBUG) DEBUG[key] = value;\n        else App.showMessage(`${App.libName}: unknown debug option \"${key}\"`, { level: \"warning\", only: \"once\" });\n    }\n    return DEBUG;\n}\n\n/*\nfunction isLocalUrl(hostname) {\n    // copied from devauth/signurl/urlMatcher.js\n\n    const LOCAL_PATTERNS = [\n        /localhost/,\n        /.*\\.local/,\n        /.*\\.ngrok.io/,\n        // 10.0.0.0 - 10.255.255.255\n        /10(?:\\.\\d{1,3}){3}/,\n        // 127.0.0.0 - 127.255.255.255\n        /127(?:\\.\\d{1,3}){3}/,\n        // 169.254.1.0 - 169.254.254.255\n        /169\\.254\\.([1-9]|1?\\d\\d|2[0-4]\\d|25[0-4])\\.\\d{1,3}/,\n        // 172.16.0.0 - 172.31.255.255\n        /(172\\.1[6-9]|172\\.2\\d|172\\.3[01])(?:\\.\\d{1,3}){2}/,\n        // 192.168.0.0 - 192.168.255.255\n        /192\\.168(?:\\.\\d{1,3}){2}/,\n        // fc00::/7\n        /\\[f[cd][\\da-f]{2}(:?:[\\da-f]{1,4}){1,7}\\]/,\n        // fe80::/10\n        /\\[fe[89ab][\\da-f](:?:[\\da-f]{1,4}){1,7}\\]/,\n        // ::1\n        /\\[::1\\]/,\n        // ::ffff:7f00:1\n        /\\[::ffff:7f00:1\\]/,\n    ];\n\n    // Concat all RegExes from above into one\n    const LOCAL_PATTERNS_RE = new RegExp(\n        `^(${LOCAL_PATTERNS.map(re => re.source).join('|')})$`,\n    );\n\n    const isLocal = LOCAL_PATTERNS_RE.test(hostname);\n\n    return isLocal;\n}\n*/\n\n/*\n    Query string parameters for DePIN (on Node, specify in the form --depin=foo):\n        depin        (means wss://api.multisynq.io/depin)\n        or\n        depin=dev    (means wss://api.multisynq.dev/depin)\n        or\n        depin=local  (means ws://localhost:8787)\n        or\n        depin=<websocket url>\n        or\n        depin=false  (to revert to websocket network)\n*/\n\nconst DEPIN_API_PROD = 'wss://api.multisynq.io/depin';\nconst DEPIN_API_DEV = 'wss://api.multisynq.dev/depin';\nconst DEPIN_API_LOCAL = 'ws://localhost:8787';\nconst DEPIN_API_DEFAULT = DEPIN_API_PROD;\n\nlet DEPIN;\nlet DEPIN_API;\nlet REFL_OR_SYNCH = \"reflector\"; // just for logging\n\nfunction initDEPIN(defaultToDEPIN) {\n    if (DEPIN !== undefined) return; // already initialized\n    DEPIN = \"depin\" in urlOptions ? urlOptions.depin : defaultToDEPIN;\n    if (DEPIN && !DEBUG.offline) {\n        // get DEPIN_API from the url options, or use the default\n        DEPIN_API = DEPIN === true ? DEPIN_API_DEFAULT\n            : DEPIN === 'prod' ? DEPIN_API_PROD\n            : DEPIN === 'dev' ? DEPIN_API_DEV\n            : DEPIN === 'local' ? DEPIN_API_LOCAL\n            : DEPIN;\n        if (DEPIN_API.endsWith('/')) DEPIN_API = DEPIN_API.slice(0, -1);\n        DEPIN_API = DEPIN_API.replace(/^http(s):/, 'ws$1:');\n        if (!DEPIN_API.startsWith('ws')) DEPIN_API = (!NODE && window.location.protocol === 'https:' ? 'wss://' : 'ws://') + DEPIN_API;\n        REFL_OR_SYNCH = \"synchronizer\";\n        if (DEBUG.session) console.log(`DEPIN_API=${DEPIN_API}`);\n    } else {\n        DEPIN = false;\n    }\n}\n\nconst NOCHEAT = urlOptions.nocheat;\n\n// schedule a snapshot after this many ms of CPU time have been used for simulation\nconst SNAPSHOT_AFTER_CPU = 5000;\n// on DePIN, schedule a snapshot after this many ms of teatime have passed since last one\nconst DEPIN_SNAPSHOT_AFTER_TEATIME = 5 * 60 * 1000;\n// after reflecting one handlePollForSnapshot event, reflector will wait this many ms before allowing another.  also used as the debounce gap for our own snapshot requests.\nconst SNAPSHOT_POLL_DEBOUNCE = 5000;\n\n// add this many ms for each external message scheduled\nconst EXTERNAL_MESSAGE_CPU_PENALTY = 5;\nconst JOIN_FAILED_DELAY = 5000; // time after which we conclude that our sending of JOIN failed\n\n// lag threshold in ms to publish \"synced(true|false)\" event (to start/stop rendering)\nconst SYNCED_MIN = 200;        // synced if tick arrives within this many ms ...\nconst SYNCED_MIN_FACTOR = 0.1; // ... or msPerTick times this (e.g. 30s/tick => 3s)\nconst SYNCED_MAX = 2000;       // unsynced if tick missing for this many ms ...\nconst SYNCED_MAX_FACTOR = 0.2; // ... or msPerTick times this (e.g. 30s/tick => 6s)\nconst SYNCED_ANNOUNCE_DELAY = 200; // ms to delay setting synced, mainly to accommodate immediate post-SYNC messages (notably \"users\") from reflector\n\n// maximum amount of time in milliseconds the model gets to spend running its simulation\nconst MAX_SIMULATION_MS = 200;\n// time spent simulating the last few frames\nconst simLoad = [0];\n// number of frames to spread load\nconst LOAD_BALANCE_FRAMES = 4;\n// number of steps to record for checking animation\nconst ANIMATION_CHECK_FRAMES = 4;\n// don't assume animation has started until average inter-frame gap over ANIMATION_CHECK_FRAMES is less than this.  most browsers will be 33 or less, but there could be some slower-running systems out there (especially if app is stepping manually).\nconst ANIMATION_REASONABLE_FRAME_GAP = 100;\n// assume animation has stopped if more than this delay in ms since end of most recent step\nconst ANIMATION_EXCESSIVE_FRAME_GAP = ANIMATION_REASONABLE_FRAME_GAP * 2;\n// maximum recommended payload size (once string-encoded)\nconst PAYLOAD_LIMIT_RECOMMENDED = 4 * 1024;\n// maximum allowed payload size\nconst PAYLOAD_LIMIT_MAX = 16 * 1024;\n\n// for loading snapshots from before we required passwords\nlet DEPRECATED_DEFAULT_KEY; // initialized only when needed, for speed\n\nfunction randomString() { return Math.floor(Math.random() * 36**10).toString(36); }\n\n// start upload worker (upload.js)\nconst UploadWorker = new UploadWorkerFactory();\n// const url = new URL(\"./upload.mjs\", import.meta.url);\nUploadWorker.onerror = e => console.error(`UploadWorker error: ${e.message}`);\nlet UploadJobs = 0;\n\nconst Controllers = new Set();\n\n// for debugging: make controller accessible as CROQUETVD.controller\nObject.defineProperty(viewDomain, \"controller\", {\n    get() { return this.controllers.values().next().value; }\n});\nviewDomain.controllers = Controllers;\n\nexport function sessionProps(sessionId=\"\") {\n    let found = null;\n    for (const controller of Controllers) {\n        if (!found) found = controller;\n        if (controller.id === sessionId) {\n            found = controller;\n            break;\n        }\n    }\n    if (found) {\n        const { appId, persistentId } = found.sessionSpec;\n        return {\n            appId, persistentId,\n            key: found.key,\n            uploadEncrypted: opts => found.uploadEncrypted(opts),\n            downloadEncrypted: opts => found.downloadEncrypted(opts),\n        };\n    }\n    return {};\n}\n\nexport function sessionController(sessionId) {\n    for (const controller of Controllers) {\n        if (controller.id === sessionId) return controller;\n    }\n    return null;\n}\n\nexport default class Controller {\n\n    constructor() {\n        if (!DEBUG) initOptions();\n        this.reset();\n    }\n\n    reset() {\n        if (globalThis.CROQUETVM === this.vm) delete globalThis.CROQUETVM;\n        /** @type {VirtualMachine} */\n        this.vm = null;\n        /** @type {Session} the session object as returned from Session.join, set in session.js. Not to be used here but only so that View.session can find it. Needs redesign. */\n        this.session = null;\n        /**  @type {Connection} our websocket connection for talking to the reflector */\n        this.connection = this.connection || new Connection(this);\n        /** the messages received from reflector */\n        this.networkQueue = [];\n        /** the time stamp of last message received from reflector, or internal tick */\n        this.reflectorTime = 0;\n        /** ms between expected ticks */\n        this.msPerTick = this.msPerTick || 0;\n        /** multiply reflector ticks if > 1 (a.k.a. \"cheat beats\") */\n        this.tickMultiplier = this.tickMultiplier || 1;\n        /** the local time at which we received the last time stamp, minus that time stamp */\n        this.extrapolatedTimeBase = Date.now();\n        /** key generated from password, shared by all clients in session */\n        this.key = this.key || null;\n        /** encrypted message used to verify all clients actually use the same key */\n        this.tove = this.tove || null;\n        /** @type {String} the client id (different in each replica, but stays the same on reconnect) */\n        this.viewId = this.viewId || randomString(); // todo: have reflector assign unique ids\n        /** @type {String} payload for view-join  */\n        this.viewDataEncrypted = this.viewDataEncrypted || null;\n        /** @type {String} stateless reflectors always start new session, this is the only way to notice that */\n        this.timeline = \"\";\n        // just to be safe ...\n        if (this.rejoinTimeout) clearTimeout(this.rejoinTimeout);\n        /** timeout rejoin if rejoinLimit has been requested */\n        this.rejoinTimeout = 0;\n        /** @type {Function[]} buffered sends to reflector while reconnecting */\n        this.sendBuffer = [];\n        /** the number of concurrent users in our vm (excluding spectators) */\n        this.users = 0;\n        /** the number of concurrent users in our vm (including spectators) */\n        this.usersTotal = 0;\n        /** CPU time spent simulating since last snapshot */\n        this.cpuTime = 0;\n        /** CPU time spent at the point when we realised a snapshot is needed */\n        this.triggeringCpuTime = null;\n        /** record of teatime for debouncing our snapshot requests */\n        this.lastSnapshotRequest = 0;\n        /** @type {Boolean} backlog was below SYNCED_MIN */\n        this.synced = null; // null indicates never synced before\n        /** last measured latency in ms */\n        this.latency = 0;\n        // only collect latency history if asked for\n        if (this.latencyHistory) {\n            /** @type {Array<Number>} */\n            this.latencyHistory = [];\n        }\n        // make sure we have no residual \"multiply\" ticks\n        if (this.localTicker) {\n            globalThis.clearInterval(this.localTicker);\n            delete this.localTicker;\n        }\n        // in case we were still waiting for sync\n        if (this.syncTimer) {\n            globalThis.clearTimeout(this.syncTimer);\n            delete this.syncTimer;\n        }\n        /** @type {Array} recent TUTTI sends and their payloads, for matching up with incoming votes and divergence alerts */\n        this.tuttiHistory = [];\n\n        // stats relevant to DePIN\n        this.auditStats = {\n            /** track total reported users in this work unit */\n            lastUsers: -1, // will be initialised by first 'users' message\n            minUsers: -1,  // ditto\n            maxUsers: -1,  // ditto\n            /** cumulative total size of message payloads received in this work unit */\n            payloadTally: 0,\n        };\n\n        /** Date.now() at end of last stepSession triggered by animation */\n        this.lastAnimationEnd = 0;\n        /** array of gaps between animation end and the next start.  replaced with the value true once rapid animation has been detected. */\n        this.animationGapCheck = [];\n        /** socket send times of recent events */\n        this.rateLimitedSendTimes = [];\n        /** events held back and bundled to avoid exceeding instantaneous send rate */\n        this.rateLimitBuffer = [];\n        this.rateLimitSoftWarned = false;\n        this.rateLimitBufferWarned = false;\n        this.rateLimitLastLogged = 0;\n        this.payloadSizeWarned = false;\n\n        // controller (only) gets to subscribe to events using the shared viewId as the \"subscriber\" argument\n        viewDomain.removeAllSubscriptionsFor(this.viewId); // in case we're recycling\n        viewDomain.addSubscription(this.viewId, \"__views__\", this.viewId, count => displayStatus(`users now ${count}`), \"oncePerFrameWhileSynced\");\n        // \"leaving\" is set in session.js if we are leaving by user's request (rather than going dormant/reconnecting), or in controller.closeConnectionWithError in the case of an unrecoverable error being thrown.\n        if (!this.leaving) App.showSyncWait(true); // enable (i.e., not synced)\n    }\n\n    /** @type {String} the session id (same for all replicas running with same options on the same app version) */\n    get id() { return this.vm ? this.vm.id : this.sessionSpec.id; }\n\n    /** @type {String} the persistent id (same for all replicas with same options across app versions) */\n    get persistentId() { return this.sessionSpec.persistentId; }\n\n    /** @type {String} identifies Croquet version and app code */\n    get versionId() { return this.sessionSpec.codeHash; }\n\n    /** @type {Number} the reflector time extrapolated beyond last received tick */\n    get extrapolatedTime() { return Date.now() - this.extrapolatedTimeBase; }\n\n    /** @type {Boolean} if true, sends to the reflector are disabled */\n    get viewOnly() { return this.sessionSpec.viewOnly; }\n\n    /**  @type {Number} how many ms need to be simulated to catch up to latest time from the reflector */\n    get backlog() { return this.vm ? this.reflectorTime - this.vm.time : 0; }\n\n    /** @type {Number} how many ms passed since we received something from reflector */\n    get starvation() { return Date.now() - this.lastReceived; }\n\n    /**  @type {Number} how many ms the simulation is lagging behind extrapolated time, beyond expected tick interval */\n    get lag() { return this.vm ? Math.max(0, this.extrapolatedTime - this.vm.time - this.msPerTick): 0; }\n\n    /** @type {Number} how many ms passed since we sent a message via the reflector */\n    get activity() { return Date.now() - this.lastSent; }\n\n    /** @type {Boolean} true if our root view is up */\n    get viewed() {\n        return !!(this.session && this.session.view);\n    }\n\n    /** @type {Boolean} true if our connection is fine */\n    get connected() { return this.connection.connected; }\n\n    /** @type {Boolean} should the connection call leave() when disconnected? */\n    get shouldLeaveWhenDisconnected() { return this.leaving || !this.canRejoinSeamlessly || this.sessionSpec.rejoinLimit === 0; }\n\n    /** @type {Boolean} does the reflector support seamless rejoin? */\n    get canRejoinSeamlessly() { return !!this.timeline; }\n\n    /** @type {Boolean} did we load a snapshot that we did not write? */\n    get migratingOldSnapshot() {\n        // if session was started with hashOverride\n        // we will load old snapshots but refuse to save them\n        if (!this.sessionSpec) return false;\n        const { codeHash, computedCodeHash} = this.sessionSpec;\n        return codeHash !== computedCodeHash;\n    }\n\n\n    checkForConnection(force) { this.connection.checkForConnection(force); }\n\n    dormantDisconnect() {\n        if (!this.connected) return;\n        this.connection.dormantDisconnect();\n    }\n\n    /**\n     * Initialise the controller from the sessionSpec assembled in Session.join()\n     * - the vm/session id is created from `name` and\n     *   a hash of registered options and source code\n     *\n     * @param {String} name - A (human-readable) name for the session/room\n     * @param {Object} sessionSpec - Spec for the session\n     * @param {Function} sessionSpec.initFn - the vm initializer `initFn(options)`\n     * @param {Function} sessionSpec.rebootModelView - for taking down and rebuilding the model (i.e., the vm) and view\n     * @param {Object} sessionSpec.options - options to pass to the vm initializer\n     * @param {Array<String>} sessionSpec.optionsFromUrl - names of additional app-specific vm initializer options to take from URL\n     * @param {String} sessionSpec.apiKey - an API key of the form `backend:secret` (or just `secret` if backend is `prod`)\n     * @param {String} sessionSpec.appId - a unique identifier for an app\n     * @param {String} sessionSpec.password - password for end-to-end encryption\n     * @param {String} sessionSpec.viewData - payload for view-join event\n     * @param {String} sessionSpec.viewIdDebugSuffix - suffix for viewIds to help debugging\n     * @param {Number|String} sessionSpec.tps - ticks per second (can be overridden by `options.tps` or `urlOptions.tps`)\n     * @param {Number} sessionSpec.autoSleep - number of seconds of being hidden to trigger dormancy (or 0 to disable)\n     * @param {Object} sessionSpec.flags - features to request from the reflector\n     */\n    async initFromSessionSpec(sessionSpec) {\n        // If we add more options here, add them to SESSION_PARAMS in session.js\n        const { name: n, optionsFromUrl, persistentIdOptions, password, appId, apiKey, viewData, viewIdDebugSuffix, location } = sessionSpec;\n        const name = appId ? `${appId}/${n}` : n;\n        // we don't care about the strength of the key derivation\n        this.key = PBKDF2(password, \"\", { keySize: 256/32, hasher: algo.SHA1, iterations: 1 });\n        if (viewIdDebugSuffix) this.viewId = this.viewId.replace(/_.*$/, \"\") + '_' + encodeURIComponent((\"\" + viewIdDebugSuffix).slice(0, 16))\n            .replace(/[^a-z0-9]/ig, c => `_${c === '%' ? \"\" : c.charCodeAt(0).toString(16).toUpperCase()}`); // ensure only a-z0-9_ in suffix\n        // root model options are only those explicitly requested by app, plus url options\n        const options = {...sessionSpec.options};\n        if (optionsFromUrl) for (const key of optionsFromUrl) {\n            if (key in urlOptions) options[key] = urlOptions[key];\n        }\n        // persistent params are those options affecting the persistent ID\n        // other options are hashed as part of deriving session ID\n        const persistentParams = {}; // affecting persistent ID\n        const sessionParams = {};    // only affecting session ID\n        for (const [key, option] of Object.entries(options)) {\n            if (persistentIdOptions?.includes(key)) persistentParams[key] = option;\n            else sessionParams[key] = option;\n        }\n        // if debugEvents or location are enabled, we want a different session\n        const debugEvents = DEBUG.events || DEBUG.publish;\n        if (debugEvents) sessionParams.__debugEvents = true;\n        if (location) sessionParams.__location = true;\n        // allow overriding versionId (for testing / reviving old sessions)\n        const hashOverride = urlOptions.hashOverride || sessionSpec.hashOverride;\n        // now do the hashing, separately for persistent and session IDs`\n        const persistentId = await hashNameAndOptions(name, persistentParams);\n        // on DePIN, token is undefined\n        const { developerId, token } = await this.verifyApiKey(apiKey, appId, persistentId);\n        const { id, codeHash, computedCodeHash } = await hashSessionAndCode(persistentId, developerId, sessionParams, hashOverride, CROQUET_VERSION);\n        if (!this.tove) this.tove = await this.encrypt(id);\n        if (viewData && !this.viewDataEncrypted) this.viewDataEncrypted = await this.encryptPayload(viewData);\n        if (DEBUG.session) console.log(`${App.libName} session \"${name}\":\n        sessionId=${id}${appId ? `\n        persistentId=${persistentId}` : \"\"}\n        versionId=${codeHash === computedCodeHash ? codeHash : `${codeHash} (specified in hashOverride)\n        versionId=${computedCodeHash} (computed)`}\n        viewId=${this.viewId}`);\n\n        // eventRateLimit and other (trivially) derived settings\n        this.eventRateLimit = sessionSpec.eventRateLimit; // max instantaneous send rate per second\n        this.eventHistoryLimit = this.eventRateLimit; // warn user if this many sends recorded in under a second\n        this.eventMaxBundles = this.eventRateLimit; // disconnect app if more than this many message bundles are waiting\n\n        this.sessionSpec = { ...sessionSpec, options, name, id, persistentId, developerId, token, codeHash, computedCodeHash, debugEvents };\n\n        const { msPerTick, multiplier } = this.getTickAndMultiplier();\n        this.msPerTick = msPerTick;\n        this.tickMultiplier = multiplier;\n\n        this.setUpActivityChecks();\n    }\n\n    /**\n     * Join or create a session by connecting to the reflector\n     */\n    async establishSession() {\n        // invoked only from session's rebootModelView, under the following circs:\n        //  a. on initial session setup\n        //  b. on reboot following a leave() triggered by a disconnection (through connectionInterrupted)\n        //  c. on reboot following a leave() triggered by SYNC when rejoin cannot proceed seamlessly\n        // it doesn't return until the session is successfully joined - however many\n        // connections/disconnections happen along the way.\n\n        // reset sessionSpec.snapshot to a dummy in preparation for install()\n        // (its dummy status is detected by lack of a models property)\n        const { id, persistentId, codeHash } = this.sessionSpec;\n        this.sessionSpec.snapshot = { id, time: 0, meta: { id, persistentId, codeHash, created: (new Date()).toISOString() } };\n        const joined = new Promise(resolve => { this.sessionSpec.sessionJoined = resolve; });\n        this.checkForConnection(false); // ensure connected unless we're blocked (e.g., in dormant state)\n        if (DEBUG.session) console.log(id, \"waiting for join and SYNC\");\n        await joined; // resolved in SYNC after installing the vm and replaying any messages\n        this.sessionSpec.sessionJoined = () => {};\n        this.syncCompleted = true;\n    }\n\n    getBackend(apiKeysWithBackend) {\n        if (DEBUG.offline) return {\n            apiKey: \"none\",\n            signServer: \"none\",\n            reflector: \"none\",\n        };\n\n        if (urlOptions.box || urlOptions.reflector) { // box is croquet-in-a-box, see session.js\n            return {\n                apiKey: \"none\",\n                signServer: \"none\",\n                reflector: urlOptions.reflector,\n            };\n        }\n\n        const keys = {};\n        for (const key of apiKeysWithBackend.split(\",\")) {\n            const split = key.lastIndexOf(':');\n            const version = key[split === -1 ? 0 : split+1]; // 1: croquet.io, 2: multisynq.io\n            if (!version?.match(/^[12]$/)) throw Error(\"Invalid API key: \" + key);\n            if (version in keys) throw Error(`Duplicate API key versions`);\n            keys[version] = {\n                key: split === -1 ? key : key.slice(split + 1),\n                backend: split === -1 ? \"\" : key.slice(0, split),\n            };\n        }\n        let defaultToDEPIN = !keys[1]; // default to DEPIN if no croquet.io key\n        if (defaultToDEPIN && keys[2].backend) defaultToDEPIN = keys[2].backend;\n        initDEPIN(defaultToDEPIN);\n        const key = keys[DEPIN ? 2 : 1];\n        if (!key) throw Error(`No ${DEPIN ? \"Multisynq\" : \"Croquet\"} API key provided`);\n\n        const apiKey = key.key;\n        const backend = urlOptions.backend || key.backend;\n        const overridden = urlOptions.reflector?.includes(\"/\");\n        if (backend === \"none\") {\n            return {\n                apiKey, // without api key even stand-alone reflectors currently send a warning\n                signServer: \"none\",\n                reflector: \"overridden\",\n            };\n        }\n\n        if (DEPIN) return {\n            apiKey,\n            signServer: `${DEPIN_API.replace(/^ws/, \"http\")}/clients`,\n            reflector: \"depin\", // unused\n        };\n\n        const reflector = overridden ? \"overridden\" : `wss://api.croquet.io/reflector/v${PROTOCOL_VERSION}`;\n        return {\n            apiKey,\n            signServer: `https://api.croquet.io/sign`,    // sign server generates file upload/download urls\n            reflector\n        };\n    }\n\n    /** fetch developerId from sign function via meta protocol */\n    async verifyApiKey(apiKeysWithBackend, appId, persistentId) {\n        const {signServer, apiKey} = this.getBackend(apiKeysWithBackend);\n        if (signServer === \"none\") return { developerId: \"unknown_dev_id\" };\n\n        try {\n            const maxRetries = 2; // plus initial try\n            const response = await this.fetchWithRetries(\"verifying API key\", [403], maxRetries, () => {\n                return fetch(`${signServer}/join?meta=login`, {\n                    method: \"GET\",\n                    mode: \"cors\",\n                    headers: {\n                        \"X-Croquet-Auth\": apiKey,\n                        \"X-Croquet-App\": appId,\n                        \"X-Croquet-Id\": persistentId,\n                        \"X-Croquet-Version\": CROQUET_VERSION,\n                        \"X-Croquet-Path\": (new URL(App.referrerURL())).pathname,\n                    },\n                    referrer: App.referrerURL(),\n                    referrerPolicy: 'no-referrer-when-downgrade',\n                });\n            });\n            // result from multisynq either has developerId or error.\n            // result from croquet.io has developerId and token.\n            const payload = await response.json();\n            const { developerId, error } = payload;\n            if (error) throw Error(error);\n            if (DEBUG.session) console.log(`${DEPIN ? \"Multisynq\" : \"Croquet\"}: verified API key for developer ${developerId}`);\n            return payload;\n        } catch (err) {\n            throw Error(`${DEPIN ? \"Multisynq\" : \"Croquet\"} API key validation failed for \"${apiKey}\": ${err.message}`);\n        }\n    }\n\n    async fetchWithRetries(goal, instantFailureCodes, allowedRetries, fetchFn) {\n        const maxTries = 1 + allowedRetries;\n        let tried = 0;\n        let failureReport;\n        for (;;) {\n            let response, error;\n            try {\n                // eslint-disable-next-line no-await-in-loop\n                response = await fetchFn();\n                if (response.ok) return response;\n            } catch (err) { error = err; }\n\n            tried++;\n\n            let prefix = \"\";\n            const instantFailure = response && instantFailureCodes.includes(response.status);\n            if (instantFailure) prefix = \"fatal \";\n            else if (tried === maxTries) prefix = \"final \";\n            failureReport = response\n                // eslint-disable-next-line no-await-in-loop\n                ? `${prefix}status ${response.status} ${response.statusText} - \"${await response.text()}\"`\n                : `${prefix}error \"${error?.message}\"`;\n\n            if (tried === maxTries || instantFailure) break;\n\n            // first retry is 100ms, then 1s, then 5s\n            const delay = tried === 1 ? 100 : tried === 2 ? 1000 : 5000;\n            console.warn(`${failureReport} while ${goal}; retrying in ${delay}ms`);\n            // eslint-disable-next-line no-await-in-loop\n            await new Promise(resolve => { setTimeout(resolve, delay); });\n        }\n\n        console.warn(`${failureReport} while ${goal}; giving up`);\n        throw Error(failureReport);\n    }\n\n    lastKnownTime(vmOrSnapshot) { return Math.max(vmOrSnapshot.time, vmOrSnapshot.externalTime); }\n\n    takeSnapshot() {\n        // !!! THIS IS BEING EXECUTED INSIDE THE SIMULATION LOOP!!!\n        const snapshot = this.vm.snapshot();\n        const time = this.lastKnownTime(snapshot);\n        const seq = snapshot.externalSeq;\n        snapshot.meta = {\n            ...this.sessionSpec.snapshot.meta,\n            options: this.sessionSpec.options,\n            time,\n            seq,\n            date: (new globalThis.CroquetViewDate()).toISOString(), // mar 2022: this is now running in Model code\n            host: NODE ? \"localhost\" : window.location.hostname,\n            sdk: CROQUET_VERSION,\n        };\n        delete snapshot.meta.hash; // old hash is invalid\n        return snapshot;\n    }\n\n    takeSnapshotHandleErrors() {\n        // !!! THIS IS BEING EXECUTED INSIDE THE SIMULATION LOOP!!!\n\n        let start, ms, snapshot;\n        try {\n            start = Stats.begin(\"snapshot\");\n            snapshot = this.takeSnapshot();\n        } catch (error) {\n            displayAppError(\"snapshot\", error);\n            return null;\n        } finally {\n            ms = Stats.end(\"snapshot\") - start;\n        }\n        if (DEBUG.snapshot) console.log(this.id, `snapshot taken in ${Math.ceil(ms)}ms`);\n        return snapshot;\n    }\n\n    setDebug(options) {\n        return setDebug(options);\n    }\n\n    requestDebugSnapshot() {\n        setDebug(\"snapshot\");\n        this.triggeringCpuTime = 1e-10; // pretend this is the fastest machine, so we will take the snapshot\n        this.scheduleSnapshot(this.viewId); // force snapshot poll from this machine\n    }\n\n    // we have spent a certain amount of CPU time on simulating, so schedule a snapshot\n    scheduleSnapshot(force=false) {\n        // abandon if this call (delayed by up to 2s - possibly more, if browser is busy)\n        // has been overtaken by a poll initiated by another client.  or if the controller\n        // has been reset, or we're disconnected, or viewOnly.\n        if (!this.connected || !this.vm || this.viewOnly) return;\n\n        const now = this.vm.time;\n        const sinceLast = now - this.vm.lastSnapshotPoll;\n        if (sinceLast < 5000 && !force) {\n            if (DEBUG.snapshot) console.log(`not requesting snapshot poll (${sinceLast}ms since poll scheduled)`);\n            return;\n        }\n\n        if (this.migratingOldSnapshot) {\n            // eslint-disable-next-line no-alert, no-restricted-globals\n            alert(\"Snapshot is due but hashOverride is set. Ignoring.\");\n            return;\n        }\n\n        if (force) {\n            // the reflector really needs a snapshot so SOME clients need to schedule\n            // we'll pick three viewIds, and if we're one of them we'll schedule\n            // (if the simulation is behind then this will not be totally identical but what can we do?)\n            const viewIds = Object.keys(this.vm.views);\n            viewIds.sort();\n            if (force === this.viewId || viewIds[0] === this.viewId || viewIds[1] === this.viewId || viewIds[2] === this.viewId) {\n                if (DEBUG.snapshot) console.log(`forcing snapshot poll`);\n            } else {\n                if (DEBUG.snapshot) console.log(`not forcing snapshot poll (not one of the three)`);\n                return;\n            }\n        }\n\n        const message = new Message(now, 0, \"_\", \"handlePollForSnapshot\", []);\n        // tell reflector only to reflect this message if no message with same ID has been sent in past 5000ms (wall-clock time)\n        this.sendTagged(message, { debounce: SNAPSHOT_POLL_DEBOUNCE, msgID: \"pollForSnapshot\" });\n        if (DEBUG.snapshot) console.log(this.id, `requesting snapshot poll via ${REFL_OR_SYNCH}`);\n    }\n\n    handlePollForSnapshot(time) {\n        // !!! THIS IS BEING EXECUTED INSIDE THE SIMULATION LOOP!!!\n        // !!! IT MUST NOT MODIFY VM !!!\n\n        if (this.synced !== true || this.viewOnly) {\n            // not going to vote, so don't waste time on creating the hash\n            this.triggeringCpuTime = null; // ...though unlikely to have been set\n            return;\n        }\n\n        const localCpuTime = this.triggeringCpuTime || this.cpuTime;\n        this.triggeringCpuTime = null;\n        this.cpuTime = 0;\n\n        let start, voteData, ms;\n        try {\n            start = Stats.begin(\"snapshot\");\n            voteData = {\n                cpuTime: localCpuTime,\n                hash: this.vm.getSummaryHash(), // this is the expensive snapshot-related part\n                viewId: this.viewId,\n            };\n        } catch (error) {\n            displayAppError(\"snapshot\", error);\n            return;\n        } finally {\n            ms = Stats.end(\"snapshot\") - start;\n            // exclude snapshot time from cpu time for logic in this.simulate()\n            this.cpuTime -= ms;  // give ourselves a time credit for the non-simulation work\n        }\n        if (DEBUG.snapshot) console.log(this.id, `Summary hashing took ${Math.ceil(ms)}ms`);\n\n        // sending the vote is handled asynchronously, because we want to add a view-side random()\n        queueMicrotask(() => this.pollForSnapshot(time, voteData));\n    }\n\n    pollForSnapshot(time, voteData) {\n        voteData.cpuTime += Math.random(); // fuzzify by 0-1ms to further reduce [already minuscule] risk of exact agreement.  NB: this is a view-side random().\n        if (DEBUG.snapshot) console.log(this.id, \"sending snapshot vote\", voteData);\n        this.sendTutti({ time, topic: \"snapshot\", data: voteData, tallyTarget: [\"handleSnapshotVote\"] });\n    }\n\n    handleSnapshotVote(data) {\n        // !!! THIS IS BEING EXECUTED INSIDE THE SIMULATION LOOP!!!\n        // !!! IT MUST NOT MODIFY VM !!!\n\n        const { tally } = data;\n\n        if (DEBUG.snapshot) console.log(this.id, \"received snapshot votes\", tally);\n\n        const { numberOfGroups, shouldUpload, dissidentFlag } = this.analyzeTally(tally, \"cpuTime\");\n        if (numberOfGroups > 1) {\n            this.diverged = true;\n            const previous = this.vm.diverged ? this.vm.diverged.size : 0;\n            console.error(this.id, `Session diverged (#${previous})! Snapshots fall into ${numberOfGroups} groups`);\n        }\n\n        if (this.synced !== true) {\n            if (DEBUG.snapshot) console.log(this.id, \"Ignoring snapshot vote during sync\");\n        } else if (shouldUpload) {\n            const auditStats = {...this.auditStats};\n            const snapshot = this.takeSnapshotHandleErrors();\n            // switch out of the simulation loop\n            if (snapshot) queueMicrotask(() => this.uploadSnapshot(snapshot, auditStats, dissidentFlag));\n        }\n    }\n\n    analyzeTally(tally, timeProperty) {\n        // !!! THIS IS BEING EXECUTED INSIDE THE SIMULATION LOOP!!!\n\n        // analyse the results of a tutti vote for either a snapshot or persistence,\n        // in which the tally keys are JSONified vote objects that are guaranteed to be\n        // unique.\n        // even if this client is not in the tally (didn't vote, or vote arrived late)\n        // we still analyse the votes, because if the hashes fall into multiple groups\n        // every client should log a warning.\n\n        let shouldUpload = false;\n        let dissidentFlag = null;\n        const votes = [];\n        const votesByHash = {};\n        let ourIndex = null;\n        Object.keys(tally).forEach((k, i) => {\n            const vote = JSON.parse(k); // { hash, viewId } and specified time property\n            votes.push(vote);\n\n            const { hash, viewId } = vote;\n            if (viewId === this.viewId) ourIndex = i;\n            if (!votesByHash[hash]) votesByHash[hash] = [];\n            votesByHash[hash].push(i);\n            });\n\n        const hashGroups = Object.keys(votesByHash);\n        const numberOfGroups = hashGroups.length;\n        let consensusIndex = 0;\n        if (numberOfGroups > 1) {\n            // decide consensus by majority vote; in a tie, summary hash first in\n            // lexicographic order is taken as the consensus.\n            hashGroups.sort((a, b) => votesByHash[b].length - votesByHash[a].length); // descending order of number of matching votes\n            if (votesByHash[hashGroups[0]].length === votesByHash[hashGroups[1]].length) {\n                if (DEBUG.snapshot) console.log(this.id, `Deciding consensus by tie-break`);\n                if (hashGroups[1] < hashGroups[0]) consensusIndex = 1;\n            }\n        }\n        const consensusHash = hashGroups[consensusIndex];\n\n        // figure out whether this client should do the upload for the group (if any)\n        // that it's in.\n        if (ourIndex !== null) {\n            const ourHash = votes[ourIndex].hash;\n            const clientIndices = votesByHash[ourHash];\n            if (clientIndices.length > 1) clientIndices.sort((a, b) => votes[a][timeProperty] - votes[b][timeProperty]); // ascending order\n            if (clientIndices[0] === ourIndex) {\n                shouldUpload = true;\n                if (ourHash !== consensusHash) dissidentFlag = { groupVotes: clientIndices.length, allVotes: votes.length };\n            }\n        }\n\n        return { numberOfGroups, shouldUpload, dissidentFlag };\n    }\n\n    snapshotPath(time, seq, hash) {\n        // snapshot time is full precision. for storage name, we use full ms.\n        const paddedTime = Math.ceil(time).toString().padStart(10, '0');\n        const { appId, persistentId, codeHash, apiKey } = this.sessionSpec;\n        if (!apiKey) return `snapshots/${this.id}/${paddedTime}_${seq}-${hash}.snap`;\n        return `apps/${appId}/snap/${codeHash}/${persistentId}.${this.id}/${paddedTime}_${seq}.${hash}`;\n    }\n\n    hashSnapshot(snapshot) {\n        // returns a Promise if hash isn't available yet\n        if (snapshot.meta.hash) return snapshot.meta.hash;\n        if (!snapshot.meta.hashPromise) {\n            snapshot.meta.hashPromise = new Promise(resolve => {\n                // exclude meta data, which has the current (real-world) time in it\n                const snapshotWithoutMeta = {...snapshot};\n                delete snapshotWithoutMeta.meta;\n                hashString(JSON.stringify(snapshotWithoutMeta))\n                .then(hash => {\n                    snapshot.meta.hash = hash;\n                    delete snapshot.meta.hashPromise;\n                    resolve(hash);\n                    });\n                });\n        }\n        return snapshot.meta.hashPromise;\n    }\n\n    uploadServer(apiKeysWithBackend) {\n        // allow overrides (should also allow override via backend?)\n        if (typeof urlOptions.files === \"string\") {\n            let url = new URL(urlOptions.files, window.location).href;\n            if (url.endsWith('/')) url = url.slice(0, -1);\n            return { url, apiKey: null };\n        }\n        const {apiKey, signServer} = this.getBackend(apiKeysWithBackend);\n        if (signServer === \"none\" && !DEBUG.offline) {\n            throw Error(\"no file server configured\");\n        }\n        return { url: signServer, apiKey };\n    }\n\n    /* upload a snapshot to the file server, optionally with a dissident argument that the reflector can interpret as meaning that this is not the snapshot to serve to new clients */\n    async uploadSnapshot(snapshot, auditStats, dissidentFlag=null) {\n        await this.hashSnapshot(snapshot);\n        const start = Stats.begin(\"snapshot\");\n        const content = JSON.stringify(snapshot);\n        const stringMS = Stats.end(\"snapshot\") - start;\n        if (DEBUG.snapshot) console.log(this.id, `snapshot stringified (${content.length} bytes) in ${Math.ceil(stringMS)}ms`);\n\n        const {time, seq, hash} = snapshot.meta;\n        const socket = this.connection.socket;\n        try {\n            const url = await this.uploadEncrypted({\n                content,\n                path: this.snapshotPath(time, seq, hash),\n                key: this.key,\n                gzip: true,\n                debug: DEBUG.snapshot,\n                what: \"snapshot\",\n            });\n            if (this.connection.socket !== socket) { console.warn(this.id, \"Controller was reset while trying to upload snapshot\"); return false; }\n            this.announceSnapshotUrl(time, seq, hash, url, auditStats, dissidentFlag);\n            return true;\n        } catch (e) { console.error(this.id, \"Failed to upload snapshot\"); return false; }\n    }\n\n    // was sendSnapshotToReflector\n    announceSnapshotUrl(time, seq, hash, url, auditStats, dissidentFlag) {\n        if (DEBUG.snapshot) {\n            let logProps = `time: ${time}, seq: ${seq}, hash: ${hash}`;\n            if (dissidentFlag) logProps += \", as dissident; \" + JSON.stringify(dissidentFlag);\n            console.log(this.id, `sending snapshot url to ${REFL_OR_SYNCH} (${logProps}): ${url}`);\n        }\n        try {\n            this.connection.send(JSON.stringify({\n                id: this.id,\n                action: 'SNAP',\n                args: {time, seq, hash, url, auditStats, dissident: dissidentFlag},\n            }));\n        } catch (e) {\n            console.error(\"ERROR while sending\", e);\n        }\n        if (this.diverged) {\n            // for debugging: send snapshot URLs to all peers\n            this.vm.publishFromView(\"__VM__\", \"__diverged__\", { key: `@${time}#${seq}`, url, dissident: dissidentFlag });\n            // VM calls diffDivergedSnapshots() once 2 URLs have been received\n        }\n    }\n\n\n    async diffDivergedSnapshots(urls) {\n        // could force reload here, but for now we just do a diff\n        const snapshots = await Promise.all(urls.map(url => this.downloadEncrypted({url, gzip: true, key: this.key, debug: DEBUG.snapshot, json: true, what: \"diverged snapshot\"})));\n        for (const snapshot of snapshots) delete snapshot.meta;\n        // we could deserialize the snapshots and compare the resulting VMs,\n        // but for now we just compare the JSON, which is simpler and faster\n        let differences = 0;\n        diffJSON(snapshots[0], snapshots[1], \"CROQUETVM\");\n        if (!differences) console.log(\"... but diverged snapshots are identical?!\");\n        else console.log(`Total ${differences} differences between diverged snapshots:`, snapshots.slice(0, 2));\n        debugger; // eslint-disable-line no-debugger\n\n        function diffJSON(a, b, path) {\n            if (typeof a !== typeof b) {\n                console.log(`${path} diverged (${typeof a} vs ${typeof b}):`, a, b);\n                differences++;\n            } else if (Array.isArray(a) !== Array.isArray(b)) {\n                console.log(`${path} diverged (array vs object):`, a, b);\n                differences++;\n            } else if (typeof a === \"object\") {\n                const aKeys = a ? Object.keys(a) : [];\n                const bKeys = b ? Object.keys(b) : [];\n                const aOnly = aKeys.filter(k => !bKeys.includes(k));\n                const bOnly = bKeys.filter(k => !aKeys.includes(k));\n                if (aOnly.length || bOnly.length) {\n                    console.log(`${path} diverged (keys mismatch):`, aOnly, bOnly);\n                    differences++;\n                }\n                for (const k of aKeys) if (bKeys.includes(k)) {\n                    diffJSON(a[k], b[k], `${path}${propertyAccessor(a, k)}`);\n                }\n            } else if (a !== b) {\n                console.log(`${path} diverged (value mismatch):`, a, b);\n                differences++;\n            }\n        }\n    }\n\n    async downloadEncrypted({url, gzip, key, debug, json, what}) {\n        // TODO: move to worker\n        if (url.startsWith(OLD_UPLOAD_SERVER)) url = url.replace(OLD_UPLOAD_SERVER, OLD_DOWNLOAD_SERVER);\n        const offline = url.startsWith(\"offline:\");\n        const maxRetries = offline ? 1 : 3; // plus initial try\n        let timer = Date.now();\n        const response = await this.fetchWithRetries(`fetching ${what}`, [], maxRetries, () => {\n            return offline\n                ? this.fetchOffline(url, what, debug)\n                : fetch(url, {\n                    method: \"GET\",\n                    mode: \"cors\",\n                    referrer: App.referrerURL(),\n                    });\n        });\n        const encrypted = await response.arrayBuffer();\n        if (debug) console.log(this.id, `${what} fetched (${encrypted.byteLength} bytes) in ${-timer + (timer = Date.now())}ms`);\n        Stats.addNetworkTraffic(`${what}_in`, encrypted.byteLength);\n        const decrypted = this.decryptBinary(encrypted, key); // Uint8Array\n        if (debug) console.log(this.id, `${what} decrypted (${decrypted.length} bytes) in ${-timer + (timer = Date.now())}ms`);\n        const uncompressed = gzip ? pako.inflate(decrypted) : decrypted;\n        if (debug && gzip) console.log(this.id, `${what} inflated (${uncompressed.length} bytes) in ${-timer + (timer = Date.now())}ms`);\n        return json ? JSON.parse(new TextDecoder().decode(uncompressed)) : uncompressed;\n    }\n\n    async fetchOffline(url, what, debug) {\n        // offline files are stored in the upload worker\n        const job = ++UploadJobs;\n        return new Promise( (resolve, reject) => {\n            // subtle difference in available methods\n            const adder = NODE ? \"addListener\" : \"addEventListener\";\n            const remover = NODE ? \"removeListener\" : \"removeEventListener\";\n            UploadWorker.postMessage({\n                job,\n                cmd: \"getOfflineFile\",\n                url,\n                id: this.id,\n                what,\n                debug,\n                offline: DEBUG.offline,\n            });\n            const onmessage = msg => {\n                if (job !== msg.data.job) return; // will be dealt with by that job's listener\n                const {ok, status, statusText, body, bytes} = msg.data;\n                Stats.addNetworkTraffic(`${what}_out`, bytes);\n                UploadWorker[remover](\"message\", onmessage);\n                if (ok) resolve({ arrayBuffer: () => body });\n                else reject(Error(`${status}: ${statusText}`));\n            };\n            try {\n                UploadWorker[adder](\"message\", onmessage);\n            } catch (e) { console.log(\"failed to add listener\", e); }\n        });\n\n    }\n\n    /** upload string or array buffer as binary encrypted, optionally gzipped\n     *\n     * if path contains %HASH% it will be replaced by the hash after encryption\n     */\n    async uploadEncrypted({content, path, key, gzip, keep, debug, what}) {\n        // leave actual work to our UploadWorker\n        const buffer = typeof content === \"string\" ? new TextEncoder().encode(content).buffer : content;\n        const transfer = keep ? undefined : [buffer];\n        const keyBase64 = typeof key === \"string\" ? key : Base64.stringify(key);\n        const { apiKey, appId, persistentId } = this.sessionSpec;\n        const job = ++UploadJobs;\n        return new Promise( (resolve, reject) => {\n            // subtle difference in available methods\n            const adder = NODE ? \"addListener\" : \"addEventListener\";\n            const remover = NODE ? \"removeListener\" : \"removeEventListener\";\n            UploadWorker.postMessage({\n                job,\n                cmd: \"uploadEncrypted\",\n                server: this.uploadServer(apiKey),\n                path,\n                buffer,\n                keyBase64,\n                gzip,\n                referrer: App.referrerURL(),\n                id: this.id,\n                appId,\n                persistentId,\n                CROQUET_VERSION,\n                debug,\n                what,\n                offline: DEBUG.offline,\n            }, transfer);\n            const onmessage = msg => {\n                if (job !== msg.data.job) return; // will be dealt with by that job's listener\n                const {url: urlWithHash, ok, status, statusText, bytes} = msg.data;\n                Stats.addNetworkTraffic(`${what}_out`, bytes);\n                UploadWorker[remover](\"message\", onmessage);\n                if (ok) resolve(urlWithHash);\n                else reject(Error(`${status}: ${statusText}`));\n            };\n            try {\n            // UploadWorker.addEventListener(\"message\", onmessage);\n            UploadWorker[adder](\"message\", onmessage);\n            } catch (e) { console.log(\"failed to add listener\", e); }\n        });\n    }\n\n    persistentPath(hash) {\n        const { appId, persistentId } = this.sessionSpec;\n        return `apps/${appId}/${persistentId}/save/${hash}`;\n    }\n\n    pollForPersist(vmTime, persistTime, persistentString, persistentHash, ms) {\n        if (!this.synced) return; // ignore during fast-forward\n        if (!this.sessionSpec.appId) throw Error(\"Persistence API requires appId\");\n        if (DEBUG.offline) return; // don't bother if offline\n\n        const ourVote = {\n            viewId: this.viewId,                // to identify our own vote\n            hash: persistentHash,               // if this differs, each group will upload\n            ms: ms + Math.random() * 0.001,     // for sorting within a group, plus add a tiny bit of randomness\n            };\n        const localContext = { persistTime, persistentHash, persistentString }; // will be supplied with the tally\n        if (DEBUG.snapshot) console.log(this.id, `sending persistence vote for time @${persistTime}`, ourVote);\n        this.sendTutti({ time: vmTime, topic: \"persist\", data: ourVote, localContext, tallyTarget: [\"handlePersistVote\"] });\n    }\n\n    async handlePersistVote(data) {\n        // !!! THIS IS BEING EXECUTED INSIDE THE SIMULATION LOOP!!!\n\n        const { tally, localContext } = data;\n        if (DEBUG.snapshot) {\n            const tookPart = !!localContext;\n            const timeString = tookPart ? `for time @${localContext.persistTime}` : \"that we didn't participate in\";\n            console.log(this.id, `received persistence vote ${timeString}`, tally);\n        }\n\n        const { numberOfGroups, shouldUpload, dissidentFlag } = this.analyzeTally(tally, \"ms\");\n        if (numberOfGroups > 1) console.warn(this.id, `Persistence records fall into ${numberOfGroups} groups`);\n        if (!shouldUpload || !localContext) return;\n\n        const { persistTime, persistentHash, persistentString } = localContext;\n        this.doPersist(persistTime, persistentString, persistentHash, dissidentFlag);\n    }\n\n    async doPersist(persistTime, persistentString, persistentHash, dissidentFlag) {\n        const url = await this.uploadEncrypted({\n            path: this.persistentPath(persistentHash),\n            content: persistentString,\n            key: this.key,\n            gzip: true,\n            debug: DEBUG.snapshot,\n            what: \"persistence\",\n        });\n        if (DEBUG.snapshot) {\n            const logProps = dissidentFlag ? ` (as dissident; ${JSON.stringify(dissidentFlag)})` : \"\";\n            console.log(this.id, `sending persistent data url to ${REFL_OR_SYNCH}${logProps}: ${url}`);\n        }\n        try {\n            this.connection.send(JSON.stringify({\n                id: this.id,\n                action: 'SAVE',\n                args: { persistTime, url, dissident: dissidentFlag },\n            }));\n        } catch (e) {\n            console.error(\"ERROR while sending\", e);\n        }\n    }\n\n    // Forced Persistence works without a vote even during fast-forward\n    // It is enabled by the forcePersist URL option\n\n    async forcePersist(persistTime, persistentString, persistentHash) {\n        // we are outside the simulation. Something triggered a persistSession call.\n        // the data may or may not be unchanged from the last time we persisted.\n        // Persist immediately, without voting, but only once.\n        if (this.didForcePersist) {\n            console.warn(this.id, \"forcePersist called more than once, ignoring\");\n            return;\n        }\n        console.warn(this.id, `forcePersist, will upload ${persistentString.length} bytes`);\n        if (urlOptions.forcePersist === \"alert\") {\n            confirm(\"forcePersist triggered. Do it?\"); // eslint-disable-line no-alert,no-restricted-globals\n        }\n        debugger; // eslint-disable-line no-debugger\n        await this.doPersist(persistTime, persistentString, persistentHash);\n        console.warn(this.id, `forcePersist completed`);\n        this.didForcePersist = true;\n    }\n\n    // convert a message generated by the reflector itself to our own format\n    convertReflectorMessage(msg) {\n        // default to do nothing\n        let selector = \"noop\";\n        let args = [];\n        // build message\n        switch (msg[2].what) {\n            case \"users\": {\n                // get arguments\n                const {joined, left, active, total} = msg[2];\n                this.users = active;\n                this.usersTotal = total;\n                // create event\n                const scope = \"__VM__\";\n                const event = \"__peers__\";\n                const payload = {entered: joined||[], exited: left||[], count: active, total};\n                for (const user of payload.entered.concat(payload.exited)) {\n                    if (!user.data) continue;\n                    user.data = this.decryptPayload(user.data);\n                }\n                // create event message\n                selector = \"publishFromModelOnly\";\n                args = [scope, event, payload];\n                // also immediately publish as view event, which this controller will\n                // have subscribed to (in its constructor).\n                viewDomain.handleEvent(this.viewId + ':__views__', payload.count);\n                break;\n            }\n            case \"tally\": {\n                // an old reflector will send a property tuttiSeq containing the dummy\n                // sequence number that we provided; a new reflector will notice that we\n                // provided a tuttiKey, and will send just that.\n                // the reflector's message also contains the tally, and optionally a tallyTarget\n                // message to be dispatched by the VM.\n                const { tuttiSeq, tuttiKey, tally, tallyTarget, missingClients } = msg[2];\n                if ((DEBUG.messages || DEBUG.snapshot) && missingClients) console.log(`${missingClients} ${missingClients === 1 ? \"client\" : \"clients\"} failed to participate in tally ${tuttiKey || tuttiSeq}`); // purely for information\n                selector = \"handleTuttiResult\";\n                args = [ { tuttiSeq, tuttiKey, tally, tallyTarget } ];\n                break;\n            }\n            case \"audit\": {\n                const time = msg[0];\n                if (DEBUG.messages) console.log(`audit request at time ${time}`);\n                selector = \"handleAuditRequest\";\n                args = [ { time } ];\n                break;\n            }\n            // no default\n        }\n        // convert to serialized state\n        const message = new Message(0, 0, \"_\", selector, args);\n        msg[2] = message.asState()[2];\n    }\n\n    handleTuttiResult(data) {\n        // !!! THIS IS BEING EXECUTED INSIDE THE SIMULATION LOOP!!!\n        const { tuttiSeq, tuttiKey, tally, tallyTarget } = data;\n        const finder = tuttiKey\n            ? (hist => hist.tuttiKey === tuttiKey)\n            : (hist => hist.dummyTuttiSeq === tuttiSeq);\n        const tuttiIndex = this.tuttiHistory.findIndex(finder);\n        const local = tuttiIndex !== -1 && this.tuttiHistory.splice(tuttiIndex, 1)[0];\n        // if we have a record of supplying a vote for this TUTTI, retrieve our contribution and any local context\n        let localPayload = null, localContext = null;\n        if (local) {\n            localPayload = local.payload;  // stringified\n            localContext = local.localContext;\n        }\n        if (tallyTarget) {\n            const [selector, ...optionalTopic] = tallyTarget;\n            const args = [ ...optionalTopic, { tally, localPayload, localContext } ];\n            const message = new Message(0, 0, \"_\", selector, args);\n            this.vm.verifyExternal(message); // may throw\n            message.executeOn(this.vm, true); // true => nested\n        }\n    }\n\n    handleAuditRequest(data) {\n        // !!! THIS IS BEING EXECUTED INSIDE THE SIMULATION LOOP!!!\n\n        // if this is during fast-forward, we do need to reset the progress-verification\n        // stats (payloadTally, etc), but not the network stats - and don't share our values.\n        const { time } = data;\n        if (this.vm.time !== time) console.error(`time ${this.vm.time} cf audit time ${time}`);\n\n        const { auditStats } = this;\n        const { lastUsers, minUsers, maxUsers, payloadTally, sessionTimeAtDispatch } = auditStats;\n        auditStats.payloadTally = 0;\n        if (this.vm.time > sessionTimeAtDispatch) {\n            auditStats.minUsers = auditStats.maxUsers = lastUsers; // number starting the new work unit\n        }\n\n        if (!this.fastForwardHandler) { // skipped during fast-forward\n            const bytesIn = Stats.networkTraffic.audit_reflector_in || 0;\n            const bytesOut = Stats.networkTraffic.audit_reflector_out || 0;\n            Stats.resetAuditStats();\n            const { clientId } = this.connection.socket; // random id assigned by CroquetWebRTCConnection\n            // having gathered the stats we need, schedule the actual reporting outside\n            // the simulation\n            queueMicrotask(() => {\n                if (DEBUG.session) console.log(this.id, `handling audit request at ${time} after ${bytesIn} bytes in, ${bytesOut} out`);\n                const encodedStats = encodeURIComponent(JSON.stringify({ time, clientId, lastUsers, minUsers, maxUsers, payloadTally, bytesIn, bytesOut }));\n                const url = `${DEPIN_API}/clients/report?session=${this.id}&stats=${encodedStats}`.replace('ws', 'http');\n                fetch(url, { mode: \"no-cors\" }); // not interested in a response\n            });\n        }\n    }\n\n    handleUserTotalForAccounting(total) {\n        // this is invoked by the VM when handling a 'users' message\n        if (DEPIN) {\n            const { auditStats } = this;\n            auditStats.lastUsers = total;\n            if (this.vm.time <= auditStats.sessionTimeAtDispatch) return;\n\n            if (auditStats.minUsers === -1 || total < auditStats.minUsers) auditStats.minUsers = total;\n            if (total > auditStats.maxUsers) auditStats.maxUsers = total;\n        }\n    }\n\n    messageSizeForAccounting(msg) {\n        let messageSize = typeof msg[2] === \"string\"\n            ? msg[2].length\n            : msg[2]._size || 0; // older synchronizers/reflectors do not have _size\n        messageSize += 16; // agreed with synchronizer to represent overhead\n        return messageSize;\n    }\n\n    // handle messages from reflector\n    async receive(action, args) {\n        const prevReceived = this.lastReceived;\n        this.lastReceived = this.connection.lastReceived;\n        switch (action) {\n            case 'SYNC': {\n                // We are joining a session.\n                this.syncReceived = true; // from this point, any disconnection implies a leave()\n                this.clearSyncReceiptTimeout();\n\n                Controllers.add(this);\n\n                // if join request included a progressReporter, prepare to call it\n                const { progressReporter } = this.sessionSpec;\n                const reportProgress = progressReporter || (() => {});\n\n                const {messages, url, persisted, time, seq, /* snapshotTime, */ snapshotSeq, tove, reflector, flags, auditStatsInitializer} = args;\n                // check that we are able to decode a shared secret (unless it's our own)\n                if (tove && tove !== this.tove) try {\n                    // decrypt will throw if it can't decrypt, which is the expected result if joining with a wrong password\n                    if (this.decrypt(tove) !== this.id) throw Error(\"wrong sessionId in tove?!\");\n                } catch (err) {\n                    this.connection.closeConnectionWithError('SYNC', Error(`session password check: ${err.message}`), 4200); // do not retry\n                    reportProgress(-1); // failure\n                    return;\n                }\n                const timeline = args.timeline;\n                this.flags = flags || {};\n                const persistedOrSnapshot = persisted ? \"persistence\" : \"snapshot\"; // used as Stats key too\n                if (DEBUG.session) console.log(this.id, `received SYNC from ${reflector} ${REFL_OR_SYNCH}: time ${time}, ${messages.length} messages, ${persistedOrSnapshot} ${url || \"<none>\"}`);\n                // if we are rejoining, check if we can do that seamlessly without taking down the view\n                // meaning we have all the messages we missed while disconnected\n                let rejoining = !!this.vm;\n                if (rejoining) {\n                    // In theory we could try to preserve unsimulated messages but that would complicate the logic\n                    // considerably, and only help in the rather unlikely case of a snapshot being taken while simulation\n                    // was backlogged, in which case it might be better to start from the new snapshot anyways.\n                    // Instead, we just make make sure no old messages are hanging around:\n                    this.networkQueue.length = 0;\n                    // old reflector does not send seq, snapshotSeq, timeline, cannot rejoin\n                    const sameSession  = !!timeline && timeline === this.timeline;\n                    const firstMessage = messages[0];\n                    const newest = seq;\n                    const oldest = snapshotSeq !== undefined ? snapshotSeq\n                        : firstMessage ? firstMessage[1] : newest;\n                    if (DEBUG.messages) console.log(this.id, `rejoin: we have #${this.vm.seq} SYNC has #${oldest}-#${newest}`);\n                    let seamlessRejoin = sameSession         // must be same timeline (in case we are connected to stateless reflector)\n                        && inSequence(oldest, this.vm.seq)   // there must be no gap between our last message and the first synced message\n                        && inSequence(this.vm.seq, newest)   // the reflector state must not be older than our vm (presumably due to reflector crash and restart)\n                        && time >= this.reflectorTime; // similarly, the reflector must not be providing an earlier time than we have already seen\n                    if (seamlessRejoin) {\n                        // rejoin appears safe.  figure out what messages (if any) in the SYNC have already\n                        // been processed here.\n                        let toDiscard = 0;\n                        if (firstMessage && inSequence(firstMessage[1], this.vm.seq)) {\n                            toDiscard = this.vm.seq - firstMessage[1] + 1 >>> 0; // 32 bit difference (!)\n                        }\n\n                        // if the messages to be processed to catch up include a 'users' event\n                        // reporting that this view has left, rejoin is not safe after all.\n                        // this is a conservative check; it's possible that the event represents\n                        // a harmless and ignorable view-exit for a duplicate connection.  but\n                        // attempting to replicate the VM's extraConnections logic here feels\n                        // like overkill.\n                        for (let i = toDiscard; seamlessRejoin && i < messages.length; i++) {\n                            const payload = messages[i][2];\n                            if (typeof payload !== \"string\" && payload.what === \"users\" && payload.left && payload.left.includes(this.viewId)) {\n                                if (DEBUG.session) console.log(this.id, `${REFL_OR_SYNCH} reports that this view has left`);\n                                seamlessRejoin = false;\n                            }\n                        }\n\n                        if (seamlessRejoin && toDiscard) {\n                            // we're going ahead with seamless rejoin.  discard the duplicates found above.\n                            if (DEBUG.messages) console.log(this.id, `rejoin: discarding ${toDiscard} messages #${firstMessage[1]}-#${this.vm.seq}`);\n                            messages.splice(0, toDiscard);\n                        }\n                    }\n                    if (seamlessRejoin) {\n                        // send out messages we buffered while disconnected\n                        if (this.sendBuffer.length > 0) {\n                            const sends = this.sendBuffer;\n                            this.sendBuffer = [];   // if we get disconnected again, sends will be re-buffered\n                            if (DEBUG.session) console.log(this.id, `rejoin: sending ${sends.length} messages buffered while disconnected`);\n                            for (const f of sends) f();\n                        }\n                        // proceed to enqueue the messages we missed while disconnected\n                    } else {\n                        // one of the checks above has found that seamless rejoin cannot happen.  reboot.\n                        if (DEBUG.session) console.log(this.id, \"cannot rejoin seamlessly; rebooting model/view\");\n                        this.leave(true); // keep controller but reset it, nulling out the vm.  now runs straight through to the end of establishSession.\n                        rejoining = false;\n                    }\n                }\n                // enqueue all messages now because the reflector will start sending more messages\n                // while we are waiting for the snapshot.\n                // if any conversion of custom reflector messages is to be done, do it before\n                // waiting for the snapshot to arrive (because there might be some meta-processing\n                // that happens immediately on conversion; this is the case for \"users\" messages)\n                const messagesSinceSync = this.networkQueue; // in case we RECVed during the await above\n                this.networkQueue = [];\n                for (const msg of messages) {\n                    const messageSize = this.messageSizeForAccounting(msg); // before any conversion\n                    if (typeof msg[2] !== \"string\") {\n                        this.convertReflectorMessage(msg);\n                    } else try {\n                        msg[2] = this.decryptPayload(msg[2])[0];\n                    } catch (err) {\n                        this.connection.closeConnectionWithError('SYNC', Error(`session password decrypt: ${err.message}`), 4200); // do not retry\n                        reportProgress(-1); // failure\n                        return;\n                    }\n                    if (DEBUG.messages) console.log(this.id, \"received in SYNC \" + JSON.stringify(msg));\n                    this.networkQueue.push([msg, messageSize]);\n                }\n                this.networkQueue.push(...messagesSinceSync);\n                if (time > this.reflectorTime) this.timeFromReflector(time, \"reflector\");\n                // if we were rejoining, then our work is done here: we got all the missing messages (and no need to report join progress)\n                if (rejoining) {\n                    if (DEBUG.session) console.log(this.id, \"seamless rejoin successful\");\n                    this.syncCompleted = true;\n                    return;\n                }\n                this.timeline = timeline || \"\"; // stored only on initial connection\n                // otherwise we need go to work\n                if (DEBUG.snapshot && url) console.log(this.id, `fetching ${persistedOrSnapshot} ${url}`);\n                let data;\n                if (url) try {\n                    data = await this.downloadEncrypted({url, gzip: true, key: this.key, debug: DEBUG.snapshot, json: true, what: persistedOrSnapshot});\n                } catch (err) {\n                    this.connection.closeConnectionWithError('SYNC', Error(`failed to fetch ${persistedOrSnapshot}: ${err.message}`), 4200); // do not retry.  synchronously nulls out socket.\n                    reportProgress(-1); // failure\n                    return;\n                }\n                if (!this.connected) {\n                    // socket connection went away while we were fetching\n                    console.log(this.id, \"disconnected during SYNC\");\n                    reportProgress(-1); // failure\n                    return;\n                }\n                if (persisted) {\n                    // run initFn() with persisted data, if any\n                    if (this.migratingOldSnapshot) throw Error(\"hashOverride is enabled but got persisted data instead of snapshot\");\n                    this.install(data);\n                } else {\n                    if (data) this.sessionSpec.snapshot = data;  // set snapshot for building the vm\n                    this.install();  // will run initFn() if no snapshot\n                }\n                if (auditStatsInitializer) {\n                    if (DEBUG.session) console.log(this.id, `installing audit stats: ${JSON.stringify(auditStatsInitializer)}`);\n                    this.auditStats = auditStatsInitializer;\n                }\n                // after install() sets this.vm, the main loop may also trigger simulation\n                if (DEBUG.session) console.log(this.id, `fast-forwarding from ${Math.round(this.vm.time)} to at least ${time}`);\n                const fastForwardStart = this.vm.time;\n                // execute pending events, up to (at least) our own view-join\n                const success = await new Promise(resolve => {\n                    const { port1, port2 } = new MessageChannel();\n                    port1.onmessage = () => {\n                        // function to be called from fastForwardHandler below, using channel\n                        // messaging so that we first yield execution to allow any\n                        // accumulated ticks and events from the reflector to be ingested.\n                        // this will work even in cases where setTimeout(0) would not.\n                        let runAgain = true;\n                        if (!this.vm) {\n                            if (DEBUG.session) console.log(this.id, \"disconnected during SYNC fast-forwarding\");\n                            reportProgress(-1); // failure\n                            resolve(false);\n                            runAgain = false;\n                        } else if (this.vm.time === this.reflectorTime) {\n                            if (this.viewId in this.vm.views) {\n                                reportProgress(1); // success\n                                resolve(true);\n                                runAgain = false;\n                            }\n                        } else {\n                            const progress = (this.vm.time - fastForwardStart) / (this.reflectorTime - fastForwardStart);\n                            reportProgress(progress);\n                        }\n                        if (runAgain) this.stepSession(\"fastForward\", { budget: MAX_SIMULATION_MS });\n                    };\n                    const checkAfterServicingTicks = () => port2.postMessage('tick');\n\n                    this.fastForwardHandler = caughtUp => {\n                        if (!this.connected || !this.vm) {\n                            console.log(this.id, \"disconnected during SYNC fast-forwarding\");\n                            reportProgress(-1); // failure\n                            resolve(false);\n                        } else if (caughtUp === \"error\") {\n                            reportProgress(-1); // failure\n                            resolve(false);\n                        } else {\n                            checkAfterServicingTicks();\n                        }\n                    };\n\n                    queueMicrotask(() => this.stepSession(\"fastForward\", { budget: MAX_SIMULATION_MS })); // immediate but not in the message handler\n                    });\n                delete this.fastForwardHandler;\n                if (success) {\n                    if (DEBUG.session) console.log(this.id, `fast-forwarded to ${Math.round(this.vm.time)}`);\n                    if (this.vm.diverged) App.showMessage(`${App.libName}: session had diverged. Try CROQUETVM.debugDiverged()`, { level: \"warning\", only: \"once\" });\n                    // iff fast-forward was successful, trigger return from establishSession().\n                    // otherwise, in due course we'll reconnect and try again.  it can keep waiting.\n                    this.sessionSpec.sessionJoined();\n                }\n                return;\n            }\n            case 'RECV': {\n                // We received a message from reflector.\n                // Put it in the queue, and set time.\n                // Actual processing happens in main loop.\n                // The 'args' object on a RECV is an array [time, seq, payload, ...]\n                const msg = args;\n                msg[1] >>>= 0; // make sure it's uint32 (reflector used to send int32)\n                // the reflector can insert messages on its own, indicated by a payload\n                // that is not a string but an object with a 'what' property (currently\n                // just 'users' or 'tally').\n                // we convert the payload to the same format as used in stringy messages.\n                const messageSize = this.messageSizeForAccounting(msg); // before any conversion\n                if (typeof msg[2] !== \"string\") {\n                    if (DEBUG.messages) console.log(this.id, \"received META \" + JSON.stringify(msg));\n                    this.convertReflectorMessage(msg); // replaces msg[2] with a fabricated encoding of (receiver, selector, args), usable like msgPayload below\n                    if (DEBUG.messages) console.log(this.id, \"converted to \" + JSON.stringify(msg));\n                } else try {\n                    // a non-meta message is an array [msgPayload, viewId, sendTime],\n                    // JSONified then encrypted by the sending client.\n                    // msgPayload is a stringy encoding of (receiver, selector, args) -\n                    // with numerical replacements for the common selectors, short refs\n                    // for model args, etc.\n                    const [msgPayload, viewId, lastSent] = this.decryptPayload(msg[2]);\n                    msg[2] = msgPayload;\n                    // if we sent this message, add it to latency statistics\n                    if (viewId === this.viewId) this.addToStatistics(lastSent, this.lastReceived);\n                    if (DEBUG.messages) console.log(this.id, \"received \" + JSON.stringify(msg));\n                } catch (err) {\n                    this.connection.closeConnectionWithError(\"RECV\", Error(`session password decrypt: ${err.message}`), 4200); // do not retry\n                    return;\n                }\n                this.networkQueue.push([msg, messageSize]);\n                let rawTime;\n                if (this.flags.rawtime) rawTime = msg[msg.length - 1];\n                this.timeFromReflector(msg[0], \"reflector\", rawTime);\n                if (this.simulateIfNeeded) queueMicrotask(() => this.simulateIfNeeded()); // immediate but not in the message handler\n                return;\n            }\n            case 'TICK': {\n                // We received a tick from reflector.\n                // Just set time so main loop knows how far it can advance.\n                if (!this.vm) return; // ignore ticks before we are simulating (this also catches any ticks received during reboot)\n                const time = (typeof args === \"number\") ? args : args.time;\n                if (DEBUG.ticks) {\n                    const jitter = prevReceived && this.lastReceived - prevReceived - this.msPerTick * this.tickMultiplier | 0;\n                    const delta = time - this.vm.time;\n                    console.log(this.id, `received TICK ${time} ${Math.abs(jitter) < 5 ? \"on time\" : jitter < 0 ? \"early\" : \"late\"} (${delta} ms, jitter ${jitter>0?'+':''}${jitter} ms)`);\n                }\n                this.timeFromReflector(time, \"reflector\");\n                if (this.tickMultiplier > 1) this.multiplyTick(time);\n                if (this.simulateIfNeeded) queueMicrotask(() => this.simulateIfNeeded()); // immediate but not in the message handler\n                return;\n            }\n            case 'INFO': {\n                // information the reflector wants us to know\n                // for the moment just show it\n                const { msg, options } = args;\n                const prefix = DEPIN ? \"Multisynq Synchronizer\" : \"Croquet Reflector\";\n                App.showMessage(`${prefix}: ${msg}`, options);\n                return;\n            }\n            case 'REQU': {\n                // reflector requests a snapshot\n                if (DEBUG.snapshot) console.log(`received REQU (snapshot request) from ${REFL_OR_SYNCH}`);\n                this.reflectorNeedsSnapshot = true;\n                return;\n            }\n            case 'RECONNECT': {\n                // currently only sent from a DePIN synchronizer, when it's about\n                // to bail out and wants us to reconnect so we'll find a new one.\n                this.connection.socket?.synchronizerDisconnected(4003, 'told to reconnect');\n                break;\n            }\n            default: console.warn(\"Unknown action:\", action, args);\n        }\n    }\n\n    // create the VirtualMachine for this Controller, based on the sessionSpec\n    install(persistentData) {\n        const start = Date.now();\n        const {snapshot, initFn, options, debugEvents } = this.sessionSpec;\n        const [verb, noun] = snapshot.models ? [\"deserializ\", \"snapshot\"] : [\"initializ\", \"root model\"];\n        if (DEBUG.session) console.log(this.id, `${verb}ing ${noun}`);\n        let newVM = new VirtualMachine(snapshot, debugEvents, () => {\n            try { return initFn(options, persistentData); }\n            catch (error) {\n                displayAppError(\"init\", error, \"fatal\");\n                throw error; // unrecoverable.  bring the whole tab to a halt.\n            }\n        }, this.migratingOldSnapshot);\n        if (DEBUG.session || (DEBUG.snapshot && snapshot.models)) {\n            console.log(this.id, `${noun} ${verb}ed in ${Date.now() - start}ms`);\n        }\n        if (DEBUG.initsnapshot && !snapshot.models) {\n            // exercise serializer if we came from initFn\n            if (DEBUG.snapshot) console.log(this.id, `exercising snapshot and restore after init()`);\n            let initialSnapshot = null;\n            try { initialSnapshot = JSON.stringify(newVM.snapshot()); }\n            catch (error) {\n                displayAppError(\"initial snapshot\", error, \"fatal\");\n                throw error; // unrecoverable.  bring the whole tab to a halt\n            }\n            try {\n                newVM = new VirtualMachine(JSON.parse(initialSnapshot), debugEvents, () => initFn(options));\n            } catch (error) {\n                displayAppError(\"initial snapshot resume\", error, \"fatal\");\n                throw error; // unrecoverable.  bring the whole tab to a halt\n            }\n        }\n        // our time is the latest of this.reflectorTime (we may have received a tick already) and the vm time in the snapshot\n        const vmTime = this.lastKnownTime(newVM);\n        this.reflectorTime = Math.max(this.reflectorTime, vmTime);\n        this.setVM(newVM); // make this our vm\n    }\n\n    setVM(vm) {\n        this.vm = vm;\n        this.vm.controller = this;\n    }\n\n    // // create a VM in its initial state\n    // createCleanVM() {\n    //     const { options, initFn } = this.sessionSpec;\n    //     const snapshot = { id: this.id };\n    //     return new VirtualMachine(snapshot, () => initFn(options));\n    // }\n\n    // network queue\n\n    sendJoin() {\n        this.syncReceived = false; // until SYNC is received, a dropped connection doesn't require controller.leave()\n        this.syncCompleted = false; // until the end of SYNC, send nothing to the reflector other than a JOIN\n        delete this.fastForwardHandler; // in case one was left\n\n        // cancel rejoin timeout (if any) immediately.  now that we're reconnected, it\n        // would be messy to have a reboot triggered between now and the SYNC.\n        if (this.rejoinTimeout) { clearTimeout(this.rejoinTimeout); this.rejoinTimeout = 0; }\n\n        if (DEBUG.session) console.log(this.id, \"Controller sending JOIN\");\n\n        const { tick, delay } = this.getTickAndMultiplier();\n        const { name: specName, codeHash, appId: specAppId, apiKey: specApiKey, persistentId, developerId, heraldUrl, rejoinLimit, autoSleep, computedCodeHash, location, flags } = this.sessionSpec;\n        const name = DEPIN ? 'hiddenName' : specName;\n        const apiKey = DEPIN ? 'hiddenApiKey' : this.getBackend(specApiKey).apiKey;\n        const appId = DEPIN ? 'hiddenAppId' : specAppId;\n        const url = DEPIN ? 'hiddenUrl' : App.referrerURL();\n        const user = this.viewDataEncrypted ? { id: this.viewId, data: this.viewDataEncrypted } :\n            location ? [this.viewId] : this.viewId;\n\n        const args = {\n            // hidden on DePIN...\n            name,                   // for debugging only\n            apiKey,                 // undefined in old clients\n            appId,                  // for sign func\n            url,                    // for sign func\n            // ...to here\n            persistentId,           // for sign func\n            sdk: CROQUET_VERSION,   // for sign func\n            developerId,            // for logging\n            version: PROTOCOL_VERSION, // protocol version\n            user,                   // viewId or [viewId] or { id, data }\n            location,               // enable location data in reflector\n            ticks: { tick, delay },\n            dormantDelay: autoSleep, // not used yet, but tells reflector this client is >= 0.5.1\n            tove: this.tove,        // an encrypted message the reflector will send to every client in SYNC\n            codeHash,               // for debugging only\n        };\n        if (heraldUrl) Object.assign(args, {\n            heraldUrl,              // url to receive POST for join/leave events\n        });\n        if (rejoinLimit) Object.assign(args, {\n            leaveDelay: rejoinLimit + 250, // delay leave events\n        });\n        if (computedCodeHash !== codeHash) Object.assign(args, {\n            computedCodeHash,       // for debugging only\n        });\n        if (flags) Object.assign(args, {\n            flags,                  // flags for requesting reflector features\n        });\n\n        this.connection.send(JSON.stringify({\n            id: this.id,\n            action: 'JOIN',\n            args,\n        }));\n\n        this.syncReceiptTimeout = setTimeout(() => {\n            delete this.syncReceiptTimeout;\n            if (!this.syncReceived) {\n                this.connection.closeConnectionWithError(\"JOIN\", Error(\"Initial reflector connection timed out\"));\n            }\n            }, JOIN_FAILED_DELAY);\n    }\n\n    clearSyncReceiptTimeout() {\n        if (this.syncReceiptTimeout) {\n            clearTimeout(this.syncReceiptTimeout);\n            delete this.syncReceiptTimeout;\n        }\n    }\n\n    connectionInterrupted() {\n        // only need to leave if we have actually joined - or at least started\n        // the work of joining, in the 'SYNC' handler\n        if (!this.syncReceived) return;\n\n        if (this.shouldLeaveWhenDisconnected) this.leave(); // including if rejoinLimit=0\n        else if (!this.rejoinTimeout) {\n            // set up a timeout to leave unless the connection gets restored\n            // within rejoinLimit\n            this.rejoinTimeout = setTimeout(() => {\n                // if we've already left (e.g., due to a fatal error on attempting\n                // to reconnect), there's nothing to do here.\n                if (this.leaving) {\n                    if (DEBUG.session) console.log(this.id, `abandoning rejoin; session is defunct`);\n                    return;\n                }\n\n                if (DEBUG.session) console.log(this.id, `rejoin timed out`);\n                this.rejoinTimeout = 0;\n                this.leave();\n            }, this.sessionSpec.rejoinLimit);\n        }\n    }\n\n    // either the connection has been broken (and seamless rejoin is not\n    // available), or the reflector has sent LEAVE.\n    // reset the controller.  unless keepController is true, remove it from\n    // the Controllers set (used for keepAlive, and for accessing the data\n    // upload/download functions from Data).\n    leave(keepController=false) {\n        const { rebootModelView } = this.sessionSpec;\n        this.reset();\n        if (DEBUG.session) console.log(this.id, `resetting ${keepController ? \"(but keeping)\" : \"and discarding\"} controller`);\n        if (!keepController) Controllers.delete(this);   // after reset so it does not re-enable the SYNC overlay\n        if (!this.sessionSpec) throw Error(\"do not discard sessionSpec!\");\n        rebootModelView(); // if controller.leaving is set (user has triggered Session.leave, or session has errored), rMV will bail out after destroying the view\n    }\n\n    async encrypt(plaintext) {\n        const iv = WordArray.random(16);\n        const ciphertext = AES.encrypt(plaintext, this.key, {\n            iv,\n            // padding: Pkcs7, // default\n            // mode: CBC       // default\n          });\n        const hmac = HmacSHA256(plaintext, this.key);\n        const encrypted = `${Base64.stringify(iv)}${Base64.stringify(hmac)}${ciphertext}`;\n        return encrypted;\n    }\n\n    get deprecatedDefaultKey() {\n        if (!DEPRECATED_DEFAULT_KEY) {\n            DEPRECATED_DEFAULT_KEY = PBKDF2(\"THIS SHOULDN'T BE IN LOGS\", \"\", { keySize: 256/32, hasher: algo.SHA1, iterations: 1 });\n        }\n        return DEPRECATED_DEFAULT_KEY;\n    }\n\n    decrypt(encrypted, key=this.key) {\n        const iv = Base64.parse(encrypted.slice(0, 24));\n        const mac = Base64.parse(encrypted.slice(24, 24 + 44));\n        const ciphertext = encrypted.slice(24 + 44);\n        const decrypted = AES.decrypt(ciphertext, key, { iv });\n        let plaintext = \"\";\n        try { plaintext = Utf8.stringify(decrypted); } catch (err) { /* ignore */ }\n        const hmac = HmacSHA256(plaintext, this.key);\n        if (this.compareHmacs(mac.words, hmac.words)) return plaintext;\n        if (key !== this.deprecatedDefaultKey) return this.decrypt(encrypted, this.deprecatedDefaultKey);\n        throw Error(\"Decryption error\");\n    }\n\n    decryptBinary(buffer, key) {\n        const version = new TextDecoder().decode(new Uint8Array(buffer, 0, 4));\n        if (typeof key === \"string\") key = Base64.parse(key);\n        let encrypted, iv, mac, ciphertext, decrypted;\n        switch (version) {\n            case \"CRQ0\": // Base64\n                encrypted = new TextDecoder().decode(buffer);\n                iv = Base64.parse(encrypted.slice(4, 4 + 24));\n                mac = Base64.parse(encrypted.slice(4 + 24, 4 + 24 + 44));\n                ciphertext = encrypted.slice(4 + 24 + 44);\n                decrypted = AES.decrypt(ciphertext, key, { iv });        // implicitly creates { ciphertext }\n                break;\n            case \"CRQ1\": // Binary\n                encrypted = new Uint8Array(buffer);\n                iv = WordArray.create(encrypted.subarray(4, 4 + 16));\n                mac = WordArray.create(encrypted.subarray(4 + 16, 4 + 16 + 32));\n                ciphertext = WordArray.create(encrypted.subarray(4 + 16 + 32));\n                decrypted = AES.decrypt({ ciphertext }, key, { iv });\n                break;\n            default: throw Error(`${this.id} unknown encryption version ${version}`);\n        }\n        decrypted.clamp(); // clamping manually because of bug in HmacSHA256\n        const hmac = HmacSHA256(decrypted, key);\n        if (this.compareHmacs(mac.words, hmac.words)) return cryptoJsWordArrayToUint8Array(decrypted);\n        if (key !== this.deprecatedDefaultKey) return this.decryptBinary(buffer, this.deprecatedDefaultKey);\n        throw Error(\"Decryption error\");\n    }\n\n    async encryptMessage(msg, viewId, sendTime) {\n        const [time, seq, msgPayload] = msg.asState();\n        const encryptedPayload = await this.encryptPayload([msgPayload, viewId, sendTime]);\n        return [time, seq, encryptedPayload];\n    }\n\n    async encryptPayload(payload) {\n        return this.encrypt(JSON.stringify(payload));\n    }\n\n    decryptPayload(encrypted) {\n        return JSON.parse(this.decrypt(encrypted));\n    }\n\n    compareHmacs(fst, snd) {\n        let ret = fst.length === snd.length;\n        for (let i=0; i<fst.length; i++) {\n            if (!(fst[i] === snd[i])) {\n                ret = false;\n            }\n        }\n        return ret;\n    }\n\n    /** send a Message to all vm replicas via reflector\n     * @param {Message} msg\n    */\n    sendMessage(msg) {\n        // SEND: Broadcast a message to all participants.\n        // ignore if controller is not allowed to send, or has been reset\n        if (this.viewOnly || !this.vm) return;\n\n        const payloadLength = msg.asState()[2].length;\n        if (payloadLength > PAYLOAD_LIMIT_MAX) {\n            console.warn(this.id, `Message with payload of ${payloadLength} bytes exceeds maximum ${PAYLOAD_LIMIT_MAX} and will not be sent to ${REFL_OR_SYNCH}.`);\n            return;\n        }\n        if (!this.payloadSizeWarned && payloadLength > PAYLOAD_LIMIT_RECOMMENDED) {\n            console.log(this.id, `Message with payload of ${payloadLength} bytes being sent to ${REFL_OR_SYNCH}. Maximum recommended is ${PAYLOAD_LIMIT_RECOMMENDED}.`);\n            this.payloadSizeWarned = true;\n        }\n\n        const now = Date.now();\n        const times = this.rateLimitedSendTimes;\n        const buffer = this.rateLimitBuffer;\n        Stats.perSecondTally({ requestedMessages: 1 });\n\n        // if there are already events in the buffer, this message has to join the queue\n        if (buffer.length) {\n            this.addToRateLimitBuffer(msg); // can potentially cause disconnection\n            return;\n        }\n\n        let delay = 0;\n        // once we have any record of recent sends, compare now to last send time.\n        // postpone if closer than allowed by the maximum instantaneous rate.\n        // avoid buffering if controller is being synced.\n        if (times.length && this.synced) {\n            const lastSend = times[times.length - 1];\n            const stillToWait = 1000 / this.eventRateLimit - (now - lastSend);\n            if (stillToWait > 1) delay = Math.ceil(stillToWait); // we want the timeout to be long enough to be sure to satisfy the gap\n        }\n        if (!delay) {\n            // go ahead immediately\n            this.recordRateLimitedSend(now);\n            this.socketSendMessage(msg); // will be added to sendBuffer if we're currently disconnected (with the chance of a reconnect, since this.vm is still set)\n            Stats.perSecondTally({ sentSingleMessages: 1, sentMessagesTotal: 1, sentPayloadTotal: payloadLength });\n        } else {\n            this.addToRateLimitBuffer(msg);\n            setTimeout(() => this.serviceRateLimitBuffer(), delay);\n        }\n    }\n\n    recordRateLimitedSend(time) {\n        const times = this.rateLimitedSendTimes;\n        // if controller isn't synced, don't push a duplicate time.\n        const isSynced = this.synced;\n        if (isSynced || !times.length || times[times.length - 1] !== time) {\n            times.push(time);\n            if (times.length > this.eventHistoryLimit) times.shift();\n        }\n\n        // it's not a short gap between consecutive messages that should trigger a\n        // warning, but any sustained sending at the peak rate (whether or not we're\n        // using the buffer).\n        if (!this.rateLimitSoftWarned && times.length === this.eventHistoryLimit && time - times[0] < 1010) { // close enough\n            console.warn(this.id, `Sends to ${REFL_OR_SYNCH} are at or above recommended limit of ${this.eventHistoryLimit} within one second. Events will be bundled as necessary to keep to the limit.`);\n            this.rateLimitSoftWarned = true;\n        }\n    }\n\n    addToRateLimitBuffer(msg) {\n        Stats.perSecondTally({ bundledMessages: 1 });\n        const now = Date.now();\n        // rateLimitBuffer is an array of { msgStates, totalPayload } bundles\n        const msgState = msg.asState(); // [time, seq, payload]\n        const payloadLength = msgState[2].length;\n        const buffer = this.rateLimitBuffer;\n        if (buffer.length) {\n            const lastBundle = buffer[buffer.length - 1];\n            const { msgStates, totalPayload } = lastBundle;\n            // add until the sum of payload sizes reaches our soft limit\n            if (totalPayload < PAYLOAD_LIMIT_RECOMMENDED) {\n                // ok to add\n                msgStates.push({ msgState, bufferTime: now });\n                lastBundle.totalPayload += payloadLength;\n                return;\n            }\n        }\n\n        // start a new bundle\n        Stats.perSecondTally({ newBundles: 1 });\n        buffer.push({ msgStates: [{ msgState, bufferTime: now }], totalPayload: payloadLength });\n        const buffered = buffer.length;\n        if (DEBUG.session && buffered % 5 === 0 && buffered !== this.rateLimitLastLogged) {\n            console.log(this.id, `SEND rate-limit buffer grew to ${buffered} event bundles (max ${this.eventMaxBundles})`);\n            this.rateLimitLastLogged = buffered;\n        }\n        if (buffered > this.eventMaxBundles) {\n            console.error(this.id, `Disconnecting after overflow of SEND rate-limit buffer.`);\n            this.connection.closeConnectionWithError(\"SEND\", Error(`Send rate exceeded`), 4200); // do not retry.  synchronously nulls out socket.\n        } else if (!this.rateLimitBufferWarned && buffered > this.eventMaxBundles / 2) {\n            console.warn(this.id, `SEND rate-limit buffer is 50% full. If send rate does not drop, the app will be disconnected.`);\n            this.rateLimitBufferWarned = true;\n        }\n    }\n\n    serviceRateLimitBuffer() {\n        if (!this.connected) return;\n\n        const buffer = this.rateLimitBuffer;\n        const buffered = buffer.length;\n        if (!buffered) return;\n\n        const now = Date.now();\n        const minGap = 1000 / this.eventRateLimit;\n        const times = this.rateLimitedSendTimes;\n        if (times.length) {\n            const lastSend = times[times.length - 1];\n            const stillToWait = minGap - (now - lastSend);\n            if (stillToWait > 0) return;\n        }\n\n        const bundle = buffer.shift();\n        const { msgStates, totalPayload } = bundle; // msgStates is an array of { msgState, bufferTime }\n        const events = [];\n        let delay = 0;\n        msgStates.forEach(m => {\n            events.push(m.msgState);\n            delay += now - m.bufferTime;\n            });\n        if (events.length === 1) {\n            const msg = Message.fromState(events[0], this.vm);\n            this.socketSendMessage(msg);\n        } else {\n            const envelope = new Message(this.vm.time, 0, \"_\", \"handleBundledEvents\", [events]);\n            this.socketSendMessage(envelope);\n        }\n        this.recordRateLimitedSend(now);\n        Stats.perSecondTally({ sentBundles: 1, sentMessagesTotal: msgStates.length, sendDelay: delay, sentBundlePayload: totalPayload, sentPayloadTotal: totalPayload });\n\n        if (DEBUG.session && this.connected) {\n            const nowBuffered = buffer.length;\n            if (nowBuffered && nowBuffered % 5 === 0 && nowBuffered !== this.rateLimitLastLogged) {\n                console.log(this.id, `SEND rate-limit buffer dropped to ${nowBuffered} event bundles`);\n                this.rateLimitLastLogged = nowBuffered;\n            }\n        }\n\n        // if there are still entries in the buffer, schedule a timeout to\n        // take another bite.\n        if (buffer.length) setTimeout(() => this.serviceRateLimitBuffer(), minGap);\n    }\n\n    async socketSendMessage(msg, tags=null) {\n        // get the asynchronous encoding out of the way before the check that\n        // we're still connected.\n        const encryptedMsg = await this.encryptMessage(msg, this.viewId, Date.now()); // [time, seq, payload]\n\n        const description = DEBUG.sends && (tags ? `tagged SEND ${msg.asState()} with tags ${JSON.stringify(tags)}` : `SEND ${msg.asState()}`);\n\n        // view sending events while connection is closing or rejoining\n        if (!this.connected || !this.syncCompleted) {\n            if (this.vm) {\n                if (DEBUG.sends) console.log(this.id, `buffering ${description}`);\n                this.sendBuffer.push(() => this.socketSendMessage(msg, tags));\n            }\n            return;\n        }\n\n        if (DEBUG.sends) console.log(this.id, `sending ${description}`);\n\n        const toSend = {\n            id: this.id,\n            action: 'SEND',\n            args: [...encryptedMsg, this.latency],\n            };\n        if (tags) toSend.tags = tags;\n        this.lastSent = Date.now();\n        this.connection.send(JSON.stringify(toSend));\n    }\n\n    /** send a Message to all vm replicas via reflector, subject to reflector preprocessing as determined by the tag(s)\n     * @param {Message} msg\n     * @param {Object} tags\n    */\n    async sendTagged(msg, tags) {\n        // reflector SEND protocol allows for an additional tags property.\n        // as of aug 2021, the only tagging is \"debounce\".  for example:\n        //    { debounce: 1000, msgID: \"pollForSnapshot\" }\n\n        // because the reflector can't see details of messages that are\n        // combined into bundles, tagged messages always bypass the buffering.\n        if (this.viewOnly) return;\n\n        this.socketSendMessage(msg, tags);\n    }\n\n    /** send a TUTTI Message\n     * @param {Object} spec\n    */\n    async sendTutti({ time, topic, data, localContext=null, firstMessage=null, wantsVote=true, tallyTarget=null }) {\n        // TUTTI: Send a message that multiple clients are expected to send identically.\n        // This method is called directly by system-level features that use voting (currently for snapshot\n        // and persistence).  It is also invoked implicitly from handleModelEventInModel, if the\n        // published event name has the #reflected suffix.\n        // The reflector will optionally broadcast the first received message immediately, then\n        // gather all messages up to a deadline and send a TALLY message summarising the results\n        // (whatever those results, if wantsVote is true; otherwise, only if there is some divergence\n        // among them).\n\n        // When called via handleModelEventInModel for a published event scope:foo#reflected\n        //  - firstMessage will be handleModelEventInModel(scope:foo) iff there is a model subscription\n        //    for scope:foo\n        //  - wantsVote will be true iff there is a view subscription for scope:foo#__vote.  in this case,\n        //    tallyTarget will be handleModelEventInView(scope:foo#__vote)\n        //  - if wantsVote is false - meaning that the tallyTarget will only be invoked if there is\n        //    divergence - the tallyTarget is handleTuttiDivergence, which invokes any model-level\n        //    subscription for scope:foo#divergence or, if none, prints an \"uncaptured divergence\" warning.\n\n        // The optional localContext is for arbitrary values that this client wants to have at hand when\n        // the vote comes in, but not to send to the reflector.  The values don't need to be serialisable.\n        if (this.viewOnly) return;\n\n        // get the asynchronous encoding out of the way before the check that\n        // we're still connected.\n        const encryptedMsg = firstMessage && await this.encryptMessage(firstMessage, this.viewId, Date.now()); // [time, seq, payload]\n        const payload = stableStringify(data); // stable, to rule out platform differences\n\n        // view sending events while connection is closing or rejoining\n        if (!this.connected || !this.syncCompleted) {\n            if (this.vm) {\n                if (DEBUG.sends) console.log(this.id, `buffering \"${topic}\" TUTTI ${payload} ${firstMessage && firstMessage.asState()}`);\n                this.sendBuffer.push(() => this.sendTutti({ time, topic, data, localContext, firstMessage, wantsVote, tallyTarget }));\n            }\n            return;\n        }\n\n        if (DEBUG.sends) console.log(this.id, `sending \"${topic}\" TUTTI ${payload} ${firstMessage && firstMessage.asState()}`);\n        this.lastSent = Date.now();\n        // jul 2021: in case we were assigned to an old reflector, we supplied a dummy\n        // tuttiSeq in second place in the arg array.  as of late 2021 all deployed\n        // reflectors check for a seventh-place argument instead.\n        const dummyTuttiSeq = 0;\n        const tuttiKey = `${topic}@${time}`;\n        this.connection.send(JSON.stringify({\n            id: this.id,\n            action: 'TUTTI',\n            args: [time, dummyTuttiSeq, payload, encryptedMsg, wantsVote, tallyTarget, tuttiKey],\n        }));\n        if (this.tuttiHistory.length > 100) this.tuttiHistory.shift();\n        this.tuttiHistory.push({ time, tuttiKey, dummyTuttiSeq, payload, localContext });\n    }\n\n    sendLog(...args) {\n        if (!this.connected || !this.syncCompleted) {\n            if (this.vm) {\n                if (DEBUG.sends) console.log(this.id, `buffering LOG`);\n                this.sendBuffer.push(() => this.sendLog(...args));\n            }\n            return;\n        }\n        if (DEBUG.sends) console.log(this.id, `sending LOG`);\n        if (args.length < 2) args = args[0];\n        this.connection.send(JSON.stringify({ action: 'LOG', args }));\n    }\n\n    addToStatistics(timeSent, timeReceived) {\n        this.latency = timeReceived - timeSent;\n        if (this.latencyHistory) {\n            if (this.latencyHistory.length >= 100) this.latencyHistory.shift();\n            this.latencyHistory.push({time: timeReceived, ms: this.latency});\n        }\n    }\n\n    get latencies() {\n        if (!this.latencyHistory) this.latencyHistory = [];\n        return this.latencyHistory;\n    }\n\n    /** parse tps `ticks x multiplier` ticks are from server, multiplied by locally generated ticks\n     *\n     * default taken from `sessionSpec.tps` unless `sessionSpec.options.tps` is present\n     *\n     * @returns {{\n     *      msPerTick: Number,  // effective tick period in ms\n     *      multiplier: Number, // local multiplier\n     *      tick: Number,       // reflector tick period in ms\n     *      delay: Number,      // reflector delay to account for locally produced ticks\n     * }}\n     */\n    getTickAndMultiplier() {\n        const options = this.sessionSpec.options;\n        const tps = [\"number\", \"string\"].includes(typeof options.tps) ? options.tps\n            : [\"number\", \"string\"].includes(typeof this.sessionSpec.tps) ? this.sessionSpec.tps\n            : 20;\n        const [rate, mult] = (tps + 'x').split('x').map(n => Number.parseFloat('0' + n));\n        const tick = 1000 / Math.max(1/30, Math.min(60, rate));     // minimum 1 tick per 30 seconds\n        const multiplier = Math.max(1, mult);      // default multiplier is 1 (no local ticks)\n        let msPerTick = tick;\n        let delay = 0;\n        if (multiplier > 1 && !NOCHEAT) {\n            msPerTick = tick / multiplier;\n            delay = Math.ceil(msPerTick * (multiplier - 1));\n        }\n        return { msPerTick, multiplier, tick, delay };\n    }\n\n    /**\n     * Process pending messages for this vm and advance simulation\n     * @param {Number} deadline CPU time deadline before interrupting simulation\n     * @return {Boolean} true if simulation finished before deadline\n     */\n    simulate(deadline) {\n        if (!this.vm) return true;     // we are probably still sync-ing\n        try {\n            let weHaveTime = true;\n            const nothingToDo = (this.networkQueue.length + this.vm.messages.size) === 0;\n            if (nothingToDo) {\n                // only advance time, do not accumulate any cpuTime\n                weHaveTime = this.vm.advanceTo(this.reflectorTime, deadline);\n            } else {\n                // perform simulation accumulating cpuTime\n                const simStart = Stats.begin(\"simulate\");\n                // simulate all received external messages\n                while (weHaveTime) {\n                    const messageWithSize = this.networkQueue[0]; // [msg, size]\n                    if (!messageWithSize) break;\n\n                    const [msgData, payloadSize] = messageWithSize;\n                    // finish simulating internal messages up to message time\n                    // (otherwise, external messages could end up in the future queue,\n                    // making snapshots non-deterministic).\n                    // msgData is a sequenced message [time, seq, stringEncodedMsg].\n                    weHaveTime = this.vm.advanceTo(msgData[0], deadline);\n                    if (!weHaveTime) break;\n                    // Remove message from the network queue\n                    this.networkQueue.shift();\n                    // and add its official size to our running tally (note that an\n                    // 'audit' message will have been added to the tally _before_ it\n                    // is handled)\n                    if (DEPIN) this.auditStats.payloadTally += payloadSize;\n                    // have the vm decode and schedule that message\n                    // it will end up first in the future message queue\n                    const msg = this.vm.scheduleExternalMessage(msgData);\n                    // simulate that message\n                    weHaveTime = this.vm.advanceTo(msg.time, deadline);\n                    // boost cpuTime by a fixed cost per message, to impose an upper limit on\n                    // the number of messages we'll accumulate before taking a snapshot\n                    this.cpuTime += EXTERNAL_MESSAGE_CPU_PENALTY;\n                }\n                // finally, simulate up to last tick (whether received or generated)\n                if (weHaveTime) weHaveTime = this.vm.advanceTo(this.reflectorTime, deadline);\n                this.cpuTime += Math.max(0.01, Stats.end(\"simulate\") - simStart); // ensure that we move forward even on a browser that rounds performance.now() to 1ms\n            }\n            Stats.backlog(this.backlog);\n            // synced is set to null in controller.reset, and is first set to false when\n            // this.reflectorTime is given its first meaningful value from a message or\n            // tick, or in SYNC.\n            // thereafter, synced will only be changed in either direction if there is\n            // currently a root view (which is set up and taken down in rebootModelView).\n            const lag = this.lag;\n            const syncedMin = Math.max(SYNCED_MIN, this.msPerTick * SYNCED_MIN_FACTOR);\n            const syncedMax = Math.max(SYNCED_MAX, this.msPerTick * SYNCED_MAX_FACTOR);\n            if (typeof this.synced === \"boolean\" && this.viewed && (this.synced && lag > syncedMax || !this.synced && lag < syncedMin)) {\n                const nowSynced = !this.synced;\n                // nov 2019: impose a delay before setting synced to true, to hold off processing that depends on being synced (notably, subscriptions with handling \"oncePerFrameWhileSynced\") long enough to incorporate processing of messages that rightfully belong with the sync batch - e.g., \"users\" messages after SYNC from reflector.  SYNCED_ANNOUNCE_DELAY is therefore chosen with reference to the reflector's USERS_INTERVAL used for batching the \"users\" messages.\n                if (nowSynced) {\n                    // this will be triggered every cycle until synced is eventually set to true.  capture with one timeout.\n                    if (!this.syncTimer) {\n                        // if we're backgrounded and timers are firing only once per minute,\n                        // the sync announcement will probably be delayed.  for now we assume\n                        // that that doesn't matter.\n                        this.syncTimer = setTimeout(() => {\n                            delete this.syncTimer;\n                            if (this.connected && this.lag < syncedMin) this.applySyncChange(true); // iff we haven't somehow dropped out of sync again\n                            }, SYNCED_ANNOUNCE_DELAY);\n                    }\n                } else this.applySyncChange(false); // switch to out-of-sync is acted on immediately\n            }\n            // only snapshot if not offline\n            if (!DEBUG.offline) {\n                // important not to schedule (resetting cpuTime) if not synced\n                if (this.synced && weHaveTime && this.vm.time - this.lastSnapshotRequest > SNAPSHOT_POLL_DEBOUNCE) {\n                    let doSchedule = false;\n                    if (this.cpuTime > SNAPSHOT_AFTER_CPU) {\n                        if (DEBUG.snapshot) console.log(this.id, `due for snapshot: cpuTime is ${Math.round(this.cpuTime)}ms`);\n                        doSchedule = true;\n                    } else if (DEPIN && this.vm.time - this.vm.lastSnapshotPoll > DEPIN_SNAPSHOT_AFTER_TEATIME) {\n                        if (DEBUG.snapshot) console.log(this.id, `due for snapshot: time since last is ${this.vm.time - this.vm.lastSnapshotPoll}ms`);\n                        doSchedule = true;\n                    }\n\n                    if (doSchedule) {\n                        this.lastSnapshotRequest = this.vm.time; // for debounce\n\n                        // the triggeringCpuTime will be used whether or not this client\n                        // ends up being the one that triggers the snapshot.\n                        this.triggeringCpuTime = this.cpuTime;\n                        this.cpuTime = 0;\n                        // first level of defence against clients simultaneously deciding\n                        // that it's time to take a snapshot: stagger pollForSnapshot sends,\n                        // so we might have heard from someone else before we send.\n                        // however, if we're backgrounded so that timers might be firing only once\n                        // per minute, it would be wrong to wait.\n                        if (this.isBeingAnimated()) {\n                            setTimeout(() => this.scheduleSnapshot(), Math.floor(Math.random()*2000));\n                        } else this.scheduleSnapshot();\n                    }\n                } else if (this.reflectorNeedsSnapshot) {\n                    // the reflector is desperate for a snapshot, so we force scheduling one\n                    this.triggeringCpuTime = this.synced ? this.cpuTime : 12345; // prefer synced clients\n                    this.scheduleSnapshot(true);\n                    this.reflectorNeedsSnapshot = false;\n                }\n            }\n            return weHaveTime;\n        } catch (error) {\n            displayAppError(\"simulate\", error);\n            this.connection.closeConnectionWithError(\"simulate\", error);\n            return \"error\";\n        }\n    }\n\n    // this is invoked by session.step() - which is called from the default\n    // onAnimationFrame handler below, or by the application if it chooses\n    // to step manually\n    stepSession(stepType, parameters={}) {\n        // iff globalThis.logMessageStats is truthy, the Stats object will be gathering\n        // per-second message stats and will return a tally once per second.\n        const report = Stats.stepSession(parameters.frameTime, true);\n        if (report) console.log(report);\n\n        const { backlog, latency, starvation, activity } = this;\n        if (stepType === \"animation\") {\n            Stats.animationFrame(parameters.frameTime, { backlog, starvation, latency, activity, users: this.users });\n\n            const now = Date.now();\n            if (this.lastAnimationEnd) {\n                const thisGap = now - this.lastAnimationEnd;\n                // if regular animation had been detected, but this latest gap is\n                // unusually long, immediately drop the isBeingAnimated status and\n                // start counting frames again.\n                if (this.animationGapCheck === true && thisGap > ANIMATION_EXCESSIVE_FRAME_GAP) {\n                    this.animationGapCheck = [];\n                    if (DEBUG.session) console.log(this.id, `animation has stopped (too long between steps)`);\n                }\n                if (this.animationGapCheck !== true) {\n                    const gaps = this.animationGapCheck;\n                    gaps.push(thisGap);\n                    if (gaps.length > ANIMATION_CHECK_FRAMES) gaps.shift();\n                    if (gaps.length === ANIMATION_CHECK_FRAMES && gaps.reduce((a, b) => a + b, 0) <= ANIMATION_CHECK_FRAMES * ANIMATION_REASONABLE_FRAME_GAP) {\n                        this.animationGapCheck = true;\n                        if (DEBUG.session) console.log(this.id, `animation has started`);\n                    }\n                }\n            }\n\n            this.lastAnimationEnd = now; // will be replaced if we run through to the end\n        }\n\n        if (!this.connected) {\n            if (!this.isInBackground()) this.checkForConnection(true); // reconnect if not blocked\n            return;\n        }\n\n        if (!this.vm) return;\n\n        let caughtUp;\n        switch (stepType) {\n            case \"animation\": {\n                // when average load is low, the balancer spreads simulation across frames by\n                // simulating with a budget equal to the mean of the durations recorded from the\n                // last LOAD_BALANCE_FRAMES simulations.\n                // a session also has a value expectedSimFPS, from which we derive the maximum time\n                // slice that the simulation can use on each frame while still letting the app\n                // render on time.  whenever the controller is found to have a backlog greater than\n                // LOAD_BALANCE_FRAMES times that per-frame slice, the balancer immediately\n                // schedules a simulation boost with a budget of MAX_SIMULATION_MS.\n                // expectedSimFPS can be set using session param expectedSimFPS; the higher\n                // the value, the less of a backlog is needed to trigger a simulation boost.  but\n                // if expectedSimFPS is set to zero, the balancer will attempt to clear any backlog\n                // on every frame.\n                // expectedSimFPS was introduced for our Unity experiments, and is undocumented.\n                // as of july 2021, all apps are running with the default value of 60.\n                const expectedSimFPS = parameters.expectedSimFPS;\n                const simStart = Date.now();\n                const simBudget = simLoad.reduce((a, b) => a + b, 0) / simLoad.length;\n                caughtUp = this.simulate(simStart + Math.min(simBudget, MAX_SIMULATION_MS));\n                if (caughtUp === false) {\n                    // maybe take another bite\n                    const allowableLag = expectedSimFPS === 0 ? 0 : LOAD_BALANCE_FRAMES * (1000 / expectedSimFPS);\n                    if (this.backlog > allowableLag) caughtUp = this.simulate(simStart + MAX_SIMULATION_MS - simBudget);\n                }\n                if (caughtUp !== \"error\") {\n                    simLoad.push(Date.now() - simStart);\n                    if (simLoad.length > LOAD_BALANCE_FRAMES) simLoad.shift();\n                }\n                break;\n                }\n            case \"fastForward\":\n            case \"background\":\n                caughtUp = this.simulate(Date.now() + parameters.budget);\n                break;\n            default:\n                console.warn(stepType);\n            }\n\n        if (this.fastForwardHandler) this.fastForwardHandler(caughtUp);\n        if (caughtUp === \"error\") return;\n\n        Stats.begin(\"update\");\n        this.processModelViewEvents(stepType === \"animation\");\n        Stats.end(\"update\");\n\n        if (!this.vm) return; // the latest simulation might have shut down the session\n\n        // the buffer for rate-limited SENDS is serviced by timeouts when\n        // the session is being animated, and will ignore additional\n        // invocations that don't fit its schedule.\n        // checking from here means it will also be called when the session\n        // is in the background, when we step on every TICK and RECV from\n        // the reflector.\n        this.serviceRateLimitBuffer();\n\n        if (stepType !== \"animation\") return;\n\n        if (parameters.view) {\n            Stats.begin(\"render\");\n            this.inViewRealm(() => parameters.view.update(parameters.frameTime));\n            Stats.end(\"render\");\n        }\n\n        this.lastAnimationEnd = Date.now();\n    }\n\n    applySyncChange(bool) {\n        if (DEBUG.session) console.log(this.id, `synced=${bool}`);\n        this.synced = bool;\n        App.showSyncWait(!bool); // true if not synced\n        this.vm.publishFromView(this.viewId, \"synced\", bool);\n    }\n\n    /** execute something in the view realm */\n    inViewRealm(fn) {\n        return inViewRealm(this.vm, () => fn(this.vm));\n    }\n\n    /** call this from main loop to process queued model=>view events\n     * @returns {Number} number of processed events\n     */\n    processModelViewEvents(isInAnimationStep) {\n        if (this.vm) {\n            return this.vm.processModelViewEvents(isInAnimationStep);\n        }\n        return 0;\n    }\n\n    /** Got the official time from reflector (on SYNC, TICK or RECV), or local tick multiplier.  src is \"reflector\" or \"controller\".  rawTime is reflector performance.now() since the resumption of the session, currently (dec 2021) defined in experimental reflectors on RECV events only, if flag \"rawtime\" is requested on join(). */\n    timeFromReflector(time, src, rawTime) {\n        if (time < this.reflectorTime) { if (src !== \"controller\" || DEBUG.ticks) console.warn(`time is ${this.reflectorTime}, ignoring time ${time} from ${src}`); return; }\n        if (typeof this.synced !== \"boolean\") this.synced = false;\n        this.reflectorTime = time;\n        this.extrapolatedTimeBase = Date.now() - time;\n        if (this.vm) Stats.backlog(this.backlog);\n        if (this.tickHook) this.tickHook(time, rawTime);\n    }\n\n    /** we received a tick from reflector, generate local ticks */\n    multiplyTick(time) {\n        if (this.localTicker) globalThis.clearInterval(this.localTicker);\n        const ms = this.msPerTick;\n        const multiplier = this.tickMultiplier;\n        let n = 1;\n        this.localTicker = globalThis.setInterval(() => {\n            this.timeFromReflector(Math.round(time + n * ms), \"controller\");\n            if (DEBUG.ticks) console.log(this.id, \"Controller generate TICK \" + this.reflectorTime, n);\n            if (++n >= multiplier) { globalThis.clearInterval(this.localTicker); this.localTicker = 0; }\n        }, ms);\n    }\n\n    startStepping(autoStepFn) {\n        // session.js won't invoke this for a Node.js app\n        const onAnimationFrame = frameTime => {\n            if (this.leaving) return; // stop the loop; it's not coming back\n\n            if (!this.isOutOfSight()) autoStepFn(frameTime);\n\n            window.requestAnimationFrame(onAnimationFrame);\n        };\n        window.requestAnimationFrame(onAnimationFrame);\n    }\n\n    setUpActivityChecks() {\n        /** intersection with the browser viewport */\n        let isVisibleInViewport = null;\n        /** whether to consider this tab visible, based on document.visibilityState and our IntersectionObserver */\n        this.isOutOfSight = () => !NODE && (document.visibilityState === \"hidden\" || !isVisibleInViewport);\n        /** whether to consider this tab as being animated regularly.  it takes ANIMATION_EXCESSIVE_FRAME_GAP (200ms) to detect that animation has stopped, and ANIMATION_CHECK_FRAMES rapidly scheduled steps to signal that it has restarted. */\n        this.isBeingAnimated = () => {\n            const gapsOk = this.animationGapCheck === true;\n            const delayOk = Date.now() - this.lastAnimationEnd < ANIMATION_EXCESSIVE_FRAME_GAP;\n            if (gapsOk && !delayOk) {\n                this.animationGapCheck = []; // start counting again\n                if (DEBUG.session) console.log(this.id, `animation has stopped (too long since last step)`);\n            }\n            return gapsOk && delayOk;\n            };\n        /** whether to consider this tab as being in the background. */\n        this.isInBackground = () => this.isOutOfSight() || !this.isBeingAnimated();\n\n        if (!NODE) {\n            const intersectionChanged = (entries, _observer) => isVisibleInViewport = entries[0].isIntersecting;\n            const observer = new IntersectionObserver(intersectionChanged);\n            observer.observe(document.body);\n        }\n\n        // only set up a dormancy check if needed\n        const autoSleep = this.sessionSpec.autoSleep; // seconds, or zero to disable\n        let checkForDormancy;\n        if (autoSleep) {\n            const dormantDelay = 1000 * autoSleep;\n            let lastDormancyCheck = 0;\n            let outOfSightSince = 0;\n            checkForDormancy = () => {\n                const now = Date.now();\n                if (now - lastDormancyCheck < 980) return; // don't insist on 1000\n\n                lastDormancyCheck = now;\n                if (this.isOutOfSight()) {\n                    if (!outOfSightSince) outOfSightSince = now;\n                    else if (now - outOfSightSince > dormantDelay) {\n                        this.dormantDisconnect();\n                        outOfSightSince = 0; // to force a new timeout if hidden immediately on reconnection\n                    }\n                } else outOfSightSince = 0;\n                };\n        }\n\n        const checkAliveness = () => {\n            if (this.leaving) {\n                if (alivenessPoll) {\n                    // stop the poll tidily, in case this is called multiple\n                    // times (via ticks) during the time it takes to leave.\n                    clearInterval(alivenessPoll);\n                    alivenessPoll = null;\n                }\n                return;\n            }\n\n            if (!this.connected || !this.vm) return;\n\n            if (checkForDormancy) checkForDormancy();\n\n            // if the session is not being animated regularly, the setInterval\n            // that normally triggers keepAlive probably isn't being stepped\n            // either.  do so from here.\n            if (!this.isBeingAnimated()) this.connection.keepAlive(Date.now());\n            };\n\n        // this poll is likely to be throttled to to once per minute in Chrome\n        // if this tab is backgrounded.  checkAliveness is therefore also sent\n        // by simulateIfNeeded if the tab is not being regularly stepped.\n        let alivenessPoll = setInterval(checkAliveness, 1000);\n\n        this.simulateIfNeeded = () => {\n            // if session is connected but not being stepped by animation\n            // frames, use ticks to trigger a liveness check and, if still\n            // connected after that, run the simulation.\n            if (this.isBeingAnimated()) return; // animation is happening as usual\n\n            checkAliveness();\n\n            if (this.fastForwardHandler) return; // leave simulation to being driven by the fast-forward loop\n\n            if (this.connected) {\n                // we set a simulation budget of 90% of the tick gap, capped at\n                // MAX_SIMULATION_MS unless this app disables dormancy, in which case\n                // we allow even a multi-second budget (if the tick is that slow)\n                // so that the simulation has all the resources we can throw at it.\n                // that said, an app that needs to do lots of simulation ought not\n                // to set a low tick rate.\n                let simBudget = this.msPerTick * 0.9;\n                if (autoSleep) simBudget = Math.min(simBudget, MAX_SIMULATION_MS);\n                const stepType = this.synced ? \"background\" : \"fastForward\"; // doesn't currently make any difference\n                this.stepSession(stepType, { budget: simBudget });\n            }\n            };\n    }\n\n    toString() { return `Controller[${this.id}]`; }\n\n    [Symbol.toPrimitive]() { return this.toString(); }\n}\n\n\n// Socket Connection\n\n/** send PULSEs using this interval until hearing back from server */\nconst KEEP_ALIVE_INTERVAL = 100;\n/** if we haven't sent anything to the reflector for this long, send a PULSE to reassure it */\nconst PULSE_TIMEOUT = 25000;\n/** if we haven't heard anything from the reflector for this long, try reconnecting */\nconst REFLECTOR_ALIVE_TIMEOUT = 50000;\n/** warn about unsent outgoing bytes after this many ms */\nconst UNSENT_TIMEOUT = 500;\n/** increase reconnect timeout exponentially up to this many ms */\nconst RECONNECT_DELAY_MAX = 30000;\n\nclass Connection {\n    constructor(controller) {\n        this.controller = controller;\n        this.socketLastSent = 0;        // only used for keepAlive check\n        this.connectBlocked = false;\n        this.connectRestricted = false;\n        this.connectHasBeenCalled = false;\n        this.reconnectDelay = 0;\n        this.missingTickThreshold = Infinity;\n    }\n\n    get id() { return this.controller.id; }\n\n    setTick(ms) {\n        this.missingTickThreshold = Math.min(ms * 3, 45000); // send PULSE after\n    }\n\n    get connected() { return !!(this.socket && this.socket.isConnected()); }\n\n    checkForConnection(force) {\n        if (this.socket || this.connectHasBeenCalled) return;\n\n        // there are three levels of rights to (re)connect:\n        // 1. fully blocked (e.g., to force a pause in attempted reconnection; only a direct connectToReflector will work)\n        // 2. blocked unless requested from a session step (force === true)\n        // 3. not blocked: any call has the right to connect (e.g., on first connect to a session)\n        if (this.connectBlocked) return;\n        if (this.connectRestricted && !force) return;\n\n        this.connectToReflector();\n    }\n\n    connectToReflector() {\n        if (this.socket || this.connectHasBeenCalled) return;\n\n        this.connectHasBeenCalled = true;\n        this.connectBlocked = false;\n        this.connectRestricted = false;\n\n        let socket;\n\n        const readyForJoin = () => {\n            // this is called with different timing on DePIN and otherwise\n            if (DEBUG.session) console.log(this.id, this.socket.constructor.name, \"connected to\", this.socket.url);\n\n            this.reconnectDelay = 0;\n            Stats.connected(true);\n            this.controller.sendJoin();\n        };\n\n        if (DEBUG.offline) {\n            socket = new OfflineSocket();\n            socket.isConnected = () => socket.readyState === WebSocket.OPEN;\n        } else if (DEPIN) {\n            // the \"socket\" is a home-grown class that connects by WebSocket\n            // to a manager to negotiate a WebRTC data-channel connection\n            // to a reflector.\n            const { synchSpec, developSpec } = urlOptions;\n            if (synchSpec && developSpec) throw Error(\"Cannot handle both synchSpec and developSpec options\");\n\n            let synchRequest = '';\n            // either option causes a token to be passed on the WS request\n            const synchToken = synchSpec || developSpec;\n            if (synchToken) synchRequest += `&synch=${encodeURIComponent(synchToken)}`;\n            const sessionId = this.id;\n            const { persistentId, appId, developerId } = this.controller.sessionSpec;\n            // sept 2024: now always include appId and developerId on connection.\n            // @@ should we sanity-check the appId?\n            socket = new CroquetWebRTCConnection(`${DEPIN_API}/clients/connect?session=${sessionId}&persist=${persistentId}&app=${encodeURIComponent(appId)}&developer=${developerId}${synchRequest}`);\n            socket.isConnected = () => socket.dataChannel?.readyState === 'open';\n            socket.onconnected = readyForJoin; // see below\n        } else {\n            let reflectorBase = this.controller.getBackend(this.controller.sessionSpec.apiKey).reflector;\n            const ourUrl = NODE ? undefined : window.location.href;\n            const reflectorParams = {};\n            const token = this.controller.sessionSpec.token;\n            if (token) reflectorParams.token = token;\n            if (urlOptions.reflector) {\n                const cloudflareColo = urlOptions.reflector.toUpperCase();\n                if (cloudflareColo === \"CF\" || cloudflareColo.match(/^[A-Z]{3}$/)) {\n                    reflectorBase = DEBUG.reflector ? DEV_CLOUDFLARE_REFLECTOR : CLOUDFLARE_REFLECTOR;\n                    if (cloudflareColo.length === 3) reflectorParams.colo = cloudflareColo;\n                }\n                else if (urlOptions.reflector.match(/^[-a-z0-9]+$/i)) reflectorParams.region = urlOptions.reflector;\n                else reflectorBase = new URL(urlOptions.reflector, ourUrl).href.replace(/^http/, 'ws');\n            }\n            if (!reflectorBase.match(/^wss?:/)) throw Error(\"Cannot interpret reflector address \" + reflectorBase);\n            if (!reflectorBase.endsWith('/')) reflectorBase += '/';\n            const reflectorUrl = new URL(reflectorBase + this.id, ourUrl);\n            for (const [k,v] of Object.entries(reflectorParams)) reflectorUrl.searchParams.append(k, v);\n\n            socket = new WebSocket(reflectorUrl);\n            socket.isConnected = () => socket.readyState === WebSocket.OPEN;\n        }\n        socket.onopen = _event => {\n            // this is triggered when the WebSocket first opens.  in the case\n            // of standard WebSocket reflectors, this also implies that the\n            // connection is ready for JOIN.  but in the case of WebRTC, the\n            // connection isn't ready until the RTCDataChannel has opened.\n\n            // under some conditions (e.g., switching a device between networks) a new\n            // socket can be opened without the old one receiving a close event\n            const oldSocket = this.socket;\n            if (oldSocket) {\n                oldSocket.onopen = oldSocket.onmessage = oldSocket.onerror = oldSocket.onclose = null;\n            }\n            this.socket = socket;\n            this.connectHasBeenCalled = false; // now that we have the socket\n            if (!socket.twoStageConnection) readyForJoin();\n        };\n        socket.onmessage = event => {\n            if (socket !== this.socket) return; // in case a socket that we've tried to close can still deliver a message\n            const { data } = event;\n            // for large objects (especially over WebRTC) support sending of chunks.\n            // each chunk starts with a prefix _CHUNK followed by two ASCII digits 0/1\n            // representing whether the chunk is the first and/or last chunk in the\n            // transmission.\n            const header = '_CHUNK';\n            if (data.startsWith(header)) {\n                const isFirst = data.charAt(header.length) === '1';\n                const isLast = data.charAt(header.length + 1) === '1';\n                const buf = data.slice(header.length + 2);\n                if (isFirst) socket.chunkCollector = [];\n                socket.chunkCollector.push(buf);\n                if (isLast) {\n                    // turn the array of chunks into a single buffer\n                    const chunkedData = ''.concat(...socket.chunkCollector);\n                    socket.chunkCollector = [];\n                    Stats.addNetworkTraffic(\"reflector_in\", chunkedData.length, !!DEPIN); // store for audit if on DePIN\n                    this.receive(chunkedData);\n                }\n            } else {\n                Stats.addNetworkTraffic(\"reflector_in\", data.length, !!DEPIN); // store for audit if on DePIN\n                this.receive(data);\n            }\n        };\n        socket.onerror = _event => {\n            // an error anywhere between here and the reflector once the socket\n            // connection has opened will also result in socket closure, and can\n            // therefore be handled in socket.onclose.  but in case the socket was\n            // never opened successfully, we clear connectHasBeenCalled here.\n            if (DEBUG.session) console.log(this.id, socket.constructor.name, \"connection error\");\n            this.connectHasBeenCalled = false; // ready to try again\n            this.controller.clearSyncReceiptTimeout(); // if any\n        };\n        socket.onclose = event => {\n            // triggered when socket is closed from the far end.  when we close\n            // it from here, this handler is first nulled out.\n            if (this.socket && socket !== this.socket) return; // ignore delayed close for a superseded socket (whereas if this.socket is null, this could be a closure before opening and needs to be let through)\n\n            this.socketClosed(event.code, event.reason);\n        };\n    }\n\n    socketClosed(code, message) {\n        // with the introduction of seamless rejoin, the closure of the connection\n        // does not directly cause controller.leave() - dismantling the view, etc.\n        // controller.connectionInterrupted() sets an independent timer for invoking\n        // leave() iff the connection has not been restored within the rejoinLimit.\n\n        if (DEBUG.session) console.log(this.id, `socketClosed with code=${code} message=\"${message}\"`);\n\n        // event codes 4100 and up mean a disconnection from which the client\n        // shouldn't automatically try to reconnect\n        // e.g., 4100 is for out-of-date reflector protocol\n        // in addition, 1000 means user-triggered Session.leave().  everything stops.\n        if (code >= 4100 && code !== 4110) {\n            if (DEBUG.session) console.warn(\"resuming this session will require a new Session.join()\");\n            if (!this.controller.leaving) {\n                this.controller.leaving = () => { }; // dummy value, to mimic the effect of Session.leave() having been invoked\n            }\n            this.reconnectDelay = 0;\n        }\n\n        // it's possible that we're seeing a closure that would not itself be\n        // fatal to the session, but that an error that _is_ fatal has already\n        // happened.  in that case, controller.leaving would already have been set.\n        const irreversibleLeave = !!this.controller.leaving;\n\n        const autoReconnect = !irreversibleLeave && code !== 1000 && code < 4100;\n        const dormant = code === 4110;\n        // don't display error if going dormant or normal close or reconnecting\n        if (!dormant && code !== 1000 && !this.reconnectDelay) {\n            // but also wait 500 ms to see if reconnect succeeded\n            setTimeout(() => {\n                if (this.connected || this.socket?.isConnecting?.()) return; // yay - connected again\n\n                const reportMsg = autoReconnect ? \"Reconnecting\" : \"Connection closed\";\n                App.showMessage(`${reportMsg}: ${code} ${message}`, {\n                    level: autoReconnect ? \"warning\" : \"fatal\",\n                });\n            }, 500);\n        }\n        if (DEBUG.session) console.log(this.id, `${this.socket ? this.socket.constructor.name + \" closed\" : \"closed before opening,\"} with code: ${code} ${message}`);\n\n        this.connectHasBeenCalled = false; // ready to try again\n        this.controller.clearSyncReceiptTimeout(); // if any\n        Stats.connected(false);\n        Stats.resetAuditStats();\n\n        if (dormant) this.connectRestricted = true; // only reconnect on session step\n        else this.connectBlocked = true; // only reconnect using connectToReflector\n        this.disconnected();\n        if (autoReconnect) {\n            // the logic above ensures that autoReconnect is only true in conjunction\n            // with connectBlocked=true.  therefore nothing else can cause a reconnection\n            // before the connectToReflector scheduled here.\n            if (DEBUG.session) console.log(this.id, `reconnecting in ${this.reconnectDelay} ms`);\n            this.reconnectTimeout = globalThis.setTimeout(() => {\n                delete this.reconnectTimeout;\n                this.connectToReflector();\n            }, this.reconnectDelay);\n            // we start reconnecting immediately once (0ms) and then back off exponentially\n            // also randomly to avoid hitting the dispatchers at the same time\n            this.reconnectDelay = Math.min(RECONNECT_DELAY_MAX, Math.round((this.reconnectDelay + 100) * (1 + Math.random())));\n        }\n    }\n\n    // from socketClosed handling, whether triggered by remote or local closure\n    disconnected() {\n        if (!this.socket) return;\n\n        this.socket = null;\n        this.lastReceived = 0;\n        this.socketLastSent = 0;\n        this.stalledSince = 0;\n        this.connectHasBeenCalled = false;\n        this.controller.connectionInterrupted();\n    }\n\n    send(data) {\n        this.socketLastSent = Date.now();\n        this.socket.send(data);\n        Stats.addNetworkTraffic(\"reflector_out\", data.length, !!DEPIN); // store for audit if on DePIN\n    }\n\n    receive(data) {\n        // data is a JSONified object with an action (TICK, SYNC, RECV etc), with\n        // optional args and - currently, for all actions other than PONG - a session id\n        this.lastReceived = Date.now();\n        const { id, action, args } = JSON.parse(data);\n        if (id) {\n            try { this.controller.receive(action, args); }\n            catch (e) { this.closeConnectionWithError(\"receive\", e); }\n        } else switch (action) {\n            case 'PONG': {\n                if (DEBUG.pong) console.log(\"PONG after\", Date.now() - args, \"ms\");\n                if (this.pongHook) {\n                    try { this.pongHook(args); }\n                    catch (e) { console.error(e); }\n                }\n                break;\n                }\n            default: console.warn(\"Unknown action\", action);\n        }\n    }\n\n    dormantDisconnect() {\n        if (!this.connected) return; // not connected anyway\n        if (DEBUG.session) console.log(this.id, `dormant; disconnecting from ${REFL_OR_SYNCH}`);\n        this.closeConnection(4110, \"Going dormant\");\n    }\n\n    closeConnectionWithError(caller, error, code=4000) {\n        console.error(code, error);\n        this.closeConnection(code, `Error in ${caller}: ${error.message || error}`);\n        // closing with error code < 4100 will try to reconnect\n    }\n\n    closeConnection(code, message) {\n        // NB: if this.socket is non-null this method synchronously sends disconnect(), which nulls it out\n        if (this.socket) {\n            // it turns out that a WebSocket can get into a state in which sending close()\n            // doesn't trigger the onclose handler (even though its readyState is OPEN).\n            // therefore when the controller wants to force closure - and perhaps\n            // reconnection - we null out the handler before sending close(), and call\n            // the onclose handling directly.\n            this.socket.onclose = null;\n            try {\n                this.socket.close(code, message); // might work, might not\n            } catch (e) { console.error(`Error in socket.close(${code}, ${JSON.stringify(message)}):`, e); }\n        }\n        // whether there was a socket or not, reset the connection so we can try again\n        this.socketClosed(code, message);\n    }\n\n    PULSE(now) {\n        if (!this.connected) return;\n        if (this.socket.bufferedAmount === 0) {\n            // only send a pulse if no other outgoing data pending\n            this.send(JSON.stringify({ action: 'PULSE' }));\n            this.stalledSince = 0;\n        } else if (this.stalledSince && now - this.stalledSince > UNSENT_TIMEOUT) {\n            // only warn about unsent data after a certain time\n            console.log(this.id, `Reflector connection stalled: ${this.socket.bufferedAmount} bytes unsent for ${now - this.stalledSince} ms`);\n        } else this.stalledSince = Date.now();\n    }\n\n    keepAlive(now) {\n        // invoked either from a setInterval of (for now) 100ms, or on every app TICK if\n        // the view is not currently being animated.\n        if (this.lastReceived === 0) return; // haven't yet consummated the connection\n        // the reflector expects to hear from us at least every 30 seconds\n        if (now - this.socketLastSent > PULSE_TIMEOUT) this.PULSE(now);\n        // if we haven't heard anything from the reflector in 50s, assume that somehow the\n        // connection dropped (even though our end of the socket hasn't registered the break)\n        else if (now - this.lastReceived > REFLECTOR_ALIVE_TIMEOUT) this.closeConnectionWithError(\"connection\", Error(`${DEPIN ? 'Synchronizer' : 'Reflector'} has gone away`));\n        // also, if we are expecting steady ticks, PULSE if ticks are missing.  goal is to\n        // prevent the connection from going idle, because otherwise some router/computer\n        // combinations will start to buffer packets instead of delivering them immediately\n        else if (now - this.lastReceived > this.missingTickThreshold) this.PULSE(now);\n    }\n\n    PING(args = Date.now()) {\n        if (!this.connected) return;\n        this.send(JSON.stringify({ action: 'PING', args }));\n    }\n}\n\nglobalThis.setInterval(() => {\n    for (const controller of Controllers) {\n        if (!controller.connected || !controller.vm) continue;\n        controller.connection.keepAlive(Date.now());\n    }\n}, KEEP_ALIVE_INTERVAL);\n\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n\nLOGIC TO DETECT BROKEN CONNECTIONS\n\nREFLECTOR:\n\n    if no JOIN received 7s after client connects to a clientless vm, delete the session\n\n    every 5s, starting 37s after JOIN:\n        if quiescence > 60s:\n            disconnect client (code 4002, so reconnection is allowed)\n        else if quiescence > 35s and not a recent, background-aware client:\n            ping client\n\n    on pong from client:\n        reset quiescence\n\n    on message from client (including PULSE):\n        reset quiescence\n\n\nCONTROLLER:\n\n    if no SYNC received 5s after sending JOIN, close connection and try again\n\n    every 100ms in an animated tab; on every TICK and RECV if not animated (so at worst, on a 30s-interval TICK):\n        if socketLastSent > 25s:\n            send PULSE to server (max ~25s + 30s since last send)\n        else if lastReceived > 50s:\n            assume that server connection is broken, and reconnect\n        else if lastReceived > min(3*TICK, 45s):\n            send PULSE to server\n\n    on any message from server:\n        reset lastReceived\n\n    on any send to server:\n        reset socketLastSent\n\n* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */\n", "import stableStringify from \"fast-json-stable-stringify\";\nimport WordArray from \"crypto-js/lib-typedarrays\";\nimport Base64 from \"crypto-js/enc-base64\";\nimport SHA256 from \"crypto-js/sha256\";\nimport urlOptions from \"./_URLOPTIONS_MODULE_\"; // eslint-disable-line import/no-unresolved\nimport { App } from \"./_HTML_MODULE_\"; // eslint-disable-line import/no-unresolved\nimport VirtualMachine from \"./vm\";\nimport { sessionProps, OLD_DATA_SERVER } from \"./controller\";\n\n\nconst MAXVERSION = '4';\n\nconst DATAHANDLE_HASH = Symbol(\"hash\");\nconst DATAHANDLE_KEY = Symbol(\"key\");\nconst DATAHANDLE_URL = Symbol(\"url\");\n\nconst HandleCache = new Map();      // map hash => handle\nlet fetchCount = 0;\n\nfunction debug(what) {\n    return urlOptions.has(\"debug\", what, false);\n}\n\nfunction hashFromUrl(url) {\n    return url.replace(/.*\\//, '');\n}\n\nfunction toBase64Url(base64) {\n    return base64.replace(/=/g, \"\").replace(/\\+/g, \"-\").replace(/\\//g, \"_\");\n}\n\nfunction fromBase64Url(base64url) {\n    return base64url.replace(/-/g, \"+\").replace(/_/g, \"/\").padEnd((base64url.length + 3) & ~3, \"=\");\n}\n\nfunction scramble(key, string) {\n    if (!key) key = '*';\n    return string.replace(/[\\s\\S]/g, c => String.fromCharCode(c.charCodeAt(0) ^ key.charCodeAt(0)));\n}\n\n/**\n * **Secure bulk data storage**\n *\n * This Data API allows encrypted bulk data storage. E.g. if a user drops a file into a Croquet\n * application, the contents of that file can be handed off to the Data API for storage.\n * It will be encrypted and uploaded to a file server. Other participants will download and\n * decrypt the data.\n *\n * The [Data.store()]{@link Data#store} method returns a *data handle* that is to be stored in the model\n * via [view.publish()]{@link View#publish}, and then other participants fetch the stored data via\n * [Data.fetch()]{@link Data#fetch}, passing the handle from the model.\n *\n * Off-loading the actual bits of data to a file server and keeping only the meta data\n * (including the data handle) in the replicated model meta is a lot more efficient than\n * trying to send that data via [publish]{@link View#publish}/[subscribe]{@link Model#subscribe}.\n * It also allows caching.\n *\n * **Shareable handles:** By default, data handles are not shareable outside the session.\n * The uploaded data is encrypted with the session password, just like snapshots, messages, etc.\n * If you set the `shareable` option to `true`, the data handle will include the decryption key\n * so it can be decrypted by anyone who has the handle, even without the session password.\n * It is not protected by the session's end-to-end encryption. If the handle leaks, anyone can\n * download and decrypt the data. Again:\n *\n * **IF MADE SHAREABLE, THE DATA IS ENCRYPTED INDEPENDENTLY, THE HANDLE INCLUDES THE DECRYPTION KEY**\n *\n * **Note:** The Data API is not available in `Model` code, only available in `View` code.\n * Typically, you would access the Data API in a view as `this.session.data.store()` and `this.session.data.fetch()`.\n *\n * See this [tutorial]{@tutorial 2_9_data} for a complete example.\n *\n * @public\n */\nclass Data {\n    /**\n     * Store data and return an (opaque) handle.\n     *\n     * If `options.shareable` is `true`, the handle will include the decryption key and can be shared (see security/privacy warning above).\n     *\n     * By default, `data` will become unusable after this call, because the ArrayBuffer is detached when being [transferred]{@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer#transferring_arraybuffers} to a web worker for encryption and upload.\n     * Set `options.keep` to `true` to make a copy instead of moving the data.\n     *\n     * @param {ArrayBuffer} data the data to be stored\n     * @param {Object} [options=null]\n     * @param {Boolean} [options.shareable=false] create data handle that can be shared outside this session\n     * @param {Boolean} [options.keep=false] if true, keep the data intact (do not detach buffer)\n     * @returns {Promise<DataHandle>} return promise for the handle\n     * @tutorial 2_9_data\n     * @example\n     * // in a view, perhaps after a file drop event\n     * const handle = await this.session.data.store(arrayBuffer);\n     * this.publish(\"set-file\", handle);\n     * @public\n     */\n    async store() { throw Error(\"Data.store() needs to be called from session.data\"); }\n\n    /**\n     * Fetch data for a given data handle\n     * @param {DataHandle} dataHandle created by [Data.store()]{@link Data#store}\n     * @returns {Promise<ArrayBuffer>} the data\n     * @tutorial 2_9_data\n     * @example\n     * // in a view, perhaps after a \"got-file\" event from the model\n     * const handle = this.model.handle;\n     * const arrayBuffer = await this.session.data.fetch(handle);\n     * @public\n     */\n    async fetch() { throw Error(\"Data.fetch() needs to be called from session.data\"); }\n\n    static async store(data, options, deprecatedKeep) {\n        if (VirtualMachine.hasCurrent()) throw Error(`${App.libName}.Data.store() called from Model code`);\n        let sessionId, shareable, keep;\n        // signature used to be (sessionId, data, optionalKeep) and only shareable\n        if (typeof data === \"string\") {\n            sessionId = data;\n            data = options;\n            shareable = true;\n            keep = deprecatedKeep;\n        } else {\n            sessionId = options && options.sessionId; // optional, sessionProps() will use any session\n            shareable = options && options.shareable;\n            keep = options && options.keep;\n        }\n        if (!(data instanceof ArrayBuffer)) throw Error(`${App.libName}.Data.store() called with non-ArrayBuffer data`);\n\n        const { appId, persistentId, key: sessionKey, uploadEncrypted } = sessionProps(sessionId);\n        const key = shareable ? WordArray.random(32).toString(Base64) : Base64.stringify(sessionKey);\n        const path = `apps/${appId}/${persistentId}/data/%HASH%`; // %HASH% will be replaced by uploadEncrypted()\n        const what = `data#${++fetchCount}`;\n        if (debug(\"data\")) console.log(`${App.libName}.Data: storing ${what} ${data.byteLength} bytes`);\n        const url = await uploadEncrypted({ path, content: data, key, keep, debug: debug(\"data\"), what });\n        const hash = hashFromUrl(url);\n        const handle = new DataHandle(hash, shareable && key, url);\n        if (debug(\"data\")) console.log(`${App.libName}.Data: stored ${what} as ${this.toId(handle)}`);\n        return handle;\n\n        // TODO: publish events and handle in vm to track assets even if user code fails to do so\n        // publish(sessionId, \"data-storing\", handle);\n        // promise.then(() => publish(sessionId, \"data-stored\", handle));\n    }\n\n    static async fetch(handle, options) {\n        let sessionId;\n        // signature used to be (sessionId, handle)\n        if (options && options[DATAHANDLE_URL]) {\n            sessionId = handle;\n            handle = options;\n        } else {\n            sessionId = options && options.sessionId; // optional, sessionProps() will use any session\n        }\n        if (VirtualMachine.hasCurrent()) throw Error(`${App.libName}.Data.fetch() called from Model code`);\n        const  { downloadEncrypted, key: sessionKey } = sessionProps(sessionId);\n        const hash = handle && handle[DATAHANDLE_HASH];\n        const key = handle && handle[DATAHANDLE_KEY] || Base64.stringify(sessionKey);\n        const url = handle && handle[DATAHANDLE_URL];\n        if (typeof hash !== \"string\" || typeof key !== \"string\" || typeof url !== \"string\" ) throw Error(`${App.libName}.Data.fetch() called with invalid handle`);\n        const what = `data#${++fetchCount}`;\n        if (debug(\"data\")) console.log(`${App.libName}.Data: fetching ${what} ${this.toId(handle)}`);\n        return downloadEncrypted({ url, key, debug: debug(\"data\"), what });\n    }\n\n    /**\n     * Answer a hash for the given data.\n     * Strings and binary arrays are hashed directly, other objects use a stable JSON stringification\n     * @param {ArrayBuffer|String|*} data the data to be hashed\n     * @param {\"hex\"|\"base64\"|\"base64url\"} output hash encoding (default: \"base64url\")\n     * @returns {String} SHA256 hash\n     */\n    static hash(data, output='base64url') {\n        if (typeof data === \"function\") data = Function.prototype.toString.call(data);\n        if (typeof data === \"string\") data = new TextEncoder().encode(data);\n        else if (data && data.constructor === DataView) data = new Uint8Array(data.buffer, data.byteOffset, data.byteLength);\n        else if (data && data.constructor === ArrayBuffer) data = new Uint8Array(data);\n        else if (!ArrayBuffer.isView(data)) data = new TextEncoder().encode(stableStringify(data));\n        const result = SHA256(WordArray.create(data));\n        switch (output) {\n            case \"hex\": return result.toString();\n            case \"base64\": return result.toString(Base64);\n            case \"base64url\": return toBase64Url(result.toString(Base64));\n            default: throw Error(`${App.libName}.Data: unknown hash output \"${output}\", expected \"hex\"/\"base64\"/\"base64url\"`);\n        }\n    }\n\n    /**\n     * Create a data handle from a string id.\n     *\n     * @param {String} id an id created by [Data.toId()]{@link Data.toId}\n     * @returns {DataHandle} a handle to be used with [Data.fetch()]{@link Data#fetch}\n     * @public\n     */\n    static fromId(id) {\n        const version = id.slice(0, 1);\n        let hash, key, url, path;\n        switch (version) {\n            case '0':\n                hash = id.slice(1, 1 + 43);\n                key = id.slice(1 + 43);\n                url = `${OLD_DATA_SERVER}/sessiondata/${hash}`;\n                break;\n            case '1':\n                hash = id.slice(1, 1 + 43);\n                key = id.slice(1 + 43, 1 + 43 + 43) + '=';\n                path = id.slice(1 + 43 + 43);\n                url = `${OLD_DATA_SERVER}/apps/${path}/data/${hash}`;\n                break;\n            case '2':\n                hash = id.slice(1, 1 + 43);\n                key = fromBase64Url(id.slice(1 + 43, 1 + 43 + 43));\n                path = scramble(key, atob(fromBase64Url(id.slice(1 + 43 + 43))));\n                url = `${OLD_DATA_SERVER}/apps/${path}/data/${hash}`;\n                break;\n            case '3':\n                key = fromBase64Url(id.slice(1, 1 + 43));\n                url = scramble(key, atob(fromBase64Url(id.slice(1 + 43))));\n                hash = url.slice(-43);\n                break;\n            case '4':\n                key = null; // use session key\n                url = scramble(key, atob(fromBase64Url(id.slice(1))));\n                hash = url.slice(-43);\n                break;\n            default:\n                throw Error(`${App.libName}.Data expected handle v0-v${MAXVERSION} got v${version}`);\n        }\n        return new this(hash, key, url);\n    }\n\n    /**\n     * Create a string id from a data handle.\n     *\n     * This base64url-encoded id is a string that includes the data location and decryption key.\n     * @param {DataHandle} handle a handle created by [Data.store()]{@link Data#store}\n     * @returns {String} id an id to be used with [Data.fromId()]{@link Data.fromId}\n     * @public\n     */\n    static toId(handle) {\n        if (!handle) return '';\n        const hash = handle[DATAHANDLE_HASH];\n        const key = handle[DATAHANDLE_KEY];\n        const url = handle[DATAHANDLE_URL];\n        if (url.slice(-43) !== hash) throw Error(`${App.libName} Data: malformed URL`);\n        // key is plain Base64, make it url-safe\n        const encodedKey = key && toBase64Url(key);\n        // the only reason for obfuscation here is so devs do not rely on any parts of the id\n        const encodedUrl = toBase64Url(btoa(scramble(key, url)));\n        return key ? `3${encodedKey}${encodedUrl}` : `4${encodedUrl}`;\n    }\n\n    constructor(hash, key=null, url) {\n        const existing = HandleCache.get(hash);\n        if (existing) {\n            // if (debug(\"data\")) console.log(`${App.libName}.Data: using cached handle for ${hash}`);\n            return existing;\n        }\n        if (url.slice(-43) !== hash) throw Error(`${App.libName} Data: malformed URL`);\n        // stored under Symbol key to be invisible to user code\n        Object.defineProperty(this, DATAHANDLE_HASH, { value: hash });\n        if (key) Object.defineProperty(this, DATAHANDLE_KEY, { value: key });\n        Object.defineProperty(this, DATAHANDLE_URL, { value: url });\n        HandleCache.set(hash, this);\n        // if (debug(\"data\")) console.log(`${App.libName}.Data: created new handle for ${hash}`);\n    }\n\n    // no other methods - API is static\n}\n\n\nexport default class DataHandle extends Data {}\n\nexport const DataHandleSpec = {\n    cls: DataHandle,\n    write: handle => DataHandle.toId(handle),\n    read: state => DataHandle.fromId(state),\n};\n", "import stableStringify from \"fast-json-stable-stringify\";\nimport SeedRandom from \"../thirdparty-patched/seedrandom/seedrandom\";\nimport \"@croquet/math\"; // creates globalThis.CroquetMath\nimport PriorityQueue from \"./priorityQueue\";\nimport { Stats } from \"./_STATS_MODULE_\"; // eslint-disable-line import/no-unresolved\nimport { App, displayWarning, displayAppError } from \"./_HTML_MODULE_\"; // eslint-disable-line import/no-unresolved\nimport urlOptions from \"./_URLOPTIONS_MODULE_\"; // eslint-disable-line import/no-unresolved\nimport Model from \"./model\";\nimport { inModelRealm, inViewRealm } from \"./realms\";\nimport { viewDomain } from \"./domain\";\nimport Data, { DataHandleSpec } from \"./data\";\n\n/** @typedef { import(\"./controller\").default } Controller */\n\n/** @type {VirtualMachine} */\nlet CurrentVM = null;\n\nlet DEBUG = null;\nfunction initDEBUG() {\n    // TODO: turn this into a reasonable API\n    DEBUG = {\n        snapshot: urlOptions.has(\"debug\", \"snapshot\", false),               // snapshotting, uploading etc\n        session: urlOptions.has(\"debug\", \"session\", false),                 // session logging\n        write: urlOptions.has(\"debug\", \"write\", false),                     // check writes into model by proxying\n    };\n}\n\nconst DEBUG_WRITE_TARGET = Symbol(\"DEBUG_WRITE_TARGET\");\nlet DEBUG_WRITE_PROXIES = null;\n\nexport function propertyAccessor(object, property) {\n    return Array.isArray(object) || typeof property !== \"string\" ? `[${property}]` :\n        property.match(/^[a-z_$][a-z0-9_$]*$/i) ? `.${property}` : `[\"${property}\"]`;\n}\n\n/** this shows up as \"CroquetWarning\" in the console */\nclass CroquetWarning extends Error {}\nObject.defineProperty(CroquetWarning.prototype, \"name\", { value: `${App.libName}Warning` });\n\n/** patch Math and Date */\nfunction patchBrowser() {\n    // patch Math.random, and the transcendentals as defined in \"@croquet/math\"\n    if (!globalThis.CroquetViewMath) {\n        // make random use CurrentVM\n        globalThis.CroquetMath.random = () => CurrentVM.random();\n        // save all original Math properties\n        globalThis.CroquetViewMath = {};\n        for (const [funcName, descriptor] of Object.entries(Object.getOwnPropertyDescriptors(Math))) {\n            globalThis.CroquetViewMath[funcName] = descriptor.value;\n        }\n        // we keep the original Math object but replace the methods found in CroquetMath\n        // with a dispatch based on being executed in model or view code\n        for (const [funcName, modelFunc] of Object.entries(globalThis.CroquetMath)) {\n            const viewFunc = Math[funcName];\n            Math[funcName] = modelFunc.length === 1\n                ? arg => CurrentVM ? modelFunc(arg) : viewFunc(arg)\n                : (arg1, arg2) => CurrentVM ? modelFunc(arg1, arg2) : viewFunc(arg1, arg2);\n        }\n    }\n    // patch Date.now to return VirtualMachine time if called from Model code\n    if (!globalThis.CroquetViewDate) {\n        // replace the original Date constructor function but return actual Date instances\n        const SystemDate = globalThis.Date; // capture in closure\n        // warn only once\n        let warned = false;\n        function modelDateWarning(expr, value) {\n            if (!warned) {\n                warned = true;\n                // log CroquetWarning object to give developers a stack trace\n                console.warn(new CroquetWarning(`${expr} used in Model code`));\n            }\n            return value;\n        }\n        // Date replacement\n        function CroquetDate(a, b, c, d, e, f, g) {\n            // written this way so CroquetDate.length === 7 per spec\n            const calledWithNew = this instanceof CroquetDate; // slightly more efficient than new.target after Babel\n            const args = [a, b, c, d, e, f, g];\n            args.length = arguments.length;\n            if (CurrentVM) {\n                // Alwys warn. Even when providing arguments, instances still use local timezone\n                // TODO: write complete replacement? Don't think so.\n                modelDateWarning(calledWithNew ? \"new Date()\" : \"Date()\");\n                switch (arguments.length) {\n                    case 0: args.push(CurrentVM.time); break;\n                    case 1: break;\n                    default:\n                        args[0] = SystemDate.UTC(...args);\n                        args.length = 1;\n                }\n            }\n            const instance = new SystemDate(...args);\n            return calledWithNew ? instance : \"\" + instance;\n        }\n        // implement static properties\n        CroquetDate.prototype = SystemDate.prototype;\n        CroquetDate.UTC = SystemDate.UTC;\n        CroquetDate.now =  () => CurrentVM ? modelDateWarning(\"Date.now()\", CurrentVM.time) : SystemDate.now();\n        CroquetDate.parse = (...args) => CurrentVM ? modelDateWarning(\"Date.parse()\", 0) : SystemDate.parse(...args);\n        // make original accessible\n        globalThis.CroquetViewDate = SystemDate;\n        // switch\n        globalThis.Date = CroquetDate;\n    }\n}\n\n/*\n * QFuncs are serializable functions.\n * They have an explicit \"this\" value and an environment that gets serialized\n * along with the source. The environment is a map of variable names to values.\n * If one of the variables references the function itself, its name is recorded in selfRef.\n * When resuming a snapshot, the function is compiled from source in its environment.\n * The environment is frozen to prevent modifications that would not be reflected in the closure.\n * All environment variables are made available as constants in the compiled function.\n */\n\nconst QFUNC = Symbol(\"QFUNC\");\n\nexport function createQFunc(thisVal, env, fnOrSource, selfRef) {\n    const qFunc = new QFunc(thisVal, env, fnOrSource, selfRef);\n    const fn = qFunc.compile();\n    fn[QFUNC] = qFunc;\n    return fn;\n}\n\nfunction compileQFunc(source, thisVal, env, selfRef) {\n    // pass env into compiler func as envVar\n    const compilerParams = [];\n    const compilerArgs = [];\n    let thisVar, envVar, envKeys, envValues;\n    if (env) {\n        // normally thisVal is the model, but env.this overrides that\n        if (\"this\" in env) {\n            thisVal = env.this;\n            // rename env.this to an unused variant of \"this\"\n            // because \"this\" is a reserved word\n            thisVar = \"_this\";\n            while (thisVar in env) thisVar = '_' + thisVar;\n            env = { ...env, [thisVar]: thisVal };\n            delete env.this;\n        }\n        // sort env keys to ensure consistent order\n        envKeys = [...Object.keys(env).sort()];\n        envValues = [...envKeys.map(key => env[key])];\n        // set envVar to an unused variant of \"env\"\n        if (envKeys.length) {\n            envVar = \"env\";\n            while (envVar in env || envVar === selfRef) envVar = '_' + envVar;\n            compilerParams.push(envVar);\n            compilerArgs.push(envValues);\n        }\n    }\n    // Make Croquet available if the word \"Croquet\" is found in the source\n    if (source.match(/\\bCroquet\\b/) && !envKeys?.includes(\"Croquet\")) {\n        compilerParams.push(\"Croquet\");\n        compilerArgs.push(Model.Croquet);\n    }\n    // Same for Multisynq\n    if (source.match(/\\bMultisynq\\b/) && !envKeys?.includes(\"Multisynq\")) {\n        compilerParams.push(\"Multisynq\");\n        compilerArgs.push(Model.Croquet);\n    }\n    // use selfRef or an unused variant of \"qFunc\" as fnVar\n    let fnVar = selfRef || \"qFunc\";\n    while (envKeys?.includes(fnVar)) fnVar = '_' + fnVar;\n    // now build source for compiler function\n    let compilerSrc = '\"use strict\"\\n\\n';\n    compilerSrc += '// Croquet QFunc Compiler by Codefrau\\n\\n';\n    compilerSrc += '//////////////// Start Compiler /////////////////\\n';\n    compilerSrc += 'try { const '; // error on undeclared variables\n    // destructure env as constants to prevent accidental writes\n    if (envKeys?.length) {\n        compilerSrc += `[${envKeys.join(', ')}] = ${envVar}, `;\n    }\n    // remove indent from all lines\n    // unless there is an odd number of backticks in any line\n    // this helps when debugging and also makes the source smaller\n    let lines = source.split('\\n');\n    const allButFirstLine = lines.slice(1);\n    const minIndent = Math.min(...allButFirstLine.map(line => line.match(/^\\s*/)[0].length));\n    if (minIndent > 0) {\n        const hasOddBackticks = lines.some(line => (line.match(/`/g) || []).length % 2 === 1);\n        if (!hasOddBackticks) {\n            lines = [lines[0], ...allButFirstLine.map(line => line.slice(minIndent))];\n            source = lines.join('\\n');\n        }\n    }\n    // if last line is still indented, indent the first line to match\n    const lastLine = lines[lines.length - 1];\n    const lastIndent = lastLine.match(/^\\s*/)[0];\n    if (lastIndent) source = lastIndent + source;\n    // compile source and store in fnVar\n    compilerSrc += `${fnVar} =\\n`;\n    compilerSrc += '//////////////// Start User Code ////////////////\\n\\n';\n    compilerSrc += source;\n    compilerSrc += '\\n\\n///////////////// End User Code /////////////////\\n';\n    // return compiled function\n    compilerSrc += `return ${fnVar}`;\n    // ... possibly bound to env.this (does not work on fat-arrow functions, see below)\n    if (thisVar) compilerSrc += `.bind(${thisVar})`;\n    compilerSrc += ' } catch (compileError) { return compileError; }\\n';\n    compilerSrc += '///////////////// End Compiler //////////////////';\n    try {\n        // NOTE: the compiler call below establishes thisVal for fat-arrow functions\n        // eslint-disable-next-line no-new-func\n        const compiler = new Function(...compilerParams, compilerSrc);\n        // we just compiled the compiler, now run it to get our function\n        const fn = compiler.call(thisVal, ...compilerArgs);\n        if (fn instanceof Error) {\n            console.warn(\"rethrowing error\", fn);\n            throw fn;\n        }\n        // done\n        return fn;\n    } catch (error) {\n        console.warn(`createQFunc compiling:\\n\\n${source}`);\n        throw Error(`createQFunc(): ${error.message}`);\n    }\n}\n\nclass QFunc {\n    // public API is new QFunc(this, env, fnOrSource, undefined)\n    // snapshot API is new QFunc(this, env, source, selfRef)\n    constructor(thisVal, env, fnOrSrc, fnSelfRef) {\n        this.thisVal = thisVal;         // the this reference for the function (usually the model)\n        this.env = env;                 // the environment for the function\n        this.selfRef = fnSelfRef;       // env name referencing the function itself (for recursive calls)\n        this.source = fnOrSrc;\n        // new QFunc, not from snapshot\n        if (fnSelfRef === undefined) {\n            this.selfRef = \"\";\n            if (typeof fnOrSrc === \"function\") this.source = fnOrSrc.toString();\n            // if fn itself is in env, remove it and use it as selfRef instead\n            const keys = Object.keys(env);\n            for (const key of keys) {\n                if (fnOrSrc === env[key]) {\n                    if (this.selfRef) throw Error(`createQFunc: env.${this.selfRef} and env.${key} cannot both reference the function`);\n                    this.selfRef = key;\n                }\n            }\n            if (this.selfRef) {\n                this.env = { ...env };\n                delete this.env[this.selfRef];\n            }\n        }\n        // freeze env to prevent modifications which would not be reflected in the closure\n        Object.freeze(this.env);\n    }\n\n    compile() {\n        return compileQFunc(this.source, this.thisVal, this.env, this.selfRef);\n    }\n}\n\nconst QFuncSpec = {\n    cls: QFUNC, // not a class, special-cased when writing a Function\n    write: ({[QFUNC]: {thisVal, env, source, selfRef}}) => [thisVal, source, selfRef, ...Object.entries(env).flat()],\n    read: ([thisVal, source, selfRef, ...flattenedEntries]) => {\n        const env = {};\n        for (let i = 0; i < flattenedEntries.length; i += 2) {\n            env[flattenedEntries[i]] = flattenedEntries[i + 1];\n        }\n        return createQFunc(thisVal, env, source, selfRef);\n    }\n    // we flatten the env object because the constructor freezes it so the deserializer can't add to it\n    // that's a deserializer bug\n};\n\n// used to construct method prefix and for error messages (\"${X} is not a method of ...\"\")\nconst FUTURE_MESSAGE_HANDLER = \"future message\";\nconst CANCEL_FUTURE = \"message in cancelFuture\";\nconst SUBSCRIPTION_HANDLER = \"subscription handler\";\nconst UNSUBSCRIBE_ARGUMENT = \"unsubscribe argument\";\n\nfunction asQFuncMethodPrefix(handler) {\n    return `qFunc~${handler.split(\" \")[0]}~`;\n}\n\nconst QFUNC_FUTURE_PREFIX = asQFuncMethodPrefix(FUTURE_MESSAGE_HANDLER);\nconst QFUNC_SUBSCRIPTION_PREFIX = asQFuncMethodPrefix(SUBSCRIPTION_HANDLER);\n\nfunction shouldRegisterQFuncMethod(handler) {\n    return handler === FUTURE_MESSAGE_HANDLER || handler === SUBSCRIPTION_HANDLER;\n}\n\nfunction isQFuncFuture(methodName) {\n    return methodName.startsWith(QFUNC_FUTURE_PREFIX);\n}\n\nfunction handlesFuture(handler) {\n    return handler === FUTURE_MESSAGE_HANDLER || handler === CANCEL_FUTURE;\n}\n\nfunction asQFuncSubscription(topic) {\n    return `${QFUNC_SUBSCRIPTION_PREFIX}${topic}`;\n}\n\nfunction isRegisteredQFuncSubscription(methodName, topic) {\n    if (!methodName.startsWith(QFUNC_SUBSCRIPTION_PREFIX)) return false;\n    return methodName.slice(QFUNC_SUBSCRIPTION_PREFIX.length) === topic;\n}\n\n// this is the only place allowed to set CurrentVM\nfunction execInVM(vm, fn) {\n    if (CurrentVM) throw Error(\"VirtualMachine confusion\");\n    if (!(vm instanceof VirtualMachine)) throw Error(\"not a VM: \" + vm);\n    const previousVM = CurrentVM;\n    try {\n        CurrentVM = vm;\n        globalThis.CROQUETVM = vm;\n        fn();\n    } finally {\n        CurrentVM = previousVM;\n    }\n}\n\nfunction execOutsideVM(fn) {\n    if (!CurrentVM) throw Error(\"VirtualMachine confusion\");\n    const previousVM = CurrentVM;\n    try {\n        CurrentVM = null;\n        fn();\n    } finally {\n        CurrentVM = previousVM;\n    }\n}\n\nconst INITIAL_SEQ = 0xFFFFFFF0; // initial sequence number, must match reflector.js\nconst VOTE_SUFFIX = \"#__vote\"; // internal, for \"vote\" handling; never seen by apps\nconst REFLECTED_SUFFIX = \"#reflected\";\nconst DIVERGENCE_SUFFIX = \"#divergence\";\n\n// messages invoked via reflector (encoded as single digit, not full string)\nconst ENCODED_MESSAGES = [\n    \"handleModelEventInModel\",   // 0: the common case (triggers handlers in models and views)\n    \"handleBundledEvents\",       // 1: the case if bundled, will verify each unbundled message\n\n    // below are encoded for consistency but not directly sent to reflector\n    \"publishFromModelOnly\",      // 2: triggers handlers in models only (specifically, join/exit)\n    \"handlePollForSnapshot\",     // 3: snapshot polling\n    \"handleTuttiResult\",         // 4: processing of TUTTI\n    \"handleTuttiDivergence\",     // 5: processing of TUTTI\n    \"handleSnapshotVote\",        // 6: snapshot voting\n    \"handlePersistVote\",         // 7: persist voting\n    \"handleModelEventInView\",    // 8: view subscription for TUTTI votes (unofficial API)\n    \"noop\",                      // 9: unused (was used in convertReflectorMessage)\n    \"handleAuditRequest\",        // A: (we're counting in Base36) respond to a DePIN audit\n    //                           // B: ...\n    // must not have more than 36 to keep it single-digit (or update encode/decode)\n];\n\n// map of message names to index for encoding\nconst ENCODE_MESSAGE = {};\nfor (let i = 0; i < ENCODED_MESSAGES.length; i++) {\n    ENCODE_MESSAGE[ENCODED_MESSAGES[i]] = i;\n}\n\n// minimum ms (vm time) between successive snapshot polls\nconst SNAPSHOT_MIN_POLL_GAP = 5000;\n// minimum ms (vm time) between successive persistence polls\nconst PERSIST_MIN_POLL_GAP = 25000; // bearing in mind max tick interval of 30s\n\nconst persistenceDetails = new WeakMap(); // map from vm to a persistence-details object\nfunction setPersistenceCache(vm, details) { persistenceDetails.set(vm, details); }\nfunction getPersistenceCache(vm) { return persistenceDetails.get(vm); }\nfunction clearPersistenceCache(vm) { persistenceDetails.set(vm, null); }\n\n/** A fake VM is used to run bit-identical code outside of the model, e.g. for Constant init */\nclass FakeVM {\n    random() {\n        throw Error(\"Math.random() cannot be used in Model.evaluate()\");\n    }\n}\n\n/** A VM holds the models which are synchronized by teatime,\n * a queue of messages, plus additional bookkeeping to make\n * uniform pub/sub between models and views possible.*/\nexport default class VirtualMachine {\n    static current() {\n        if (!CurrentVM) console.warn(`VirtualMachine.current() called from outside the vm!`);\n        return CurrentVM;\n    }\n\n    static hasCurrent() {\n        return !!CurrentVM;\n    }\n\n    /** exposed as Model.evaluate() */\n    static evaluate(fn) {\n        if (CurrentVM) return fn();\n        patchBrowser(); // trivial if already installed\n        const previousVM = CurrentVM;\n        try {\n            CurrentVM = new FakeVM();\n            return fn();\n        } finally {\n            CurrentVM = previousVM;\n        }\n    }\n\n    constructor(snapshot, debugEvents, initFn, compat) {\n        patchBrowser(); // trivial if already installed\n        initDEBUG();\n        clearPersistenceCache(this);\n\n        execInVM(this, () => {\n            inModelRealm(this, () => {\n                /** all the models in this vm by id */\n                this.models = {};\n                /** named models (initially only 'modelRoot') */\n                this.namedModels = {};\n                /** future/pending external messages, sorted by time and sequence number */\n                this.messages = new PriorityQueue((a, b) => a.before(b));\n                /** @type {{\"scope:event\": Array<String>}} model subscriptions, maps topic to handlers */\n                this.subscriptions = {};\n                /** @type {Map<String, Set<String>>} maps models to subscribed topics. Excluded from snapshot */\n                this.subscribers = new Map();\n                /** @type {Array<{topic,handler}>} generic subscriptions, i.e. subscribe('*', ...) */\n                this.genericSubscriptions = [];\n                /** @type {string} meta data for currently executing subscription handler */\n                this.currentEvent = \"\";\n                /** @type {boolean} true if the currentEvent was published by a model */\n                this.currentEventFromModel = false;\n                /** @type {boolean} true if event logging is enabled */\n                this.debugEvents = debugEvents;\n                /** @type {{[id:string]: {extraConnections?: Number, data?: object, loc?: object}}} active reflector connections */\n                this.views = {};\n                /** @type {SeedRandom} our synced pseudo random stream */\n                this._random = () => { throw Error(\"You must not use random when applying state!\"); };\n                /** @type {String} session ID */\n                this.id = snapshot.id; // the controller always provides an ID\n                /** @type {Number} how far simulation has progressed */\n                this.time = 0;\n                /** @type {Number} sequence number of last executed external message */\n                this.seq = INITIAL_SEQ;       // 0xFFFFFFF0 provokes 32 bit rollover soon\n                /** @type {Number} timestamp of last scheduled external message */\n                this.externalTime = 0;\n                /** @type {Number} sequence number of last scheduled external message */\n                this.externalSeq = this.seq;\n                /** @type {Number} sequence number for disambiguating future messages with same timestamp */\n                this.futureSeq = 0;\n                /** @type {Number} simulation time when last snapshot poll was taken */\n                this.lastSnapshotPoll = 0;\n                /** @type {Number} simulation time when last persistence poll was requested */\n                this.lastPersistencePoll = 0;\n                /** @type {Boolean} true when a future persistence poll has been scheduled */\n                this.inPersistenceCoolOff = false;\n                /** @type {String} hash of last persistent data upload */\n                this.persisted = \"\";\n                /** @type {Number} number for giving ids to model */\n                this.modelsId = 0;\n                /** @type {Map<String, Array<String>} if session diverged, maps timestamps to snapshot urls */\n                this.diverged = null;\n                /** @type {Controller} our controller, for sending messages. Excluded from snapshot */\n                this.controller = null;\n                if (snapshot.models) {\n                    // read vm from snapshot\n                    const reader = VMReader.newOrRecycled(this);\n                    const vmData = reader.readVM(snapshot, \"VM\", compat);\n                    let staticInitializers = [];\n                    let messages = [];\n                    // only read keys declared above\n                    for (const key of Object.keys(vmData)) {\n                        if (key === \"meta\") continue;\n                        else if (key === \"staticInitializers\") staticInitializers = vmData[key];\n                        else if (!(key in this)) console.warn(`Ignoring property snapshot.${key}`);\n                        else if (key === \"_random\") this[key] = new SeedRandom(null, { state: vmData[key] });\n                        else if (key === \"messages\") messages = vmData.messages;\n                        else this[key] = vmData[key];\n                    }\n                    // execute initializers of static class properties\n                    for (const staticInitializer of staticInitializers) staticInitializer();\n                    // add messages array to priority queue\n                    for (const msg of messages) this.messages.add(msg);\n                    // recreate subscribers from subscriptions\n                    for (const [topic, handlers] of Object.entries(this.subscriptions)) {\n                        for (const handler of handlers) {\n                            const [modelId] = handler.split('.');\n                            let topics = this.subscribers.get(modelId);\n                            if (!topics) this.subscribers.set(modelId, topics = new Set());\n                            topics.add(topic);\n                        }\n                    }\n                } else {\n                    // seed with session id so different sessions get different random streams\n                    this._random = new SeedRandom(snapshot.id, { state: true });\n                    this.addSubscription(this, \"__VM__\", \"__peers__\", this.generateJoinExit);\n                    this.addSubscription(this, \"__VM__\", \"__diverged__\", this.handleSessionDiverged);\n                    // creates root model and makes it well-known as 'modelRoot'\n                    initFn(this);\n                }\n            });\n        });\n    }\n\n    registerModel(model, id) {\n        if (CurrentVM !== this) throw Error(\"You can only create models from model code!\");\n        if (!id) id = \"M\" + ++this.modelsId;\n        this.models[id] = model;\n        // not assigning the id here catches missing super calls in init() and load()\n        return id;\n    }\n\n    deregisterModel(id) {\n        if (CurrentVM !== this) throw Error(\"You can only destroy models from model code!\");\n        const model = this.models;\n        delete this.models[id];\n        for (const [name, value] of Object.entries(this.namedModels)) {\n            if (model === value) delete this.namedModels[name];\n        }\n        this.messages.removeMany(msg => msg.hasReceiver(id));\n    }\n\n    lookUpModel(id) {\n        if (id === \"_\") return this;\n        let model = this.models[id];\n        if (model) return model;\n        const [_, modelID, partId] = id.match(/^([^#]+)#(.*)$/) || [];\n        model = this.models[modelID];\n        return model && model.lookUp(partId);\n    }\n\n    get(modelName) {\n        const model = this.namedModels[modelName];\n        if (CurrentVM !== this && DEBUG.write && model) return this.debugWriteProxy(this, model, model.id);\n        return model;\n    }\n\n    set(modelName, model) {\n        if (CurrentVM !== this) throw Error(\"You can only make a model well-known from model code!\");\n        this.namedModels[modelName] = model;\n    }\n\n    debugWriteProxy(vm, object, path) {\n        if (typeof object !== \"object\" || object === null || object[DEBUG_WRITE_TARGET]) return object;\n        if (object instanceof Model) path = object.id;\n        if (!this.$debugWriteProxyHandler) {\n            if (!DEBUG_WRITE_PROXIES) DEBUG_WRITE_PROXIES = new WeakMap();\n            function writeError(what, obj, prop) {\n                if (prop) what += ` ${prop} of`;\n                const objPath = DEBUG_WRITE_PROXIES.get(obj).path;\n                console.warn(`write-debug: non-model code is ${what} ${objPath}:`, obj);\n                if (prop && prop[0] !== \"$\") throw Error(`write-debug: Attempt to modify ${App.libName} model state from outside!`);\n            }\n            this.$debugWriteProxyHandler = {\n                set(target, property, value) {\n                    if (CurrentVM !== vm) writeError(\"assigning\", target, property);\n                    else { console.warn(`${App.libName} debug write protection inside model - this should not happen!`); }\n                    target[property] = value;\n                },\n                deleteProperty(target, property) {\n                    if (CurrentVM !== vm) writeError(\"deleting\", target, property);\n                    else { console.warn(`${App.libName} debug write protection inside model - this should not happen!`); }\n                    delete target[property];\n                },\n                get(target, property) {\n                    if (property === DEBUG_WRITE_TARGET) return target;\n                    const value = target[property];\n                    if (value && value[DEBUG_WRITE_TARGET]) return value;\n                    if (CurrentVM !== vm) {\n                        if (typeof value === \"object\" && value !== null) {\n                            const targetPath = DEBUG_WRITE_PROXIES.get(target).path;\n                            if (value instanceof Map) {\n                                const map = new Map([...value.entries()].map(([key, val], i) => {\n                                    return [\n                                        vm.debugWriteProxy(vm, key, `${targetPath}.key#${i}`),\n                                        vm.debugWriteProxy(vm, val, `${targetPath}.value#${i}`)\n                                    ];\n                                }));\n                                map[DEBUG_WRITE_TARGET] = value;\n                                map.set = () => writeError(\"setting an item in\", value);\n                                map.delete = () => writeError(\"deleting from\", value);\n                                map.clear = () => writeError(\"clearing\", value);\n                                DEBUG_WRITE_PROXIES.set(value, { proxy: map, path: targetPath + propertyAccessor(value, property) });\n                                return map;\n                            }\n                            if (value instanceof Set) {\n                                const set = new Set([...value.values()].map((val, i) => vm.debugWriteProxy(vm, val, `${targetPath}.item#${i}`)));\n                                set[DEBUG_WRITE_TARGET] = value;\n                                set.add = () => writeError(\"adding to\", value);\n                                set.delete = () => writeError(\"deleting from\", value);\n                                set.clear = () => writeError(\"clearing\", value);\n                                DEBUG_WRITE_PROXIES.set(value, { proxy: set, path: targetPath + propertyAccessor(value, property) });\n                                return set;\n                            }\n                            // TODO: Proxies for TypedArrays, DataView, ArrayBuffer, etc\n                            // (Array appears to work, it internally calls proxy.get() for e.g. slice())\n                            return vm.debugWriteProxy(vm, value, targetPath + propertyAccessor(value, property));\n                        }\n                    } else { console.warn(`${App.libName} debug write protection inside model - this should not happen!`); }\n                    return value;\n                }\n            };\n        }\n        let proxy = DEBUG_WRITE_PROXIES.get(object);\n        if (!proxy) {\n            proxy = {\n                proxy: new Proxy(object, this.$debugWriteProxyHandler),\n                path\n            };\n            DEBUG_WRITE_PROXIES.set(object, proxy);\n        }\n        return proxy.proxy;\n    }\n\n    // used in Controller.convertReflectorMessage()\n    noop() {}\n\n    // generate perfectly paired view-join and view-exit events\n    // from imperfectly paired reflector messages\n    // e.g. nobody is there to receive an exit event for the last view\n    // leaving a session so we generate those when the first view resumes a session\n    // keeping track of views in the currently not exposed this.views property\n    generateJoinExit({entered, exited, count, total}) {\n        // for DePIN accounting, we want to track the moments when the synchronizer's\n        // 'user' messages convey a change in the number of users.\n        this.controller.handleUserTotalForAccounting(total);\n\n        // if the app passed viewData to Session.join() then the controller\n        // sent { id, data } as user instead of a plain viewId string. If location was\n        // also requested then the reflector may have added the location as\n        // { id, data, location: {region, city: {name, lat, lng}} }\n        // if location was enabled (but no viewData) then controller.join() sent\n        // a [viewId] array as user instead of a plain viewId string, so the reflector\n        // may have added the location as [viewId, {region, city: {name, lat, lng}}],\n        // see JOIN() in reflector.js\n\n        const newViews = {};\n        for (const user of entered) {\n            if (typeof user === \"string\") continue; // only viewId\n            let viewId, loc, data;\n            if (Array.isArray(user)) [ viewId, loc ] = user;\n            else { viewId = user.id; data = user.data; loc = user.location; }\n            newViews[viewId] = {};\n            if (data) newViews[viewId].data = data;\n            if (loc) {\n                if (loc.region) {\n                    loc.country = loc.region.slice(0, 2);\n                    loc.region = loc.region.slice(2);\n                }\n                newViews[viewId].loc = loc;\n            }\n        }\n        entered = entered.map(user => typeof user === \"string\" ? user : Array.isArray(user) ? user[0] : user.id);\n        exited = exited.map(user => typeof user === \"string\" ? user : Array.isArray(user) ? user[0] : user.id);\n        // if entered length == count then the reflector just resumed the session\n        // synthesize exit events for old views stored in snapshot\n        if (entered.length === count) {\n            exited = Object.keys(this.views);\n            // all connections gone\n            for (const id of exited) this.views[id].extraConnections = 0;\n        }\n        // reflector may send join+exit for same view in one event\n        // in which case we remove it from both lists to avoid\n        // generating an exit immediately followed by a join\n        if (entered.length > 0 && exited.length > 0 && entered.some(id => exited.includes(id))) {\n            // it's possible that either array contains the same view twice\n            // so we remove them in pairs to keep the count correct\n            for (let enterIndex = 0; enterIndex < entered.length; enterIndex++) {\n                const id = entered[enterIndex];\n                const exitIndex = exited.indexOf(id);\n                if (exitIndex >= 0) {\n                    entered.splice(enterIndex, 1);\n                    exited.splice(exitIndex, 1);\n                    enterIndex--; // we removed this id, check the same index again\n                }\n            }\n            // if there are no events left then there's nothing to do\n            if (entered.length + exited.length === 0) return;\n        }\n        // join/exit event payload is either \"viewId\" or { viewId, viewData }\n        // depending on whether the session was joined with a viewData\n        const viewInfo = id => {\n            const { data, loc } = this.views[id];\n            if (!data) return id;\n            const info = { viewId: id, viewData: data };\n            if (loc) info.location = loc; // location only if requested\n            return info;\n        };\n        // process exits first\n        for (const id of exited) {\n            if (this.views[id]) {\n                // ignore exit for multiple connections (see below)\n                if (this.views[id].extraConnections) {\n                    this.views[id].extraConnections--;\n                    if (DEBUG.session) console.log(this.id, `@${this.time}#${this.seq} view ${id} closed extra connection`);\n                    continue;\n                }\n                // otherwise this is a real exit\n                const payload = viewInfo(id);\n                delete this.views[id];\n                this.publishFromModelOnly(this.id, \"view-exit\", payload);\n            } else {\n                // there is no way this could ever happen. If it does, something is seriously broken.\n                const { time, seq } = this;\n                console.error(`${this.id} @${time}#${seq} view ${id} exited without being present - this should not happen`);\n                Promise.resolve().then(() => {\n                    this.controller.sendLog(`view-exit-mismatch @${time}#${seq} ${id} left without being present`);\n                });\n            }\n        }\n        // then joins\n        for (const id of entered) {\n            if (this.views[id]) {\n                // this happens if a client rejoins but the reflector is still holding\n                // onto the old connection\n                if (DEBUG.session) console.log(this.id, `@${this.time}#${this.seq} view ${id} opened another connection`);\n                this.views[id].extraConnections = (this.views[id].extraConnections||0) + 1;\n            } else {\n                // otherwise this is a real join\n                this.views[id] = newViews[id] || {};\n                const payload = viewInfo(id);\n                this.publishFromModelOnly(this.id, \"view-join\", payload);\n            }\n        }\n        // sanity check: the active number of connections on the reflector should match our count\n        const connections = Object.values(this.views).reduce((n, view) => n + 1 + (view.extraConnections || 0), 0);\n        if (count !== connections) {\n            const { time, seq } = this;\n            console.error(`@${time}#${seq} view count mismatch (model: ${connections}, reflector: ${count}) - this should not happen`);\n            Promise.resolve().then(() => {\n                this.controller.sendLog(`view-exit-mismatch @${time}#${seq} connections model: ${connections} reflector: ${count}`);\n            });\n        }\n    }\n\n    /** decode msgData and sort it into future queue\n     * @param {MessageData} msgData - encoded message\n     * @return {Message} decoded message\n     */\n    scheduleExternalMessage(msgData) {\n        const message = Message.fromState(msgData, this);\n        if (message.time < this.time) throw Error(\"past message from reflector \" + msgData);\n        const nextSeq = (this.externalSeq + 1) >>> 0;\n        if (message.seq !== nextSeq) throw Error(`External message error. Expected message #${nextSeq} got #${message.seq}`);\n        this.externalTime = message.time; // we have all external messages up to this time\n        this.externalSeq = message.seq; // we have all external messages up to this sequence number\n        message.seq = message.seq * 2 + 1;  // make odd sequence for external messages\n        this.verifyExternal(message); // may throw\n        this.messages.add(message);\n        return message;\n    }\n\n    /** limit the methods that can be triggered directly via reflector */\n    verifyExternal(msg) {\n        if (msg.receiver !== \"_\") throw Error(`invalid receiver in external message: ${msg}`);\n        if (!(msg.selector in ENCODE_MESSAGE)) throw Error(`unexpected external message: ${msg.selector}`);\n    }\n\n    futureSend(tOffset, receiverID, selector, args) {\n        if (tOffset.every) return this.futureRepeat(tOffset.every, receiverID, selector, args);\n        if (tOffset < 0) throw Error(\"attempt to send future message into the past\");\n        // Wrapping below is fine because the message comparison function deals with it.\n        // To have a defined ordering between future messages generated on vm\n        // and messages from the reflector, we create even sequence numbers here and\n        // the reflector's sequence numbers are made odd on arrival\n        this.futureSeq = (this.futureSeq + 1) >>> 0;\n        const message = new Message(this.time + tOffset, 2 * this.futureSeq, receiverID, selector, args);\n        this.messages.add(message);\n        return { time: message.time, seq: message.seq }; // for cancelFuture\n    }\n\n    cancelFuture(model, methodOrMessage) {\n        const messages = this.messages;\n        let removed;\n        if (typeof methodOrMessage.time === \"number\") {\n            const { time, seq } = methodOrMessage;\n            removed = messages.removeOne(msg => msg.time === time && msg.seq === seq);\n        } else if (methodOrMessage === \"*\") {\n            removed = messages.removeMany(msg => msg.receiver === model.id);\n            return removed.length > 0;\n        } else {\n            const methodName = this.asMethodName(model, methodOrMessage, CANCEL_FUTURE);\n            const receiverID = model.id;\n            removed = messages.removeOne(msg => msg.receiver === receiverID && msg.selector === methodName\n                || msg.receiver === \"_\" && msg.selector === \"futureExecAndRepeat\" && msg.args[1] === receiverID && msg.args[2] === methodName);\n            if (isQFuncFuture(methodName)) {\n                delete model[methodName];\n            }\n        }\n        return removed !== undefined;\n    }\n\n    futureRepeat(tOffset, receiverID, selector, args) {\n        // \"_ \" is a special receiver that means \"this VM\"\n        this.futureSend(tOffset, \"_\", \"futureExecAndRepeat\", [tOffset, receiverID, selector, args]);\n    }\n\n    futureExecAndRepeat(tOffset, receiverID, selector, args) {\n        const model = this.lookUpModel(receiverID);\n        if (!model) return; // model was destroyed\n        if (typeof model[selector] === \"function\") {\n            try {\n                model[selector](...args);\n            } catch (error) {\n                displayAppError(`future message ${model}.${selector}`, error);\n            }\n        } else {\n            const fn = this.compileFuncString(selector, model);\n            try {\n                fn(...args);\n            } catch (error) {\n                displayAppError(`future message ${model} ${fn}`, error);\n            }\n        }\n        this.futureRepeat(tOffset, receiverID, selector, args);\n    }\n\n\n    // Convert model.future(tOffset).property(...args)\n    // or model.future(tOffset, \"property\",...args)\n    // into this.futureSend(tOffset, model.id, \"property\", args)\n    future(model, tOffset, methodNameOrCallback, methodArgs) {\n        if (!this.lookUpModel(model.id)) throw Error(`future send to unregistered model ${model}`);\n        if (methodNameOrCallback === undefined) {\n            const vm = this;\n            return new Proxy(model, {\n                get(_target, property) { return (...args) => vm.future(model, tOffset, property, args); }\n            });\n        }\n        const methodName = this.asMethodName(model, methodNameOrCallback, FUTURE_MESSAGE_HANDLER);\n        if (typeof methodName !== \"string\") throw Error(`future message to ${model} ${methodName} is not a string`);\n        if (typeof model[methodName] !== \"function\" && methodName.indexOf('.') < 0 && methodName[0] !== '{') throw Error(`future send to ${model} with unknown method ${methodName}()`);\n        return this.futureSend(tOffset, model.id, methodName, methodArgs);\n    }\n\n    /**\n     * Process pending messages for this vm and advance simulation time.\n     * Must only be sent by controller!\n     * @param {Number} newTime - simulate at most up to this time\n     * @param {Number} deadline - CPU time deadline for interrupting simulation\n     * @returns {Boolean} true if finished simulation before deadline\n     */\n    advanceTo(newTime, deadline) {\n        if (CurrentVM) throw Error(\"cannot advance time from model code\");\n        let message;\n        // process each message in queue up to newTime\n        while ((message = this.messages.peek()) && message.time <= newTime) {\n            const { time, seq } = message;\n            if (time < this.time) throw Error(\"past message encountered: \" + message);\n            // if external message, check seq so we don't miss any\n            if (seq & 1) {\n                this.seq = (this.seq + 1) >>> 0;  // uint32 rollover\n                // use seq/2 instead of seq >>> 1 because message.seq has 33 bits\n                if ((seq/2) >>> 0 !== this.seq) throw Error(`Sequence error: expected ${this.seq} got ${(seq/2) >>> 0} in ${message}`);\n            }\n            // drop first message in message queue\n            this.messages.poll();\n            // advance time\n            this.time = message.time;\n            // execute future or external message\n            message.executeOn(this);\n            // if we're out of time, bail out\n            if (globalThis.CroquetViewDate.now() >= deadline) return false;\n        }\n        // we processed all messages up to newTime\n        this.time = newTime;\n        return true;\n    }\n\n    // Pub-sub\n\n    // Subscriptions and future messages are stored as strings\n    // and interpreted as method names.\n    // Typically we recommend passing \"this.method\" as the handler\n    // which stores the method name in the model and returns it.\n    // It's also acceptable to pass the method name as a string.\n    // If a QFunc is passed, it is registered as a method in the model\n    // temporarily under a special name, and that special name is returned.\n    // The QFunc method is removed automatically:\n    // - if it's a future message, right before executing the message\n    // - if it's a subscription handler, when unsubscribing\n    asMethodName(model, func, what, topic=null) {\n        // if a string was passed in, assume it's a method name\n        if (typeof func === \"string\") return func;\n        // if a function was passed in, it should be a method or QFunc\n        if (typeof func === \"function\") {\n            // if passing this.method we can just return the name\n            if (model[func.name] === func) return func.name;\n            // if passing a QFunc, we can check if it's a subscription handler for the topic\n            if (func[QFUNC] && topic) {\n                const subscription = asQFuncSubscription(topic);\n                if (model[subscription] === func) return subscription;\n            }\n            // if passing this.foo = this.method\n            let obj = model;\n            while (obj !== null) {\n                // if it's a method or future-message QFunc, return the name\n                for (const [name, desc] of Object.entries(Object.getOwnPropertyDescriptors(obj))) {\n                    if (desc.value === func) {\n                        if (func[QFUNC] && !(handlesFuture(what) && isQFuncFuture(name))) continue;\n                        return name;\n                    }\n                }\n                // if it's a QFunc handler, register it in the model\n                // (if it was registered before, it would have been found above)\n                if (obj === model && func[QFUNC]) {\n                    if (!shouldRegisterQFuncMethod(what)) {\n                        displayWarning(`${what} is not a registered QFunc: ${func}`, { only: \"once\" });\n                        return null;\n                    }\n                    let name;\n                    if (topic) name = asQFuncSubscription(topic); // implies a subscription\n                    else {\n                        const prefix = QFUNC_FUTURE_PREFIX;\n                        let i = 0;\n                        do { name = `${prefix}${i++}`; } while (model[name]);\n                    }\n                    model[name] = func;\n                    return name;\n                    // this registration is cleaned up after executing a future QFunc\n                    // or when unsubscribing the QFunc\n                }\n                // no QFunc, check the prototype chain\n                obj = Object.getPrototypeOf(obj);\n            }\n            // otherwise, assume it's an inline function\n            displayWarning(`${what} is not a method of ${model} and not a QFunc: ${func}\\n`, { only: \"once\" });\n            // if passing (foo) => this.bar(baz)\n            // match:                (   foo             )   =>  this .  bar              (    baz               )\n            const HANDLER_REGEX = /^\\(?([a-z][a-z0-9]*)?\\)? *=> *this\\.([a-z][a-z0-9]*) *\\( *([a-z][a-z0-9]*)? *\\) *$/i;\n            // captures:               [      1       ]                [       2      ]      [      3       ]\n            const source = func.toString();\n            const match = source.match(HANDLER_REGEX);\n            // it matches, and the parameter name is the same as the argument name\n            if (match && (!match[3] || match[3] === match[1])) return match[2];\n            // otherwise, convert the function to a func string\n            return this.asFuncString(func);\n        }\n        return null;\n    }\n\n    /*\n    * asFuncString and compileFuncString are used to serialize simple inline\n    * event handler functions. They can be used directly as handlers in model\n    * code (subcriptions and future messages) but are not fully supported.\n    * A warning is displayed if they are used.\n    * TODO: make full QFuncs usable in these places\n    */\n\n    asFuncString(fn) {\n        const source = fn.toString();\n        return `{${btoa(JSON.stringify(source))}}`;\n        // methodName[0] === \"{\" is used to identify this as a funcString\n    }\n\n    compileFuncString(str, model) {\n        // funcs are bound to model instances, only cache them per VM\n        if (!this.$compiledFuncs) this.$compiledFuncs = {};\n        const cacheKey = model.id + ':' + str;\n        let fn = this.$compiledFuncs[cacheKey];\n        if (!fn) {\n            const source = JSON.parse(atob(str.slice(1, -1)));\n            fn = compileQFunc(source, model);\n            if (source.startsWith(\"function\")) fn = fn.bind(model);\n            this.$compiledFuncs[cacheKey] = fn;\n        }\n        return fn;\n    }\n\n\n    addSubscription(model, scope, event, methodNameOrCallback) {\n        if (CurrentVM !== this) throw Error(\"Cannot add a model subscription from outside model code\");\n        if (scope.includes(':')) throw Error(`Invalid subscription scope \"${scope}\" (must not contain ':')`);\n        const topic = scope + ':' + event;\n        const methodName = this.asMethodName(model, methodNameOrCallback, SUBSCRIPTION_HANDLER, topic);\n        if (typeof methodName !== \"string\") {\n            throw Error(`Subscription handler for \"${event}\" must be a method name`);\n        }\n        if (methodName.indexOf('.') < 0 && typeof model[methodName] !== \"function\") {\n            if (methodName[0] !== '{') throw Error(`Subscriber method for \"${event}\" not found: ${model}.${methodName}()`);\n        }\n        const id = model === this ? \"_\" : model.id;\n        const handler = id + '.' + methodName;\n        // check for generic subscriptions first\n        if (scope === \"*\" || event === \"*\") {\n            this.addGenericSubscription(topic, handler);\n            return;\n        }\n        // model subscriptions need to be ordered, so we're using an array\n        if (!this.subscriptions[topic]) this.subscriptions[topic] = [];\n        else if (this.subscriptions[topic].indexOf(handler) !== -1) {\n            throw Error(`${model}.${methodName} already subscribed to ${event}`);\n        }\n        this.subscriptions[topic].push(handler);\n        let topics = this.subscribers.get(id);\n        if (!topics) this.subscribers.set(id, topics = new Set());\n        topics.add(topic);\n    }\n\n    removeSubscription(model, scope, event, methodName=\"*\") {\n        if (CurrentVM !== this) throw Error(\"Cannot remove a model subscription from outside model code\");\n        if (scope === \"*\" || event === \"*\") {\n            this.removeGenericSubscription(model, scope, event, methodName);\n            return;\n        }\n        const topic = scope + ':' + event;\n        const handlers = this.subscriptions[topic];\n        if (handlers) {\n            const handlerPrefix = model.id + '.';\n            if (methodName === \"*\") {\n                // modify the array in place so the loop in handleModelEventInModel()\n                // will not execute removed handlers\n                for (let i = handlers.length - 1; i >= 0; i--) {\n                    if (handlers[i].startsWith(handlerPrefix)) {\n                        const nameString = handlers[i].slice(handlerPrefix.length);\n                        if (isRegisteredQFuncSubscription(nameString, topic)) delete model[nameString];\n                        handlers.splice(i, 1);\n                    }\n                }\n                if (handlers.length === 0) delete this.subscriptions[topic];\n            } else {\n                const nameString = this.asMethodName(model, methodName, UNSUBSCRIBE_ARGUMENT, topic);\n                if (typeof nameString !== \"string\") {\n                    throw Error(`Invalid unsubscribe args for \"${event}\" in ${model}: ${methodName}`);\n                }\n                const handler = handlerPrefix + nameString;\n                const indexToRemove = handlers.indexOf(handler);\n                if (indexToRemove !== -1) {\n                    handlers.splice(indexToRemove, 1);\n                    if (handlers.length === 0) delete this.subscriptions[topic];\n                    if (isRegisteredQFuncSubscription(nameString, topic)) delete model[nameString];\n                }\n                // if there are remaining handlers, do not remove the topic for this model\n                if (handlers.find(h => h.startsWith(handlerPrefix))) {\n                    return;\n                }\n            }\n            // all handlers of this model for the topic are gone, remove the topic\n            const topics = this.subscribers.get(model.id);\n            topics.delete(topic);\n            if (topics.size === 0) this.subscribers.delete(model.id);\n        }\n    }\n\n    addGenericSubscription(topic, handler) {\n        this.genericSubscriptions.push({ topic, handler });\n    }\n\n    removeGenericSubscription(model, scope, event, methodName = \"*\") {\n        const topic = scope + ':' + event;\n        const handlerPrefix = model.id + '.';\n        for (let i = this.genericSubscriptions.length - 1; i >= 0; i--) {\n            const subscription = this.genericSubscriptions[i];\n            if (subscription.topic === topic && subscription.handler.startsWith(handlerPrefix)) {\n                if (methodName === \"*\" || subscription.handler === handlerPrefix + methodName) {\n                    this.genericSubscriptions.splice(i, 1);\n                    if (isRegisteredQFuncSubscription(methodName, topic)) delete model[methodName];\n                }\n            }\n        }\n    }\n\n    removeAllSubscriptionsFor(model) {\n        const topics = this.subscribers.get(model.id);\n        if (topics) {\n            const handlerPrefix = model.id + '.';\n            for (const topic of topics) {\n                const handlers = this.subscriptions[topic];\n                // modify the array in place so the loop in handleModelEventInModel()\n                // will not execute removed handlers\n                for (let i = handlers.length - 1; i >= 0; i--) {\n                    if (handlers[i].startsWith(handlerPrefix)) {\n                        const nameString = handlers[i].slice(handlerPrefix.length);\n                        if (isRegisteredQFuncSubscription(nameString, topic)) delete model[nameString];\n                        handlers.splice(i, 1);\n                    }\n                }\n                if (handlers.length === 0) delete this.subscriptions[topic];\n            }\n            this.subscribers.delete(model.id);\n        }\n    }\n\n    publishFromModel(scope, event, data) {\n        if (CurrentVM !== this) throw Error(\"Cannot publish a model event from outside model code\");\n        if (scope.includes(':')) throw Error(`Invalid publish scope \"${scope}\" (must not contain ':')`);\n        // @@ hack for forcing reflection of model-to-model messages\n        const reflected = event.endsWith(REFLECTED_SUFFIX);\n        if (reflected) event = event.slice(0, event.length - REFLECTED_SUFFIX.length);\n\n        const fromModel = this.currentEventFromModel;\n        this.currentEventFromModel = true;\n\n        const topic = scope + ':' + event;\n        this.handleModelEventInModel(topic, data, reflected);\n        this.handleModelEventInView(topic, data);\n\n        this.currentEventFromModel = fromModel;\n    }\n\n    publishFromModelOnly(scope, event, data) {\n        if (CurrentVM !== this) throw Error(\"Cannot publish a model event from outside model code\");\n        // we don't set currentEventFromModel because this method\n        // is only used to translate reflector messages into model events\n        const topic = scope + ':' + event;\n        this.handleModelEventInModel(topic, data);\n    }\n\n    publishFromView(scope, event, data) {\n        if (CurrentVM) throw Error(\"Cannot publish a view event from model code\");\n        if (scope.includes(':')) throw Error(`Invalid publish scope \"${scope}\" (must not contain ':')`);\n        const topic = scope + ':' + event;\n        this.handleViewEventInModel(topic, data);\n        this.handleViewEventInView(topic, data);\n    }\n\n    handleBundledEvents(events) {\n        for (const msgState of events) {\n            const message = Message.fromState(msgState, this);\n            this.verifyExternal(message); // may throw\n            message.executeOn(this, true); // nested invocation\n        }\n    }\n\n    handleModelEventInModel(topic, data, reflect=false) {\n        // model=>model events are handled synchronously unless reflected\n        // because making them async would mean having to use future messages\n        if (CurrentVM !== this) throw Error(\"handleModelEventInModel called from outside model code\");\n        if (reflect) {\n            if (this.controller.synced !== true) return;\n\n            const voteTopic = topic + VOTE_SUFFIX;\n            const divergenceTopic = topic + DIVERGENCE_SUFFIX;\n            const wantsVote = !!viewDomain.subscriptions[voteTopic], wantsFirst = !!this.subscriptions[topic], wantsDiverge = !!this.subscriptions[divergenceTopic];\n            if (wantsVote && wantsDiverge) console.log(`divergence subscription for ${topic} overridden by vote subscription`);\n            // iff there are subscribers to a first message, build a candidate for the message that should be broadcast\n            const firstMessage = wantsFirst ? new Message(this.time, 0, \"_\", \"handleModelEventInModel\", [topic, data]) : null;\n            // provide the receiver, selector and topic for any eventual tally response from the reflector.\n            // if there are subscriptions to a vote, it'll be a handleModelEventInView with\n            // the vote-augmented topic.  if not, default to our handleTuttiDivergence.\n            let tallyTarget;\n            if (wantsVote) tallyTarget = [\"handleModelEventInView\", voteTopic];\n            else tallyTarget = [\"handleTuttiDivergence\", divergenceTopic];\n            Promise.resolve().then(() => this.controller.sendTutti({\n                time: this.time,\n                topic,\n                data,\n                firstMessage,\n                wantsVote,\n                tallyTarget\n                })); // break out of model code\n        } else {\n            // try to keep this as quick as possible if there is no subscription\n\n            // generic handlers (typically none)\n            // these are first so e.g. a logger logs before other handlers\n            // that were triggered by an external event\n            if (this.genericSubscriptions.length > 0) {\n                this.invokeGenericHandlers(topic, data);\n            }\n\n            // regular handlers\n            if (this.subscriptions[topic]) {\n                this.invokeHandlers(this.subscriptions[topic], topic, data);\n            }\n        }\n    }\n\n    invokeHandlers(liveHandlers, topic, data) {\n        // live handlers may be added or removed during the loop\n        // we skip both removed and added handlers for this event cycle\n        const handlers = liveHandlers.slice(); // O(n)\n        for (let i = 0; i < handlers.length; i++) {\n            const handler = handlers[i];\n            // the includes() in this loop makes it O(n^2), but we only do it\n            // when a handler is removed while iterating, which is rare.\n            // Devs can avoid this by using future(0) to unsubscribe/destroy\n            if (handler !== liveHandlers[i] && !liveHandlers.includes(handler)) {\n                continue; // handler was removed\n            }\n            this.invokeHandler(handler, topic, data);\n        }\n    }\n\n    invokeGenericHandlers(topic, data) {\n        const [scope, event] = topic.split(':');\n        if ((scope.startsWith(\"__\") && scope.endsWith(\"__\"))\n            || (event.startsWith(\"__\") && event.endsWith(\"__\"))) return; // ignore internal events\n        for (const subscription of this.genericSubscriptions) {\n            const [subScope, subEvent] = subscription.topic.split(':');\n            if (subScope === \"*\" && subEvent === event\n                || subScope === scope && subEvent === \"*\"\n                || subScope === \"*\" && subEvent === \"*\")\n            {\n                this.invokeHandler(subscription.handler, topic, data);\n            }\n        }\n    }\n\n    invokeHandler(handler, topic, data) {\n        const prevEvent = this.currentEvent;\n        this.currentEvent = topic;\n        try {\n            const [id, ...rest] = handler.split('.');\n            const methodName = rest.join('.');\n            const model = this.lookUpModel(id);\n\n            if (!model) {\n                displayWarning(`event ${topic} .${methodName}(): subscriber not found`);\n                return;\n            }\n            if (methodName[0] === '{') {\n                const fn = this.compileFuncString(methodName, model);\n                try {\n                    fn(data);\n                } catch (error) {\n                    displayAppError(`event ${topic} ${model} ${fn}`, error);\n                }\n                return;\n            }\n            if (methodName.indexOf('.') >= 0) {\n                const dot = methodName.indexOf('.');\n                const head = methodName.slice(0, dot);\n                const tail = methodName.slice(dot + 1);\n                try {\n                    model.call(head, tail, data);\n                } catch (error) {\n                    displayAppError(`event ${topic} ${model}.call(${JSON.stringify(head)}, ${JSON.stringify(tail)})`, error);\n                }\n                return;\n            }\n            if (typeof model[methodName] !== \"function\") {\n                displayAppError(`event ${topic} ${model}.${methodName}(): method not found`);\n                return;\n            }\n            try {\n                model[methodName](data);\n            } catch (error) {\n                displayAppError(`event ${topic} ${model}.${methodName}()`, error);\n            }\n        } finally {\n            this.currentEvent = prevEvent;\n        }\n    }\n\n    handleViewEventInModel(topic, data) {\n        // view=>model events are converted to model=>model events via reflector\n        if (this.subscriptions[topic]) {\n            const args = [topic];\n            if (data !== undefined) args.push(data); // avoid {\"$class\":\"Undefined\"}\n            const message = new Message(this.time, 0, \"_\", \"handleModelEventInModel\", args);\n            this.controller.sendMessage(message);\n        }\n    }\n\n    handleModelEventInView(topic, data) {\n        if (DEBUG.write) data = this.debugWriteProxy(this, data, `event ${topic} arg`);\n        viewDomain.handleEvent(topic, data, fn => execOutsideVM(() => inViewRealm(this, fn, true)));\n    }\n\n    handleViewEventInView(topic, data) {\n        viewDomain.handleEvent(topic, data);\n    }\n\n    handleTuttiDivergence(divergenceTopic, data) {\n        // for a reflected model message foo#reflected, by default divergence triggers any model\n        // subscriptions for foo#divergence.\n        if (this.subscriptions[divergenceTopic]) this.handleModelEventInModel(divergenceTopic, data);\n        else {\n            const event = divergenceTopic.split(':').slice(-1)[0];\n            console.warn(`uncaptured divergence in ${event}:`, data);\n        }\n    }\n\n    handleSessionDiverged(data) {\n        const { key, url } = data;\n        if (!this.diverged) this.diverged = new Map();\n        let urls = this.diverged.get(key);\n        if (!urls) this.diverged.set(key, urls = []);\n        urls.push(url);\n        if (urls.length === 2 && this.controller && !this.controller.fastForwardHandler) this.debugDiverged(key);\n    }\n\n    debugDiverged(key) {\n        if (!key) key = this.diverged.keys().next().value;\n        const urls = this.diverged.get(key);\n        if (!urls || urls.length < 2) throw Error(`no diverged urls for snapshot ${key}`);\n        Promise.resolve().then(() => this.controller.diffDivergedSnapshots(urls));\n    }\n\n    processModelViewEvents(isInAnimationStep) {\n        if (CurrentVM) throw Error(\"cannot process view events in model code\");\n        return inViewRealm(this, () => viewDomain.processFrameEvents(isInAnimationStep, !!this.controller.synced));\n    }\n\n    handlePollForSnapshot() {\n        // make sure there isn't a clash between clients simultaneously deciding\n        // that it's time for someone to take a snapshot.\n        const now = this.time;\n        const sinceLast = now - this.lastSnapshotPoll;\n        if (sinceLast < SNAPSHOT_MIN_POLL_GAP) { // arbitrary - needs to be long enough to ensure this isn't part of the same batch\n            console.log(`rejecting snapshot poll ${sinceLast}ms after previous`);\n            return;\n        }\n\n        this.lastSnapshotPoll = now;\n        this.controller.handlePollForSnapshot(now);\n    }\n\n    handleTuttiResult(data) {\n        this.controller.handleTuttiResult(data);\n    }\n\n    handleSnapshotVote(data) {\n        this.controller.handleSnapshotVote(data);\n    }\n\n    handlePersistVote(data) {\n        this.controller.handlePersistVote(data);\n    }\n\n    handleAuditRequest(data) {\n        this.controller.handleAuditRequest(data);\n    }\n\n    snapshot() {\n        const writer = VMWriter.newOrRecycled(this);\n        return writer.snapshot(this, \"VM\");\n    }\n\n    // return the stringification of an object describing the vm - currently { oC, mC, nanC, infC, zC, nC, nH, sC, sL, fC } - for checking agreement between instances\n    getSummaryHash() {\n        return stableStringify(new VMHasher().getHash(this));\n    }\n\n    debug(options) {\n        // only for debugging: options is either { [option]: value } or a 'opt1,opt2,noopt3,...' string\n        return this.controller.setDebug(options);\n    }\n\n    forceSnapshot() {\n        // only for debugging\n        this.controller.requestDebugSnapshot();\n    }\n\n    persist(model, persistentDataFunc) {\n        if (this.controller && this.controller.sessionSpec.appId === 'no.appId') console.warn(`${App.libName}: appId should be provided in Session.join() to not overwrite another apps's persistent data`);\n        const start = Stats.begin(\"snapshot\");\n        const persistentData = typeof persistentDataFunc === \"function\" ? persistentDataFunc.call(model) : persistentDataFunc;\n        if (typeof persistentData !== \"object\") throw Error(`${App.libName}: persistSession() can only persist objects (got ${typeof persistentData})`);\n        const persistentString = stableStringify(persistentData);\n        const persistentHash = Data.hash(persistentString);\n        const ms = Stats.end(\"snapshot\") - start;\n        const unchanged = this.persisted === persistentHash;\n        const persistTime = this.time;\n        if (DEBUG.snapshot) console.log(this.id, `persistent data @${persistTime} collected, stringified and hashed in ${Math.ceil(ms)}ms${unchanged ? \" (unchanged, ignoring)\" : \"\"}`);\n        if (urlOptions.forcePersist) {\n            queueMicrotask(() => this.controller.forcePersist(persistTime, persistentString, persistentHash));\n        }\n        if (unchanged) return;\n\n        // we rely on a local, view-specific cache of persistence data that deserves\n        // to be uploaded, perhaps after a suitable cooloff period since the previous.\n        // newly joining clients will each populate that local cache if they simulate\n        // their way through the steps that cause the persistence call... but if there\n        // has been a snapshot since that call, a new client will not populate the cache.\n        // therefore we update the model with the new persistentHash as soon as it is\n        // generated, even though there is no guarantee that any client will survive\n        // long enough with the cached persistentString to upload it.  in the worst\n        // case, that iteration of the persistence will be lost.\n        setPersistenceCache(this, { persistTime, persistentString, persistentHash, ms });\n        this.persisted = persistentHash; // update the model, whatever happens\n\n        // figure out whether it's ok to go ahead immediately with a poll\n        if (this.inPersistenceCoolOff) {\n            if (DEBUG.snapshot) console.log(this.id, `persistence poll postponed by cooloff`);\n        } else {\n            const timeUntilReady = this.lastPersistencePoll ? this.lastPersistencePoll + PERSIST_MIN_POLL_GAP - this.time : 0;\n            if (timeUntilReady > 0) {\n                if (DEBUG.snapshot) console.log(this.id, `postponing persistence poll by ${timeUntilReady}ms`);\n                this.futureSend(timeUntilReady, \"_\", \"triggerPersistencePoll\", []);\n                this.inPersistenceCoolOff = true;\n            } else {\n                // go right ahead\n                this.triggerPersistencePoll();\n            }\n        }\n    }\n\n    triggerPersistencePoll() {\n        this.inPersistenceCoolOff = false;\n        this.lastPersistencePoll = this.controller ? this.time : 0; // ignore during init()\n\n        const details = getPersistenceCache(this);\n        if (!details) return; // this client, at least, has nothing ready to upload\n\n        const { persistTime, persistentString, persistentHash, ms } = details;\n        clearPersistenceCache(this);\n\n        // controller is unset only during init()\n        // this lets us init the hash, but we won't upload the initial state\n        if (!this.controller) return;\n\n        if (this.controller.synced) {\n            if (DEBUG.snapshot) console.log(this.id, `asking controller to poll for persistence @${persistTime}`);\n\n            // run everything else outside of VM\n            const vmTime = this.time;\n            Promise.resolve().then(() => this.controller.pollForPersist(vmTime, persistTime, persistentString, persistentHash, ms));\n        }\n    }\n\n    random() {\n        if (CurrentVM !== this) throw Error(\"synchronized random accessed from outside the model\");\n        return this._random();\n    }\n\n    randomID() {\n        if (CurrentVM !== this) throw Error(\"synchronized random accessed from outside the model\");\n        let id = \"\";\n        for (let i = 0; i < 4; i++) {\n            id += (this._random.int32() >>> 0).toString(16).padStart(8, '0');\n        }\n        return id;\n    }\n\n    toString() { return `VirtualMachine[${this.id}]`; }\n\n    [Symbol.toPrimitive]() { return this.toString(); }\n}\n\n\nfunction encode(receiver, selector, args) {\n    let encoded;\n    if (receiver === \"_\") {\n        const index = ENCODE_MESSAGE[selector];\n        if (typeof index === \"number\") encoded = index.toString(36); // Base36\n    }\n    if (encoded === undefined) encoded = `${receiver}>${selector}`;\n    if (args.length > 0) {\n        const encoder = MessageArgumentEncoder.newOrRecycled();\n        encoded += JSON.stringify(encoder.encode(args));\n    }\n    return encoded;\n}\n\nfunction decode(payload, vm) {\n    let receiver, selector, argString;\n    if (payload.length === 1 || payload[1] === '[') {\n        const index = parseInt(payload[0], 36); // Base36\n        receiver = \"_\";\n        selector = ENCODED_MESSAGES[index];\n        argString = payload.slice(1);\n    } else {\n        const selPos = payload.indexOf('>');\n        let argPos = payload.indexOf('[');\n        if (argPos === -1) argPos = payload.length;\n        receiver = payload.slice(0, selPos);\n        selector = payload.slice(selPos + 1, argPos);\n        argString = payload.slice(argPos);\n    }\n    let args = [];\n    if (argString) {\n        const decoder = MessageArgumentDecoder.newOrRecycled(vm);\n        args = decoder.decode(JSON.parse(argString));\n    }\n    return {receiver, selector, args};\n}\n\n/** Answer true if seqA comes before seqB:\n * - sequence numbers are 32 bit unsigned ints with overflow\n * - seqA comes before seqB if it takes fewer increments to\n *    go from seqA to seqB (zero increments counts) than\n *    going from seqB to seqA\n * @typedef {Number} Uint32\n * @argument {Uint32} seqA\n * @argument {Uint32} seqB\n */\nexport function inSequence(seqA, seqB) {\n    return ((seqB - seqA) | 0) >= 0;     // signed difference works with overflow\n}\n\nexport class Message {\n    constructor(time, seq, receiverId, selector, args) {\n        /** @type {Number} floating point seconds since beginning of session */\n        this.time = time;\n        /** @type {Number} a 32 bit unsigned integer (wraps around) */\n        this.seq = seq;\n        /** @type {String} id of receiver */\n        this.receiver = receiverId;\n        /** @type {String} method name */\n        this.selector = selector;\n        /** @type {Array} method arguments */\n        this.args = args;\n    }\n\n    // Messages are generally sorted by time\n    // For the same time stamp, we sort reflected messages after future messages\n    // because otherwise it would depend on timing where the external message is put\n    // (e.g when there are many future messages for the same time, we simulate a few,\n    // and then insert an external message)\n    before(other) {\n        // sort by time\n        if (this.time !== other.time) return this.time < other.time;\n        // internal before external\n        if (this.isExternal() !== other.isExternal()) return other.isExternal();\n        return this.isExternal()\n            ? inSequence(this.externalSeq, other.externalSeq)\n            : inSequence(this.internalSeq, other.internalSeq);\n    }\n\n    hasReceiver(id) { return this.receiver === id; }\n\n    isExternal() { return this.seq & 1; }\n    get externalSeq() { return (this.seq / 2) >>> 0; }\n    set externalSeq(seq) { this.seq = seq * 2 + 1; }\n    get internalSeq() { return (this.seq / 2) >>> 0; }\n    set internalSeq(seq) { this.seq = seq * 2; }\n\n    asState() {\n        // controller relies on this being a 3-element array,\n        // the first two elements being numbers\n        // and the third being a string which will be encrypted\n        return [this.time, this.seq, encode(this.receiver, this.selector, this.args)];\n    }\n\n    static fromState(state, vm) {\n        const [time, seq, payload] = state;\n        const { receiver, selector, args } = decode(payload, vm);\n        return new Message(time, seq, receiver, selector, args);\n    }\n\n    executeOn(vm, nested=false) {\n        vm.currentEventFromModel = !this.isExternal();\n        const executor = nested\n            ? fn => fn()\n            : fn => execInVM(vm, () => inModelRealm(vm, fn));\n        const { receiver, selector, args } = this;\n        const model = vm.lookUpModel(receiver); // could be VM itself, if receiver === \"_\"\n        if (!model) displayWarning(`${this.shortString()} ${selector}(): receiver not found`);\n        else if (selector[0] === '{') {\n            const fn = vm.compileFuncString(selector, model);\n            executor(() => {\n                try {\n                    fn(...args);\n                } catch (error) {\n                    displayAppError(`${this.shortString()} ${fn}`, error);\n                }\n                });\n        } else if (selector.indexOf('.') >= 0) {\n            executor(() => {\n                const i = selector.indexOf('.');\n                const head = selector.slice(0, i);\n                const tail = selector.slice(i + 1);\n                try {\n                    model.call(head, tail, ...args);\n                } catch (error) {\n                    displayAppError(`${this.shortString()} ${model}.call(${JSON.stringify(head)}, ${JSON.stringify(tail)})`, error);\n                }\n                });\n        } else if (typeof model[selector] !== \"function\") {\n            displayWarning(`${this.shortString()} ${model}.${selector}(): method not found`);\n        } else executor(() => {\n            try {\n                if (isQFuncFuture(selector)) {\n                    const qFunc = model[selector];\n                    delete model[selector]; // delete before calling, might be redefined in call\n                    qFunc(...args);\n                } else {\n                    model[selector](...args);\n                }\n            } catch (error) {\n                displayAppError(`${this.shortString()} ${model}.${selector}()`, error);\n            }\n            });\n    }\n\n    shortString() {\n        return `${this.isExternal() ? \"External\" : \"Future\"}Message`;\n    }\n\n    toString() {\n        const { receiver, selector, args } = this;\n        const ext = this.isExternal();\n        const seq = ext ? this.externalSeq : this.internalSeq;\n        return `${ext ? \"External\" : \"Future\"}Message[${this.time}${\":#\"[+ext]}${seq} ${receiver}.${selector}(${args.map(JSON.stringify).join(\", \")})]`;\n    }\n\n    [Symbol.toPrimitive]() { return this.toString(); }\n}\n\nconst sumForFloat = (() => {\n    // use DataView so we can enforce little-endian interpretation of float as ints on any platform\n    const buffer = new ArrayBuffer(8);\n    const view = new DataView(buffer);\n    return fl => {\n        view.setFloat64(0, fl, true);\n        return view.getInt32(0, true) + view.getInt32(4, true);\n    };\n    })();\n\n// VMHasher walks the object tree gathering statistics intended to help\n// identify divergence between vm instances.\nclass VMHasher {\n    constructor() {\n        this.done = new Set();\n        this.todo = []; // we use breadth-first writing to limit stack depth\n        this.hashers = new Map();\n        this.addHasher(\"Teatime:Message\", Message);\n        this.addHasher(\"Teatime:Data\", DataHandleSpec);\n        this.addHasher(\"Teatime:QFunc\", QFuncSpec);\n        for (const [classId, ClassOrSpec] of Model.allClassTypes()) {\n            this.addHasher(classId, ClassOrSpec);\n        }\n    }\n\n    addHasher(classId, ClassOrSpec) {\n        const { cls, write } = (Object.getPrototypeOf(ClassOrSpec) === Object.prototype) ? ClassOrSpec\n            : { cls: ClassOrSpec, write: obj => ({ ...obj }) };\n        if (!write) return;\n        this.hashers.set(cls, obj => this.hashStructure(obj, write(obj)));\n    }\n\n    /** @param {VirtualMachine} vm */\n    getHash(vm) {\n        this.hashState = {\n            oC: 0, // count of JS Objects\n            mC: 0, // count of models\n            nanC: 0, // count of NaNs\n            infC: 0, // count of Infinities (+ve or -ve)\n            zC: 0, // count of zeros\n            nC: 0, // count of non-zero finite numbers\n            nH: 0, // sum of the Int32 parts of non-zero numbers treated as Float64s\n            sC: 0, // number of strings\n            sL: 0,  // sum of lengths of strings\n            fC: 0  // count of future messages\n        };\n\n        for (const [key, value] of Object.entries(vm)) {\n            if (key === \"controller\") continue;\n            if (key === \"meta\") continue;\n            if (key === \"_random\") this.hash(value.state(), false);\n            else if (key === \"messages\") {\n                const messageArray = value.asArray(); // from PriorityQueue\n                const count = this.hashState.fC = messageArray.length;\n                if (count) this.hash(messageArray, false);\n            } else this.hashEntry(key, value);\n        }\n        this.hashDeferred();\n        return this.hashState;\n    }\n\n    hashDeferred() {\n        let index = 0;\n        while (index < this.todo.length) {\n            const { key, value } = this.todo[index++];\n            this.hashEntry(key, value, false);\n        }\n        this.todo.length = 0;\n    }\n\n    hash(value, defer = true) {\n        switch (typeof value) {\n            case \"number\":\n                if (Number.isNaN(value)) this.hashState.nanC++;\n                else if (!Number.isFinite(value)) this.hashState.infC++;\n                else if (value === 0) this.hashState.zC++;\n                else {\n                    this.hashState.nC++;\n                    this.hashState.nH += sumForFloat(value);\n                }\n                return;\n            case \"string\":\n                this.hashState.sC++;\n                this.hashState.sL += value.length;\n                return;\n            case \"boolean\":\n            case \"undefined\":\n                return;\n            case \"bigint\": {\n                if (value === 0n) this.hashState.zC++;\n                else {\n                    this.hashState.nC++;\n                    const limit = value < 0 ? -1n : 0n;\n                    while (value !== limit) {\n                        this.hashState.nH += Number(value & 0xFFFFFFFFn);\n                        value >>= 32n;\n                    }\n                }\n                return;\n            }\n            default: {\n                if (this.done.has(value)) return;\n                if (value === null) return; // not counted\n                if (this.hashers.has(value.constructor)) { this.hashers.get(value.constructor)(value); return; }\n                const type = Object.prototype.toString.call(value).slice(8, -1);\n                if (this.hashers.has(type)) { this.hashers.get(type)(value); return; }\n                switch (type) {\n                    case \"Array\":\n                        this.hashArray(value, defer);\n                        return;\n                    case \"ArrayBuffer\":\n                        this.hashIntArray(new Uint8Array(value));\n                        return;\n                    case \"Set\":\n                        this.hashStructure(value, [...value]);\n                        return;\n                    case \"Map\":\n                        this.hashStructure(value, [...value], false);\n                        return;\n                    case \"DataView\":\n                        this.hashIntArray(new Uint8Array(value.buffer, value.byteOffset, value.byteLength));\n                        return;\n                    case \"Int8Array\":\n                    case \"Uint8Array\":\n                    case \"Uint8ClampedArray\":\n                    case \"Int16Array\":\n                    case \"Uint16Array\":\n                    case \"Int32Array\":\n                    case \"Uint32Array\":\n                        this.hashIntArray(value);\n                        return;\n                    case \"Float32Array\":\n                    case \"Float64Array\":\n                        this.hashArray(value, false);\n                        return;\n                    case \"Object\":\n                        if (value instanceof Model) this.hashModel(value);\n                        else if (value.constructor === Object) this.hashObject(value, defer);\n                        // no class error here, will be caught and reported by snapshot with full path\n                    // ignore other errors here (e.g. Function), will be caught and reported by snapshot with full path\n                    /* no default */\n                }\n            }\n        }\n    }\n\n    hashModel(model) {\n        this.hashState.mC++;\n        this.done.add(model);      // mark done before recursing\n        // note: for the hash as currently taken, all tallies are additive\n        // so order is not important\n        for (const [key, value] of Object.entries(model)) {\n            if (key === \"__realm\") continue;\n            if (value !== undefined) this.hashEntry(key, value);\n        }\n    }\n\n    hashObject(object, defer = true) {\n        this.hashState.oC++;\n        this.done.add(object);      // mark done before recursing\n        // see comment in hashModel re order\n        for (const [key, value] of Object.entries(object)) {\n            if (value !== undefined) this.hashEntry(key, value, defer);\n        }\n    }\n\n    hashArray(array, defer = true) {\n        this.done.add(array);       // mark done before recursing\n        for (let i = 0; i < array.length; i++) {\n            this.hashEntry(i, array[i], defer);\n        }\n    }\n\n    hashIntArray(array) {\n        this.done.add(array);       // mark done before recursing\n        for (let i = 0; i < array.length; i++) {\n            const value = array[i];\n            if (value === 0) this.hashState.zC++;\n            else {\n                this.hashState.nC++;\n                this.hashState.nH += value;\n            }\n        }\n    }\n\n    hashStructure(object, value, defer = true) {\n        if (value === undefined) return;\n        this.done.add(object);      // mark done before recursing\n        this.hash(value, defer);\n    }\n\n    hashEntry(key, value, defer = true) {\n        if (key[0] === '$') return;\n        if (defer && typeof value === \"object\") {\n            this.todo.push({ key, value });\n            return;\n        }\n        this.hash(value, defer);\n    }\n}\n\n\nclass VMWriter {\n    static newOrRecycled(vm) {\n        let inst = this.reusableInstance;\n        if (!inst) {\n            inst = this.reusableInstance = new this(vm);\n        } else {\n            inst.vm = vm;\n            inst.nextRef = 1;\n            inst.refs = new Map();\n            inst.todo = [];\n        }\n        return inst;\n    }\n\n    static get reusableInstance() { return this[this.name + \"-instance\"]; }\n\n    static set reusableInstance(val) { this[this.name + \"-instance\"] = val; }\n\n    static resetInstance() { this.reusableInstance = null; }\n\n    constructor(vm) {\n        this.vm = vm;\n        this.nextRef = 1;\n        this.refs = new Map();\n        this.todo = []; // we use breadth-first writing to limit stack depth\n        this.writers = new Map();\n        this.addWriter(\"Teatime:Message\", Message);\n        this.addWriter(\"Teatime:Data\", DataHandleSpec);\n        this.addWriter(\"Teatime:QFunc\", QFuncSpec);\n        for (const [classId, ClassOrSpec] of Model.allClassTypes()) {\n            this.addWriter(classId, ClassOrSpec);\n        }\n        this.okayToIgnore = { $debugWriteProxyHandler: true };\n        for (const Class of Model.allClasses()) {\n            if (Object.prototype.hasOwnProperty.call(Class, \"okayToIgnore\")) {\n                const props = Class.okayToIgnore();\n                if (!Array.isArray(props)) throw new Error(\"okayToIgnore() must return an array\");\n                for (const prop of props) {\n                    if (prop[0] !== '$') throw Error(`okayToIgnore: ignored prop \"${prop}\" must start with '$'`);\n                    this.okayToIgnore[prop] = true;\n                }\n            }\n        }\n    }\n\n    addWriter(classId, ClassOrSpec) {\n        const isSpec = Object.getPrototypeOf(ClassOrSpec) === Object.prototype;\n        const {cls, write} = isSpec ? ClassOrSpec : {cls: ClassOrSpec, write: obj => ({ ...obj })};\n        // Object and Array are used by the serializer itself, can't override their serialization\n        if (cls === Object) throw Error(`${App.libName} types: '${classId}' is the Object class itself, must be a user class`);\n        if (cls === Array) throw Error(`${App.libName} types: '${classId}' is the Array class, must be a user class`);\n        if (!write) {\n            if (!ClassOrSpec.writeStatic) console.warn(`${App.libName} types: ${classId} does not implement write() or writeStatic()`);\n            return;\n        }\n        this.writers.set(cls, (obj, path) => this.writeAs(classId, obj, write(obj), isSpec ? `${path}.write(${cls.name})` : path));\n    }\n\n    /** @param {VirtualMachine} vm */\n    snapshot(vm, path) {\n        const state = {\n            _random: vm._random.state(), // _random is a function\n            messages: this.write(vm.messages.asArray(), \"FutureMessages\"),\n            subscribers: undefined, // do not write subscribers\n            controller: undefined, // do not write controller\n            $compiledFuncs: undefined, // do not write compiledFuncStrings\n        };\n        // write static class properties\n        this.writeAllStaticInto(state);\n        // write remaining properties of the vm\n        for (const [key, value] of Object.entries(vm)) {\n            if (key in state) continue;\n            this.writeInto(state, key, value, path);\n        }\n        this.writeDeferred();\n\n        delete state.controller; // remove undefined\n        delete state.subscribers; // remove undefined\n        delete state.$compiledFuncs; // remove undefined\n        return state;\n    }\n\n    writeAllStaticInto(state) {\n        // get static properties of all model classes\n        for (const Class of Model.allClasses()) {\n            if (Class === Model) continue;\n            for (const [key, value] of Object.entries(Class)) {\n                if (key[0] === '$') continue;\n                const name = Model.classToID(Class);\n                if (!state.staticModelProps) state.staticModelProps = {};\n                if (!(name in state.staticModelProps)) state.staticModelProps[name] = {};\n                this.writeInto(state.staticModelProps[name], key, value, `Model(${name}).static`);\n                warnMultipleSessionsStatic(\"Model\", name);\n            }\n        }\n        // write static properties of registered types with a writeStatic method\n        for (const [name, ClassOrSpec] of Model.allClassTypes()) {\n            if (typeof ClassOrSpec === \"object\") {\n                const { writeStatic } = ClassOrSpec;\n                if (writeStatic) {\n                    const props = writeStatic();\n                    if (props) {\n                        if (!state.staticTypeProps) state.staticTypeProps = {};\n                        state.staticTypeProps[name] = this.write(props, `Type(${name}).writeStatic()`);\n                        warnMultipleSessionsStatic(\"Type\", name);\n                    }\n                }\n            }\n        }\n    }\n\n    writeDeferred() {\n        let index = 0;\n        while (index < this.todo.length) {\n            const { state, key, value, path } = this.todo[index++];\n            this.writeInto(state, key, value, path, false);\n        }\n        this.todo.length = 0;\n    }\n\n    write(value, path, defer=true) {\n        // NOTE: finite numbers, strings, and booleans typically are handled already\n        switch (typeof value) {\n            case \"number\":\n                // JSON disallows NaN and Infinity, and writes -0 as \"0\"\n                if (Object.is(value, -0)) return {$class: \"NegZero\"};\n                if (Number.isFinite(value)) return value;\n                if (Number.isNaN(value)) return {$class: \"NaN\"};\n                return {$class: \"Infinity\", $value: Math.sign(value)};\n            case \"string\":\n            case \"boolean\":\n                return value;\n            case \"undefined\":\n                return {$class: \"Undefined\"};\n            case \"bigint\":\n                return {$class: \"BigInt\", $value: value.toString()};\n            default: {\n                if (this.refs.has(value)) return this.writeRef(value);\n                if (value === null) return value;\n                // allow override of default writers\n                if (this.writers.has(value.constructor)) return this.writers.get(value.constructor)(value, path);\n                const type = Object.prototype.toString.call(value).slice(8, -1);\n                if (this.writers.has(type)) return this.writers.get(type)(value, path);\n                // default writers\n                switch (type) {\n                    case \"Array\": return this.writeArray(value, path, defer);\n                    case \"ArrayBuffer\": return this.writeArrayBuffer(value);\n                    case \"Set\":\n                        return this.writeAs(type, value, [...value], path);\n                    case \"Map\":\n                        return this.writeAs(type, value, [...value].flat(), path); // flatten to single array [key, value, key, value, ...]\n                    case \"DataView\":\n                    case \"Int8Array\":\n                    case \"Uint8Array\":\n                    case \"Uint8ClampedArray\":\n                    case \"Int16Array\":\n                    case \"Uint16Array\":\n                    case \"Int32Array\":\n                    case \"Uint32Array\":\n                    case \"Float32Array\":\n                    case \"Float64Array\":\n                        return this.writeTypedArray(type, value);\n                    case \"Object\": {\n                        if (value instanceof Model) return this.writeModel(value, path);\n                        if (value.constructor === Object || typeof value.constructor !== \"function\") return this.writeObject(value, path, defer);\n                        // no writer has been registered for this class\n                        console.warn(`${App.libName}: unknown class at ${path}:`, value);\n                        throw Error(`${App.libName}: class not registered in Model.types(): ${value.constructor.name}`);\n                    }\n                    case \"Function\":\n                        if (value[QFUNC]) return this.writers.get(QFUNC)(value, path); // uses QFuncSpec\n                        console.warn(`${App.libName}: found function at ${path}:`, value);\n                        throw Error(`${App.libName}: cannot serialize functions except for QFuncs`);\n                    default: {\n                        // no writer has been registered for this type\n                        console.warn(`${App.libName}: unsupported property at ${path}:`, value);\n                        throw Error(`${App.libName}: serialization of ${type}s is not supported`);\n                    }\n                }\n            }\n        }\n    }\n\n    writeModel(model, path) {\n        const state = {};\n        this.refs.set(model, state);      // register ref before recursing\n\n        try {\n            state.$model = Model.classToID(model.constructor);\n        } catch (err) {\n            console.error(`unregistered model class at ${path}:`, model);\n            throw err;\n        }\n\n        /* see comment in writeObject\n        const descriptors = Object.getOwnPropertyDescriptors(model);\n        for (const key of Object.keys(descriptors).sort()) {\n            if (key === \"__realm\") continue;\n            const descriptor = descriptors[key];\n            if (descriptor.value !== undefined) {\n                this.writeInto(state, key, descriptor.value, path);\n            }\n        }\n        */\n\n        for (const key of Object.keys(model).sort()) {\n            if (key === \"__realm\") continue; // not enumerable in a Model, but is set directly in a ModelPart\n            const value = model[key];\n            if (((typeof value === \"number\" && Number.isFinite(value) && !Object.is(value, -0)) || typeof value === \"string\" || typeof value === \"boolean\") && key[0] !== '$') {\n                state[key] = value;\n            } else {\n                // for display purposes, we use the model name as the root path\n                this.writeInto(state, key, value, `${model}`, true);\n            }\n        }\n\n        return state;\n    }\n\n    writeObject(object, path, defer=true) {\n        const state = {};\n        this.refs.set(object, state);      // register ref before recursing\n        for (const key of Object.keys(object).sort()) {\n            const value = object[key];\n            if (((typeof value === \"number\" && Number.isFinite(value) && !Object.is(value, -0)) || typeof value === \"string\" || typeof value === \"boolean\") && key[0] !== '$') {\n                state[key] = value;\n            } else {\n                this.writeInto(state, key, value, path, defer);\n            }\n        }\n\n        return state;\n    }\n\n    writeArray(array, path, defer=true) {\n        const state = [];\n        this.refs.set(array, state);       // register ref before recursing\n        for (let i = 0; i < array.length; i++) {\n            const value = array[i];\n            if ((typeof value === \"number\" && Number.isFinite(value) && !Object.is(value, -0)) || typeof value === \"string\" || typeof value === \"boolean\") {\n                state[i] = value;\n            } else {\n                this.writeInto(state, i, value, path, defer);\n            }\n        }\n        return state;\n    }\n\n    writeArrayBuffer(buffer) {\n        const state = {\n            $class: \"ArrayBuffer\",\n            $value: arrayBufferToBase64(buffer),\n        };\n        this.refs.set(buffer, state);\n        return state;\n    }\n\n    writeTypedArray(type, array) {\n        const state = {\n            $class: type,\n            $value: [this.write(array.buffer), array.byteOffset, type === \"DataView\" ? array.byteLength : array.length],\n        };\n        this.refs.set(array, state);\n        return state;\n    }\n\n    writeAs(classId, object, value, path) {\n        const state = { $class: classId };\n        this.refs.set(object, state);      // register ref before recursing\n        const written = this.write(value, path, false);\n        // only use $value property if necessary\n        if (typeof written !== \"object\" || written === null || written.$class || Array.isArray(written)) state.$value = written;\n        else Object.assign(state, written);\n        return state;\n    }\n\n    writeRef(object) {\n        const state = this.refs.get(object);\n        if (typeof state !== \"object\") throw Error(\"Non-object in refs: \" + object);\n        if (Array.isArray(state)) {\n            // usually, extra properties on arrays don't get serialized to JSON\n            // so we use this hack that does a one-time replacement of toJSON\n            // on this particular array (and restore it in readAsArray() below)\n            state.toJSON = function () {\n                return {\n                    $id: this.$id,\n                    $class: \"Array\",\n                    $value: [...this]\n                };\n            };\n        }\n        const $ref = state.$id || (state.$id = this.nextRef++);\n        return {$ref};\n    }\n\n    writeInto(state, key, value, path, defer=true) {\n        if (key[0] === '$') {\n            if (!this.okayToIgnore[key]) {\n                displayWarning(`snapshot: ignoring property ${key} (declare as okayToIgnore to suppress warning)`, { only: \"once\" });\n                this.okayToIgnore[key] = true;\n            }\n            return;\n        }\n        if (defer && typeof value === \"object\") {\n            this.todo.push({state, key, value, path});\n            return;\n        }\n        const written = this.write(value, path + propertyAccessor(state, key));\n        state[key] = written;\n    }\n}\n\nconst UNRESOLVED = Symbol(\"croquet:unresolved\");\n\nclass VMReader {\n    static newOrRecycled(vm) {\n        let inst = this.reusableInstance;\n        if (!inst) {\n            inst = this.reusableInstance = new this(vm);\n        } else {\n            inst.vm = vm;\n            inst.refs = new Map();\n            inst.todo = [];\n            inst.unresolved = [];\n            inst.postprocess = [];\n        }\n        return inst;\n    }\n\n    static get reusableInstance() { return this[this.name + \"-instance\"]; }\n\n    static set reusableInstance(val) { this[this.name + \"-instance\"] = val; }\n\n    static resetInstance() { this.reusableInstance = null; }\n\n    constructor(vm) {\n        this.vm = vm;\n        this.refs = new Map();\n        this.todo = [];        // we use breadth-first deferred reading to limit stack depth\n        this.unresolved = [];  // some refs can only be resolved in 2nd pass\n        this.postprocess = []; // 3rd pass fills Sets and Maps that had unresolved refs\n        this.readers = new Map();\n        this.addReader(\"Teatime:Message\", Message);\n        this.addReader(\"Teatime:Data\", DataHandleSpec);\n        this.addReader(\"Teatime:QFunc\", QFuncSpec);\n        this.readers.set(\"Undefined\", () => undefined);\n        this.readers.set(\"NaN\", () => NaN);\n        this.readers.set(\"Infinity\", sign => sign * Infinity);\n        this.readers.set(\"NegZero\", () => -0);\n        this.readers.set(\"BigInt\", value => BigInt(value));\n        this.readers.set(\"ArrayBuffer\", data => base64ToArrayBuffer(data));\n        this.readers.set(\"DataView\", args => new DataView(...args));\n        this.readers.set(\"Int8Array\", args => new Int8Array(...args));\n        this.readers.set(\"Uint8Array\", args => new Uint8Array(...args));\n        this.readers.set(\"Uint8ClampedArray\", args => new Uint8ClampedArray(...args));\n        this.readers.set(\"Int16Array\", args => new Int16Array(...args));\n        this.readers.set(\"Uint16Array\", args => new Uint16Array(...args));\n        this.readers.set(\"Int32Array\", args => new Int32Array(...args));\n        this.readers.set(\"Uint32Array\", args => new Uint32Array(...args));\n        this.readers.set(\"Float32Array\", args => new Float32Array(...args));\n        this.readers.set(\"Float64Array\", args => new Float64Array(...args));\n        for (const [classId, ClassOrSpec] of Model.allClassTypes()) {\n            this.addReader(classId, ClassOrSpec);\n        }\n    }\n\n    addReader(classId, ClassOrSpec) {\n        // default to assigning all properties to a new instance of the class\n        let read = state => Object.assign(Object.create(ClassOrSpec.prototype), state);\n        if (typeof ClassOrSpec === \"object\") read = ClassOrSpec.read;\n        this.readers.set(classId, read);\n    }\n\n    enableBackwardCompatibility(snapshot) {\n        // the Croquet version that created the snapshot\n        const version = snapshot?.meta?.sdk;\n        if (!version) return;\n        const [major, minor, patch, pre] = version.split(/[-.+]/).map(n => +n);\n        let parsed = `${major}.${minor}`;\n        if (patch) parsed += `.${patch}`;\n        if (pre) parsed += `-${pre}`;\n        console.warn(`${App.libName}: reading snapshot version ${parsed}`);\n        // before 1.1.0-7, Maps were written as an arry of [key, value] pairs\n        this.compatMaps = major < 1 || (major === 1 && (minor < 1 || (minor === 1 && patch < 7)));\n    }\n\n    readVM(snapshot, root, compat) {\n        if (root !== \"VM\") throw Error(\"VirtualMachine must be root object\");\n        if (compat) this.enableBackwardCompatibility(snapshot);\n        const vmData = this.read(snapshot, root, false); // shallow read root props\n        this.readDeferred();  // 1st pass: breadth-first, use UNRESOLVED placeholder for forward refs\n        this.resolveRefs();   // 2nd pass: resolve forward refs\n        this.doPostprocess(); // 3rd pass: fill Sets and Maps with resolved temp content arrays\n        this.readAllStatic(vmData); // create initializers for static class properties\n        return vmData;\n    }\n\n    readDeferred() {\n        let index = 0;\n        while (index < this.todo.length) {\n            const {object, key, value, path} = this.todo[index++];\n            this.readInto(object, key, value, path, false);\n        }\n        this.todo.length = 0;\n    }\n\n    resolveRefs() {\n        for (const {object, key, ref, path} of this.unresolved) {\n            if (this.refs.has(ref)) {\n                object[key] = this.refs.get(ref);\n            } else {\n                throw Error(`Unresolved ref: ${ref} at ${path}[${JSON.stringify(key)}]`);\n            }\n        }\n        this.unresolved.length = 0;\n        this.refs.clear();\n    }\n\n    doPostprocess() {\n        for (const fn of this.postprocess) {\n            fn();\n        }\n        this.postprocess.length = 0;\n    }\n\n    readAllStatic(vmState) {\n        const { staticModelProps, staticTypeProps } = vmState;\n        const staticInitializers = [];\n        if (staticModelProps) {\n            for (const [name, props] of Object.entries(staticModelProps)) {\n                const modelClass = Model.classFromID(name);\n                staticInitializers.push(() => Object.assign(modelClass, props));\n                warnMultipleSessionsStatic(\"Model\", name);\n            }\n            delete vmState.staticModelProps;\n        }\n        if (staticTypeProps) {\n            const ClassOrSpecs = Object.fromEntries(Model.allClassTypes());\n            for (const [name, props] of Object.entries(staticTypeProps)) {\n                const ClassOrSpec = ClassOrSpecs[name];\n                if (typeof ClassOrSpec === \"object\") {\n                    const typeSpec = ClassOrSpec;\n                    staticInitializers.push(() => typeSpec.readStatic(props));\n                } else {\n                    const classFromTypes = ClassOrSpec;\n                    staticInitializers.push(() => Object.assign(classFromTypes, props));\n                }\n                warnMultipleSessionsStatic(\"Type\", name);\n            }\n            delete vmState.staticTypeProps;\n        }\n        if (staticInitializers.length) {\n            vmState.staticInitializers = staticInitializers;\n        }\n    }\n\n    read(value, path, defer=true) {\n        // if defer is false, this is the $value property of an object,\n        // which is either a plain Array or a plain Object\n        switch (typeof value) {\n            case \"number\":\n            case \"string\":\n            case \"boolean\":\n                return value;\n            default: {\n                const type = Object.prototype.toString.call(value).slice(8, -1);\n                switch (type) {\n                    case \"Array\": return this.readArray(value, path, defer);\n                    case \"Null\": return null;\n                    case \"Object\": {\n                        const { $class, $model, $ref } = value;\n                        if ($ref) throw Error(\"refs should have been handled in readInto()\");\n                        if ($model) return this.readModel(value, path);\n                        if ($class) return this.readAs($class, value, path);\n                        return this.readObject(Object, value, path, defer);\n                    }\n                    default:\n                        throw Error(`Don't know how to deserialize ${type} at ${path}`);\n                }\n            }\n        }\n    }\n\n    readModel(state, path) {\n        const model = Model.instantiateClassID(state.$model, state.id);\n        if (state.$id) this.refs.set(state.$id, model);\n        for (const [key, value] of Object.entries(state)) {\n            if (key === \"id\" || key[0] === '$') continue;\n            this.readInto(model, key, value, path);\n        }\n        return model;\n    }\n\n    readObject(Class, state, path, defer=true) {\n        const object = new Class();\n        if (state.$id) this.refs.set(state.$id, object);\n        for (const [key, value] of Object.entries(state)) {\n            if (key[0] === '$') continue;\n            this.readInto(object, key, value, path, defer);\n        }\n        return object;\n    }\n\n    readArray(array, path, defer=true) {\n        const result = [];\n        if (array.$id) this.refs.set(array.$id, result);\n        for (let i = 0; i < array.length; i++) {\n            if (array[i] !== undefined) this.readInto(result, i, array[i], path, defer); // allow for missing indices\n        }\n        return result;\n    }\n\n    // special case for arrays with a $id property which is not preserved by JSON\n    // instead they were serialized as { $class: \"Array\", $value: [...], $id: ... }\n    // in writeRef(), so we restore the $id property here\n    readAsArray(state, path, defer=true) {\n        const array = state.$value;\n        if (state.$id) array.$id = state.$id;\n        return this.readArray(array, path, defer);\n    }\n\n    readAsSet(state, path) {\n        const set = new Set();\n        if (state.$id) this.refs.set(state.$id, set);\n        const before = this.unresolved.length;\n        const contents = this.read(state.$value, path, false);\n        const fillContents = () => {\n            for (const item of contents) set.add(item);\n        };\n        if (this.unresolved.length === before) {\n            fillContents();\n        } else {\n            // resolving refs only updates the contents array, so we need to defer this\n            this.postprocess.push(fillContents);\n        }\n        return set;\n    }\n\n    readAsMap(state, path) {\n        const map = new Map();\n        if (state.$id) this.refs.set(state.$id, map);\n        const before = this.unresolved.length;\n        const contents = this.read(state.$value, path, false);\n        const fillContents = this.compatMaps\n            ? // before 1.1.0-7, Maps were written as an arry of [key, value] pairs\n                () => {\n                    // see if all entries have been resolved\n                    if (contents.some(keyValue => keyValue.length !== 2)) {\n                        // not yet resolved, defer\n                        console.warn(\"Deferring map resolution at\", path);\n                        this.postprocess.push(fillContents);\n                    } else {\n                        for (const [key, value] of contents) map.set(key, value);\n                    }\n                }\n            : // since 1.1.0-7, Maps are written as a flat array [key, value, key, value, ...]\n                () => {\n                    for (let i = 0; i < contents.length; i += 2) map.set(contents[i], contents[i + 1]);\n                };\n        if (this.unresolved.length === before) {\n            fillContents();\n        } else {\n            // resolving refs only updates the contents array, so we need to defer this\n            this.postprocess.push(fillContents);\n        }\n        return map;\n    }\n\n    readAsClass(classId, state, path) {\n        let temp = {};\n        const unresolved = new Map();\n        if (\"$value\" in state) temp = this.read(state.$value, path, false);\n        else for (const [key, value] of Object.entries(state)) {\n            if (key[0] === '$') continue;\n            const ref = value && value.$ref;\n            if (ref) {\n                if (this.refs.has(ref)) temp[key] = this.refs.get(ref);\n                else {\n                    temp[key] = UNRESOLVED;\n                    unresolved.set(ref, key);\n                }\n            } else {\n                this.readInto(temp, key, value, path, false);\n            }\n        }\n        const reader = this.readers.get(classId);\n        const object = reader(temp, path);\n        if (!object && classId !== \"Undefined\" && classId !== \"BigInt\" && classId !== \"NaN\" && classId !== \"NegZero\") console.warn(`Reading \"${classId}\" returned ${object} at ${path}`);\n        if (state.$id) this.refs.set(state.$id, object);\n        for (const [ref, key] of unresolved.entries()) {\n            this.unresolved.push({object, key, ref, path});\n        }\n        return object;\n    }\n\n    readAs(classId, state, path) {\n        switch (classId) {\n            case \"Array\": return this.readAsArray(state, path);\n            case \"Set\": return this.readAsSet(state, path);\n            case \"Map\": return this.readAsMap(state, path);\n            default: return this.readAsClass(classId, state, path);\n        }\n    }\n\n    readRef(object, key, value, path) {\n        if (!value || !value.$ref) return false;\n        const ref = value.$ref;\n        if (this.refs.has(ref)) {\n            object[key] = this.refs.get(ref);\n        } else {\n            object[key] = UNRESOLVED;\n            this.unresolved.push({object, key, ref, path});\n        }\n        return true;\n    }\n\n    readInto(object, key, value, path, defer=true) {\n        if (this.readRef(object, key, value, path)) return;\n        if (defer && typeof value === \"object\") {\n            this.todo.push({object, key, value, path});\n            return;\n        }\n        object[key] = this.read(value, path + propertyAccessor(object, key)); // always deferred\n    }\n}\n\nclass MessageArgumentEncoder extends VMWriter {\n    encode(args) {\n        const encoded = this.writeArray(args, \"args\");\n        this.writeDeferred();\n        return encoded;\n    }\n\n    writeModel(model) {\n        return { $ref: model.id };\n    }\n}\n\nclass MessageArgumentDecoder extends VMReader {\n    decode(args) {\n        const decoded = this.readArray(args, \"args\");\n        this.readDeferred();\n        this.resolveRefs();\n        this.doPostprocess();\n        return decoded;\n    }\n\n    resolveRefs() {\n        for (const {object, key, ref, path} of this.unresolved) {\n            if (this.refs.has(ref)) {\n                object[key] = this.refs.get(ref);\n            } else {\n                const model = this.vm.lookUpModel(ref);\n                if (model) object[key] = model;\n                else throw Error(`Unresolved ref: ${ref} at ${path}[${JSON.stringify(key)}]`);\n            }\n        }\n    }\n}\n\nexport function resetReadersAndWriters() {\n    VMReader.resetInstance();\n    VMWriter.resetInstance();\n    MessageArgumentEncoder.resetInstance();\n    MessageArgumentDecoder.resetInstance();\n}\n\n// we handle reading/writing for all the system classes\nconst SYSTEM_CLASSES = [\n    Object,\n    Array,\n    Map,\n    Set,\n    BigInt,\n    ArrayBuffer,\n    DataView,\n    Int8Array,\n    Uint8Array,\n    Uint8ClampedArray,\n    Int16Array,\n    Uint16Array,\n    Int32Array,\n    Uint32Array,\n    Float32Array,\n    Float64Array,\n];\n\nexport function gatherClassTypes(object, prefix, gatheredClasses, seen) {\n    // get all contained values\n    const values = (Array.isArray(object) ? object\n        : object.constructor === Set ? object.values()\n        : object.constructor === Map ? object.entries()\n        : Object.values(object));\n    // filter out non-objects and already seen objects\n    const newObjects = [];\n    for (const val of values) {\n        if (typeof val !== 'object' || val === null || seen.has(val)) continue;\n        seen.add(val);\n        newObjects.push(val);\n    }\n    // gather classes of the new objects, ignoring standard classes\n    for (const obj of newObjects) {\n        if (SYSTEM_CLASSES.includes(obj.constructor)) continue;\n\n        const className = prefix + '.' + obj.constructor.name;\n        if (gatheredClasses[className]) {\n            if (gatheredClasses[className] !== obj.constructor) {\n                throw new Error(\"Class with name \" + className + \" already gathered, but new one has different identity\");\n            }\n        } else {\n            gatheredClasses[className] = obj.constructor;\n        }\n    }\n    // recurse into the new objects\n    for (const obj of newObjects) {\n        gatherClassTypes(obj, prefix, gatheredClasses, seen);\n    }\n}\n\nfunction warnMultipleSessionsStatic(kind, className) {\n    // warn about static properties if there is more than one session\n    const sessions = viewDomain.controllers.size;\n    if (sessions > 1) {\n        displayWarning(`Static properties in shared ${kind} ${className} ` +\n            `can lead to divergence because ${sessions} ` +\n            `${App.libName} sessions are running simultaneaously. Consider using ` +\n            `wellKnownModel() instead.`,\n            { only: \"once\" });\n    }\n}\n\nfunction arrayBufferToBase64(buffer) {\n    const array = new Uint8Array(buffer);\n    const dest = [];\n    for (let i = 0; i < array.byteLength; i += 4096) {\n        const chunk = array.subarray(i, i + 4096);\n        dest.push(String.fromCharCode.apply(null, chunk));\n    }\n    return globalThis.btoa(dest.join(''));\n}\n\nfunction base64ToArrayBuffer(base64) {\n    const string = globalThis.atob(base64);\n    const n = string.length;\n    const array = new Uint8Array(n);\n    for (let i = 0; i < n; i++) {\n        array[i] = string.charCodeAt(i);\n    }\n    return array.buffer;\n}\n", "import urlOptions from \"./_URLOPTIONS_MODULE_\"; // eslint-disable-line import/no-unresolved\nimport { displayAppError } from \"./_HTML_MODULE_\"; // eslint-disable-line import/no-unresolved\nimport { addClassHash } from \"./hashing\";\nimport { currentRealm } from \"./realms\";\nimport VirtualMachine, { createQFunc, resetReadersAndWriters, gatherClassTypes } from \"./vm\";\n\nconst DEBUG = {\n    classes: urlOptions.has(\"debug\", \"classes\"),\n};\n\nfunction initDEBUG() {\n    DEBUG.write = urlOptions.has(\"debug\", \"write\");\n    DEBUG.publish = urlOptions.has(\"debug\", \"publish\");\n    DEBUG.events = urlOptions.has(\"debug\", \"events\");\n}\n\n/** passed to Model constructor to check if it was called via create */\nlet SECRET = Symbol(\"SECRET\");\n\n/** For warning about model instances that have not called super.init */\nconst SuperInitNotCalled = new WeakSet();\n\n/**\n * Models are synchronized objects in Croquet.\n *\n * They are automatically kept in sync for each user in the same [session]{@link Session.join}.\n * Models receive input by [subscribing]{@link Model#subscribe} to events published in a {@link View}.\n * Their output is handled by views subscribing to events [published]{@link Model#publish} by a model.\n * Models advance time by sending messages into their [future]{@link Model#future}.\n *\n * ## Instance Creation and Initialization\n *\n * ### Do __NOT__ create a {@link Model} instance using `new` and<br>do __NOT__ override the `constructor`!\n *\n * To __create__ a new instance, use [create()]{@link Model.create}, for example:\n * ```\n * this.foo = FooModel.create({answer: 123});\n * ```\n * To __initialize__ an instance, override [init()]{@link Model#init}, for example:\n * ```\n * class FooModel extends Croquet.Model {\n *     init(options={}) {\n *         this.answer = options.answer || 42;\n *     }\n * }\n * ```\n * The **reason** for this is that Models are only initialized by calling `init()`\n * the first time the object comes into existence in the session.\n * After that, when joining a session, the models are deserialized from the snapshot, which\n * restores all properties automatically without calling `init()`. A constructor would\n * be called all the time, not just when starting a session.\n *\n * @hideconstructor\n * @public\n */\nclass Model {\n    /**\n     * __Create an instance of a Model subclass.__\n     *\n     * The instance will be registered for automatical snapshotting, and is assigned an [id]{@link Model#id}.\n     *\n     * Then it will call the user-defined [init()]{@link Model#init} method to initialize the instance,\n     * passing the {@link options}.\n     *\n     * **Note:** When your model instance is no longer needed, you must [destroy]{@link Model#destroy} it.\n     * Otherwise it will be kept in the snapshot forever.\n     *\n     * **Warning**: never create a Model instance using `new`, or override its constructor. See [above]{@link Model}.\n     *\n     * @example this.foo = FooModel.create({answer: 123});\n     * @public\n     * @param {Object=} options - option object to be passed to [init()]{@link Model#init}.\n     *     There are no system-defined `options`, you're free to define your own.\n     * @param {Object=} persistentData - passed to [init()]{@link Model#init}, if provided.\n     */\n    static create(...options) {\n        // we actuall pass all options to init(), but we leave the type declaration\n        // with only two arguments to match what the root model gets\n        if (!hasID(this)) throw Error(`Model class \"${this.name}\" not registered`);\n        const ModelClass = this;\n        const model = this.createNoInit();\n        // make root model well-known before calling its init() so\n        // that other models created in init() can look it up\n        const beModelRoot = !this.wellKnownModel(\"modelRoot\");\n        if (beModelRoot) {\n            model.beWellKnownAs(\"modelRoot\");\n            // set up event log subscriptions before user subscriptions\n            if (model.__realm.vm.debugEvents) {\n                this.eventDebugInit(model);\n            }\n        }\n        // now call user init\n        SuperInitNotCalled.add(model);\n        model.init(...options);\n        if (SuperInitNotCalled.has(model)) {\n            SuperInitNotCalled.delete(model);\n            // only warn about deep subclasses\n            if (Object.getPrototypeOf(ModelClass) !== Model) {\n                console.warn(`${model} did not call super.init(options)`);\n            }\n        }\n        return model;\n    }\n    /* When we announce persistence, add this above\n     * @param {Object=} persistentData - persistent data to be passed to [init()]{@link Model#init}.\n     *     Only your root model's `init` receives the stored data automatically.\n     *     This argument allows you to pass portions of that data when creating submodels.\n     */\n\n    // this version is used by the serializer\n    static createNoInit(id) {\n        const ModelClass = this;\n        const realm = currentRealm();\n        const model = new ModelClass(SECRET);\n        if (!id) id = realm.register(model);\n        // debug proxying does not work for non-writable object props\n        if (DEBUG.write === undefined) initDEBUG();\n        Object.defineProperty(model, \"__realm\", { value: realm, writable: DEBUG.write });\n        Object.defineProperty(model, \"id\", { value: id, enumerable: true });\n        return model;\n    }\n\n    // hack for Parts that still use constructors\n    static allowConstructors() {\n        SECRET = undefined;\n        console.warn(\"disabling error reporting for Model constructors\");\n    }\n\n    /**\n     * __Registers this model subclass with Croquet__\n     *\n     * It is necessary to register all Model subclasses so the serializer can recreate their instances from a snapshot.\n     * Since source code minification can change the actual class name, you have to pass a `classId` explicitly.\n     *\n     * Secondly, the [session id]{@link Session.join} is derived by hashing the source code of all registered classes.\n     * This ensures that only clients running the same source code can be in the same session,\n     * so that the synchronized computations are identical for each client.\n     *\n     * **Important**: for the hashing to work reliably across browsers, be sure to specify `charset=\"utf-8\"` for your `<html>` or all `<script>` tags.\n     * @example\n     * class MyModel extends Croquet.Model {\n     *   ...\n     * }\n     * MyModel.register(\"MyModel\")\n     * @param {String} classId Id for this model class. Must be unique. If you use the same class name in two files, use e.g. `\"file1/MyModel\"` and `\"file2/MyModel\"`.\n     * @public\n     */\n    static register(classId) {\n        if (!classId) {\n            classId = this.name;\n            console.warn(`Deprecation warning: ${this.name}.register(classId) called without classId. See https://croquet.io/docs/croquet/Model.html#.register`);\n        }\n        resetReadersAndWriters();\n        addClassHash(this, classId);\n        registerClass(this, classId);\n        Model.lastRegistered = this;\n        return this;\n    }\n\n    /**\n     * Static version of [wellKnownModel()]{@link Model#wellKnownModel} for currently executing model.\n     *\n     * This can be used to emulate static accessors, e.g. for lazy initialization.\n     *\n     * __WARNING!__ Do not store the result in a static variable.\n     * Like any global state, that can lead to divergence.\n     *\n     * Will throw an error if called from outside model code.\n     *\n     * @example\n     * static get Default() {\n     *     let default = this.wellKnownModel(\"DefaultModel\");\n     *     if (!default) {\n     *         console.log(\"Creating default\")\n     *         default = MyModel.create();\n     *         default.beWellKnownAs(\"DefaultModel\");\n     *     }\n     *     return default;\n     * }\n     * @param {String} name - the name given in [beWellKnownAs()]{@link Model#beWellKnownAs}\n     * @returns {Model?} the model if found, or `undefined`\n     * @public\n     */\n    static wellKnownModel(name) {\n        if (!VirtualMachine.hasCurrent()) throw Error(\"static Model.wellKnownModel() called from outside model\");\n        return VirtualMachine.current().get(name);\n    }\n\n    /**\n     * Evaluates func inside of a temporary VM to get bit-identical results, e.g. to init [Constants]{@link Constants}.\n     * @param {Function} func - function to evaluate\n     * @returns {*} result of func\n     * @since 1.1.0\n     * @public\n    */\n    static evaluate(func) {\n        return VirtualMachine.evaluate(func);\n    }\n\n    /**\n     * **Check if currently executing code is inside a model.**\n     * @returns {Boolean} true if currently executing code is inside a model\n     * @since 2.0\n     * @public\n     */\n    static isExecuting() {\n        return VirtualMachine.hasCurrent();\n    }\n\n    /**\n     * __Static declaration of how to serialize non-model classes.__\n     *\n     * The Croquet snapshot mechanism knows about {@link Model} subclasses, as well as many JS built-in types (see below),\n     * it handles circular references, and it works recursively by converting all non-JSON types to JSON.\n     *\n     * If you want to store instances of non-model classes in your model, override this method.\n     *\n     * `types()` needs to return an Object that maps _names_ to _class descriptions_:\n     * - the name can be any string, it just has to be unique within your app\n     * - the class description can either be just the class itself (if the serializer should\n     *   snapshot all its fields, see first example below), or an object with `write()` and `read()` methods to\n     *   convert instances from and to their serializable form (see second example below),\n     *   and (since v2.0) `writeStatic()` and `readStatic()` to serialize and restore static properties.\n     * - the serialized form answered by `write()` should return a simpler representation,\n     *   but it can still contain references to other objects, which will be resolved by the serializer.\n     *   E.g. if it answers an Array of objects then the serializer will be called for each of those objects.\n     *   Conversely, these objects will be deserialized before passing the reconstructed Array to `read()`.\n     *\n     * Declaring a type in any class makes that declaration available globally.\n     * The types only need to be declared once, even if several different Model subclasses are using them.\n     *\n     * __NOTE:__ This is currently the only way to customize serialization (for example to keep snapshots fast and small).\n     * The serialization of Model subclasses themselves can not be customized, except through \"dollar properties\":\n     *\n     * __All properties starting with `$` are ignored, e.g. `$foo`.__\n     * This can be used for caching big objects that should not appear in the snapshot,\n     * but care needs to be taken to make sure that the cache is reconstructed whenever used.\n     *\n     * Serialization types supported:\n     * - plain `Object`, `Array`, `number`, `string`, `boolean`, `null`: just like JSON\n     * - `-0`, `NaN`, `Infinity`, `-Infinity`\n     * - `BigInt` (since 1.1.0)\n     * - `undefined`\n     * - `ArrayBuffer`, `DataView`, `Int8Array`, `Uint8Array`, `Uint8ClampedArray`, `Int16Array`, `Uint16Array`, `Int32Array`, `Uint32Array`, `Float32Array`, `Float64Array`\n     * - `Set`, `Map`\n     *\n     * Not supported:\n     * - `Date`: the built-in Date type is dangerous because it implicitly depends on the current timezone which can lead to divergence.\n     * - `RegExp`: this has built-in state that can not be introspected and recreated in JS.\n     * - `WeakMap`, `WeakSet`: these are not enumerable and can not be serialized.\n     * - `Symbol`: these are unique and can not be serialized.\n     * - `Function`, `Promise`, `Generator` etc: there is no generic way to serialize functions because closures can not be introspected in JS.\n     *    Even just for the source code, browsers differ in how they convert functions to strings.\n     *    If you need to store functions in the model (e.g. for live coding),\n     *    either wrap the source and function in a custom type (where `read` would compile the source saved by `write`),\n     *    or store the source in a regular property, the function in a dollar property,\n     *    and have an accessor that compiles the function lazily when needed.\n     *    (see the source of [croquet.io/live]{@link https://croquet.io/live/} for a simple live-coding example)\n     *\n     * @example <caption>To use the default serializer just declare the class:</caption>\n     * class MyModel extends Croquet.Model {\n     *   static types() {\n     *     return {\n     *       \"SomeUniqueName\": MyNonModelClass,\n     *       \"THREE.Vector3\": THREE.Vector3,        // serialized as '{\"x\":...,\"y\":...,\"z\":...}'\n     *       \"THREE.Quaternion\": THREE.Quaternion,\n     *     };\n     *   }\n     * }\n     *\n     * @example <caption>To define your own serializer, declare read and write functions:</caption>\n     * class MyModel extends Croquet.Model {\n     *   static types() {\n     *     return {\n     *      \"SomeUniqueName\": {\n     *          cls: MyNonModelClass,\n     *          write: obj => obj.serialize(),  // answer a serializable type, see above\n     *          read: state => MyNonModelClass.deserialize(state), // answer a new instance\n     *          writeStatic: () => ({foo: MyNonModelClass.foo}),\n     *          readStatic: state => MyNonModelClass.foo = state.foo,\n     *       },\n     *       \"THREE.Vector3\": {\n     *         cls: THREE.Vector3,\n     *         write: v => [v.x, v.y, v.z],        // serialized as '[...,...,...]' which is shorter than the default above\n     *         read: v => new THREE.Vector3(v[0], v[1], v[2]),\n     *       },\n     *       \"THREE.Color\": {\n     *         cls: THREE.Color,\n     *         write: color => '#' + color.getHexString(),\n     *         read: state => new THREE.Color(state)\n     *       },\n     *     }\n     *   }\n     * }\n     * @public\n     */\n    static types() {\n        return {};\n    }\n\n    /** Find classes inside an external library\n     *\n     * This recursivley traverses a dummy object and gathers all object classes found.\n     * Returns a mapping that can be returned from a Model's static `types()` method.\n     *\n     * This can be used to gather all internal class types of a third party library\n     * that otherwise would not be accessible to the serializer\n     *\n     * @example<caption>\n     *   If `Foo` is a class from a third party library\n     *   that internally create a `Bar` instance,\n     *   this would find both classes\n     * </caption>\n     * class Bar {} // internal class\n     * class Foo { constructor() { this.bar = new Bar(); } }\n     * static types() {\n     *    const sample = new Foo();\n     *    return this.gatherClassTypes(sample, \"MyLib\");\n     *    // returns { \"MyLib.Foo\": Foo, \"MyLib.Bar\": Bar }\n     * }\n     * @param {Object} dummyObject - an instance of a class from the library\n     * @param {String} prefix - a prefix to add to the class names\n     * @since 2.0\n     */\n    static gatherClassTypes(dummyObject, prefix) {\n        const result = {};\n        gatherClassTypes({root: dummyObject}, prefix, result, new Set());\n        return result;\n    }\n\n    static eventDebugOptions() { return DEBUG; }\n\n    /** register event logger subscription */\n    static eventDebugInit(model) {\n        // use string to survive minification\n        const logEvents = `\n        function logEvents(data) {\n            // do this now to have no side effects below\n            const { scope, event, source } = this.activeSubscription;\n            // below stuff is outside the model. Must not have any side effects!\n            const debug = this.constructor.eventDebugOptions();\n            if (!debug.events && !debug.publish) return;\n            const action = source === \"model\" ? \"publish\" : \"receive\";\n            const emoji = source === \"model\" ? \"\" : \"\";\n            console.log(\\`\\${emoji} @\\${this.now()} Model \\${action} \\${scope}:\\${event}\\`, data);\n        }\n        `;\n        model.subscribe(\"*\", \"*\", model.createQFunc(logEvents));\n    }\n\n\n    // for use by serializer (see vm.js)\n    static okayToIgnore() { return []; }\n    static classToID(cls) {  return classToID(cls); }\n    static classFromID(id) { return classFromID(id); }\n    static allClasses() { return allClasses(); }\n    static allClassTypes() { return allClassTypes(); }\n    static instantiateClassID(classId, id) {\n        const ModelClass = classFromID(classId);\n        return ModelClass.createNoInit(id);\n    }\n\n    constructor(secret) {\n        if (secret !== SECRET) throw Error(`You must create ${App.libName} Models using create() not \"new\"!`);\n    }\n\n    /**\n     * This is called by [create()]{@link Model.create} to initialize a model instance.\n     *\n     * In your Model subclass this is the place to [subscribe]{@link Model#subscribe} to events,\n     * or start a [future]{@link Model#future} message chain.\n     *\n     * If you pass `{options:...}` to [Session.join]{@link Session.join}, these will be passed to your root model's `init()`.\n     * Note that `options` affect the session's `persistentId`  in most cases, using [Croquet.Constants]{@link Constants}\n     * is a better choice to customize what happens in `init()`.\n     *\n     * If you called [persistSession]{@link Model#persistSession} in a previous session (same name, same options, different code base),\n     * that data will be passed as `persistentData` to your root model's `init()`. Based on that data you should re-create submodels,\n     * subscriptions, future messages etc. to start the new session in a state similar to when it was last saved.\n     *\n     * **Note:** When your model instance is no longer needed, you must [destroy]{@link Model#destroy} it.\n     *\n     * @param {Object=} options - if passed to [Session.join]{@link Session.join}\n     * @param {Object=} persistentData - data previously stored by [persistSession]{@link Model#persistSession}\n     * @public\n     */\n    init(options, persistentData) { /* eslint-disable-line no-unused-vars */\n        // for reporting errors if user forgot to call super.init()\n        SuperInitNotCalled.delete(this);\n        // eslint-disable-next-line no-constant-condition\n        if (false) {\n            /** Each model has an id which can be used to scope [events]{@link Model#publish}. It is unique within the session.\n             *\n             * This property is read-only. There will be an error if you try to assign to it.\n             *\n             * It is assigned in {@link Model.create} before calling [init]{@link Model#init}.\n             * @example\n             * this.publish(this.id, \"changed\");\n             * @type {String}\n             * @public\n             */\n            this.id = \"\";\n            // don't know how to otherwise add documentation\n        }\n    }\n\n    /**\n     * Unsubscribes all [subscriptions]{@link Model#subscribe} this model has,\n     * unschedules all [future]{@link Model#future} messages,\n     * and removes it from future snapshots.\n     * @example\n     * removeChild(child) {\n     *    const index = this.children.indexOf(child);\n     *    this.children.splice(index, 1);\n     *    child.destroy();\n     * }\n     * @public\n     */\n    destroy() {\n        currentRealm().unsubscribeAll(this);\n        currentRealm().deregister(this);\n        // we're not deleting the object's id here\n        // because it comes in handy for queued view event handlers\n    }\n\n    // Pub / Sub\n\n    /**\n     * **Publish an event to a scope.**\n     *\n     * Events are the main form of communication between models and views in Croquet.\n     * Both models and views can publish events, and subscribe to each other's events.\n     * Model-to-model and view-to-view subscriptions are possible, too.\n     *\n     * See [Model.subscribe]{@link Model#subscribe}() for a discussion of **scopes** and **event names**.\n     * Refer to [View.subscribe]{@link View#subscribe}() for invoking event handlers *asynchronously* or *immediately*.\n     *\n     * Optionally, you can pass some **data** along with the event.\n     * For events published by a model, this can be any arbitrary value or object.\n     * See View's [publish]{@link View#publish} method for restrictions in passing data from a view to a model.\n     *\n     * If you subscribe inside the model to an event that is published by the model,\n     * the handler will be called immediately, before the publish method returns.\n     * If you want to have it handled asynchronously, you can use a future message:\n     *\n     *     this.future(0).publish(\"scope\", \"event\", data);\n     *\n     * Note that there is no way of testing whether subscriptions exist or not (because models can exist independent of views).\n     * Publishing an event that has no subscriptions is about as cheap as that test would be, so feel free to always publish,\n     * there is very little overhead.\n     *\n     * @example\n     * this.publish(\"something\", \"changed\");\n     * this.publish(this.id, \"moved\", this.pos);\n     * @param {String} scope see [subscribe]{@link Model#subscribe}()\n     * @param {String} event see [subscribe]{@link Model#subscribe}()\n     * @param {*=} data can be any value or object\n     * @public\n     */\n    publish(scope, event, data) {\n        if (!this.__realm) this.__realmError();\n        this.__realm.publish(event, data, scope);\n    }\n\n    /**\n     * **Register an event handler for an event published to a scope.**\n     *\n     * Both `scope` and `event` can be arbitrary strings.\n     * Typically, the scope would select the object (or groups of objects) to respond to the event,\n     * and the event name would select which operation to perform.\n     *\n     * A commonly used scope is `this.id` (in a model) and `model.id` (in a view) to establish\n     * a communication channel between a model and its corresponding view.\n     *\n     * You can use any literal string as a global scope, or use [`this.sessionId`]{@link Model#sessionId} for a\n     * session-global scope (if your application supports multipe sessions at the same time).\n     * The predefined [`\"view-join\"` event]{@link event:view-join} and [`\"view-exit\"` event]{@link event:view-exit}\n     * use this session scope.\n     *\n     * The handler must be a method of `this`, e.g. `subscribe(\"scope\", \"event\", this.methodName)` will schedule the\n     * invocation of `this[\"methodName\"](data)` whenever `publish(\"scope\", \"event\", data)` is executed.\n     *\n     * If `data` was passed to the [publish]{@link Model#publish} call, it will be passed as an argument to the handler method.\n     * You can have at most one argument. To pass multiple values, pass an Object or Array containing those values.\n     * Note that views can only pass serializable data to models, because those events are routed via a reflector server\n     * (see [View.publish){@link View#publish}).\n     *\n     * @example\n     * this.subscribe(\"something\", \"changed\", this.update);\n     * this.subscribe(this.id, \"moved\", this.handleMove);\n     * @example\n     * class MyModel extends Croquet.Model {\n     *   init() {\n     *     this.subscribe(this.id, \"moved\", this.handleMove);\n     *   }\n     *   handleMove({x,y}) {\n     *     this.x = x;\n     *     this.y = y;\n     *   }\n     * }\n     * class MyView extends Croquet.View {\n     *   constructor(model) {\n     *     this.modelId = model.id;\n     *   }\n     *   onpointermove(evt) {\n     *      const x = evt.x;\n     *      const y = evt.y;\n     *      this.publish(this.modelId, \"moved\", {x,y});\n     *   }\n     * }\n     * @param {String} scope - the event scope (to distinguish between events of the same name used by different objects)\n     * @param {String} event - the event name (user-defined or system-defined)\n     * @param {Function} handler - the event handler (must be a method of `this`)\n     * @return {this}\n     * @public\n     */\n    subscribe(scope, event, methodName) {\n        if (!this.__realm) this.__realmError();\n        return this.__realm.subscribe(this, scope, event, methodName);\n    }\n\n    /**\n     * Unsubscribes this model's handler(s) for the given event in the given scope.\n     *\n     * To unsubscribe only a specific handler, pass it as the third argument.\n     * @example\n     * this.unsubscribe(\"something\", \"changed\");\n     * this.unsubscribe(this.id, \"moved\", this.handleMove);\n     * @param {String} scope see [subscribe]{@link Model#subscribe}\n     * @param {String} event see [subscribe]{@link Model#subscribe}\n     * @param {Function?} handler (optional) the handler to unsubscribe (added in 1.1)\n     * @public\n     */\n    unsubscribe(scope, event, methodName='*') {\n        if (!this.__realm) this.__realmError();\n        this.__realm.unsubscribe(this, scope, event, methodName);\n    }\n\n    /**\n     * Unsubscribes all of this model's handlers for any event in any scope.\n     * @public\n     */\n    unsubscribeAll() {\n        if (!this.__realm) this.__realmError();\n        this.__realm.unsubscribeAll(this);\n    }\n\n    /**\n     * Scope, event, and source of the currently executing subscription handler.\n     *\n     * The `source` is either `\"model\"` or `\"view\"`.\n     *\n     * @example\n     * // this.subscribe(\"*\", \"*\", this.logEvents)\n     * logEvents(data: any) {\n     *     const {scope, event, source} = this.activeSubscription;\n     *     console.log(`${this.now()} Event in model from ${source} ${scope}:${event} with`, data);\n     * }\n     * @returns {Object} `{scope, event, source}` or `undefined` if not in a subscription handler.\n     * @since 2.0\n     * @public\n     */\n    get activeSubscription() {\n        if (!VirtualMachine.hasCurrent()) return undefined;\n        const { currentEvent, currentEventFromModel } = VirtualMachine.current();\n        if (!currentEvent) return undefined;\n        const [scope, event] = currentEvent.split(\":\");\n        const source = currentEventFromModel ? \"model\" : \"view\";\n        return { scope, event, source };\n    }\n\n    __realmError() {\n        if (!this.id) throw Error(`${this} has no ID, did you call super.init(options)?`);\n    }\n\n    // Misc\n\n    /**\n     * **Schedule a message for future execution**\n     *\n     * Use a future message to automatically advance time in a model,\n     * for example for animations.\n     * The execution will be scheduled `tOffset` milliseconds into the future.\n     * It will run at precisely `this.now() + tOffset`.\n     *\n     * Use the form `this.future(100).methodName(args)` to schedule the execution\n     * of `this.methodName(args)` at time `this.now() + tOffset`.\n     *\n     * **Hint**: This would be an unusual use of `future()`, but the `tOffset` given may be `0`,\n     * in which case the execution will happen asynchronously before advancing time.\n     * This is the only way for asynchronous execution in the model since you must not\n     * use Promises or async functions in model code (because a snapshot may happen at any time\n     * and it would not capture those executions).\n     *\n     * **Note:** the recommended form given above is equivalent to `this.future(100, \"methodName\", arg1, arg2)`\n     * but makes it more clear that \"methodName\" is not just a string but the name of a method of this object.\n     * Also, this will survive minification.\n     * Technically, it answers a [Proxy]{@link https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Proxy}\n     * that captures the name and arguments of `.methodName(args)` for later execution.\n     *\n     * See this [tutorial]{@tutorial 1_1_hello_world} for a complete example.\n     * @example <caption>single invocation with two arguments</caption>\n     * this.future(3000).say(\"hello\", \"world\");\n     * @example <caption>repeated invocation with no arguments</caption>\n     * tick() {\n     *     this.n++;\n     *     this.publish(this.id, \"count\", {time: this.now(), count: this.n)});\n     *     this.future(100).tick();\n     * }\n     * @param {Number} tOffset - time offset in milliseconds, must be >= 0\n     * @returns {this}\n     * @public\n     */\n    future(tOffset=0, methodName=undefined, ...args) {\n        if (!this.__realm) this.__realmError();\n        return this.__realm.future(this, tOffset, methodName, args);\n    }\n\n    /**\n     * **Cancel a previously scheduled future message**\n     *\n     * This unschedules the invocation of a message that was scheduled with [future]{@link Model#future}.\n     * It is okay to call this method even if the message was already executed or if it was never scheduled.\n     *\n     * **Note:** as with [future]{@link Model#future}, the recommended form is to pass the method itself,\n     * but you can also pass the name of the method as a string.\n     *\n     * @example\n     * this.future(3000).say(\"hello\", \"world\");\n     * ...\n     * this.cancelFuture(this.say);\n     * @param {Function} method - the method (must be a method of `this`) or \"*\" to cancel all of this object's future messages\n     * @returns {Boolean} true if the message was found and canceled, false if it was not found\n     * @since 1.1.0\n     * @public\n    */\n    cancelFuture(methodOrMessage) {\n        if (!this.__realm) this.__realmError();\n        return this.__realm.cancelFuture(this, methodOrMessage);\n    }\n\n    /**\n     * **Generate a synchronized pseudo-random number**\n     *\n     * This returns a floating-point, pseudo-random number in the range 01 (inclusive of 0, but not 1) with approximately uniform distribution over that range\n     * (just like [Math.random]{@link https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Math/random}).\n     *\n     * Since the model computation is synchronized for every user on their device, the sequence of random numbers generated must also\n     * be exactly the same for everyone. This method provides access to such a random number generator.\n     *\n     * @returns {Number}\n     * @public\n     */\n    random() {\n        return currentRealm().random();\n    }\n\n    /**\n     * **The model's current time**\n     *\n     * Time is discreet in Croquet, meaning it advances in steps.\n     * Every user's device performs the exact same computation at the exact same virtual time.\n     * This is what allows Croquet to do perfectly synchronized computation.\n     *\n     * Every [event handler]{@link Model#subscribe} and [future message]{@link Model#future}\n     * is run at a precisely defined moment in virtual model time, and time stands still while this execution is happening.\n     * That means if you were to access `this.now()` in a loop, it would never answer a different value.\n     *\n     * The unit of `now` is milliseconds (1/1000 second) but the value can be fractional, it is a floating-point value.\n     *\n     * @return {Number} the model's time in milliseconds since the first user created the session.\n     * @see [View.now()]{@link View#now}\n     * @public\n     */\n    now() {\n        return currentRealm().now();\n    }\n\n    /**\n     * Make this model globally accessible under the given name.\n     * It can be retrieved from any other model in the same session using [wellKnownModel()]{@link Model#wellKnownModel}.\n     *\n     * Hint: Another way to make a model well-known is to pass a name as second argument to {@link Model.create}().\n     *\n     * Note: The instance of your root Model class is automatically made well-known as `\"modelRoot\"`\n     * and passed to the [constructor]{@link View} of your root View during {@link Session.join}.\n     * @example\n     * class FooManager extends Croquet.Model {\n     *   init() {\n     *     this.beWellKnownAs(\"UberFoo\");\n     *   }\n     * }\n     * class Underlings extends Croquet.Model {\n     *   reportToManager(something) {\n     *     this.wellKnownModel(\"UberFoo\").report(something);\n     *   }\n     * }\n     * @param {String} name - a name for the model\n     * @public\n     */\n    beWellKnownAs(name) {\n        currentRealm().vm.set(name, this);\n    }\n\n    /**\n     * Look up a model in the current session given its `id`\n     * @example\n     * const otherModel = this.getModel(otherId);\n     * @param {String} id - the model's `id`\n     * @returns {Model} the model if found, or `undefined`\n     * @public\n     */\n    getModel(id) {\n        return this.__realm.vm.lookUpModel(id);\n    }\n\n    /**\n     * Access a model that was registered previously using  [beWellKnownAs()]{@link Model#beWellKnownAs}.\n     *\n     * Note: The instance of your root Model class is automatically made well-known as `\"modelRoot\"`\n     * and passed to the [constructor]{@link View} of your root View during {@link Session.join}.\n     * @example\n     * const topModel = this.wellKnownModel(\"modelRoot\");\n     * @param {String} name - the name given in [beWellKnownAs()]{@link Model#beWellKnownAs}\n     * @returns {Model?} the model if found, or `undefined`\n     * @public\n     */\n    wellKnownModel(name) {\n        return this.__realm.vm.get(name);\n    }\n\n    /**\n     * This methods checks if it is being called from a model, and throws an Error otherwise.\n     *\n     * Use this to protect some model code against accidentally being called from a view.\n     * @example\n     * get foo() { return this._foo; }\n     * set foo(value) { this.modelOnly(); this._foo = value; }\n     * @param {String=} msg - error message to display\n     * @throws Error if called from view\n     * @returns {Boolean} true (otherwise, throws Error)\n     * @public\n     */\n    modelOnly(msg) {\n        if (VirtualMachine.current() === this.__realm.vm) return true;\n        const error = Error(msg || `${this}.modelOnly() called from outside a model!`);\n        displayAppError('view code', error);\n        throw error;\n    }\n\n    /**\n     * **Identifies the shared session of all users**<br>\n     * (as opposed to the [viewId]{@link View#viewId} which identifies the non-shared views of each user).\n     *\n     * The session id is used as \"global\" scope for events like the [`\"view-join\"` event]{@link event:view-join}.\n     *\n     * See {@link Session.join} for how the session id is generated.\n     *\n     * If your app has several sessions at the same time, each session id will be different.\n     * @example\n     * this.subscribe(this.sessionId, \"view-join\", this.addUser);\n     * @type {String}\n     * @public\n     */\n    get sessionId() {\n        return this.__realm.vm.id;\n    }\n\n    /**\n     * **The number of users currently in this session.**\n     *\n     * All users in a session share the same Model (meaning all model objects) but each user has a different View\n     * (meaning all the non-model state). This is the number of views currently sharing this model.\n     * It is increased by 1 before every [`\"view-join\"` event]{@link event:view-join}\n     * and decreased by 1 before every [`\"view-exit\"` event]{@link event:view-exit}\n     * handler is executed.\n     *\n     * @example\n     * this.subscribe(this.sessionId, \"view-join\", this.showUsers);\n     * this.subscribe(this.sessionId, \"view-exit\", this.showUsers);\n     * showUsers() { this.publish(this.sessionId, \"view-count\", this.viewCount); }\n     * @type {Number}\n     * @public\n     */\n    get viewCount() {\n        return Object.keys(this.__realm.vm.views).length;\n    }\n\n    /**\n     * **Create a serializable function that can be stored in the model.**\n     *\n     * Plain functions can not be serialized because they may contain closures that can\n     * not be introspected by the snapshot mechanism. This method creates a serializable\n     * \"QFunc\" from a regular function. It can be stored in the model and called like\n     * the original function.\n     *\n     * The function can only access global references (like classes), *all local\n     * references must be passed in the `env` object*. They are captured\n     * as constants at the time the QFunc is created. Since they are constants,\n     * re-assignments will throw an error.\n     *\n     * In a fat-arrow function, `this` is bound to the model that called `createQFunc`,\n     * even in a different lexical scope. It is okay to call a model's `createQFunc` from\n     * anywhere, e.g. from a view. QFuncs can be passed from view to model as arguments\n     * in `publish()` (provided their environment is serializable).\n     *\n     * **Warning:** Minification can change the names of local variables and functions,\n     * but the env will still use the unminified names. You need to disable\n     * minification for source code that creates QFuncs with env. Alternatively, you can\n     * pass the function's source code as a string, which will not be minified.\n     *\n     * Behind the scenes, the function is stored as a string and compiled when needed.\n     * The env needs to be constant because the serializer would not able to capture\n     * the values if they were allowed to change.\n     *\n     * @example\n     * const template = { greeting: \"Hi there,\" };\n     * this.greet = this.createQFunc({template}, (name) => console.log(template.greeting, name));\n     * this.greet(this, \"friend\"); // logs \"Hi there, friend\"\n     * template.greeting = \"Bye now,\";\n     * this.greet(this, \"friend\"); // logs \"Bye now, friend\"\n     *\n     * @param {Object} env - an object with references used by the function\n     * @param {Function|String} func - the function to be wrapped, or a string with the function's source code\n     * @returns {Function} a serializable function bound to the given environment\n     * @public\n     * @since 2.0\n     */\n    createQFunc(env, func) {\n        if (func === undefined) { func = env; env = {}; }\n        return createQFunc(this, env, func);\n    }\n\n    /**\n     * Store an application-defined JSON representation of this session to be loaded into future\n     * sessions. This will be passed into the root model's [init]{@link Model#init} method\n     * if resuming a session that is not currently ongoing (e.g. due to changes in the model code).\n     *\n     * **Note:** You should design the JSON in a way to be loadable in newer versions of your app.\n     * To help migrating incompatible data, you may want to include a version identifier so a future\n     * version of your [init]{@link Model#init} can decide what to do.\n     *\n     * **Warning** Do NOT use `JSON.stringify` because the result is not guaranteed to have the same ordering of keys\n     * everywhere. Instead, store the JSON data directly and let Croquet apply its stable stringification.\n     *\n     * Also you must only call persistSession() from your [root model]{@link Model#wellKnownModel}.\n     * If there are submodels, your collectDataFunc should collect data from all submodels.\n     * Similarly, only your root model's `init` will receive that persisted data.\n     * It should recreate submodels as necessary.\n     *\n     * Croquet will not interpret this data in any way (e.g. not even the `version` property in the example below).\n     * It is stringified, encrypted, and stored.\n     *\n     * @example\n     * class SimpleAppRootModel {\n     *     init(options, persisted) {\n     *         ...                         // regular setup\n     *         if (persisted) {\n     *             if (persisted.version === 1) {\n     *                 ...                 // init from persisted data\n     *             }\n     *         }\n     *     }\n     *\n     *     save() {\n     *         this.persistSession(() => {\n     *             const data = {\n     *                version: 1,         // for future migrations\n     *                ...                 // data to persist\n     *             };\n     *             return data;\n     *         });\n     *     }\n     * }\n     * @tutorial 2_A_persistence\n     * @tutorial 2_9_data\n     * @public\n     * @param {Function} collectDataFunc - method returning information to be stored, will be stringified as JSON\n     */\n    persistSession(collectDataFunc) {\n        if (this !== this.wellKnownModel(\"modelRoot\")) throw Error('persistSession() must only be called on the root model');\n        this.__realm.vm.persist(this, collectDataFunc);\n    }\n\n    [Symbol.toPrimitive]() {\n        const className = this.constructor[CLASS_ID] || this.constructor.name;\n        return `${className}#${this.id}`;\n    }\n}\n// Model.register(\"Croquet.Model\");\n// registered at end of this file without hashing or logging\n\n/// MODEL CLASS LOADING\n\n// map model class names to model classes\nconst ModelClasses = {};\n\n// Symbol for storing class ID in constructors\nconst CLASS_ID = Symbol('CLASS_ID');\n\nfunction allClasses() {\n    return Object.values(ModelClasses);\n}\n\nfunction allClassTypes() {\n    const types = {};\n    for (const modelClass of allClasses()) {\n        Object.assign(types, modelClass.types());\n    }\n    return Object.entries(types);\n}\n\nfunction hasID(cls) {\n    return Object.prototype.hasOwnProperty.call(cls, CLASS_ID);\n}\n\nfunction classToID(cls) {\n    if (hasID(cls)) return cls[CLASS_ID];\n    const name = cls.name || 'ClassName';\n    throw Error(`Model class not registered, did you call ${name}.register(\"${name}\")?`);\n}\n\nfunction classFromID(classId) {\n    if (ModelClasses[classId]) return ModelClasses[classId];\n    throw Error(`Model class \"${classId}\" in snapshot, but not registered?`);\n}\n\nfunction registerClass(cls, classId) {\n    // create a classId for this class\n    const dupe = ModelClasses[classId];\n    if (dupe && dupe !== cls) throw Error(`Registering model class ${cls.name} failed, id \"${classId}\" already used by ${dupe.name}`);\n    if (hasID(cls)) {\n        if (DEBUG.classes && !dupe) console.warn(`ignoring re-exported model class ${classId}`);\n    } else {\n        if (DEBUG.classes) console.log(`registering model class ${classId}`);\n        cls[CLASS_ID] = classId;\n    }\n    ModelClasses[classId] = cls;\n    return cls;\n}\n\n// register without logging or hashing\nconst modelClassId = \"Croquet.Model\";\nModel[CLASS_ID] = modelClassId;\nModelClasses[modelClassId] = Model;\n\nexport default Model;\n", "import { App, displayStatus, displayWarning, displayError } from \"./_HTML_MODULE_\"; // eslint-disable-line import/no-unresolved\nimport { currentRealm, inViewRealm } from \"./realms\";\nimport { viewDomain } from \"./domain\";\nimport urlOptions from \"./_URLOPTIONS_MODULE_\"; // eslint-disable-line import/no-unresolved\n\nlet DEBUG;\n\nfunction initDEBUG() {\n    DEBUG = {\n        events: urlOptions.has(\"debug\", \"events\"),\n        publish: urlOptions.has(\"debug\", \"publish\"),\n    };\n}\n\n/**\n * Views are the local, non-synchronized part of a Croquet Application.\n * Each device and browser window creates its own independent local view.\n * The view [subscribes]{@link View#subscribe} to events [published]{@link Model#publish}\n * by the synchronized model, so it stays up to date in real time.\n *\n * What the view is showing, however, is completely up to the application developer.\n * The view can adapt to the device it's running on and show very different things.\n *\n * **Croquet makes no assumptions about the UI framework you use** - be it plain HTML or Three.js or React or whatever.\n * Croquet only provides the publish/subscribe mechanism to hook into the synchronized model simulation.\n *\n * It's possible for a single view instance to handle all the events, you don't event have to subclass Croquet.View for that.\n * That being said, a common pattern is to make a hierarchy of `Croquet.View` subclasses to mimic your hierarchy of {@link Model} subclasses.\n *\n * @public\n */\nclass View {\n    static displayStatus(msg, options) { return displayStatus(msg, options); }\n    static displayWarning(msg, options) { return displayWarning(msg, options); }\n    static displayError(msg, options) { return displayError(msg, options); }\n\n    /**\n     * A View instance is created in {@link Session.join}, and the root model is passed into its constructor.\n     *\n     * This inherited constructor does not use the model in any way.\n     * Your constructor should recreate the view state to exactly match what is in the model.\n     * It should also [subscribe]{@link View#subscribe} to any changes published by the model.\n     * Typically, a view would also subscribe to the browser's or framework's input events,\n     * and in response [publish]{@link View#publish} events for the model to consume.\n     *\n     * The constructor will, however, register the view and assign it an [id]{@link View#id}.\n     *\n     * **Note:** When your view instance is no longer needed, you must [detach]{@link View#detach} it.\n     * Otherwise it will be kept in memory forever.\n     *\n     * @param {Model} model - the view's model\n     * @param {Object?} viewOptions - if `viewOptions` where given in {@link Session.join}\n     * @public\n     */\n    constructor(model) {\n        if (typeof model !== \"object\" || !(\"__realm\" in model)) console.warn(`${App.libName}: argument to View constructor needs to be a Model`);\n        let realm = currentRealm(\"\");\n        if (!realm || !realm.isViewRealm()) {\n            realm = inViewRealm(model.__realm.vm, () => currentRealm(), true);\n        }\n        // read-only properties\n        Object.defineProperty(this, \"realm\", { value: realm });\n        Object.defineProperty(this, \"id\", {  value: realm.register(this), configurable: true });\n        // hack to get root view into session object before constructor finishes\n        const session = realm.controller.session;\n        if (!session.view) session.view = this;\n        // if event debugging is enabled, log events in root view\n        if (!DEBUG) initDEBUG();\n        if (session.view === this && (DEBUG.events || DEBUG.publish)) {\n            const logEvent = data => {\n                if (!realm.vm.debugEvents) return; // disabled by model\n                const { scope, event, source, subscribed } = this.activeSubscription;\n                if (!subscribed && !DEBUG.publish) return;\n                const action = source === \"view\" ? \"publish\" : \"receive\";\n                const emoji = source === \"view\" ? \"\" : \"\";\n                const noSubscribers = subscribed || action === \"publish\" ? \"\" : \" (no subscribers)\";\n                console.log(`${emoji} View ${action} ${scope}:${event}${noSubscribers}`, data);\n            };\n            const logPublishedEvent = data => this.activeSubscription.source === \"view\" && logEvent(data);\n            const logReceivedEvent = data => this.activeSubscription.source === \"model\" && logEvent(data);\n            logPublishedEvent.__CROQUET__ = true;\n            logReceivedEvent.__CROQUET__ = true;\n            this.subscribe(\"*\", {event: \"*\", handling: \"queued\"}, logReceivedEvent);\n            this.subscribe(\"*\", {event: \"*\", handling: \"immediate\"}, logPublishedEvent);\n        }\n        // eslint-disable-next-line no-constant-condition\n        if (false) {\n            /** Each view has an id which can be used to scope [events]{@link View#publish} between views.\n             * It is unique within the session for each user.\n             *\n             * **Note:** The `id` is **not** currently guaranteed to be unique for different users.\n             * Views on multiple devices may or may not be given the same id.\n             *\n             * This property is read-only. It is assigned in the view's constructor. There will be an error if you try to assign to it.\n             *\n             * @example\n             * this.publish(this.id, \"changed\");\n             * @type {String}\n             * @public\n             */\n            this.id = \"\";\n            // don't know how to otherwise add documentation\n        }\n    }\n\n    /**\n     * **Unsubscribes all [subscriptions]{@link View#subscribe} this view has,\n     * and removes it from the list of views**\n     *\n     * This needs to be called when a view is no longer needed, to prevent memory leaks.\n     * A session's root view is automatically sent `detach` when the session becomes\n     * inactive (for example, going dormant because its browser tab is hidden).\n     * A root view should therefore override `detach` (remembering to call `super.detach()`)\n     * to detach any subsidiary views that it has created.\n     * @example\n     * removeChild(child) {\n     *    const index = this.children.indexOf(child);\n     *    this.children.splice(index, 1);\n     *    child.detach();\n     * }\n     * @public\n     */\n    detach() {\n        this.unsubscribeAll();\n        this.realm.deregister(this);\n        Object.defineProperty(this, \"id\", {  value: \"\" });\n    }\n\n    // ael - provisional\n    reattach() {\n        Object.defineProperty(this, \"id\", { value: this.realm.register(this) });\n    }\n\n    /**\n     * **Publish an event to a scope.**\n     *\n     * Events are the main form of communication between models and views in Croquet.\n     * Both models and views can publish events, and subscribe to each other's events.\n     * Model-to-model and view-to-view subscriptions are possible, too.\n     *\n     * See [Model.subscribe]{@link Model#subscribe} for a discussion of **scopes** and **event names**.\n     *\n     * Optionally, you can pass some **data** along with the event.\n     * For events published by a view and received by a model,\n     * the data needs to be serializable, because it will be sent via the reflector to all users.\n     * For view-to-view events it can be any value or object.\n     *\n     * Note that there is no way of testing whether subscriptions exist or not (because models can exist independent of views).\n     * Publishing an event that has no subscriptions is about as cheap as that test would be, so feel free to always publish,\n     * there is very little overhead.\n     *\n     * @example\n     * this.publish(\"input\", \"keypressed\", {key: 'A'});\n     * this.publish(this.model.id, \"move-to\", this.pos);\n     * @param {String} scope see [subscribe]{@link Model#subscribe}()\n     * @param {String} event see [subscribe]{@link Model#subscribe}()\n     * @param {*=} data can be any value or object (for view-to-model, must be serializable)\n     * @public\n     */\n    publish(scope, event, data) {\n        this.realm.publish(event, data, scope);\n    }\n    /**\n     * **Register an event handler for an event published to a scope.**\n     *\n     * Both `scope` and `event` can be arbitrary strings.\n     * Typically, the scope would select the object (or groups of objects) to respond to the event,\n     * and the event name would select which operation to perform.\n     *\n     * A commonly used scope is `this.id` (in a model) and `model.id` (in a view) to establish\n     * a communication channel between a model and its corresponding view.\n     *\n     * Unlike in a model's [subscribe]{@link Model#subscribe} method, you can specify when the event should be handled:\n     * - **Queued:** The handler will be called on the next run of the [main loop]{@link Session.join},\n     *   the same number of times this event was published.\n     *   This is useful if you need each piece of data that was passed in each [publish]{@link Model#publish} call.\n     *\n     *   An example would be log entries generated in the model that the view is supposed to print.\n     *   Even if more than one log event is published in one render frame, the view needs to receive each one.\n     *\n     *   **`{ event: \"name\", handling: \"queued\" }` is the default.  Simply specify `\"name\"` instead.**\n     *\n     * - **Once Per Frame:** The handler will be called only _once_ during the next run of the [main loop]{@link Session.join}.\n     *   If [publish]{@link Model#publish} was called multiple times, the handler will only be invoked once,\n     *   passing the data of only the last `publish` call.\n     *\n     *   For example, a view typically would only be interested in the current position of a model to render it.\n     *   Since rendering only happens once per frame, it should subscribe using the `oncePerFrame` option.\n     *   The event typically would be published only once per frame anyways, however,\n     *   while the model is catching up when joining a session, this would be fired rapidly.\n     *\n     *   **`{ event: \"name\", handling: \"oncePerFrame\" }` is the most efficient option, you should use it whenever possible.**\n     *\n     * - **Immediate:** The handler will be invoked _synchronously_ during the [publish]{@link Model#publish} call.\n     *   This will tie the view code very closely to the model simulation, which in general is undesirable.\n     *   However, if the event handler needs to set up another subscription,\n     *   immediate execution ensures that a subsequent publish will be properly handled\n     *   (especially when rapidly replaying events for a new user).\n     *   Similarly, if the view needs to know the exact state of the model at the time the event was published,\n     *   before execution in the model proceeds, then this is the facility to allow this without having to copy model state.\n     *\n     *   Pass `{event: \"name\", handling: \"immediate\"}` to enforce this behavior.\n     *\n     * The `handler` can be any callback function.\n     * Unlike a model's [handler]{@link Model#subscribe} which must be a method of that model,\n     * a view's handler can be any function, including fat-arrow functions declared in-line.\n     * Passing a method like in the model is allowed too, it will be bound to `this` in the subscribe call.\n     *\n     * @example\n     * this.subscribe(\"something\", \"changed\", this.update); // \"queued\" handling implied\n     * this.subscribe(this.id, {event: \"moved\", handling: \"oncePerFrame\"}, pos => this.sceneObject.setPosition(pos.x, pos.y, pos.z));\n     * @tutorial 1_4_view_smoothing\n     * @param {String} scope - the event scope (to distinguish between events of the same name used by different objects)\n     * @param {String|Object} eventSpec - the event name (user-defined or system-defined), or an event handling spec object\n     * @param {String} eventSpec.event - the event name (user-defined or system-defined)\n     * @param {String} eventSpec.handling - `\"queued\"` (default), `\"oncePerFrame\"`, or `\"immediate\"`\n     * @param {Function} handler - the event handler (can be any function)\n     * @return {this}\n     * @public\n     */\n    subscribe(scope, eventSpec, callback) {\n        if (typeof callback === \"string\") callback = this[callback];\n        if (typeof callback !== \"function\") throw Error(`${App.libName}: subscribe() handler is not a function`);\n        const unbound = callback;\n        callback = unbound.bind(this);\n        callback.unbound = unbound; // for unsubscribing\n        const {event, handling} = eventSpec.event ? eventSpec : {event: eventSpec};\n        this.realm.subscribe(event, this.id, callback, scope, handling);\n    }\n\n    /**\n     * Unsubscribes this view's handler(s) for the given event in the given scope.\n     *\n     * To unsubscribe only a specific handler, pass it as the third argument.\n     * @example\n     * this.unsubscribe(\"something\", \"changed\");\n     * this.unsubscribe(\"something\", \"changed\", this.handleMove);\n     * @param {String} scope see [subscribe]{@link View#subscribe}\n     * @param {String} event see [subscribe]{@link View#subscribe}\n     * @param {Function?} handler (optional) the handler to unsubscribe (added in 1.1)\n     * @public\n     */\n    unsubscribe(scope, event, callback=null) {\n        if (typeof callback === \"string\") callback = this[callback];\n        this.realm.unsubscribe(event, this.id, callback, scope);\n    }\n\n    /**\n     * Unsubscribes all of this view's handlers for any event in any scope.\n     * @public\n     */\n    unsubscribeAll() {\n        this.realm.unsubscribeAll(this.id);\n    }\n\n    /**\n     * Scope, event, and source of the currently executing subscription handler.\n     *\n     * @example\n     * // this.subscribe(\"*\", \"*\", this.logEvents)\n     * logEvents(data) {\n     *     const {scope, event, source} = this.activeSubscription;\n     *     console.log(`Event in view from ${source} ${scope}:${event} with`, data);\n     * }\n     * @returns {Object} `{scope, event, source}` or `undefined` if not in a subscription handler.\n     * @since 2.0\n     * @public\n     */\n    get activeSubscription() {\n        const { currentEvent, currentEventFromModel, currentEventOnlyGeneric } = viewDomain;\n        if (!currentEvent) return undefined;\n        const [scope, event] = currentEvent.split(\":\");\n        const source = currentEventFromModel ? \"model\" : \"view\";\n        const subscribed = !currentEventOnlyGeneric;\n        return { scope, event, source, subscribed };\n    }\n\n    // Misc\n\n    /**\n     * **Schedule a message for future execution**\n     *\n     * This method is here for symmetry with [Model.future]{@link Model#future}.\n     *\n     * It simply schedules the execution using\n     * [globalThis.setTimeout]{@link https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout}.\n     * The only advantage to using this over setTimeout() is consistent style.\n     *\n     * @param {Number} tOffset - time offset in milliseconds\n     * @returns {this}\n     * @public\n     */\n    future(tOffset=0) {\n        return this.realm.future(this, tOffset);\n    }\n\n    /**\n     * **Answers [Math.random()]{@link https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Math/random}**\n     *\n     * This method is here purely for symmetry with [Model.random]{@link Model#random}.\n     *\n     * @returns {Number} [Math.random()]{@link https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Math/random}\n     * @public\n     */\n    random() {\n        // use currentRealm() to force a check that the call is happening in an appropriate context (not, e.g., in Model code)\n        return currentRealm().random();\n    }\n\n    /**\n     * **The model's current time**\n     *\n     * This is the time of how far the model has been simulated.\n     * Normally this corresponds roughly to real-world time, since the reflector is generating time stamps\n     * based on real-world time.\n     *\n     * If there is [backlog]{@link View#externalNow} however (e.g while a newly joined user is catching up),\n     * this time will advance much faster than real time.\n     *\n     * The unit is milliseconds (1/1000 second) but the value can be fractional, it is a floating-point value.\n     *\n     * @return {Number} the model's time in milliseconds since the first user created the session.\n     * @see [Model.now()]{@link Model#now}\n     * @public\n     */\n    now() {\n        return this.realm.now();\n    }\n\n    /**\n     * **The latest timestamp received from reflector**\n     *\n     * Timestamps are received asynchronously from the reflector at the specified tick rate.\n     * [Model time]{@link View#now} however only advances synchronously on every iteration of the [main loop]{@link Session.join}.\n     * Usually `now == externalNow`, but if the model has not caught up yet, then `now < externalNow`.\n     *\n     * We call the difference \"backlog\". If the backlog is too large, Croquet will put an overlay on the scene,\n     * and remove it once the model simulation has caught up.\n     * The [`\"synced\"` event]{@link event:synced} is sent when that happens.\n     *\n     * The `externalNow` value is rarely used by apps but may be useful if you need to synchronize views to real-time\n     * (but note that [extrapolatedNow()]{@link View#extrapolatedNow} is usually more useful for that).\n     * @example\n     * const backlog = this.externalNow() - this.now();\n     * @returns {number} the latest timestamp in milliseconds received from the reflector\n     * @public\n     */\n    externalNow() {\n        return this.realm.externalNow();\n    }\n\n    /**\n     * **The model time extrapolated beyond latest timestamp received from reflector**\n     *\n     * Timestamps are received asynchronously from the reflector at the specified tick rate.\n     * In-between ticks or messages, neither [now()]{@link View#now} nor [externalNow()]{@link View#externalNow} advances.\n     * `extrapolatedNow` is `externalNow` plus the local time elapsed since that timestamp was received,\n     * so it always advances.\n     *\n     * `extrapolatedNow()` will always be >= `now()` and `externalNow()`.\n     * However, it is only guaranteed to be monotonous in-between time stamps received from the reflector\n     * (there is no \"smoothing\" to reconcile local time with reflector time).\n     *\n     * @returns {number} milliseconds based on local `Date.now()` but same epoch as model time\n     * @public\n     */\n    extrapolatedNow() {\n        return this.realm.extrapolatedNow();\n    }\n\n    /** Called on the root view from [main loop]{@link Session.join} once per frame. Default implementation does nothing.\n     *\n     * Override to add your own view-side input polling, rendering, etc.\n     *\n     * If you want this to be called for other views than the root view, you will have to call\n     * those methods from the root view's `update()`.\n     *\n     * The `time` received is related to the local real-world time. If you need to access the model's time,\n     * use [`this.now()`]{@link View#now}.\n     *\n     * @param {Number} time - this frame's time stamp in milliseconds, as received by\n     *     [requestAnimationFrame]{@link https://developer.mozilla.org/docs/Web/API/window/requestAnimationFrame}\n     *     (or passed into `step(time)` if [stepping manually]{@link Session.join})\n     * @public\n    */\n    update(_time) {\n    }\n\n    /**\n     * Access a model that was registered previously using  [beWellKnownAs()]{@link Model#beWellKnownAs}.\n     *\n     * Note: The instance of your root Model class is automatically made well-known as `\"modelRoot\"`\n     * and passed to the [constructor]{@link View} of your root View during {@link Session.join}.\n     * @example\n     * const topModel = this.wellKnownModel(\"modelRoot\");\n     * @param {String} name - the name given in [beWellKnownAs()]{@link Model#beWellKnownAs}\n     * @returns {Model} the model if found, or `undefined`\n     * @public\n     */\n    wellKnownModel(name) {\n        return this.realm.vm.get(name);\n    }\n\n    /**\n     * **Identifies the shared session.**\n     *\n     * The session id is used as \"global\" scope for events like the model-only\n     * [`\"view-join\"` event]{@link event:view-join} and [`\"view-exit\"` event]{@link event:view-exit}.\n     *\n     * See {@link Session.join} for how the session id is generated.\n     *\n     * If your app has several sessions at the same time, each session id will be different.\n     * @type {String}\n     * @public\n     */\n    get sessionId() {\n        return this.realm.controller.sessionSpec.id;\n    }\n\n    /**\n     * **The session object**\n     *\n     * Same as returned by {@link Session.join}.\n     *\n     * WILL BE UNDEFINED WHEN DISCONNECTED! In callbacks that can still be executed\n     * after a disconnect, you should check `if (!this.session) return` to avoid errors.\n     *\n     * @type {Object|undefined}\n     * @public\n     */\n    get session() {\n        if (!this.id || !this.realm.valid()) return undefined; // undefined after detach\n        return this.realm.controller.session;\n    }\n\n\n    /**\n     * **Identifies the View of the current user.**\n     *\n     * All users in a session share the same Model (meaning all model objects) but each user has a different View\n     * (meaning all the non-model state). The `viewId` identifies each user's view, or more specifically,\n     * their connection to the server.\n     * It is sent as argument in the model-only [`\"view-join\"` event]{@link event:view-join} and [`\"view-exit\"` event]{@link event:view-exit}.\n     *\n     * The `viewId` is also used as a scope for local events, for example the [`\"synced\"` event]{@link event:synced}.\n     *\n     * **Note:** `this.viewId` is different from [`this.id`]{@link View#id} which identifies each individual view object\n     * (if you create multiple views in your code). `this.viewId` identifies the local user, so it will be the same\n     * in each individual view object. See [`\"view-join\"` event]{@link event:view-join}.\n     * @example\n     * this.subscribe(this.viewId, \"synced\", this.handleSynced);\n     * @type {String}\n     * @public\n     */\n    get viewId() {\n        return this.realm.controller.viewId;\n    }\n\n    [Symbol.toPrimitive]() {\n        const className = this.constructor.name;\n        if (className.includes('View')) return className;\n        return `${className}[View]`;\n    }\n}\n\nexport default View;\n", "// There are three kinds of messages:\n// 1. An app to the container.\n// 2. The container to a single app\n// 3. The container to all apps\n\n// The TeaTime framework creates a singleton instance of M and install it to Croquet.Messenger\n// To use the Messenger object, the client needs to set the receiver object for invoking the handler for an incoming message:\n//  Croquet.Messenger.setReceiver(this);\n\n// where \"this\" is a view side object that handles incoming messages.\n\n// To listen on an incoming message, the receiver calls:\n//    Croquet.Messenger.on(event<string>, callback<function or method name<string>>);\n\n// To send a message:\n//    Croquet.Messenger.send(event<string>, data<serializable object>, receipent<window or null>);\n\n// An app can send a message only to the container so the recipient argument will be ignored.\n// The container can send a message to a specific Window by supplying the third argument.\n\n// When a message is received, the function or the method specified by the method name is invoked with the object provided for the Messenger constructor as \"this\".\n\n// The object follows the \"structured clone algorithm, but let us say that it should be\n// JSONable\n\n// An example on the container side looks like this (the view class or the expander, is an instance of PasteUpView in this example):\n\n//    init() {\n//      Croquet.Messenger.setReceiver(this);\n//      Croquet.Messenger.onC\"requestUserInfo\", \"sendUserInfo\");\n//    }\n//\n//    and aPasteUpView.sendUsernfo looks like:\n//    sendUserInfo(data, source) {\n//       const userInfo = this.model._get(\"userInfo\")[this.viewId];\n//       Croquet.Messenger.send(\"userInfo\", userInfo, source);\n//       // where the last argument specifies that this is a directed message\n//    }\n\n// The container needs to be careful what information it sends to an app.\n\n// On the container side, there is a method called setIframeEnumerator, where Croquet, of a future container app, specifies a way to enumerate all relevant iframes.\n\n// For a cursor movement, an app may do:\n// Croquet.Messenger.send(\"pointerPosition\", {x, y});\n\n// The container side PasteUpView would have a subscriber:\n\n//    handlePointerMove(data, source) {\n//        let iframe = this.apps[source]; // this.apps would be a WeakMap\n//        let translatedPostion = f(iframe.style.transformation... data.x, ... data.y);\n//        this.pointerMoved(transatedPosition);\n//    }\n\nclass M {\n    constructor() {\n        this.ready = false;\n        this.isInIframe =  window.top !== window;\n        this.subscriptions = {};\n        this.enumerator = null;\n    }\n\n    setReceiver(receiver) {\n        this.receiver = receiver;\n        this.ready = true;\n    }\n\n    setIframeEnumerator(func) {\n        this.enumerator = func;\n    }\n\n    on(event, method) {\n        if (!this.receiver) {throw Error(\"setReceiver() has not been called\");}\n        if (typeof method === \"string\") {\n            method = this.receiver[method];\n        }\n\n        if (!method) {throw Error(\"Messenger.on: the second argument must be a method name or a function\");}\n\n        if (!this.subscriptions[event]) {\n            this.subscriptions[event] = [];\n        } else if (this.findIndex(this.subscriptions[event], method) >= 0) {\n            throw Error(`${method} is already subscribed`);\n        }\n        this.subscriptions[event].push(method);\n\n        if (!this.listener) {\n            this.listener = msg => this.receive(msg);\n            window.addEventListener(\"message\", this.listener);\n        }\n    }\n\n    detach() {\n        if (this.listener) {\n            window.removeEventListener(\"message\", this.listener);\n            this.listener = null;\n        }\n\n        this.stopPublishingPointerMove();\n\n        this.receiver = null;\n        this.subscriptions = {};\n        this.enumerator = null;\n        this.ready = false;\n    }\n\n    removeSubscription(event, method) {\n        if (typeof method === \"string\") {\n            method = this.receiver[method];\n        }\n\n        const handlers = this.subscriptions[event];\n        if (handlers) {\n            const indexToRemove = this.findIndex(handlers, method);\n            handlers.splice(indexToRemove, 1);\n            if (handlers.length === 0) delete this.subscriptions[event];\n        }\n    }\n\n    removeAllSubscriptions() {\n        this.subscriptions = {};\n    }\n\n    receive(msg) {\n        const {event, data} = msg.data;\n        const source = msg.source;\n\n        this.handleEvent(event, data, source);\n    }\n\n    handleEvent(event, data, source) {\n        const handlers = this.subscriptions[event];\n        if (!handlers) {return;}\n        handlers.forEach(handler => {\n            handler.call(this.receiver, data, source);\n        });\n    }\n\n    send(event, data, directWindow) {\n        if (this.isInIframe) {\n            window.top.postMessage({event, data}, \"*\");\n            return;\n        }\n\n        if (directWindow) {\n            directWindow.postMessage({event, data}, \"*\");\n            return;\n        }\n\n        if (!this.enumerator) {return;}\n\n        const iframes = this.enumerator();\n        iframes.forEach(iframe => {\n            iframe.contentWindow.postMessage({event, data}, \"*\");\n            // or we still pass a strong created from iframe as target origin\n        });\n    }\n\n    findIndex(array, method) {\n        const mName = method.name;\n        return array.findIndex(entry => {\n            const eName = entry.name;\n            if (!mName && !eName) {\n                // when they are not proxied, a === comparison\n                // for the case of both being anonymous\n                return method === entry;\n            }\n            // otherwise, compare their names.\n            // it is okay as the receiver is the same,\n            // and the client should call removeSubscription if it wants to update the handler\n            return mName === eName;\n        });\n    }\n\n    startPublishingPointerMove() {\n        if (this._moveHandler) {return;}\n        this._moveHandler = evt => this.send(\"pointerPosition\", {x: evt.clientX, y: evt.clientY, type: evt.type});\n        window.document.addEventListener(\"pointermove\", this._moveHandler, true);\n    }\n\n    stopPublishingPointerMove() {\n        if (this._moveHandler) {\n            window.document.removeEventListener(\"pointermove\", this._moveHandler, true);\n            this._moveHandler = null;\n        }\n    }\n\n}\n\nexport const Messenger = new M();\n", "/* global croquet_build_process */\nimport { App } from \"./_HTML_MODULE_\"; // eslint-disable-line import/no-unresolved\nimport urlOptions from \"./_URLOPTIONS_MODULE_\"; // eslint-disable-line import/no-unresolved\nimport { Messenger } from \"./_MESSENGER_MODULE_\"; // eslint-disable-line import/no-unresolved\n\nimport { addConstantsHash } from \"./hashing\";\n\nimport Model from \"./model\";\nimport View from \"./view\";\nimport Data from \"./data\";\nimport Controller, { sessionController } from \"./controller\";\nimport VirtualMachine from \"./vm\";\n\nconst NODE = croquet_build_process.env.CROQUET_PLATFORM === 'node';\n\nexport function deprecatedStartSession(...args) {\n    App.showMessage(`${App.libName}.startSession() is deprecated, please use ${App.libName}.Session.join()`, { level: \"warning\", only: \"once\"});\n    return Session.join(...args);\n}\n\nconst DEFAULT_BALANCE_FPS = 60;\nconst MAX_BALANCE_FPS = 120;\nlet expectedSimFPS = DEFAULT_BALANCE_FPS;\n\nconst DORMANCY_DEFAULT_SECONDS = 10;\nconst DEFAULT_EVENT_RATE_LIMIT = 20;\n\n/**\n * @hideconstructor\n * @public\n */\nexport class Session {\n\n    /**\n     * **Join a Croquet session.**\n     *\n     * Joins a session by instantiating the root model (for a new session) or resuming from a snapshot, then constructs the view root instance.\n     *\n     * The `appId` identifies each Croquet app. It must be a globally unique identifier following\n     * the [Android convention](https://developer.android.com/studio/build/application-id),\n     * e.g. `\"com.example.myapp\"`. Each dot-separated segment must start\n     * with a letter, and only letters, digits, and underscores are allowed.\n     *\n     * The session `name` identifies individual sessions within an app.\n     * You can use it for example to create different sessions for different users.\n     * That is, a user in session `\"ABC\"` will not see a user in `\"DEF\"`.\n     * One simple way to create unique sessions is via `Croquet.App.autoSession()` which will\n     * use or generate a random name in the query part (`?...`) of the current url.\n     * (If you use a constant, then all users will end up in the same session.\n     * This is what we do in some of our tutorials for simplicity, but actual apps should manage sessions.)\n     *\n     * The session `password` is used for end-to-end encryption of all data leaving the client.\n     * If your app does not need to protect user data, you will still have to provide a constant dummy password.\n     * One simple way to have individual passwords is via `Croquet.App.autoPassword()` which will\n     * use or generate a random password in the hash part (`#...`) of the current url.\n     *\n     * A [session id]{@link Model#sessionId} is created from the given session `name` and `options`,\n     * and a hash of all the [registered]{@link Model.register} Model classes and {@link Constants}.\n     * This ensures that only users running the exact same source code end up in the same session,\n     * which is a prerequisite for perfectly synchronized computation.\n     *\n     * The session id is used to connect to a reflector. If there is no ongoing session,\n     * an instance of the `model` class is [created]{@link Model.create} (which in turn typically creates a number of submodels).\n     * Otherwise, the previously stored [modelRoot]{@link Model#beWellKnownAs} is deserialized from the snapshot,\n     * along with all additional models.\n     *\n     * That root model instance is passed to the [constructor]{@link View} of your root `view` class.\n     * The root view should set up the input and output operations of your application,\n     * and create any additional views as to match the application state as found in the models.\n     *\n     * Then the Croquet **main loop** is started (unless you pass in a `step: \"manual\"` parameter, e.g. for WebXR, see example below).\n     * This uses [requestAnimationFrame()](https://developer.mozilla.org/docs/Web/API/window/requestAnimationFrame)\n     * for continuous updating. Each step of the main loop executes in three phases:\n     *\n     * 1. _Simulation:_ the models execute the events received via the reflector,\n     *    and the [future messages]{@link Model#future} up to the latest time stamp received from the reflector.\n     *    The [events]{@link Model#publish} generated in this phase are put in a queue for the views to consume.\n     * 2. _Event Processing:_ the queued events are processed by calling the view's [event handlers]{@link View#subscribe}.\n     *    The views typically use these events to modify some view state, e.g. moving a DOM element or setting some\n     *    attribute of a Three.js object.\n     * 3. _Updating/Rendering:_ The view root's [update()]{@link View#update} method is called after all the queued events have been processed.\n     *    In some applications, the update method will do nothing (e.g. DOM elements are rendered after returning control to the browser).\n     *    When using other UI frameworks (e.g. Three.js), this is the place to perform the actual rendering.\n     *    Also, polling input and other tasks that should happen in every frame should be placed here.\n     *\n     * @async\n     * @param {Object} parameters\n     * @param {String} parameters.apiKey - API key (from multisynq.io/coder)\n     * @param {String} parameters.appId - unique application identifier as [dot-separated words](https://developer.android.com/studio/build/application-id) (e.g. `\"com.example.myapp\"`)\n     * @param {String?} parameters.name - a name for this session (e.g. `\"123abc\"`)\n     * @param {String?} parameters.password - a password for this session (used for end-to-end encryption of messages and snapshots)\n     * @param {Model}   parameters.model - the root Model class for your app\n     * @param {View?}   parameters.view - the root View class for your app\n     * @param {Object?} parameters.options - options passed into the root model's [init()]{@link Model#init} function (no default)\n     * @param {Object?} parameters.viewOptions - options passed into the root views's [constructor()]{@link View#constructor} (no default)\n     * @param {Object?} parameters.viewData - data passed as additional payload to the [`\"view-join\"` event]{@link event:view-join} and [`\"view-exit\"` event]{@link event:view-exit} (no default)\n     * @param {String?} parameters.step - `\"auto\"` (default) for automatic stepping via [requestAnimationFrame()](https://developer.mozilla.org/docs/Web/API/window/requestAnimationFrame), or `\"manual\"` to leave it as the application's responsibility to call the session's `step()` function regularly (see WebXR example below)\n     * @param {Number?} parameters.tps - ticks per second generated by reflector when no messages are sent by any user (a value of `1/30` or below will result in one tick every 30s; max `60` per second; default `20`)\n     * @param {(Number|Boolean)?} parameters.autoSleep - number of seconds of app being hidden (e.g., in a tab that is behind others) before it should go dormant - disconnecting from the reflector, and staying that way until it is made visible again (`0` or `false` mean the app will never voluntarily go dormant; `true` means default value of `10`s; otherwise any non-negative number)\n     * @param {Number?} parameters.rejoinLimit - time in milliseconds until view is destroyed after a disconnection, to allow for short network glitches to be smoothly passed over (default `1000`)\n     * @param {Number?} parameters.eventRateLimit - maximum number of events (single or bundled) sent to reflector per second (`1` to `60`; default `20`)\n     * @param {String?} parameters.reflector - URL of the reflector to use (default is the public reflector)\n     * @param {String?} parameters.files - URL of the file server to use (default is the public file server)\n     * @param {String?} parameters.box - croquet-in-a-box server to use (reflector + file server)\n     * @param {String|String[]} parameters.debug - array, or comma-separated string, containing one or more of the following values to enable console logging of the corresponding details\n     * (note that you can also enable these temporarily for a deployed app via the `debug` URL parameter, e.g. `?debug=session,snapshot`):\n     * | value         | description\n     * |----------------|------------\n     * | `\"session\"`    | session ID and connections/disconnections\n     * | `\"messages\"`   | received from reflector, after decryption (cf. encrypted messages visible in a WebSocket debugger)\n     * | `\"sends\"`      | sent to reflector, before encryption (cf. encrypted messages visible in a WebSocket debugger)\n     * | `\"snapshot\"`   | snapshot stats\n     * | `\"data\"`       | data API stats\n     * | `\"hashing\"`    | code hashing to derive session ID/persistentId\n     * | `\"subscribe\"`  | subscription additions/removals\n     * | `\"publish\"`    | events published\n     * | `\"classes\"`    | class registrations\n     * | `\"ticks\"`      | each tick received\n     * | `\"write\"`      | detect accidental writes from view code to model properties\n     * | `\"offline\"`    | disable multiuser\n     *\n     * @returns {Promise} Promise that resolves to an object describing the session:\n     * ```\n     * {\n     *     id,           // session id\n     *     view,         // view instance\n     *     step(time),   // function for \"manual\" stepping\n     *     leave(),      // function for leaving the session\n     * }\n     * ```\n     *\n     *   where\n     *  - `view` is an instance of the supplied view class, or of Croquet.View if no view class was given\n     *  - `step(time)` should be invoked regularly if you selected `manual` stepping, to nudge it to process the latest events from the reflector or generated internally.\n     *     The `time` argument is expected to be in milliseconds, monotonically increasing - for example, the time received by a function passed to `window.requestAnimationFrame`.\n     *  - `leave()` is an async function for requesting immediate, permanent disconnection from the session.\n     * @example <caption>auto name, password, and main loop</caption>\n     * Croquet.Session.join({\n     *     apiKey: \"your_api_key\",                 // paste from multisynq.io/coder\n     *     appId: \"com.example.myapp\",             // namespace for session names\n     *     name: Croquet.App.autoSession(),        // session via URL arg\n     *     password: Croquet.App.autoPassword(),   // password via URL arg\n     *     model: MyRootModel,\n     *     view: MyRootView,\n     *     debug: [\"session\"],\n     * });\n     * @example <caption>manual name, password, and WebXR main loop</caption>\n     * Croquet.Session.join({ apiKey: \"your_api_key\", appId: \"com.example.myapp\", name: \"abc\", password: \"password\", model: MyRootModel, view: MyRootView, step: \"manual\"}).then(session => {\n     *     function xrAnimFrame(time, xrFrame) {\n     *         session.step(time);\n     *         ...\n     *         xrSession.requestAnimationFrame(xrAnimFrame);\n     *     }\n     *     xrSession.requestAnimationFrame(xrAnimFrame);\n     * });\n     * @public\n     */\n    static async join(parameters) {\n        try {\n            return await this.join_impl(parameters);\n        } catch (err) {\n            App.showMessage(err.message || err, { level: \"fatal\" });\n            throw err;\n        }\n    }\n\n    static async join_impl(parameters) {\n        // defaults\n        if (!parameters.appId) parameters.appId = 'no.appId'; // must match warning in VM.persist()\n        if (!parameters.name) { // auto password only if no name given\n            parameters.name = App.autoSession();\n            if (!parameters.password) parameters.password = App.autoPassword();\n        }\n        if (!parameters.model) parameters.model = Model.lastRegistered;\n        if (!parameters.view) parameters.view = View;\n        // resolve promises, if any\n        const promises = [];\n        for (const [k,v] of Object.entries(parameters)) {\n            if (v instanceof Promise) {\n                promises.push(v.then(val => parameters[k] = val));\n            }\n        }\n        // await even if no promises so code after Session.join() can proceed now\n        // (in particular, PBKDF2 is synchronous, and expensive in our case because of crypto.js)\n        await Promise.all(promises);\n        function inherits(A, B) { return A === B || A.prototype instanceof B; }\n        // check apiKey if no box is given\n        if (parameters.box) {\n            if (typeof parameters.box !== \"string\") throw Error(`${App.libName}: box must be a string in Session.join()!`);\n            if (!parameters.box.includes('/')) throw Error(`${App.libName}: box must be a (partial) URL in Session.join()!`);\n        } else if (!parameters.reflector || !parameters.files) {\n            if (typeof parameters.apiKey !== \"string\") throw Error(`${App.libName}: no apiKey provided in Session.join()!`);\n            if (parameters.apiKey.length > 128) throw Error(`${App.libName}: apiKey > 128 characters in Session.join()!`);\n        }\n        // sanitize name\n        if (typeof parameters.name !== \"string\") throw Error(`${App.libName}: no session name provided in Session.join()!`);\n        if (parameters.name.length > 128) throw Error(`${App.libName}: session name > 128 characters in Session.join()!`);\n        // must pass a model\n        const ModelRoot = parameters.model;\n        if (typeof ModelRoot !== \"function\" || !inherits(ModelRoot, Model)) throw Error(`${App.libName}: bad model class in Session.join()`);\n        // view defaults to View\n        const ViewRoot = parameters.view || View;\n        if (typeof ViewRoot !== \"function\" || !inherits(ViewRoot, View)) throw Error(`${App.libName}: bad view class in Session.join()`);\n        // check appId\n        if (typeof parameters.appId !== \"string\") throw Error(`${App.libName}: no appId provided in Session.join()`);\n        if (!parameters.appId.length > 128) throw Error(`${App.libName}: appId > 128 characters in Session.join()`);\n        if (!parameters.appId.match(/^[a-z](-?[a-z0-9_])*(\\.[a-z0-9_](-?[a-z0-9_])*)+$/i)) throw Error(`${App.libName}: malformed appId in Session.join()`);\n        // check password\n        if (typeof parameters.password !== \"string\" || !parameters.password) throw Error(`${App.libName}: no password provided in Session.join()`);\n        // ensure that certain parameters that can be specified as parameters or url\n        // options are in the urlOptions object that gets checked in controller.js\n        for (const key of ['reflector', 'synchronizer', 'files', 'backend', 'box']) {\n            const value = urlOptions[key] || parameters[key]; // url option takes precedence\n            if (value !== undefined) urlOptions[key] = value;\n        }\n        // verify manual stepping for Node\n        if (NODE && parameters.step !== \"manual\") {\n            throw Error(\"stepping must be manual in a Node.js app\");\n        }\n        // verify and default rejoinLimit\n        if (\"rejoinLimit\" in parameters) {\n            if (typeof parameters.rejoinLimit !== \"number\" || parameters.rejoinLimit < 0 || parameters.rejoinLimit > 60000) {\n                throw Error(\"rejoinLimit range: 0-60000\");\n            }\n        } else parameters.rejoinLimit = 1000;\n        // verify and default eventRateLimit\n        if (\"eventRateLimit\" in parameters) {\n            if (typeof parameters.eventRateLimit !== \"number\" || parameters.eventRateLimit < 1 || parameters.eventRateLimit > 60) {\n                throw Error(\"eventRateLimit range: 1-60\");\n            }\n        } else parameters.eventRateLimit = DEFAULT_EVENT_RATE_LIMIT;\n        // verify heraldUrl\n        if (parameters.heraldUrl) {\n            if (parameters.heraldUrl.length > 256) throw Error('heraldUrl can only be 256 characters');\n            if (!parameters.heraldUrl.startsWith(\"https://\")) throw Error('heraldUrl needs to be https');\n        }\n        // verify hashOverride\n        if (parameters.hashOverride) {\n            if (parameters.hashOverride.length !== 43) throw Error('hashOverride must be 43 characters');\n            if (parameters.hashOverride.search(/[^-_a-zA-Z0-9]/) !== -1) throw Error('hashOverride must be base64url encoded');\n        }\n        // also add debug parameters\n        if (parameters.debug) {\n            function asArray(a) {\n                if (typeof a === \"string\") a = a.split(',');\n                return a ? (Array.isArray(a) ? a : [a]) : [];\n            }\n            urlOptions.debug = [...asArray(parameters.debug), ...asArray(urlOptions.debug)].join(',');\n        }\n        // verify and default autoSleep\n        if (\"autoSleep\" in parameters) {\n            const sleep = parameters.autoSleep;\n            const sleepType = typeof sleep;\n            if (sleepType === \"number\") {\n                if (sleep < 0) throw Error(\"an autoSleep value must be >= 0\");\n            } else if (sleepType === \"boolean\") {\n                parameters.autoSleep = sleep ? DORMANCY_DEFAULT_SECONDS : 0;\n            } else throw Error(\"autoSleep must be numeric or boolean\");\n        } else parameters.autoSleep = DORMANCY_DEFAULT_SECONDS;\n        // turn flags from a single string, a separated string or an array into an object\n        if (parameters.flags) {\n            let props = parameters.flags;\n            if (typeof props === \"string\") props = props.split(',');\n            props = props ? (Array.isArray(props) ? props : [props]) : []; // copied from debug above\n            props = props.filter(prop => typeof prop !== \"object\");\n            if (props.length) {\n                parameters.flags = {};\n                props.forEach(prop => parameters.flags[prop] = true);\n            } else parameters.flags = null;\n        }\n        // now start\n        if (\"expectedSimFPS\" in parameters) expectedSimFPS = Math.min(parameters.expectedSimFPS, MAX_BALANCE_FPS);\n        // parameters to be included in the session spec, if specified by app (or defaulted)\n        const SESSION_PARAMS = ['name', 'password', 'apiKey', 'appId', 'tps', 'autoSleep', 'heraldUrl', 'rejoinLimit', 'eventRateLimit', 'optionsFromUrl', 'persistentIdOptions', 'viewOptions', 'viewData', 'viewIdDebugSuffix', 'hashOverride', 'location', 'flags', 'progressReporter'];\n        freezeAndHashConstants();\n        const controller = new Controller();\n        // make sure options are JSONable\n        const options = JSON.parse(JSON.stringify({...parameters.options}));\n        // make sure persistentIdOptions are keys in options\n        if (parameters.persistentIdOptions) {\n            if (!Array.isArray(parameters.persistentIdOptions)) throw Error(\"persistentIdOptions must be an array\");\n            for (const key of parameters.persistentIdOptions) {\n                if (!(key in options)) throw Error(`persistentIdOptions key \"${key}\" not found in options`);\n            }\n        }\n        /** our return value */\n        const session = {\n            id: '',\n            persistentId: '',\n            versionId: '',\n            name: parameters.name,\n            model: null,\n            view: null,\n            // called from our own onAnimationFrame, or application if stepping manually\n            step(frameTime) {\n                controller.stepSession(\"animation\", { frameTime, view: session.view, expectedSimFPS });\n            },\n            leave() {\n                return Session.leave(session.id);\n            },\n            data: {\n                store: (data, dataOpts) => Data.store(data, {...dataOpts, sessionId: session.id}),\n                fetch: (handle, dataOpts) => Data.fetch(handle, {...dataOpts, sessionId: session.id}),\n                hash: data => Data.hash(data),\n                toId: handle => Data.toId(handle),\n                fromId: id => Data.fromId(id),\n            },\n            get latency() { return controller.latency; },\n            get latencies() { return controller.latencies; },\n        };\n\n        if ( typeof __CROQUET_DEVTOOLS__ !== 'undefined' ) {\n            __CROQUET_DEVTOOLS__.dispatchEvent(new CustomEvent('session', {\n                detail: {\n                    session,\n                    controller,\n                }\n            }));\n        }\n\n        const sessionSpec = {\n            options,\n            /** executed inside the vm to initialize session */\n            initFn: (opts, persistentData) => ModelRoot.create(opts, persistentData),\n            /** called by controller when leaving the session */\n            rebootModelView\n        };\n        for (const [param, value] of Object.entries(parameters)) {\n            if (SESSION_PARAMS.includes(param)) sessionSpec[param] = value;\n        }\n        await controller.initFromSessionSpec(sessionSpec);\n\n        let rebooting = false;\n        await rebootModelView();\n\n        if (parameters.step !== \"manual\") controller.startStepping(session.step);\n\n        return session;\n\n        async function rebootModelView() {\n            // invoked from static Session.join() above and from controller.leave()\n\n            clear(); // remove session.model, detach the view\n\n            // controller.leaving is set by the static Session.leave(), which\n            // handles an explicit user request to leave the session, or in\n            // controller.closeConnectionWithError in the case of an unrecoverable\n            // error (code 4100 or above, other than 4110).  when it's set,\n            // the only way back in is to invoke Session.join() again - or reload\n            // the app.\n            if (controller.leaving) { controller.leaving(true); return; }\n\n            // repeated connections and disconnections along the way to a (re)join\n            // can cause this function to be called multiple times.  if there is an\n            // instance already in progress, let it finish its work.\n            if (rebooting) return;\n\n            rebooting = true;\n            await controller.establishSession(sessionSpec);\n            rebooting = false;\n\n            session.model = controller.vm.get(\"modelRoot\");\n            session.id = controller.id;\n            session.persistentId = controller.persistentId;\n            session.versionId = controller.versionId;\n            controller.session = session;\n\n            App.makeSessionWidgets(session.id);\n            controller.inViewRealm(() => {\n                if (urlOptions.has(\"debug\", \"session\", false)) console.log(session.id, 'creating root view');\n                /* session.view = */ new ViewRoot(session.model, sessionSpec.viewOptions);\n                // constructor stores the view into session.view\n            });\n        }\n\n        function clear() {\n            session.model = null;\n            if (session.view) {\n                if (urlOptions.has(\"debug\", \"session\", false)) console.log(session.id, 'detaching root view');\n                session.view.detach();\n                if (session.view.id !== \"\") console.warn(`${App.libName}: ${session.view} did not call super.detach()`);\n                session.view = null;\n            }\n            App.clearSessionMoniker();\n            if (Messenger.ready) {Messenger.detach();}\n        }\n    }\n\n    static async leave(sessionId) {\n        const controller = sessionController(sessionId);\n        if (!controller) return false;\n        // make sure there is no lurking timeout that would cause the controller\n        // to reconnect.\n        if (controller.reconnectTimeout) {\n            clearTimeout(controller.reconnectTimeout);\n            delete controller.reconnectTimeout;\n        }\n        const leavePromise = new Promise(resolve => controller.leaving = resolve);\n        const connection = controller.connection;\n        if (!connection.connected) return false;\n        connection.closeConnection(1000); // calls socketClosed, and hence eventually rebootModelView to shut down the view\n        return leavePromise;\n    }\n\n    static thisSession() {\n        const vm = VirtualMachine.current();\n        return vm ? vm.id : \"\";\n    }\n\n    // below are \"instance properties\" and \"methods\" JUST FOR DOCUMENTATION PURPOSES\n    // we are not actually creating a Session instance, but a Session object\n    // (maybe we should?)\n\n    /** Session ID, generated by [Session.join]{@link Session.join}.\n     *\n     * This is a unique identifier for the session, combining the session's\n     * [persistentId]{@link Session.persistentId} and [versionId]{@link Session.versionId}.\n     * It ensures that all users in a session execute the exact same Model code.\n     *\n     * @type {String}\n     * @public\n     * @readonly\n     */\n    get id() { return \"\"; }\n\n    /** Persistent ID, generated by [Session.join]{@link Session.join}.\n     *\n     * This is a unique identifier for the session, which remains the same\n     * even if a new code version is deployed.\n     *\n     * @type {String}\n     * @public\n     * @readonly\n     */\n    get persistentId() { return \"\"; }\n\n    /** Version ID, generated by [Session.join]{@link Session.join}.\n     *\n     * This is a unique identifier for the app version independent of the session name.\n     * It is a hash of the source code of registered Model classes and Constants.\n     * Everything the Model depends on must be registered, or Constants, to ensure\n     * that all users in a session have the exact same code. Otherwise, they might\n     * diverge in their computations.\n     *\n    */\n    get versionId() { return \"\"; }\n\n    /** The session name, as given to [Session.join]{@link Session.join}.\n     *\n     * @type {String}\n     * @public\n     * @readonly\n     */\n    get name() { return \"\"; }\n\n    /** interface to the bulk [Data API]{@link Data} for this session.\n     * @type {Data}\n     * @public\n     * @readonly\n     */\n    get data() { return {}; }\n\n    /** Invoke this function regularly if you selected `\"manual\"` stepping in [Session.join]{@link Session.join}.\n     *\n     * @param {Number} time - the time in milliseconds, monotonically increasing\n     * @public\n     */\n    step(_time) {}\n\n    /** Leave the session.\n     *\n     * The only way back in is to invoke [Session.join()]{@link Session.join} again - or reload\n     * the app.\n     * @async\n     * @public\n     * @returns {Promise} Promise that resolves when the session was left\n     */\n    leave() {}\n}\n\n/**\n * **User-defined Constants**\n *\n * To ensure that all users in a session execute the exact same Model code, the [session id]{@link joinSession}\n * is derived by [hashing]{@link Model.register} the source code of Model classes and value of constants.\n * To hash your own constants, put them into `Croquet.Constants` object.\n *\n * The constants can be used in both Model and View.\n *\n * **Note:** the Constants object is recursively\n * [frozen]{@link https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/freeze}\n * once a session was started, to avoid accidental modification.\n * @example\n * const Q = Croquet.Constants;\n * Q.ANSWER = 42;\n * Q.POWERLEVEL = 9000;\n *\n * class MyModel extends Croquet.Model {\n *     init() {\n *          this.answer = Q.ANSWER;\n *          this.level = Q.POWERLEVEL;\n *     }\n * }\n * @public\n */\nexport const Constants = {};\n\nfunction deepFreeze(object) {\n    if (Object.isFrozen(object)) return;\n    Object.freeze(object);\n    for (const value of Object.values(object)) {\n        if (value && (typeof value === \"object\" || typeof value === \"function\")) {\n            deepFreeze(value);\n        }\n    }\n}\n\nfunction freezeAndHashConstants() {\n    if (Object.isFrozen(Constants)) return;\n    deepFreeze(Constants);\n    addConstantsHash(Constants);\n}\n", "import {\n    Model, View, Session, Data, Constants, App, Messenger, VERSION\n} from \"./teatime\";\n\nexport {\n    Model, View, Session, Data, Constants, App, Messenger, VERSION\n};\n\nconst Croquet = {\n    Model, View, Session, Data, Constants, App, Messenger, VERSION\n};\n\nModel.Croquet = Croquet;\nView.Croquet = Croquet;\n\nif (typeof __CROQUET_DEVTOOLS__ !== 'undefined') {\n    __CROQUET_DEVTOOLS__.dispatchEvent(new CustomEvent('load', {\n        detail: {\n            version: VERSION,\n        }\n    }));\n}\n\nif (typeof globalThis !== 'undefined') {\n    if (globalThis.__CROQUET__) {\n        console.warn( 'WARNING: Multiple instances of Croquet being imported.' );\n    } else {\n        globalThis.__CROQUET__ = VERSION;\n    }\n}\n", "// Multisynq uses Croquet to run the client-side code\n\nimport {\n    Model,\n    View,\n    Session,\n    Data,\n    Constants,\n    App,\n} from \"@croquet/croquet\";\n\nconst VERSION = process.env.MULTISYNQ_VERSION || \"0.0.0\";\nconsole.log(`Multisynq ${VERSION}`);\n\nexport {\n    Model,\n    View,\n    Session,\n    Data,\n    Constants,\n    App,\n    VERSION,\n}\n\nconst Multisynq = {\n    Model,\n    View,\n    Session,\n    Data,\n    Constants,\n    App,\n    VERSION,\n};\n\n// mimic how Croquet does it\n(Model as any).Multisynq = Multisynq;\n(View as any).Multisynq = Multisynq;\n\n\nif (typeof globalThis !== 'undefined') {\n    if (globalThis.__MULTISYNQ__) {\n        console.warn( 'WARNING: Multiple instances of Multisynq being imported.' );\n    } else {\n        globalThis.__MULTISYNQ__ = VERSION;\n    }\n}\n"],
  "mappings": "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AAI,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAA,GAAI,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAI,GAAA,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAI,GAAA,CAAC,GAAE,KAAI,IAAG,GAAE,KAAI,EAAA,GAAI,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAA,GAAI,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAI,GAAA,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAA,GAAI,CAAC,GAAE,KAAI,GAAK,GAAA,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAI,GAAA,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAA,GAAI,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAA,GAAI,CAAC,GAAE,KAAI,KAAI,GAAE,KAAI,GAAK,GAAA,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAA,GAAI,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAA,GAAI,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAI,GAAA,CAAC,GAAE,KAAI,IAAG,GAAE,KAAI,EAAI,GAAA,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAA,GAAI,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAA,GAAI,CAAC,IAAG,IAAG,EAAA,GAAI,CAAC,GAAE,KAAI,IAAG,GAAE,KAAI,EAAA,GAAI,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAI,GAAA,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAI,GAAA,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAA,GAAI,CAAC,GAAE,KAAI,KAAI,GAAE,KAAI,GAAA,GAAK,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAA,GAAI,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAA,GAAI,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAI,GAAA,CAAC,GAAE,KAAI,KAAI,GAAE,KAAI,GAAA,GAAK,CAAC,GAAE,IAAG,IAAG,GAAE,IAAG,EAAI,GAAA,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAA,GAAI,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAA,GAAI,CAAC,GAAE,KAAI,KAAI,GAAE,KAAI,GAAK,GAAA,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAI,GAAA,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAA,GAAI,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAA,GAAI,CAAC,GAAE,KAAI,KAAI,GAAE,KAAI,GAAA,GAAK,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAA,GAAI,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAI,GAAA,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAI,GAAA,CAAC,GAAE,KAAI,KAAI,GAAE,KAAI,GAAA,GAAK,CAAC,IAAG,IAAG,EAAA,GAAI,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAA,GAAI,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAI,GAAA,CAAC,GAAE,KAAI,KAAI,GAAE,KAAI,GAAA,GAAK,CAAC,IAAG,IAAG,EAAA,GAAI,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAA,GAAI,CAAC,IAAG,IAAG,EAAA,GAAI,CAAC,GAAE,KAAI,KAAI,GAAE,KAAI,GAAK,GAAA,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAI,GAAA,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAA,GAAI,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAA,GAAI,CAAC,GAAE,KAAI,KAAI,GAAE,KAAI,GAAA,GAAK,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAA,GAAI,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAI,GAAA,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAI,GAAA,CAAC,GAAE,KAAI,KAAI,GAAE,KAAI,GAAA,GAAK,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAA,GAAI,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAA,GAAI,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAI,GAAA,CAAC,IAAG,KAAI,KAAI,GAAE,KAAI,GAAK,GAAA,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAA,GAAI,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAA,GAAI,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAA,GAAI,CAAC,GAAE,KAAI,KAAI,GAAE,KAAI,GAAA,GAAK,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAI,GAAA,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAI,GAAA,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAA,GAAI,CAAC,GAAE,KAAI,KAAI,IAAG,KAAI,GAAA,GAAK,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAI,GAAA,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAA,GAAI,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAA,GAAI,CAAC,GAAE,KAAI,KAAI,GAAE,KAAI,GAAK,GAAA,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAI,GAAA,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAA,GAAI,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAA,GAAI,CAAC,GAAE,KAAI,KAAI,IAAG,KAAI,GAAA,GAAK,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAA,GAAI,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAI,GAAA,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAI,GAAA,CAAC,IAAG,KAAI,KAAI,GAAE,KAAI,GAAA,GAAK,CAAC,GAAE,IAAG,IAAG,IAAG,IAAG,EAAA,GAAI,CAAC,IAAG,IAAG,IAAG,GAAE,IAAG,EAAI,GAAA,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAA,GAAI,CAAC,IAAG,KAAI,GAAK,GAAA,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAI,GAAA,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAA,GAAI,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAA,GAAI,CAAC,IAAG,KAAI,KAAI,GAAE,KAAI,GAAA,GAAK,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAI,GAAA,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAI,GAAA,CAAC,IAAG,IAAG,IAAG,IAAG,IAAG,EAAA,GAAI,CAAC,IAAG,KAAI,KAAI,GAAE,KAAI,GAAA,GAAK,CAAC,I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",
  "names": ["global", "self", "i", "a", "i", "a", "i", "l", "runtime", "exports", "undefined", "Op", "Object", "prototype", "hasOwn", "hasOwnProperty", "defineProperty", "obj", "key", "desc", "value", "$Symbol", "Symbol", "iteratorSymbol", "iterator", "asyncIteratorSymbol", "asyncIterator", "toStringTagSymbol", "toStringTag", "define", "enumerable", "configurable", "writable", "err", "wrap", "innerFn", "outerFn", "self", "tryLocsList", "protoGenerator", "Generator", "generator", "create", "context", "Context", "makeInvokeMethod", "tryCatch", "fn", "arg", "type", "call", "GenStateSuspendedStart", "GenStateSuspendedYield", "GenStateExecuting", "GenStateCompleted", "ContinueSentinel", "GeneratorFunction", "GeneratorFunctionPrototype", "IteratorPrototype", "this", "getProto", "getPrototypeOf", "NativeIteratorPrototype", "values", "Gp", "defineIteratorMethods", "forEach", "method", "_invoke", "AsyncIterator", "PromiseImpl", "invoke", "resolve", "reject", "record", "result", "__await", "then", "unwrapped", "error", "previousPromise", "callInvokeWithMethodAndArg", "state", "Error", "done", "delegate", "delegateResult", "maybeInvokeDelegate", "sent", "_sent", "dispatchException", "abrupt", "methodName", "TypeError", "info", "resultName", "next", "nextLoc", "pushTryEntry", "locs", "entry", "tryLoc", "catchLoc", "finallyLoc", "afterLoc", "tryEntries", "push", "resetTryEntry", "completion", "reset", "iterable", "iteratorMethod", "isNaN", "length", "i", "displayName", "isGeneratorFunction", "genFun", "ctor", "constructor", "name", "mark", "setPrototypeOf", "__proto__", "awrap", "async", "Promise", "iter", "keys", "val", "object", "reverse", "pop", "skipTempReset", "prev", "charAt", "slice", "stop", "rootRecord", "rval", "exception", "handle", "loc", "caught", "hasCatch", "hasFinally", "finallyEntry", "complete", "finish", "catch", "thrown", "delegateYield", "module", "regeneratorRuntime", "accidentalStrictMode", "globalThis", "Function", "a", "l", "sessionFromPath", "window", "location", "hostname", "endsWith", "sessionApp", "sessionArgs", "parseUrlOptionString", "target", "optionString", "split", "keyAndVal", "decodeURIComponent", "join", "match", "JSON", "parse", "e", "urlOptions", "getSession", "search", "hash", "pathname", "indexOf", "ar", "has", "item", "defaultValue", "arguments", "isHost", "urlString", "urlItems", "includes", "PATH_REGEX", "pathMatch", "HASH_REGEX", "hashMatch", "session", "setSession", "replace", "url", "history", "replaceState", "pushState", "actualHostname", "protocol", "isLocalhost", "QRCode", "width", "startdenom", "Math", "pow", "significance", "overflow", "mask", "seedrandom", "seed", "options", "entropy", "smear", "stringseed", "j", "charCodeAt", "String", "fromCharCode", "apply", "flatten", "arc4", "ARC4", "prng", "n", "g", "d", "x", "int32", "quick", "double", "pass", "S", "copy", "t", "keylen", "me", "s", "count", "r", "f", "depth", "prop", "typ", "QR8bitByte", "data", "mode", "QRMode", "MODE_8BIT_BYTE", "parsedData", "byteArray", "code", "Array", "concat", "unshift", "QRCodeModel", "typeNumber", "errorCorrectLevel", "modules", "moduleCount", "dataCache", "dataList", "getLength", "buffer", "write", "put", "addData", "newData", "isDark", "row", "col", "getModuleCount", "make", "makeImpl", "getBestMaskPattern", "test", "maskPattern", "setupPositionProbePattern", "setupPositionAdjustPattern", "setupTimingPattern", "setupTypeInfo", "setupTypeNumber", "createData", "mapData", "c", "minLostPoint", "pattern", "lostPoint", "QRUtil", "getLostPoint", "createMovieClip", "target_mc", "instance_name", "qr_mc", "createEmptyMovieClip", "y", "beginFill", "moveTo", "lineTo", "endFill", "pos", "getPatternPosition", "bits", "getBCHTypeNumber", "mod", "floor", "getBCHTypeInfo", "inc", "bitIndex", "byteIndex", "dark", "getMask", "PAD0", "PAD1", "rsBlocks", "QRRSBlock", "getRSBlocks", "QRBitBuffer", "getLengthInBits", "totalDataCount", "dataCount", "putBit", "createBytes", "offset", "maxDcCount", "maxEcCount", "dcdata", "ecdata", "dcCount", "ecCount", "totalCount", "max", "rsPoly", "getErrorCorrectPolynomial", "modPoly", "QRPolynomial", "modIndex", "get", "totalCodeCount", "index", "MODE_NUMBER", "MODE_ALPHA_NUM", "MODE_KANJI", "QRErrorCorrectLevel", "L", "M", "Q", "H", "QRMaskPattern", "PATTERN_POSITION_TABLE", "G15", "G18", "G15_MASK", "getBCHDigit", "digit", "errorCorrectLength", "multiply", "QRMath", "gexp", "qrCode", "sameCount", "darkCount", "abs", "glog", "LOG_TABLE", "EXP_TABLE", "num", "shift", "ratio", "RS_BLOCK_TABLE", "rsBlock", "getRsBlockTable", "list", "bufIndex", "bit", "QRCodeLimitLength", "Drawing", "el", "htOption", "_bIsPainted", "_htOption", "_elCanvas", "document", "createElement", "height", "appendChild", "_el", "_oContext", "getContext", "_bSupportDataURI", "draw", "oQRCode", "nCount", "nWidth", "nHeight", "nRoundedWidth", "round", "nRoundedHeight", "clear", "bIsDark", "nLeft", "nTop", "strokeStyle", "colorDark", "colorLight", "lineWidth", "fillStyle", "fillRect", "strokeRect", "ceil", "isPainted", "clearRect", "nNumber", "_getTypeNumber", "sText", "nCorrectLevel", "nType", "replacedText", "encodeURI", "toString", "len", "nLimit", "vOption", "correctLevel", "text", "getElementById", "useSVG", "svgDrawer", "_oQRCode", "_oDrawing", "makeCode", "getCanvas", "children", "child", "tagName", "CorrectLevel", "QRCode$1", "CryptoJS", "crypto", "msCrypto", "global", "require$$0", "cryptoSecureRandomInt", "getRandomValues", "Uint32Array", "randomBytes", "readInt32LE", "F", "subtype", "C", "C_lib", "lib", "Base", "extend", "overrides", "mixIn", "init", "$super", "instance", "properties", "propertyName", "clone", "WordArray", "words", "sigBytes", "encoder", "Hex", "stringify", "wordArray", "thisWords", "thatWords", "thisSigBytes", "thatSigBytes", "clamp", "thatByte", "random", "nBytes", "C_enc", "enc", "hexChars", "bite", "hexStr", "hexStrLength", "parseInt", "substr", "Latin1", "latin1Chars", "latin1Str", "latin1StrLength", "Utf8", "escape", "utf8Str", "unescape", "encodeURIComponent", "BufferedBlockAlgorithm", "_data", "_nDataBytes", "_append", "_process", "doFlush", "processedWords", "dataWords", "dataSigBytes", "blockSize", "nBlocksReady", "nWordsReady", "_minBufferSize", "nBytesReady", "min", "_doProcessBlock", "splice", "Hasher", "cfg", "_doReset", "update", "messageUpdate", "finalize", "_doFinalize", "_createHelper", "hasher", "message", "_createHmacHelper", "C_algo", "HMAC", "algo", "ArrayBuffer", "superInit", "subInit", "typedArray", "Uint8Array", "Int8Array", "Uint8ClampedArray", "Int16Array", "Uint16Array", "Int32Array", "Float32Array", "Float64Array", "byteOffset", "byteLength", "typedArrayByteLength", "K", "isPrime", "sqrtN", "sqrt", "factor", "getFractionalBits", "nPrime", "W", "SHA256", "_hash", "b", "h", "gamma0x", "gamma0", "gamma1x", "gamma1", "maj", "sigma0", "t1", "nBitsTotal", "nBitsLeft", "HmacSHA256", "NODE", "croquet_build_process", "CROQUET_PLATFORM", "digest", "cryptoJsWordArrayToUint8Array", "w", "funcSrc", "func", "cleanup", "str", "openingBrace", "closingBrace", "lastIndexOf", "head", "body", "trim", "src", "startsWith", "p", "getOwnPropertyNames", "map", "toBase64url", "btoa", "debugHashing", "subtle", "bind", "algorithm", "arrayBuffer", "App", "libName", "inputWordArray", "sha256", "debugHashes", "TextEncoder", "hashString", "string", "encode", "hashPromises", "codeHashCache", "logged", "Set", "StartDate", "Date", "now", "performance", "order", "colors", "total", "render", "simulate", "snapshot", "backlog", "network", "horizCanvas", "hCtx", "statsDiv", "canvas", "ctx", "drawX", "fps", "fCtx", "makeStats", "div", "firstChild", "removeChild", "style", "background", "id", "innerWidth", "font", "title", "entries", "_ref", "k", "innerDiv", "frames", "maxBacklog", "connected", "currentFrame", "newFrame", "oneFrame", "v", "makeHorizCanvas", "baseCanvas", "position", "left", "querySelector", "m", "stroke", "start", "items", "users", "latency", "activity", "endCurrentFrame", "timestamp", "limit", "offsetHeight", "realFrames", "filter", "avgMS", "reduce", "maxMS", "globalCompositeOperation", "line", "toLocaleString", "fillText", "toFixed", "drawImage", "mapBacklog", "frame", "beginPath", "ms", "stack", "networkTraffic", "currentSecond", "Stats", "animationFrame", "stats", "begin", "outer", "end", "expected", "starvation", "bool", "wasConnected", "remove", "addNetworkTraffic", "bytes", "storeForAudit", "resetAuditStats", "perSecondTally", "logMessageStats", "stepSession", "_timestamp", "report", "second", "requestedMessages", "sentMessagesTotal", "sampleSeconds", "sentBundles", "averageDelay", "sendDelay", "averageBundlePayload", "sentBundlePayload", "CROQUETSTATS", "TOUCH", "documentElement", "IFRAMED", "parent", "BUTTON_WIDTH", "BUTTON_OFFSET", "addedWidgetStyle", "addedSpinnerStyle", "localStorage", "addedToastifyStyle", "displayWarning", "msg", "showMessage", "level", "displayStatus", "displayAppError", "where", "console", "userStack", "duration", "stopOnFocus", "warn", "dockState", "pinned", "activePage", "smotherEvent", "evt", "preventDefault", "stopPropagation", "makeButton", "textAlign", "textBaseline", "button", "className", "trigger", "ontouchstart", "ontouchend", "onpointerdown", "onpointerup", "onclick", "makeBadge", "sessionId", "badge", "moniker", "SeedRandom", "letters", "closePath", "fill", "makeQRCode", "displayQRCodeIfNeeded", "root", "qrcode", "noqr", "sessionURL", "qrDiv", "findElement", "shiftKey", "dockDiv", "classList", "toggle", "open", "spinnerOverlay", "spinnerEnabled", "spinnerTimeout", "makeSpinner", "spinnerCSS", "spinnerStyle", "innerHTML", "insertBefore", "addSpinnerStyle", "overlay", "spinner", "innerText", "ifNotFoundDo", "Element", "elem", "secureRandomString", "seenMessages", "_sessionURL", "canonicalUrl", "metas", "getElementsByTagName", "meta", "getAttribute", "href", "__MULTISYNQ__", "sync", "messages", "makeWidgetDock", "nodock", "debug", "oldDockDiv", "parentElement", "dockParent", "widgetCSS", "widgetStyle", "addWidgetStyle", "add", "iframe", "display", "barDiv", "badgeDiv", "contentDiv", "dockPageIds", "shiftPage", "dir", "numPages", "oldElem", "oldIndex", "newPage", "newElem", "alwaysPinned", "pinButton", "setPinState", "setCustomSize", "sz", "docHeight", "barHeight", "top", "border", "size", "fixedSize", "activate", "setTimeout", "transition", "TRANSITION_TIME", "deactivate", "contains", "onmouseenter", "onmouseleave", "lastWheelTime", "addEventListener", "deltaY", "sign", "innerHeight", "offsetWidth", "passive", "makeSessionWidgets", "nostats", "displayStatsIfNeeded", "makeQRCanvas", "clearSessionMoniker", "showSyncWait", "enabled", "clearTimeout", "opacity", "messageFunction", "gradient", "parentDef", "toastifyCSS", "toastifyStyle", "toastOpts", "gravity", "selector", "Toastify", "showToast", "only", "nomessages", "isCroquetHost", "referrerURL", "URL", "sameOrigin", "host", "autoSession", "force", "default", "keyless", "fragment", "params", "keyAndFragment", "find", "param", "searchParams", "set", "ex", "randomSession", "log", "retVal", "toPrimitive", "autoPassword", "scrub", "password", "keyAndPassword", "randomPassword", "VOTE_SUFFIX", "removeHandlers", "handlers", "subscriberId", "callback", "remaining", "handling", "handler", "for", "unbound", "delete", "viewDomain", "CROQUETVD", "subscriptions", "subscribers", "Map", "genericSubscriptions", "queuedEvents", "perFrameEvents", "perSyncedFrameEvents", "subscriberIds", "currentEvent", "currentEventFromModel", "register", "_subscriber", "deregister", "addSubscription", "scope", "event", "topic", "immediate", "queued", "oncePerFrame", "oncePerFrameWhileSynced", "topics", "removeSubscription", "removeAllSubscriptionsFor", "subscriptionsFor", "subscription", "hasUserSubcription", "generic", "genericSubscription", "onlyGeneric", "__CROQUET__", "handleEvent", "immediateWrapper", "fromModel", "prevEvent", "prevEventFromModel", "prevEventOnlyGeneric", "currentEventOnlyGeneric", "processFrameEvents", "controllerIsInAnimationStep", "controllerIsSynced", "invokeHandlers", "_genericTopic", "DEBUG", "subscribe", "ModelRealm", "vm", "model", "registerModel", "deregisterModel", "publish", "publishFromModel", "unsubscribe", "unsubscribeAll", "future", "tOffset", "methodArgs", "__currentRealm", "equal", "cancelFuture", "methodOrMessage", "time", "otherRealm", "isViewRealm", "ViewRealm", "vd", "controller", "valid", "view", "publishFromView", "Proxy", "_target", "property", "_method", "_this", "args", "inViewRealm", "externalNow", "reflectorTime", "extrapolatedNow", "extrapolatedTime", "isSynced", "synced", "currentRealm", "errorIfNoRealm", "inModelRealm", "prevRealm", "lib$1", "lib$2", "rational_pq", "s1", "s2", "rational_rs", "lib$3", "sgn", "zz", "z", "NaN", "lib$4", "FLG", "lib$5", "lib$6", "tostring", "native_class", "lib$7", "tostringtag", "polyfill", "isOwn", "tag", "out", "lib$8", "hasUint32Array", "lib$9", "lib$a", "uint32array", "main$7", "arr", "uint32array$1", "polyfill_1", "lib$c", "hasFloat64Array", "lib$d", "float64array", "main$a", "float64array$1", "polyfill_1$1", "lib$f", "hasUint8Array", "lib$g", "uint8array", "main$d", "lib$h", "uint8array$1", "polyfill_1$2", "lib$j", "hasUint16Array", "lib$k", "uint16array", "main$g", "lib$l", "uint16array$1", "uint16view", "polyfill_1$3", "ctors_1", "uint16", "uint8", "lib$o", "high", "FLOAT64_VIEW", "UINT32_VIEW", "lib$p", "high$1", "FLOAT64_VIEW$1", "UINT32_VIEW$1", "main$j", "lib$q", "lib$r", "Number", "POSITIVE_INFINITY", "lib$t", "NEGATIVE_INFINITY", "lib$u", "polyval_lp", "LN2_HI", "LN2_LO", "lib$v", "hfsq", "hu", "R", "u", "lib$w", "polyval_p", "polyval_q", "LN2_HI$1", "LN2_LO$1", "HIGH_SIGNIFICAND_MASK", "lib$x", "hx", "lib$y", "lib$z", "NEAR_ZERO", "lib$A", "xx", "lib$B", "polyval_p$1", "polyval_q$1", "MOREBITS$2", "lib$C", "flg", "NEAR_ZERO$1", "HIGH$2", "LOW", "lib$D", "indices_1", "HIGH", "FLOAT64_VIEW$2", "UINT32_VIEW$2", "HIGH$3", "LOW$1", "to_words", "HIGH$4", "LOW$2", "lib$E", "indices_1$1", "FLOAT64_VIEW$3", "UINT32_VIEW$3", "HIGH$5", "LOW$3", "main$l", "low", "lib$F", "WORDS", "lib$G", "hy", "lib$H", "lib$I", "lib$J", "q", "lib$K", "polyval_p$2", "ABS_MASK", "cbrt_1", "lib$L", "polyval_c13", "polyval_c46", "lib$M", "hz", "S1", "lib$N", "FLOAT64_VIEW$4", "UINT32_VIEW$4", "lib$O", "lib$P", "lib$T", "normalize_1", "lib$U", "main$q", "lib$W", "FRAC", "WORDS$1", "ldexp_1", "frac", "exp", "lib$X", "IPIO2", "PIO2", "TWO24", "TWON24", "zero", "FQ", "IQ", "compute", "jz", "q0", "jk", "jv", "jx", "carry", "fw", "ih", "jp", "kernel_rempio2", "e0", "nx", "lib$Y", "rempio2_medium", "ix", "PIO2_1$1", "PIO2_1T$1", "TWO_PIO2_1T", "THREE_PIO2_1T", "FOUR_PIO2_1T", "TX", "TY", "rempio2_1", "lib$Z", "lib$_", "lib$$", "lib$10", "polyval_p$3", "expmulti_1", "hi", "lo", "LOG2_E", "NEARZERO", "lib$11", "lib$12", "polyval_q$2", "LN2_HI$3", "LN2_LO$3", "LN2_INV", "lib$14", "halfX", "r1", "low$1", "FLOAT64_VIEW$5", "UINT32_VIEW$5", "main$r", "lib$15", "polyval_p$4", "polyval_q$3", "HIGH_SIGNIFICAND_MASK$1", "klog_1", "IVLN10HI", "lib$16", "polyval_p$5", "polyval_q$4", "HIGH_SIGNIFICAND_MASK$3", "klog_1$1", "IVLN2HI", "WORDS$2", "lib$17", "Y", "lib$18", "rational_pq$1", "MAXLOG", "POS_OVERFLOW", "LARGE", "lib$19", "polyval_t_odd", "polyval_t_even", "lib$1a", "buffer$1", "lib$1b", "rational_pq$2", "lib$1c", "CroquetMath", "assign", "acos", "acosh", "asin", "asinh", "atan", "atanh", "atan2", "cbrt", "cos", "cosh", "expm1", "log1p", "log10", "log2", "sin", "sinh", "tan", "tanh", "mathPow", "isInfinite$1", "Infinity", "isInteger", "signResult", "PriorityQueue", "FastPriorityQueue", "poll", "super", "array", "asArray", "asUnsortedArray", "parseLoop", "base64Str", "base64StrLength", "reverseMap", "bitsCombined", "Base64", "_map", "base64Chars", "triplet", "paddingChar", "_reverseMap", "paddingIndex", "_hasher", "hasherBlockSize", "hasherBlockSizeBytes", "oKey", "_oKey", "iKey", "_iKey", "oKeyWords", "iKeyWords", "innerHash", "PBKDF2", "keySize", "iterations", "salt", "hmac", "derivedKey", "blockIndex", "derivedKeyWords", "blockIndexWords", "block", "blockWords", "blockWordsLength", "intermediate", "intermediateWords", "require$$1", "require$$2", "T", "MD5", "offset_i", "M_offset_i", "M_offset_0", "M_offset_1", "M_offset_2", "M_offset_3", "M_offset_4", "M_offset_5", "M_offset_6", "M_offset_7", "M_offset_8", "M_offset_9", "M_offset_10", "M_offset_11", "M_offset_12", "M_offset_13", "M_offset_14", "M_offset_15", "FF", "GG", "HH", "II", "nBitsTotalH", "nBitsTotalL", "H_i", "HmacMD5", "SHA1", "HmacSHA1", "EvpKDF", "BlockCipher", "SBOX", "INV_SBOX", "SUB_MIX_0", "SUB_MIX_1", "SUB_MIX_2", "SUB_MIX_3", "INV_SUB_MIX_0", "INV_SUB_MIX_1", "INV_SUB_MIX_2", "INV_SUB_MIX_3", "xi", "sx", "x2", "x4", "x8", "RCON", "AES", "_nRounds", "_keyPriorReset", "_key", "keyWords", "ksRows", "keySchedule", "_keySchedule", "ksRow", "invKeySchedule", "_invKeySchedule", "invKsRow", "encryptBlock", "_doCryptBlock", "decryptBlock", "nRounds", "s0", "s3", "t0", "t2", "t3", "require$$3", "Cipher", "createEncryptor", "_ENC_XFORM_MODE", "createDecryptor", "_DEC_XFORM_MODE", "xformMode", "_xformMode", "process", "dataUpdate", "ivSize", "selectCipherStrategy", "PasswordBasedCipher", "SerializableCipher", "cipher", "encrypt", "decrypt", "ciphertext", "StreamCipher", "C_mode", "BlockCipherMode", "iv", "Encryptor", "Decryptor", "_cipher", "_iv", "CBC", "xorBlock", "_prevBlock", "processBlock", "thisBlock", "Pkcs7", "pad", "blockSizeBytes", "nPaddingBytes", "paddingWord", "paddingWords", "padding", "unpad", "modeCreator", "_mode", "__creator", "finalProcessedBlocks", "CipherParams", "cipherParams", "formatter", "OpenSSLFormatter", "format", "OpenSSL", "openSSLStr", "ciphertextWords", "encryptor", "cipherCfg", "_parse", "OpenSSLKdf", "kdf", "execute", "derivedParams", "zero$1", "buf", "LITERALS$1", "L_CODES$1", "D_CODES$1", "MAX_BITS$1", "extra_lbits", "extra_dbits", "extra_blbits", "bl_order", "static_ltree", "static_dtree", "_dist_code", "_length_code", "MAX_MATCH$1", "base_length", "base_dist", "StaticTreeDesc", "static_tree", "extra_bits", "extra_base", "elems", "max_length", "has_stree", "static_l_desc", "static_d_desc", "static_bl_desc", "TreeDesc", "dyn_tree", "stat_desc", "max_code", "d_code", "dist", "put_short", "pending_buf", "pending", "send_bits", "bi_valid", "bi_buf", "send_code", "tree", "bi_reverse", "res", "gen_codes", "bl_count", "next_code", "init_block", "dyn_ltree", "dyn_dtree", "bl_tree", "END_BLOCK", "opt_len", "static_len", "sym_next", "matches", "bi_windup", "smaller", "_n2", "_m2", "pqdownheap", "heap", "heap_len", "compress_block", "ltree", "dtree", "lc", "extra", "sym_buf", "build_tree", "stree", "node", "heap_max", "base", "xbits", "scan_tree", "curlen", "prevlen", "nextlen", "max_count", "min_count", "REP_3_6", "REPZ_3_10", "REPZ_11_138", "send_tree", "static_init_done", "_tr_stored_block$1", "stored_len", "last", "subarray", "_tr_flush_block_1", "_tr_flush_block$1", "opt_lenb", "static_lenb", "max_blindex", "strm", "data_type", "block_mask", "l_desc", "d_desc", "bl_desc", "BL_CODES$1", "strategy", "send_all_trees", "lcodes", "dcodes", "blcodes", "rank", "trees", "_tr_init", "LENGTH_CODES$1", "tr_static_init", "_tr_stored_block", "_tr_flush_block", "_tr_tally", "_tr_tally$1", "sym_end", "_tr_align", "STATIC_TREES", "adler32_1", "adler32", "adler", "crcTable", "table", "crc32_1", "crc32", "crc", "constants$2", "Z_NO_FLUSH", "Z_PARTIAL_FLUSH", "Z_SYNC_FLUSH", "Z_FULL_FLUSH", "Z_FINISH", "Z_BLOCK", "Z_TREES", "Z_OK", "Z_STREAM_END", "Z_NEED_DICT", "Z_ERRNO", "Z_STREAM_ERROR", "Z_DATA_ERROR", "Z_MEM_ERROR", "Z_BUF_ERROR", "Z_NO_COMPRESSION", "Z_BEST_SPEED", "Z_BEST_COMPRESSION", "Z_DEFAULT_COMPRESSION", "Z_FILTERED", "Z_HUFFMAN_ONLY", "Z_RLE", "Z_FIXED", "Z_DEFAULT_STRATEGY", "Z_BINARY", "Z_TEXT", "Z_UNKNOWN", "Z_DEFLATED", "Z_NO_FLUSH$2", "Z_FULL_FLUSH$1", "Z_FINISH$3", "Z_BLOCK$1", "Z_OK$3", "Z_STREAM_END$3", "Z_STREAM_ERROR$2", "Z_DATA_ERROR$2", "Z_BUF_ERROR$1", "Z_DEFAULT_COMPRESSION$1", "Z_DEFAULT_STRATEGY$1", "Z_DEFLATED$2", "MAX_MATCH", "MIN_LOOKAHEAD", "INIT_STATE", "BUSY_STATE", "FINISH_STATE", "errorCode", "slide_hash", "wsize", "w_size", "hash_size", "HASH", "HASH_ZLIB", "hash_shift", "hash_mask", "flush_pending", "avail_out", "output", "pending_out", "next_out", "total_out", "flush_block_only", "block_start", "strstart", "put_byte", "putShortMSB", "read_buf", "avail_in", "input", "next_in", "total_in", "longest_match", "cur_match", "chain_length", "max_chain_length", "scan", "best_len", "prev_length", "nice_match", "_win", "wmask", "w_mask", "strend", "scan_end1", "scan_end", "good_match", "lookahead", "match_start", "fill_window", "_w_size", "more", "window_size", "insert", "ins_h", "deflate_stored", "flush", "have", "min_block", "pending_buf_size", "used", "high_water", "deflate_fast", "hash_head", "bflush", "match_length", "max_lazy_match", "MIN_MATCH", "deflate_slow", "max_insert", "prev_match", "match_available", "Config", "good_length", "max_lazy", "nice_length", "max_chain", "configuration_table", "DeflateState", "status", "gzhead", "gzindex", "last_flush", "w_bits", "hash_bits", "HEAP_SIZE", "MAX_BITS", "lit_bufsize", "deflateStateCheck", "deflateResetKeep", "deflateReset", "ret", "deflateInit2", "windowBits", "memLevel", "deflate_2$1", "deflate$2", "old_flush", "header", "level_flags", "hcrc", "comment", "os", "beg", "gzhead_extra", "bstate", "deflate_rle", "deflate_1$2", "deflateInit", "deflateSetHeader", "deflate", "deflateEnd", "deflateSetDictionary", "dictionary", "dictLength", "tmpDict", "avail", "deflateInfo", "_has", "common", "sources", "source", "chunks", "chunk", "STR_APPLY_UIA_OK", "__", "_utf8len", "strings", "c2", "m_pos", "str_len", "buf_len", "buf2string", "TextDecoder", "decode", "utf16buf", "c_len", "buf2binstring", "utf8border", "zstream", "toString$1", "Z_NO_FLUSH$1", "Z_FINISH$2", "Z_OK$2", "Z_STREAM_END$2", "Z_DEFLATED$1", "Deflate$1", "chunkSize", "opt", "raw", "gzip", "ended", "dict", "_dict_set", "deflate$1", "deflator", "flush_mode", "_flush_mode", "onData", "onEnd", "deflate_1$1", "Deflate", "deflateRaw", "BAD$1", "inffast", "_in", "_out", "dmax", "whave", "wnext", "s_window", "hold", "lcode", "dcode", "lmask", "dmask", "here", "op", "from", "from_source", "lencode", "distcode", "lenbits", "distbits", "dolen", "sane", "MAXBITS", "lbase", "lext", "dbase", "dext", "inftrees", "inflate_table", "lens", "lens_index", "codes", "table_index", "work", "opts", "incr", "sym", "curr", "drop", "huff", "offs", "here_bits", "here_op", "here_val", "Z_FINISH$1", "Z_OK$1", "Z_STREAM_END$1", "Z_NEED_DICT$1", "Z_STREAM_ERROR$1", "Z_DATA_ERROR$1", "Z_MEM_ERROR$1", "HEAD", "DICT", "TYPE", "TYPEDO", "COPY_", "LEN_", "LEN", "CHECK", "BAD", "zswap32", "InflateState", "havedict", "flags", "check", "wbits", "ncode", "nlen", "ndist", "lendyn", "distdyn", "back", "was", "inflateStateCheck", "inflateResetKeep", "inflateReset", "inflateReset2", "inflateInit2", "lenfix", "distfix", "virgin", "fixedtables", "updatewindow", "inflate_2$1", "inflate$2", "last_bits", "last_op", "last_val", "hbuf", "inf_leave", "xflags", "extra_len", "inflate_1$2", "inflateInit", "inflate", "inflateEnd", "inflateGetHeader", "inflateSetDictionary", "dictid", "inflateInfo", "gzheader", "Inflate$1", "to", "inflate$1", "inflator", "last_avail_out", "next_out_utf8", "tail", "utf8str", "inflate_1$1", "Inflate", "inflateRaw", "ungzip", "pako", "constants", "OfflineSocket", "readyState", "WebSocket", "CONNECTING", "bufferedAmount", "OPEN", "onopen", "send", "action", "ticks", "tick", "seq", "reply", "tove", "reflector", "what", "joined", "user", "active", "close", "reason", "CLOSING", "CLOSED", "onclose", "clearInterval", "ticker", "setInterval", "onmessage", "FIREFOX", "navigator", "userAgent", "toLowerCase", "connection", "CroquetWebRTCConnection", "registryURL", "clientId", "substring", "pc", "dataChannel", "signaling", "connectionTypes", "onerror", "onconnected", "twoStageConnection", "openConnection", "isConnecting", "openSignalingChannel", "createPeerConnection", "createDataChannel", "onDataChannelOpen", "onDataChannelMessage", "onclosing", "onDataChannelClosing", "onDataChannelClose", "onDataChannelError", "offer", "createOffer", "negotiationTimeout", "dataChannelFlowing", "signalingCloseScheduled", "scheduleSignalingClose", "synchronizerDisconnected", "signalToSessionRunner", "sdp", "setLocalDescription", "sctp", "iceTransport", "transport", "onselectedcandidatepairchange", "pair", "getSelectedCandidatePair", "local", "remote", "logConnectionState", "synchronizerGatheringComplete", "localGatheringComplete", "signalingKey", "rawMsg", "msgData", "iceServers", "handleAnswer", "handleCandidate", "synchronizerError", "clearNegotiationTimeout", "msgStr", "getStats", "selectedPairId", "stat", "selectedCandidatePairId", "candidatePair", "selected", "localCandidateId", "candidateType", "remoteCandidateId", "clientType", "syncType", "_code", "_message", "cleanUpConnection", "synchronizerCloseReason", "errorDetail", "closeSignalingChannel", "peerConnectionStatsInterval", "iceReportedErrors", "RTCPeerConnection", "onnegotiationneeded", "_e", "onsignalingstatechange", "signalingState", "onconnectionstatechange", "connectionState", "iceConnectionState", "oniceconnectionstatechange", "dataChannelState", "onicegatheringstatechange", "iceGatheringState", "onicecandidate", "candidate", "sdpMid", "sdpMLineIndex", "onicecandidateerror", "errorKey", "errorText", "answer", "setRemoteDescription", "addIceCandidate", "parts", "_event", "defunct_readConnectionType", "o", "CROQUET_VERSION", "OLD_UPLOAD_SERVER", "OLD_DOWNLOAD_SERVER", "OLD_DATA_SERVER", "initOptions", "appOnCroquetIoDev", "devOrCroquetIoDev", "dev", "sends", "events", "pong", "initsnapshot", "offline", "box", "files", "setDebug", "fromEntries", "option", "DEPIN_API_PROD", "DEPIN_API_DEFAULT", "DEPIN", "DEPIN_API", "REFL_OR_SYNCH", "NOCHEAT", "nocheat", "MAX_SIMULATION_MS", "simLoad", "PAYLOAD_LIMIT_RECOMMENDED", "DEPRECATED_DEFAULT_KEY", "UploadWorker", "UploadWorkerFactory", "UploadJobs", "Controllers", "sessionProps", "found", "appId", "persistentId", "sessionSpec", "uploadEncrypted", "downloadEncrypted", "controllers", "Controller", "CROQUETVM", "Connection", "networkQueue", "msPerTick", "tickMultiplier", "extrapolatedTimeBase", "viewId", "viewDataEncrypted", "timeline", "rejoinTimeout", "sendBuffer", "usersTotal", "cpuTime", "triggeringCpuTime", "lastSnapshotRequest", "latencyHistory", "localTicker", "syncTimer", "tuttiHistory", "auditStats", "lastUsers", "minUsers", "maxUsers", "payloadTally", "lastAnimationEnd", "animationGapCheck", "rateLimitedSendTimes", "rateLimitBuffer", "rateLimitSoftWarned", "rateLimitBufferWarned", "rateLimitLastLogged", "payloadSizeWarned", "leaving", "codeHash", "viewOnly", "lastReceived", "lag", "lastSent", "canRejoinSeamlessly", "rejoinLimit", "computedCodeHash", "checkForConnection", "dormantDisconnect", "optionsFromUrl", "persistentIdOptions", "apiKey", "viewData", "viewIdDebugSuffix", "toUpperCase", "persistentParams", "sessionParams", "debugEvents", "__debugEvents", "__location", "hashOverride", "appIdAndName", "stableStringify", "developerId", "token", "verifyApiKey", "sdk_version", "codeHashes", "cached", "cacheAnnotation", "all", "effectiveCodeHash", "allHashes", "each", "encryptPayload", "eventRateLimit", "eventHistoryLimit", "eventMaxBundles", "multiplier", "getTickAndMultiplier", "setUpActivityChecks", "establishSession", "created", "toISOString", "sessionJoined", "syncCompleted", "getBackend", "apiKeysWithBackend", "signServer", "version", "backend", "defaultToDEPIN", "depin", "overridden", "maxRetries", "response", "fetchWithRetries", "fetch", "headers", "referrer", "referrerPolicy", "payload", "json", "goal", "instantFailureCodes", "allowedRetries", "fetchFn", "maxTries", "failureReport", "tried", "ok", "prefix", "instantFailure", "statusText", "delay", "lastKnownTime", "vmOrSnapshot", "externalTime", "takeSnapshot", "externalSeq", "date", "CroquetViewDate", "sdk", "takeSnapshotHandleErrors", "requestDebugSnapshot", "scheduleSnapshot", "sinceLast", "lastSnapshotPoll", "migratingOldSnapshot", "alert", "viewIds", "views", "sort", "Message", "sendTagged", "debounce", "msgID", "handlePollForSnapshot", "localCpuTime", "voteData", "getSummaryHash", "queueMicrotask", "pollForSnapshot", "sendTutti", "tallyTarget", "handleSnapshotVote", "tally", "numberOfGroups", "shouldUpload", "dissidentFlag", "analyzeTally", "diverged", "previous", "uploadSnapshot", "timeProperty", "votes", "votesByHash", "ourIndex", "vote", "hashGroups", "consensusIndex", "consensusHash", "ourHash", "clientIndices", "groupVotes", "allVotes", "snapshotPath", "paddedTime", "padStart", "hashSnapshot", "hashPromise", "snapshotWithoutMeta", "uploadServer", "content", "stringMS", "socket", "path", "announceSnapshotUrl", "logProps", "dissident", "urls", "snapshots", "differences", "diffJSON", "isArray", "aKeys", "bKeys", "aOnly", "bOnly", "propertyAccessor", "timer", "fetchOffline", "encrypted", "decrypted", "decryptBinary", "uncompressed", "job", "adder", "remover", "postMessage", "cmd", "_ref2", "keep", "transfer", "keyBase64", "server", "urlWithHash", "persistentPath", "pollForPersist", "vmTime", "persistTime", "persistentString", "persistentHash", "ourVote", "localContext", "handlePersistVote", "timeString", "doPersist", "didForcePersist", "forcePersist", "confirm", "convertReflectorMessage", "entered", "exited", "decryptPayload", "tuttiSeq", "tuttiKey", "missingClients", "asState", "handleTuttiResult", "finder", "hist", "dummyTuttiSeq", "tuttiIndex", "findIndex", "localPayload", "optionalTopic", "verifyExternal", "executeOn", "handleAuditRequest", "sessionTimeAtDispatch", "fastForwardHandler", "bytesIn", "audit_reflector_in", "bytesOut", "audit_reflector_out", "encodedStats", "handleUserTotalForAccounting", "messageSizeForAccounting", "messageSize", "_size", "receive", "prevReceived", "syncReceived", "clearSyncReceiptTimeout", "progressReporter", "reportProgress", "persisted", "snapshotSeq", "auditStatsInitializer", "closeConnectionWithError", "persistedOrSnapshot", "rejoining", "sameSession", "firstMessage", "newest", "oldest", "seamlessRejoin", "inSequence", "toDiscard", "leave", "messagesSinceSync", "timeFromReflector", "install", "fastForwardStart", "success", "port1", "port2", "MessageChannel", "runAgain", "progress", "budget", "caughtUp", "msgPayload", "addToStatistics", "rawTime", "rawtime", "simulateIfNeeded", "jitter", "delta", "multiplyTick", "reflectorNeedsSnapshot", "persistentData", "initFn", "verb", "noun", "models", "newVM", "VirtualMachine", "initialSnapshot", "setVM", "sendJoin", "specName", "specAppId", "specApiKey", "heraldUrl", "autoSleep", "dormantDelay", "leaveDelay", "syncReceiptTimeout", "connectionInterrupted", "shouldLeaveWhenDisconnected", "keepController", "rebootModelView", "plaintext", "deprecatedDefaultKey", "mac", "compareHmacs", "encryptMessage", "sendTime", "fst", "snd", "sendMessage", "payloadLength", "times", "addToRateLimitBuffer", "lastSend", "stillToWait", "serviceRateLimitBuffer", "recordRateLimitedSend", "socketSendMessage", "sentSingleMessages", "sentPayloadTotal", "bundledMessages", "msgState", "lastBundle", "msgStates", "totalPayload", "bufferTime", "newBundles", "buffered", "minGap", "bundle", "fromState", "envelope", "nowBuffered", "tags", "encryptedMsg", "description", "toSend", "_ref3", "wantsVote", "sendLog", "_len", "timeSent", "timeReceived", "tps", "rate", "mult", "parseFloat", "deadline", "weHaveTime", "advanceTo", "simStart", "messageWithSize", "payloadSize", "scheduleExternalMessage", "syncedMin", "syncedMax", "viewed", "applySyncChange", "doSchedule", "isBeingAnimated", "stepType", "parameters", "frameTime", "thisGap", "ANIMATION_REASONABLE_FRAME_GAP", "gaps", "ANIMATION_CHECK_FRAMES", "isInBackground", "expectedSimFPS", "simBudget", "allowableLag", "processModelViewEvents", "isInAnimationStep", "tickHook", "startStepping", "autoStepFn", "onAnimationFrame", "isOutOfSight", "requestAnimationFrame", "isVisibleInViewport", "visibilityState", "gapsOk", "delayOk", "IntersectionObserver", "intersectionChanged", "_observer", "isIntersecting", "observe", "checkForDormancy", "lastDormancyCheck", "outOfSightSince", "checkAliveness", "alivenessPoll", "keepAlive", "socketLastSent", "connectBlocked", "connectRestricted", "connectHasBeenCalled", "reconnectDelay", "missingTickThreshold", "setTick", "isConnected", "connectToReflector", "readyForJoin", "synchSpec", "developSpec", "synchRequest", "synchToken", "reflectorBase", "ourUrl", "reflectorParams", "cloudflareColo", "colo", "region", "reflectorUrl", "append", "oldSocket", "isFirst", "isLast", "chunkCollector", "chunkedData", "socketClosed", "autoReconnect", "dormant", "reportMsg", "disconnected", "reconnectTimeout", "stalledSince", "pongHook", "closeConnection", "caller", "PULSE", "PING", "DATAHANDLE_HASH", "DATAHANDLE_KEY", "DATAHANDLE_URL", "HandleCache", "fetchCount", "toBase64Url", "base64", "fromBase64Url", "base64url", "padEnd", "scramble", "Data", "store", "deprecatedKeep", "hasCurrent", "shareable", "sessionKey", "DataHandle", "toId", "DataView", "isView", "fromId", "atob", "encodedKey", "encodedUrl", "existing", "DataHandleSpec", "cls", "read", "CurrentVM", "DEBUG_WRITE_TARGET", "DEBUG_WRITE_PROXIES", "CroquetWarning", "patchBrowser", "CroquetViewMath", "funcName", "descriptor", "getOwnPropertyDescriptors", "modelFunc", "viewFunc", "arg1", "arg2", "modelDateWarning", "expr", "warned", "CroquetDate", "calledWithNew", "SystemDate", "UTC", "QFUNC", "createQFunc", "thisVal", "env", "fnOrSource", "selfRef", "qFunc", "QFunc", "compile", "compileQFunc", "compilerParams", "compilerArgs", "thisVar", "envVar", "envKeys", "envValues", "Model", "Croquet", "fnVar", "compilerSrc", "lines", "allButFirstLine", "minIndent", "some", "lastIndent", "fnOrSrc", "fnSelfRef", "freeze", "QFuncSpec", "flat", "flattenedEntries", "FUTURE_MESSAGE_HANDLER", "CANCEL_FUTURE", "SUBSCRIPTION_HANDLER", "asQFuncMethodPrefix", "QFUNC_FUTURE_PREFIX", "QFUNC_SUBSCRIPTION_PREFIX", "shouldRegisterQFuncMethod", "isQFuncFuture", "asQFuncSubscription", "isRegisteredQFuncSubscription", "execInVM", "previousVM", "REFLECTED_SUFFIX", "ENCODED_MESSAGES", "ENCODE_MESSAGE", "persistenceDetails", "WeakMap", "clearPersistenceCache", "FakeVM", "current", "compat", "namedModels", "before", "_random", "futureSeq", "lastPersistencePoll", "inPersistenceCoolOff", "modelsId", "vmData", "VMReader", "newOrRecycled", "readVM", "staticInitializers", "staticInitializer", "modelId", "generateJoinExit", "handleSessionDiverged", "removeMany", "hasReceiver", "lookUpModel", "_", "modelID", "partId", "lookUp", "modelName", "debugWriteProxy", "$debugWriteProxyHandler", "writeError", "objPath", "deleteProperty", "targetPath", "proxy", "noop", "_ref4", "newViews", "country", "extraConnections", "enterIndex", "exitIndex", "viewInfo", "publishFromModelOnly", "connections", "nextSeq", "receiver", "futureSend", "receiverID", "every", "futureRepeat", "removed", "removeOne", "asMethodName", "futureExecAndRepeat", "compileFuncString", "methodNameOrCallback", "newTime", "peek", "HANDLER_REGEX", "asFuncString", "$compiledFuncs", "cacheKey", "addGenericSubscription", "removeGenericSubscription", "handlerPrefix", "nameString", "indexToRemove", "reflected", "handleModelEventInModel", "handleModelEventInView", "handleViewEventInModel", "handleViewEventInView", "handleBundledEvents", "reflect", "voteTopic", "divergenceTopic", "wantsFirst", "wantsDiverge", "invokeGenericHandlers", "liveHandlers", "invokeHandler", "subScope", "subEvent", "rest", "dot", "handleTuttiDivergence", "debugDiverged", "diffDivergedSnapshots", "VMWriter", "VMHasher", "getHash", "forceSnapshot", "persist", "persistentDataFunc", "unchanged", "details", "timeUntilReady", "triggerPersistencePoll", "randomID", "encoded", "MessageArgumentEncoder", "seqA", "seqB", "receiverId", "other", "isExternal", "internalSeq", "argString", "selPos", "argPos", "MessageArgumentDecoder", "nested", "executor", "shortString", "ext", "sumForFloat", "fl", "setFloat64", "getInt32", "todo", "hashers", "addHasher", "classId", "ClassOrSpec", "allClassTypes", "hashStructure", "hashState", "oC", "mC", "nanC", "infC", "zC", "nC", "nH", "sC", "sL", "fC", "messageArray", "hashEntry", "hashDeferred", "defer", "isFinite", "hashArray", "hashIntArray", "hashModel", "hashObject", "inst", "reusableInstance", "nextRef", "refs", "writers", "addWriter", "okayToIgnore", "Class", "allClasses", "props", "isSpec", "writeAs", "writeStatic", "writeAllStaticInto", "writeInto", "writeDeferred", "classToID", "staticModelProps", "warnMultipleSessionsStatic", "staticTypeProps", "is", "$class", "$value", "writeRef", "writeArray", "writeArrayBuffer", "writeTypedArray", "writeModel", "writeObject", "$model", "arrayBufferToBase64", "written", "toJSON", "$id", "$ref", "UNRESOLVED", "unresolved", "postprocess", "readers", "addReader", "BigInt", "enableBackwardCompatibility", "major", "minor", "patch", "pre", "parsed", "compatMaps", "readDeferred", "resolveRefs", "doPostprocess", "readAllStatic", "readInto", "ref", "vmState", "modelClass", "classFromID", "ClassOrSpecs", "typeSpec", "readStatic", "classFromTypes", "readArray", "readModel", "readAs", "readObject", "instantiateClassID", "readAsArray", "readAsSet", "contents", "fillContents", "readAsMap", "keyValue", "readAsClass", "temp", "readRef", "decoded", "SYSTEM_CLASSES", "gatherClassTypes", "gatheredClasses", "seen", "newObjects", "kind", "sessions", "dest", "classes", "SECRET", "SuperInitNotCalled", "WeakSet", "hasID", "ModelClass", "createNoInit", "wellKnownModel", "beWellKnownAs", "__realm", "eventDebugInit", "realm", "allowConstructors", "resetInstance", "dupe", "ModelClasses", "CLASS_ID", "lastRegistered", "evaluate", "isExecuting", "dummyObject", "eventDebugOptions", "types", "secret", "destroy", "__realmError", "activeSubscription", "getModel", "modelOnly", "viewCount", "persistSession", "collectDataFunc", "modelClassId", "View", "logEvent", "subscribed", "emoji", "noSubscribers", "logPublishedEvent", "logReceivedEvent", "detach", "reattach", "eventSpec", "_time", "Messenger", "ready", "isInIframe", "enumerator", "setReceiver", "setIframeEnumerator", "on", "listener", "removeEventListener", "stopPublishingPointerMove", "removeAllSubscriptions", "directWindow", "contentWindow", "mName", "eName", "startPublishingPointerMove", "_moveHandler", "clientX", "clientY", "Session", "join_impl", "promises", "inherits", "A", "B", "ModelRoot", "ViewRoot", "step", "sleep", "sleepType", "SESSION_PARAMS", "isFrozen", "Constants", "deepFreeze", "freezeAndHashConstants", "versionId", "dataOpts", "latencies", "__CROQUET_DEVTOOLS__", "dispatchEvent", "CustomEvent", "detail", "initFromSessionSpec", "rebooting", "viewOptions", "leavePromise", "thisSession", "VERSION", "VERSION", "Multisynq", "Model", "View", "Session", "Data", "Constants", "App"]
}
